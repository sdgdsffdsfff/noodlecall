var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijcalendar",i={general:0,weekEnd:1,otherMonth:2,outOfRange:4,today:8,custom:16,disabled:32,selected:64,gap:128},s=function(e){function t(){e.apply(this,arguments),this._touchRangeSelect=!1}return __extends(t,e),t.prototype._create=function(){var e=this,t=e.options.wijCSS;e._originalStyle=e.element.attr("style"),window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),n.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(this.options),this.element.addClass("wijmo-wijcalendar  "+t.datepickerInline+" "+t.datepicker+" "+t.widget+" "+t.content+" "+t.helperClearFix+" "+t.cornerAll).attr("role","grid"),this._previewWrapper(this.options.allowPreview),this.element.data("preview.wijcalendar",!1),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refresh(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijcalendar")},t.prototype._init=function(){if(this.options.popupMode){var e={autoHide:!!this.options.autoHide,showing:undefined,shown:undefined,hiding:undefined,hidden:undefined},t=this;this.options.beforePopup&&(e.showing=this.options.beforePopup),this.options.afterPopup&&(e.shown=this.options.afterPopup),this.options.beforeClose&&(e.hiding=this.options.beforeClose),e.hidden=function(e){t.element.removeData("lastdate.wijcalendar"),t.options.afterClose&&t.options.afterClose.call(e)},this.element.wijpopup(e)}else this.element.removeAttr("style"),this._originalStyle&&this.element.attr("style",this._originalStyle);this._getSelectedDates(),this._getDisabledDates(),this._resetWidth(),this.refresh()},t.prototype.destroy=function(){var t=this.options.wijCSS;e.prototype.destroy.call(this),this.close(),this.element.html(""),this.element.removeClass("wijmo-wijcalendar "+t.datepickerInline+" "+t.datepicker+" "+t.widget+" "+t.content+" "+t.helperClearFix+" "+t.cornerAll+" "+t.datepickerMulti).removeAttr("role");var r=this;n.each(["preview","disableddates","selecteddates","dragging","lastdate","animating"],function(e,t){r.element.removeData(t+".wijcalendar")}),this._previewWrapper(!1)},t.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"showWeekDays":case"showWeekNumbers":case"showTitle":case"showOtherMonthDays":case"selectionMode":this.unSelectAll(),this._resetWidth(),this.refresh();break;case"culture":this.refresh();break;case"allowPreview":this._previewWrapper(n),this.refresh();break;case"monthCols":this._myGrid&&(this._myGrid=undefined),this._resetWidth(),this.refresh();break;case"monthRows":this._myGrid&&(this._myGrid=undefined);break;case"autoHide":this.element.wijpopup({autoHide:this.options.autoHide});break;case"selectedDates":this._getSelectedDates().setDates(n),this.refresh();break;case"disabledDates":this._getDisabledDates().setDates(n),this.refresh();break;case"displayDate":this.refresh();break;case"allowQuickPick":this._myGrid&&(this._myGrid=undefined),this.refresh()}},t.prototype._previewWrapper=function(e){e?this.element.parent().hasClass("wijmo-wijcalendar-preview-wrapper")||this.element.wrap("<div class='wijmo-wijcalendar-preview-wrapper "+this.options.wijCSS.helperClearFix+"'></div>"):this.element.parent().hasClass("wijmo-wijcalendar-preview-wrapper")&&this.element.unwrap()},t.prototype._isRTL=function(){return!!this._getCulture(null).isRTL},t.prototype.refresh=function(){this.element.empty().append(this._createCalendar()),this.element[(this._isRTL()?"add":"remove")+"Class"](this.options.wijCSS.datepickerRtl),this.options.showTitle?this.element.removeClass("wijmo-wijcalendar-notitle"):this.element.addClass("wijmo-wijcalendar-notitle"),this._bindEvents()},t.prototype.refreshDate=function(e){if(!this._monthViews)return;if(e<this._groupStartDate||e>this._groupEndDate)return;n.each(this._monthViews,function(){this._refreshDate(e)})},t.prototype.getDisplayDate=function(){var e=this.options.displayDate?this.options.displayDate:new Date;return a.isSameDate(e,new Date(1900,0,1))&&(e=new Date),e},t.prototype.getSelectedDate=function(){var e=this.options.selectedDates;return!e||e.length===0?null:e[0]},t.prototype.selectDate=function(e){return e=new Date(e),this._getDisabledDates().contains(e)?!1:e<this.options.minDate||e>this.options.maxDate?!1:(this._getSelectedDates().add(e),this.refreshDate(e),!0)},t.prototype.unSelectDate=function(e){return e=new Date(e),this._getDisabledDates().contains(e)?!1:e<this.options.minDate||e>this.options.maxDate?!1:(this._getSelectedDates().remove(e),this.refreshDate(e),!0)},t.prototype.unSelectAll=function(){var e=this.options.selectedDates,t;if(e&&e.length>0){this._getSelectedDates().clear();for(t=0;t<e.length;t++)this.refreshDate(e[t])}},t.prototype._slideToDate=function(e){if(a.isSameMonth(this.getDisplayDate(),e))return;var t=this.element.is(":visible");if(!t)this.options.displayDate=e;else{if(this._trigger("beforeSlide")===!1)return;this._isSingleMonth()?this._playSlideAnimation(e):this._playMmSlideAnimation(e)}},t.prototype.isPopupShowing=function(){return this.options.popupMode?this.element.wijpopup("isVisible"):!1},t.prototype.popup=function(e){this._myGrid=undefined,this.refresh(),this.element.data("dragging.wijcalendar",!1),this.element.data("wijmoWijpopup")&&this.element.wijpopup("show",e)},t.prototype.popupAt=function(e,t){this._myGrid=undefined,this.refresh(),this.element.data("dragging.wijcalendar",!1),this.element.data("wijmoWijpopup")&&this.element.wijpopup("showAt",e,t)},t.prototype.close=function(){this.isPopupShowing()&&this.element.wijpopup("hide")},t.prototype._getCulture=function(e){return Globalize.findClosestCulture(e||this.options.culture)},t.prototype._getDates=function(e){var t=e.toLowerCase()+".wijcalendar",n=this.element.data(t);return n===undefined&&(n=new l(this,e),this.element.data(t,n)),n},t.prototype._getDisabledDates=function(){return this._getDates("disabledDates")},t.prototype._getSelectedDates=function(){return this._getDates("selectedDates")},t.prototype._onDayDragStart=function(e){return e.preventDefault(),e.stopPropagation(),!1},t.prototype._onDayMouseDown=function(e){e.preventDefault(),e.stopPropagation();var t=this.options,r=this,i,s,o=!1,u=t.selectedDates,a=!1,f=[];if(e.which!==1)return e.which===0&&this._onTouchstart(e),!1;if(n.browser.msie&&parseFloat(n.browser.version)>=10)if(e.originalEvent.pointerType){if(e.originalEvent.pointerType===2||e.originalEvent.pointerType==="touch")return this._onTouchstart(e),!1}else if(e.originalEvent.originalEvent.pointerType)if(e.originalEvent.originalEvent.pointerType===2||e.originalEvent.originalEvent.pointerType==="touch")return this._onTouchstart(e),!1;return i=this._getCellDate(e.currentTarget),i===undefined?!1:t.selectionMode.day?(s={date:i},this._trigger("beforeSelect",null,s)===!1?!1:((!t.selectionMode.days||!e.metaKey&&!e.shiftKey&&!e.ctrlKey)&&this.unSelectAll(),!t.selectionMode.days||(e.shiftKey&&this.element.data("lastdate.wijcalendar")?(this._selectRange(this.element.data("lastdate.wijcalendar"),i,null),o=!0):e.ctrlKey&&(this.element.data("lastdate.wijcalendar",i),n.each(u,function(e,t){if(i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()&&i.getDate()===t.getDate())return a=!0,!1}),a?this.unSelectDate(i):this.selectDate(i),u=t.selectedDates,n.each(u,function(e,t){f.push(new Date(t))}),this._trigger("selectedDatesChanged",null,{dates:f}),o=!0)),o||(this.element.data("lastdate.wijcalendar",i),o=this.selectDate(i),this._trigger("selectedDatesChanged",null,{dates:[i]})),o&&(this._trigger("afterSelect",null,s),!t.selectionMode.days||(this.element.data("dragging.wijcalendar",!0),n(document.body).bind("mouseup."+this.widgetName,function(){n(document.body).unbind("mouseup."+r.widgetName),r.element.data("dragging.wijcalendar",!1)}))),!1)):!1},t.prototype._onMouseUp=function(e){return e.preventDefault(),e.stopPropagation(),this.element.data("dragging.wijcalendar",!1),!1},t.prototype._onDayClicked=function(e){var t=this._getCellDate(e.currentTarget);return t===undefined?!1:this.options.selectionMode.day?(this.isPopupShowing()?this.close():n(e.currentTarget).hasAllClasses(this.options.wijCSS.datepickerOtherMonth)&&this._slideToDate(t),!1):!1},t.prototype._onDayMouseEnter=function(e){n(e.currentTarget).attr("state","hover"),this._refreshDayCell(e.currentTarget);if(!!this.element.data("dragging.wijcalendar")){var t=this._getCellDate(e.currentTarget);if(t===undefined)return;this.unSelectAll(),this._selectRange(this.element.data("lastdate.wijcalendar"),t,!0)}},t.prototype._onDayMouseLeave=function(e){n(e.currentTarget).attr("state","normal"),this._refreshDayCell(e.currentTarget)},t.prototype._onTouchstart=function(e){this._touchStartTime=new Date},t.prototype._onTouchend=function(e){e.preventDefault(),e.stopPropagation();var t=new Date,r=t-this._touchStartTime,i=this.options,s=this,o,u,a=i.selectedDates,f=!1,l=[];this.element.data("dragging.wijcalendar",!1);if(n.browser.msie){if(!(parseFloat(n.browser.version)>=10))return!1;if(e.originalEvent.pointerType){if(e.originalEvent.pointerType!==2&&e.originalEvent.pointerType!=="touch")return!1}else{if(!e.originalEvent.originalEvent.pointerType)return!1;if(e.originalEvent.originalEvent.pointerType!==2&&e.originalEvent.originalEvent.pointerType!=="touch")return!1}}else if(e.which!==0)return!1;return o=this._getCellDate(e.currentTarget),o===undefined?!1:i.selectionMode.day?(u={date:o},this._trigger("beforeSelect",null,u)===!1?!1:(n.each(a,function(e,t){if(o.getFullYear()===t.getFullYear()&&o.getMonth()===t.getMonth()&&o.getDate()===t.getDate())return f=!0,!1}),!this._touchRangeSelect&&r>=750?(this.element.data("lastdate.wijcalendar",o),f?!i.selectionMode.days||this.unSelectDate(o):(i.selectionMode.days?this._touchRangeSelect=!0:this.unSelectAll(),this.selectDate(o)),a=i.selectedDates,n.each(a,function(e,t){l.push(new Date(t))}),a.length>0&&this._trigger("selectedDatesChanged",null,{dates:l})):(i.selectionMode.days||(this.unSelectAll(),this._touchRangeSelect=!1),this._touchRangeSelect?(r>=750&&(!i.selectionMode.days||(this.element.data("lastdate.wijcalendar",o),f?(this.unSelectDate(o),this._touchRangeSelect=!1):this.selectDate(o),a=i.selectedDates,n.each(a,function(e,t){l.push(new Date(t))}),this._trigger("selectedDatesChanged",null,{dates:l}))),r<750&&this.element.data("lastdate.wijcalendar")&&(this._selectRange(this.element.data("lastdate.wijcalendar"),o,null),this._touchRangeSelect&&(this._touchRangeSelect=!1))):(this.unSelectAll(),this.element.data("lastdate.wijcalendar",o),this.selectDate(o),this._trigger("selectedDatesChanged",null,{dates:[o]}))),this._trigger("afterSelect",null,u),this._touchStartTime=null,!1)):!1},t.prototype._selectRange=function(e,t,n){if(e!==undefined&&e!==new Date(1900,1,1)){var r=e,i=t,s=[];e>t&&(i=e,r=t);for(;;){if(r>i)break;this.selectDate(r),s[s.length]=r,r=a.addDays(r,1)}n||this.element.removeData("lastdate.wijcalendar"),this._trigger("selectedDatesChanged",null,{dates:s})}else this.selectDate(e),this._trigger("selectedDatesChanged",null,{dates:[e]});return!0},t.prototype._getCellDate=function(e){var t=n(e).attr("date");return t===undefined?t:new Date(t)},t.prototype._getParentTable=function(e){var t=n(e).parents("table");return t.length===0?undefined:t.get(0)},t.prototype._initMonthSelector=function(e){if(n(e).data("cells")!==undefined)return;var t=e.id.split("_"),r,i,s=[],o,u,a,f,l;if(t[t.length-1]!=="ms")throw Error.create("not a monthview");r=t.slice(0,t.length-1).join("_"),i=this._getParentTable(e);if(i){if(i.id!==r)throw Error.create("not a monthview");for(o=0;o<i.rows.length;o++){l=i.rows[o];for(u=0;u<l.cells.length;u++)a=l.cells[u],a&&(f=n(a).attr("daytype"),f!==undefined&&n(a).find("a").hasAllClasses(this.options.wijCSS.prioritySecondary)===!1&&this._isSelectable(parseInt(f,10))&&(s[s.length]=a))}}n(e).data("cells",s)},t.prototype._onMonthSelectorClicked=function(e){this._initMonthSelector(e.currentTarget);var t=n(e.currentTarget).data("cells"),r=[],i,s,o,u;this.element.removeData("lastdate.wijcalendar"),this.unSelectAll();for(i=0;i<t.length;i++)s=t[i],o=n(s).attr("date"),o!==undefined&&(u=new Date(o),this.selectDate(u),r[r.length]=u);return this._trigger("selectedDatesChanged",null,{dates:r}),this.isPopupShowing()&&this.close(),!1},t.prototype._onMonthSelectorMouseEnter=function(e){this._initMonthSelector(e.currentTarget);var t=n(e.currentTarget).data("cells"),r;for(r=0;r<t.length;r++)e.currentTarget=t[r],this._onDayMouseEnter(e)},t.prototype._onMonthSelectorMouseLeave=function(e){this._initMonthSelector(e.currentTarget);var t=n(e.currentTarget).data("cells"),r;for(r=0;r<t.length;r++)e.currentTarget=t[r],this._onDayMouseLeave(e)},t.prototype._initWeekDaySelector=function(e){if(n(e).data("cells")!==undefined)return;var t=e.id.split("_"),r,i,s,o=[],u=0,a,f,l;if(t[t.length-2]!=="cs")throw Error.create("not a column");r=parseInt(t[t.length-1],10),i=t.slice(0,t.length-2).join("_"),s=this._getParentTable(e);if(s){if(s.id!==i)throw Error.create("not a column");this.options.showWeekDays&&u++;for(;u<s.rows.length;u++)a=s.rows[u],r<a.cells.length&&(f=a.cells[r],f&&(l=n(f).attr("daytype"),l!==undefined&&n(f).find("a").hasAllClasses(this.options.wijCSS.prioritySecondary)===!1&&this._isSelectable(parseInt(l,10))&&(o[o.length]=f)))}n(e).data("cells",o)},t.prototype._onWeekDayClicked=function(e){this._initWeekDaySelector(e.currentTarget);var t=n(e.currentTarget).data("cells"),r=[],i,s,o,u;this.unSelectAll();for(i=0;i<t.length;i++)s=n(t[i]),o=s.attr("date"),o!==undefined&&(u=new Date(o),this.selectDate(u),r[r.length]=u);return this._trigger("selectedDatesChanged",null,{dates:r}),this.isPopupShowing()&&this.close(),!1},t.prototype._onWeekDayMouseEnter=function(e){this._initWeekDaySelector(e.currentTarget);var t=n(e.currentTarget).data("cells"),r;for(r=0;r<t.length;r++)e.currentTarget=t[r],this._onDayMouseEnter(e)},t.prototype._onWeekDayMouseLeave=function(e){this._initWeekDaySelector(e.currentTarget);var t=n(e.currentTarget).data("cells"),r;for(r=0;r<t.length;r++)e.currentTarget=t[r],this._onDayMouseLeave(e)},t.prototype._initWeekNumberSelector=function(e){if(n(e).data("cells")!==undefined)return;var t=e.id.split("_"),r,i,s,o=[],u,a,f,l;if(t[t.length-2]!=="rs")throw Error.create("not a row");r=parseInt(t[t.length-1],10),i=t.slice(0,t.length-2).join("_"),s=this._getParentTable(e);if(s){if(s.id!==i)throw Error.create("not a row");u=s.rows[r];if(u){a=0,this.options.showWeekNumbers&&a++;for(;a<u.cells.length;a++)f=u.cells[a],f&&(l=n(f).attr("daytype"),l!==undefined&&n(f).find("a").hasAllClasses(this.options.wijCSS.prioritySecondary)===!1&&this._isSelectable(parseInt(l,10))&&(o[o.length]=f))}}n(e).data("cells",o)},t.prototype._onWeekNumberClicked=function(e){this._initWeekNumberSelector(e.currentTarget);var t=n(e.currentTarget).data("cells"),r=[],i,s,o,u;this.unSelectAll();for(i=0;i<t.length;i++)s=n(t[i]),o=s.attr("date"),o!==undefined&&(u=new Date(o),this.selectDate(u),r[r.length]=u);return this._trigger("selectedDatesChanged",null,{dates:r}),this.isPopupShowing()&&this.close(),!1},t.prototype._onWeekNumberMouseEnter=function(e){this._initWeekNumberSelector(e.currentTarget);var t=n(e.currentTarget).data("cells"),r;for(r=0;r<t.length;r++)e.currentTarget=t[r],this._onDayMouseEnter(e)},t.prototype._onWeekNumberMouseLeave=function(e){this._initWeekNumberSelector(e.currentTarget);var t=n(e.currentTarget).data("cells"),r;for(r=0;r<t.length;r++)e.currentTarget=t[r],this._onDayMouseLeave(e)},t.prototype._isAnimating=function(){return!!this.element.data("animating.wijcalendar")},t.prototype._onPreviewMouseEnter=function(e){if(!!this.element.data("previewContainer"))return;if(this._isAnimating())return;var t=n(e.currentTarget),r=t.attr("id"),i=this.getDisplayDate(),s=this.options.wijCSS,o=this.options.monthCols*this.options.monthRows,u=n("<div/>");if(r===undefined)return;r==="prevPreview"&&(o=-o),this.options.displayDate=a.addMonths(i,o),this.element.data("preview.wijcalendar",!0),u.appendTo(document.body),u.hide(),u.addClass("wijmo-wijcalendar "+s.datepickerInline+" "+s.datepicker+" "+s.widget+" "+s.content+" "+s.helperClearFix+" "+s.cornerAll),u.append(this._createCalendar()),this.options.displayDate=i,this.element.data("preview.wijcalendar",!1),this._createMonthViews(),u.wijpopup({showEffect:"slide",showOptions:{direction:r==="prevPreview"?"right":"left"},hideEffect:"slide",hideOptions:{direction:r==="prevPreview"?"right":"left"}}),u.wijpopup("show",{my:r==="prevPreview"?"right top":"left top",at:r==="prevPreview"?"left top":"right top",of:t}),this.element.data("previewContainer",u)},t.prototype._onPreviewMouseLeave=function(e){var t=n(e.currentTarget),r=t.attr("id"),i=this.element.data("previewContainer"),s=this;if(r===undefined)return;i&&(i.wijpopup("isAnimating")?window.setTimeout(function(){s._onPreviewMouseLeave(e)},200):(i.wijpopup("hide"),this.element.removeData("previewContainer")))},t.prototype._resetWidth=function(){this._myGrid||(this.element.css("height",""),this.options.monthCols>1?(this.element.css("width",17*this.options.monthCols+"em"),this.element.addClass(this.options.wijCSS.datepickerMulti)):(this.element.css("width",""),this.element.removeClass(this.options.wijCSS.datepickerMulti)))},t.prototype._playMmSlideAnimation=function(e){var t=this.element.width(),r=this.element.height(),i=this.getDisplayDate(),s,o,u,a=this.options.direction||"horizontal",f=this,l,c;this.element.height(r),this.element.wrapInner("<div class='wijmo-wijcalendar-multi-aniwrapper'></div>"),s=this.element.find(">:first-child").width(t).height(r),o=s.clone(!1),o.hide(),this.options.displayDate=e,this._createMonthViews(),o.empty().append(this._createMonthGroup()),o.appendTo(this.element),u=e>i,this.element.data("animating.wijcalendar",!0),n.effects?(s.effect("slide",{mode:"hide",direction:a==="horizontal"?u?"left":"right":u?"up":"down",easing:this.options.easing||"easeOutBack",duration:this.options.duration},function(){s.remove()}),o.effect("slide",{direction:a==="horizontal"?u?"right":"left":u?"down":"up",easing:this.options.easing||"easeOutBack",duration:this.options.duration},function(){while(o.parent().is(".wijmo-wijcalendar-multi-aniwrapper"))o.parent().replaceWith(o);o.replaceWith(o.contents()),f.element.height(""),f._bindEvents(),f.element.data("animating.wijcalendar",!1),f._trigger("afterSlide")})):(a==="horizontal"?(l={width:0},c={width:"100%"}):(l={height:0},c={height:"100%"}),s.animate(l,this.options.duration,null,function(){s.remove()}),o.animate(c,this.options.duration,null,function(){while(o.parent().is(".wijmo-wijcalendar-multi-aniwrapper"))o.parent().replaceWith(o);o.replaceWith(o.contents()),f.element.height(""),f._bindEvents(),f.element.data("animating.wijcalendar",!1),f._trigger("afterSlide")}))},t.prototype._playSlideAnimation=function(e){if(!this._isSingleMonth())return;var t=this,r=this.getDisplayDate(),i=t.options.wijCSS,s=this.element.find("."+i.datepickerCalendar),o,u,a=1,l=this.options.direction||"horizontal",c=e>r,h=[],p,d,v;s.parent().is(".wijmo-wijcalendar-aniwrapper")?o=s.parent():(o=n.createWrapper(s).css({overflow:"hidden"}),o.removeClass(i.effectsWrapper),o.addClass("wijmo-wijcalendar-aniwrapper")),o.parent().is(".wijmo-wijcalendar-aniwrapper")?u=o.parent():(u=n.createWrapper(o).css({overflow:"hidden"}),u.removeClass(i.effectsWrapper),u.addClass("wijmo-wijcalendar-aniwrapper"));if(this._myGrid)switch(this._myGrid.gridType){case"month":a=1;break;case"year":a=10;break;case"decade":a=100}h[h.length]=e,p=s.outerWidth(),d=s.outerHeight(),l==="horizontal"?(s.width(p).css("float",c?"left":"right"),o.width((h.length+1)*p),o.css("left",c?0:-h.length*p).css("position","absolute")):(o.width(p),o.css("top",c?0:-h.length*d).css("position","absolute"),o.height((h.length+1)*d)),n.each(h,function(e,r){if(t._myGrid===undefined){var i=new f(t,r),s=t._customize(i.getHtml(!0));l==="horizontal"?s.width(p).css("float",c?"left":"right").appendTo(o):s.appendTo(o)}else l==="horizontal"?n(t._myGrid.getHtml(r,!0)).width(p).height(d).css("float",c?"left":"right").appendTo(o):n(t._myGrid.getHtml(r,!0)).height(d).appendTo(o)}),this.options.displayDate=e,this._myGrid===undefined&&this._createMonthViews(),this._refreshTitle(),this.element.data("animating.wijcalendar",!0),n.effects?o.effect("slide",{mode:"hide",direction:l==="horizontal"?c?"left":"right":c?"up":"down",easing:this.options.easing||"easeOutBack",distance:(l==="horizontal"?p:d)*h.length,duration:this.options.duration},function(){s=o.children(":last");while(s.parent().is(".wijmo-wijcalendar-aniwrapper"))s.parent().replaceWith(s);s.css({"float":"",width:""}),t._bindEvents(),t.element.data("animating.wijcalendar",!1),t._trigger("afterSlide")}):(l==="horizontal"?v={width:0}:v={height:0},o.animate(v,this.options.duration,null,function(){s=o.children(":last");while(s.parent().is(".wijmo-wijcalendar-aniwrapper"))s.parent().replaceWith(s);s.css({"float":"",width:""}),t._bindEvents(),t.element.data("animating.wijcalendar",!1),t._trigger("afterSlide")}))},t.prototype._onTitleClicked=function(){if(!this.options.allowQuickPick||!this._isSingleMonth())return;if(this._isAnimating())return;if(this._myGrid===undefined)this._myGrid=new c(this);else switch(this._myGrid.gridType){case"month":this._myGrid.gridType="year";break;case"year":this._myGrid.gridType="decade";break;case"decade":return}this._refreshTitle(),this.element.width(this.element.width()).height(this.element.height());var e=this.options.wijCSS,t=this.element.find("."+e.datepickerCalendar),r,i,s,o=t.outerWidth(),u=t.outerHeight(),a,f,l,h,p,d,v=this;t.parent().is(".wijmo-wijcalendar-aniwrapper")?r=t.parent():r=n.createWrapper(t).css({overflow:"hidden"}).removeClass(e.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper"),r.parent().is(".wijmo-wijcalendar-aniwrapper")?i=r.parent():i=n.createWrapper(r).css({overflow:"hidden"}).removeClass(e.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper").width(o).height(u),s=n(this._myGrid.getHtml(!0)).css({position:"absolute",top:0,left:0,opacity:0}).appendTo(i).height(u),a=this._myGrid.getSelectedIndex(),f=Math.floor(a/4),l=a-f*4,h=o/4,p=u/3,d={left:h*l,top:p*f,width:h,height:p},t.width("100%").height("100%"),r.css({border:"solid 1px #cccccc"}),this.element.data("animating.wijcalendar",!0),n.effects?r.effect("size",{to:d,duration:this.options.duration||500},function(){r.remove()}):r.animate(d,this.options.duration||500,null,function(){r.remove()}),s.animate({opacity:1},this.options.duration||500,null,function(){s.css({position:"",top:"",left:"",filter:""});while(s.parent().is(".wijmo-wijcalendar-aniwrapper"))s.parent().replaceWith(s);v._bindEvents(),v.element.data("animating.wijcalendar",!1)})},t.prototype._onMyGridClicked=function(e){if(this._myGrid===undefined)return!1;if(this._isAnimating())return!1;var t=n(e.currentTarget),r=parseInt(t.attr("index"),10),i=parseInt(t.attr("value"),10),s=this.options.wijCSS,o=this.element.find("."+s.datepickerCalendar),u,a,f,l,c,h,p,d,v,m=this;if(this._myGrid.gridType!=="month")if(!r||r===11)return!1;return t.hasAllClasses(s.stateActive)||this._myGrid.select(r,i),this._myGrid.gridType==="decade"?this._myGrid.gridType="year":this._myGrid.gridType==="year"?this._myGrid.gridType="month":this._myGrid=undefined,this._refreshTitle(),f=o.outerWidth(),l=o.outerHeight(),o.parent().is(".wijmo-wijcalendar-aniwrapper")?a=o.parent():a=n.createWrapper(o).css({overflow:"hidden"}).removeClass(s.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper").width(f).height(l),c=n.extend({},t.position(),{width:t.width(),height:t.height()}),this._myGrid===undefined?(this._createMonthViews(),p=this.getDisplayDate(),d=this._getMonthView(p),h=this._customize(d.getHtml(!0))):h=n(this._myGrid.getHtml(!0)),v=h.height(l).appendTo(a),u=n.createWrapper(v).css({overflow:"hidden"}).removeClass(s.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper").css(n.extend(c,{border:"solid 1px #cccccc",position:"absolute"})),this.element.data("animating.wijcalendar",!0),u.animate({left:0,top:0,width:f,height:l},this.options.duration||500,null,function(){v.css("width","")}),o.animate({opacity:0},this.options.duration||500,null,function(){o.remove();while(v.parent().is(".wijmo-wijcalendar-aniwrapper"))v.parent().replaceWith(v);m._myGrid===undefined&&m.element.width("").height(""),m._bindEvents(),m.element.data("animating.wijcalendar",!1)}),!1},t.prototype._onMyGridMouseEnter=function(e){if(this._myGrid===undefined)return;var t=n(e.currentTarget),r=parseInt(t.attr("index"),10);if(this._myGrid.gridType!=="month"&&(r<0||r>11))return;t.addClass(this.options.wijCSS.stateHover)},t.prototype._onMyGridMouseLeave=function(e){if(this._myGrid===undefined)return;var t=n(e.currentTarget),r=parseInt(t.attr("index"),10);if(this._myGrid.gridType!=="month"&&(r<0||r>11))return;t.removeClass(this.options.wijCSS.stateHover)},t.prototype._bindEvents=function(){var e=this.options.wijCSS;!this.element.data("preview.wijcalendar")&&!this.options.disabledState&&!this.options.disabled&&(this.element.find("div .wijmo-wijcalendar-navbutton").unbind().bind("mouseout.wijcalendar",function(){var t=n(this);t.removeClass(e.stateHover),t.hasAllClasses(e.datepickerNextHover)?t.removeClass(e.datepickerNextHover):t.hasAllClasses(e.datepickerPrevHover)&&t.removeClass(e.datepickerPrevHover)}).bind("mouseover.wijcalendar",function(){var t=n(this);t.addClass(e.stateHover),t.hasAllClasses(e.datepickerNext)?t.addClass(e.datepickerNextHover):t.hasAllClasses(e.datepickerPrev)&&t.addClass(e.datepickerPrevHover)}).bind("click.wijcalendar",n.proxy(this._onNavButtonClicked,this)),this.element.unbind(".wijcalendar").bind({"mouseup.wijcalendar":n.proxy(this._onMouseUp,this)}),this.element.find("."+e.datepickerTitle).unbind().bind("mouseout.wijcalendar",function(){n(this).removeClass(e.stateHover)}).bind("mouseover.wijcalendar",function(){n(this).addClass(e.stateHover)}).bind("click.wijcalendar",n.proxy(this._onTitleClicked,this)),this.element.find(".wijmo-wijcalendar-prevpreview-button, .wijmo-wijcalendar-nextpreview-button").unbind("mouseenter.wijcalendar").unbind("mouseleave.wijcalendar").bind({"mouseenter.wijcalendar":n.proxy(this._onPreviewMouseEnter,this),"mouseleave.wijcalendar":n.proxy(this._onPreviewMouseLeave,this)}),this._myGrid===undefined?(this.element.find(".wijmo-wijcalendar-day-selectable").unbind().bind({"wijclick.wijcalendar":n.proxy(this._onDayClicked,this),"mouseenter.wijcalendar":n.proxy(this._onDayMouseEnter,this),"mouseleave.wijcalendar":n.proxy(this._onDayMouseLeave,this),"wijmousedown.wijcalendar":n.proxy(this._onDayMouseDown,this),"dragstart.wijcalendar":n.proxy(this._onDayDragStart,this)}),n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(n.browser.msie&&this.element.unbind("contextmenu.wijcalendar").bind({"contextmenu.wijcalendar":function(){return!1}}),this.element.find(".wijmo-wijcalendar-day-selectable").unbind("wijmouseup.wijcalendar").bind({"wijmouseup.wijcalendar":n.proxy(this._onTouchend,this)})),!this.options.selectionMode.month||this.element.find(".wijmo-wijcalendar-monthselector").unbind().bind({"click.wijcalendar":n.proxy(this._onMonthSelectorClicked,this),"mouseenter.wijcalendar":n.proxy(this._onMonthSelectorMouseEnter,this),"mouseleave.wijcalendar":n.proxy(this._onMonthSelectorMouseLeave,this)}),!this.options.selectionMode.weekDay||this.element.find("."+e.datepickerWeekDay).unbind().bind({"click.wijcalendar":n.proxy(this._onWeekDayClicked,this),"mouseenter.wijcalendar":n.proxy(this._onWeekDayMouseEnter,this),"mouseleave.wijcalendar":n.proxy(this._onWeekDayMouseLeave,this)}),!this.options.selectionMode.weekNumber||this.element.find(".wijmo-wijcalendar-week-num").unbind().bind({"click.wijcalendar":n.proxy(this._onWeekNumberClicked,this),"mouseenter.wijcalendar":n.proxy(this._onWeekNumberMouseEnter,this),"mouseleave.wijcalendar":n.proxy(this._onWeekNumberMouseLeave,this)})):this.element.find(".wijmo-wijcalendar-day-selectable").unbind().bind({"click.wijcalendar":n.proxy(this._onMyGridClicked,this),"mouseenter.wijcalendar":n.proxy(this._onMyGridMouseEnter,this),"mouseleave.wijcalendar":n.proxy(this._onMyGridMouseLeave,this)}))},t.prototype._isSelectable=function(e){var t=this.options;return t.showOtherMonthDays&&e&i.otherMonth||!(e&(i.outOfRange|i.disabled|i.otherMonth))},t.prototype._getCellClassName=function(e,t,n){var r=this.options,s="",o=r.wijCSS.stateDefault,u=!!r.selectionMode.day||!!r.selectionMode.days;return n=n||!1,!n&&!r.disabledState&&!r.disabled&&u&&this._isSelectable(e)&&(s+=" wijmo-wijcalendar-day-selectable"),e&i.weekEnd&&(s+=" "+r.wijCSS.datepickerWeekEnd),e&i.otherMonth&&(s+=" "+r.wijCSS.datepickerOtherMonth,o+=" "+r.wijCSS.prioritySecondary),e&i.outOfRange&&(s+=" wijmo-wijcalendar-outofrangeday",o+=" "+r.wijCSS.prioritySecondary),e&i.gap?s+=" wijmo-wijcalendar-gap":(e&i.disabled&&(s+=" "+r.wijCSS.datepickerUnselectable,o+=" "+r.wijCSS.stateDisabled),e&i.today&&(s+=" "+r.wijCSS.datepickerDaysCellOver+" "+r.wijCSS.datepickerToday,o+=" "+r.wijCSS.stateHighlight),e&i.selected&&(e&(i.outOfRange|i.disabled))===0&&(s+=" "+r.wijCSS.datepickerCurrentDay,o+=" "+r.wijCSS.stateActive),e&i.gap&&(s+=" wijmo-wijcalendar-gap"),e&i.custom&&(s+=" wijmo-wijcalendar-customday")),{cssCell:s,cssText:o}},t.prototype._onNavButtonClicked=function(e){if(this._isAnimating())return!1;var t=1,r=n(e.currentTarget).attr("id"),i=this.getDisplayDate(),s=i;if(this._myGrid===undefined)t=r.indexOf("quick")>=0?this.options.quickNavStep:1,t=r.indexOf("next")>=0?t:-t,t=t*this.options.monthRows*this.options.monthCols,s=a.addMonths(i,t);else{t=r.indexOf("next")>=0?1:-1;switch(this._myGrid.gridType){case"month":s=a.addYears(i,t);break;case"year":s=a.addYears(i,t*10);break;case"decade":s=a.addYears(i,t*100)}}return this._slideToDate(s),!1},t.prototype._getMonthGroupHtml=function(){var e=this.getDisplayDate(),t,n,r,i=this.options.wijCSS,s,o;if(this._isSingleMonth())return t=this._getMonthView(e),t.showPreview=this.options.allowPreview&&!this.element.data("preview.wijcalendar"),t.getHtml();n=100/this.options.monthCols+"%",r=new u;for(s=0;s<this.options.monthRows;s++){for(o=0;o<this.options.monthCols;o++)r.writeBeginTag("div"),r.writeAttribute("class",i.datepickerGroup+(o===0?" "+i.datepickerGroupFirst:"")+(o===this.options.monthCols-1?" "+i.datepickerGroupLast:"")),r.writeAttribute("style","width:"+n),r.writeTagRightChar(),t=this._getMonthView(e),t.showPreview=!1,r.write(t.getHtml()),r.writeEndTag("div"),e=a.addMonths(e,1);r.writeBeginTag("div"),r.writeAttribute("class",i.datepickerRowBreak),r.writeTagRightChar(),r.writeEndTag("div")}return r.toString()},t.prototype._getCalendarHtml=function(){this._createMonthViews();var e=new u;return e.write(this._getMonthGroupHtml()),e.toString()},t.prototype._customizeDayCell=function(e){e.attr("state")===undefined&&e.attr("state","normal");if(e.attr("daytype")===undefined)return;if(e.attr("date")===undefined)return;var t=parseInt(e.attr("daytype"),10),n=new Date(e.attr("date")),r=e.attr("state")==="hover";this.options.customizeDate(e,n,t,r)},t.prototype._customize=function(e){var t=this.options,r=this,i=n(e);return n.isFunction(t.customizeDate)?(n.each(i.find(".wijmo-wijcalendar-day-selectable"),function(e,t){r._customizeDayCell(n(t))}),i):i},t.prototype._createCalendar=function(){return this._customize(n(n.parseHTML(this._getCalendarHtml())))},t.prototype._createMonthGroup=function(){return this._customize(n(this._getMonthGroupHtml()))},t.prototype._getMonthID=function(e){return e.getFullYear()+"_"+(e.getMonth()+1)},t.prototype._createMonthViews=function(){this._monthViews={};var e="",t=this.getDisplayDate(),n,r,i,s;for(n=0;n<this.options.monthRows;n++)for(r=0;r<this.options.monthCols;r++)e=this._getMonthID(t),this._monthViews[e]=new f(this,t),n===0&&(r===0&&(this._monthViews[e].isFirst=!0),r===this.options.monthCols-1&&(this._monthViews[e].isLast=!0)),t=a.addMonths(t,1);t=this.getDisplayDate(),e=this._getMonthID(t),i=this._monthViews[e],i&&(this._groupStartDate=i.getStartDate()),s=this.options.monthRows*this.options.monthCols,s>1&&(t=a.addMonths(t,s-1),e=this._getMonthID(t),i=this._monthViews[e]),i&&(this._groupEndDate=i.getEndDate())},t.prototype._getMonthView=function(e){var t=this._getMonthID(e);return this._monthViews[t]},t.prototype._getId=function(){return this.element.attr("id")},t.prototype._getChildElement=function(e){var t=this.element.find("[id*='"+e+"']");return t.length===0?undefined:t},t.prototype._refreshDayCell=function(e){var t=n(e),r=this.options,s,o,u,a;t.attr("state")===undefined&&t.attr("state","normal");if(t.attr("daytype")===undefined)return;if(t.attr("date")===undefined)return;s=parseInt(t.attr("daytype"),10),o=new Date(t.attr("date")),u=t.attr("state")==="hover",t.attr("class",this._getCellClassName(s,o,undefined).cssCell),t.removeAttr("aria-selected"),s&i.selected&&t.attr("aria-selected",!0);if(n.isFunction(r.customizeDate)&&this._customizeDayCell(t))return;a=t.find("a"),a.length>0&&(a.toggleClass(this.options.wijCSS.stateHover,u),a.toggleClass(this.options.wijCSS.stateActive,(s&i.selected)!==0))},t.prototype._isSingleMonth=function(){return this.options.monthCols*this.options.monthRows===1},t.prototype._splitString=function(e,t,n){if(n===undefined)return e.split(t);var r=[],i=e.split(t),s;for(s=0;s<i.length;s++)s>=n?r[n-1]=r[n-1]+t+i[s]:r.push(i[s]);return r},t.prototype._getNavButtonHtml=function(e,t,n,r){var i=new u;return i.writeBeginTag("a"),i.writeAttribute("id",e),i.writeAttribute("class",t),i.writeAttribute("role","button"),i.writeAttribute("href","#"),r&&(i.writeAttribute("title",r),i.writeAttribute("aria-label",r)),i.writeTagRightChar(),i.writeBeginTag("span"),i.writeAttribute("class",n),i.writeTagRightChar(),r&&i.write(r),i.writeEndTag("span"),i.writeEndTag("a"),i.toString()},t.prototype._getTitleText=function(e){if(this._myGrid!==undefined)return this._myGrid.getTitle();var t=e||this.getDisplayDate(),r=this.options.titleFormat||"MMMM yyyy";return n.isFunction(this.options.title)?this.options.title(t,r)||this._formatDate(r,t):this._formatDate(r,t)},t.prototype._refreshTitle=function(){this.element.find("."+this.options.wijCSS.datepickerTitle).html(this._getTitleText(undefined))},t.prototype._fillTitle=function(e,t){var n=this.options.wijCSS;e.writeBeginTag("div"),e.writeAttribute("class",n.datepickerTitle+" wijmo-wijcalendar-title"+" "+n.stateDefault+" "+n.cornerAll),e.writeTagRightChar(),e.write(this._getTitleText(t)),e.writeEndTag("div")},t.prototype._getHeaderHtml=function(e,t,n){var r=!!this.element.data("preview.wijcalendar"),i=this.options.wijCSS,s=r?"none":this._isSingleMonth()?this.options.navButtons:"default",o=this.element.is("."+i.datepickerRtl),a=new u;return s==="quick"?(a.writeBeginTag("div"),a.writeAttribute("class",i.header+" wijmo-wijcalendar-header "+i.helperClearFix+" "+i.cornerAll),a.writeAttribute("role","heading"),a.writeTagRightChar(),!t||a.write(this._getNavButtonHtml("quickprev","wijmo-wijcalendar-navbutton "+i.datepickerPrev+" "+i.cornerAll,i.icon+" ui-icon-seek-"+(o?"next":"prev")+" "+(o?this.options.wijCSS.iconArrowRight:this.options.wijCSS.iconArrowLeft),this.options.quickPrevTooltip.replace("#",this.options.quickNavStep))),a.writeBeginTag("div"),a.writeAttribute("class",i.datepickerHeader+" wijmo-wijcalendar-header-inner"),a.writeTagRightChar(),!t||a.write(this._getNavButtonHtml("prev","wijmo-wijcalendar-navbutton "+i.datepickerPrev+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(o?"e":"w")+" "+(o?this.options.wijCSS.iconArrowRight:this.options.wijCSS.iconArrowLeft),this.options.prevTooltip)),this._fillTitle(a,e),!n||a.write(this._getNavButtonHtml("next","wijmo-wijcalendar-navbutton "+i.datepickerNext+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(o?"w":"e")+" "+(o?this.options.wijCSS.iconArrowLeft:this.options.wijCSS.iconArrowRight),this.options.nextTooltip)),a.writeEndTag("div"),!n||a.write(this._getNavButtonHtml("quicknext","wijmo-wijcalendar-navbutton "+i.datepickerNext+" "+i.cornerAll,i.icon+" ui-icon-seek-"+(o?"prev":"next")+" "+(o?this.options.wijCSS.iconArrowLeft:this.options.wijCSS.iconArrowRight),this.options.quickNextTooltip.replace("#",this.options.quickNavStep))),a.writeEndTag("div")):(a.writeBeginTag("div"),a.writeAttribute("class",i.datepickerHeader+" "+i.header+" "+i.datepickerHeader+" "+i.helperClearFix+" "+i.cornerAll),a.writeAttribute("role","heading"),a.writeTagRightChar(),s!=="none"&&!!t&&a.write(this._getNavButtonHtml("prev","wijmo-wijcalendar-navbutton "+i.datepickerPrev+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(o?"e":"w")+" "+(o?this.options.wijCSS.iconArrowRight:this.options.wijCSS.iconArrowLeft),this.options.prevTooltip)),this._fillTitle(a,e),s!=="none"&&!!n&&a.write(this._getNavButtonHtml("next","wijmo-wijcalendar-navbutton "+i.datepickerNext+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(o?"w":"e")+" "+(o?this.options.wijCSS.iconArrowLeft:this.options.wijCSS.iconArrowRight),this.options.nextTooltip)),a.writeEndTag("div")),a.toString()},t.prototype._formatDate=function(e,t){return a.getTicks(t)?Globalize.format(t,e,this._getCulture(null)):"&nbsp;"},t}(e.wijmoWidget);t.wijcalendar=s;var o=function(){function e(){this.initSelector=":jqmData(role='wijcalendar')",this.wijCSS={datepickerInline:"ui-datepicker-inline",datepicker:"ui-datepicker",datepickerCalendar:"ui-datepicker-calendar",datepickerMulti:"ui-datepicker-multi",datepickerRtl:"datepicker-rtl",datepickerOtherMonth:"ui-datepicker-other-month",prioritySecondary:"ui-priority-secondary",effectsWrapper:"ui-effects-wrapper",datepickerNextHover:"ui-datepicker-next-hover",datepickerPrevHover:"ui-datepicker-prev-hover",datepickerNext:"ui-datepicker-next",datepickerPrev:"ui-datepicker-prev",datepickerTitle:"ui-datepicker-title",datepickerWeekDay:"ui-datepicker-week-day",datepickerWeekEnd:"ui-datepicker-week-end",datepickerUnselectable:"ui-datepicker-unselectable",datepickerDaysCellOver:"ui-datepicker-days-cell-over",datepickerToday:"ui-datepicker-today",stateHighlight:"ui-state-highlight",datepickerCurrentDay:"ui-datepicker-current-day",datepickerGroup:"ui-datepicker-group",datepickerGroupFirst:"ui-datepicker-group-first",datepickerGroupLast:"ui-datepicker-group-last",datepickerRowBreak:"ui-datepicker-row-break",datepickerHeader:"ui-datepicker-header",uiIconGripDottedVertical:"ui-icon-grip-dotted-vertical",uiDatepickerWeekCol:"ui-datepicker-week-col"},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body ui-body-c",stateDefault:"ui-btn-up-c",stateHighlight:"ui-btn-down-e"},this.culture="",this.monthCols=1,this.monthRows=1,this.titleFormat="MMMM yyyy",this.showTitle=!0,this.displayDate=undefined,this.dayRows=6,this.dayCols=7,this.weekDayFormat="short",this.showWeekDays=!0,this.showWeekNumbers=!1,this.calendarWeekRule="firstDay",this.minDate=new Date(1900,0,1),this.maxDate=new Date(2099,11,31),this.showOtherMonthDays=!0,this.showDayPadding=!1,this.selectionMode={day:!0,days:!0},this.allowPreview=!1,this.allowQuickPick=!0,this.toolTipFormat="dddd, MMMM dd, yyyy",this.prevTooltip="Previous",this.nextTooltip="Next",this.quickPrevTooltip="Quick Previous",this.quickNextTooltip="Quick Next",this.prevPreviewTooltip="",this.nextPreviewTooltip="",this.navButtons="default",this.quickNavStep=12,this.direction="horizontal",this.duration=250,this.easing="easeInQuad",this.popupMode=!1,this.autoHide=!0,this.customizeDate=null,this.title=null,this.beforeSlide=null,this.afterSlide=null,this.beforeSelect=null,this.afterSelect=null,this.selectedDatesChanged=null}return e}();s.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new o),n.wijmo.registerWidget("wijcalendar",s.prototype);var u=function(){function e(){this._html=[]}return e.prototype.writeTagLeftChar=function(){this._html[this._html.length]="<"},e.prototype.writeTagRightChar=function(){this._html[this._html.length]=">"},e.prototype.write=function(e){this._html[this._html.length]=" "+e+" "},e.prototype.writeBeginTag=function(e){this._html[this._html.length]="<"+e},e.prototype.writeEndTag=function(e){this._html[this._html.length]="</"+e+">"},e.prototype.writeFullBeginTag=function(e){this._html[this._html.length]="<"+e+">"},e.prototype.writeSelfClosingTagEnd=function(){this._html[this._html.length]="/>"},e.prototype.writeAttribute=function(e,t){if(t===undefined||t===null)return;this._html[this._html.length]=" "+e+'="',this._html[this._html.length]=t,this._html[this._html.length]='"'},e.prototype.clean=function(){this._html=[]},e.prototype.toString=function(){return this._html.join("")},e}();t.htmlTextWriter=u;var a={addDays:function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()+t);return t&&n.getDate()===e.getDate()&&(n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n.setTime(n.getTime()+t*24*3600*1e3)),n},addMonths:function(e,t){return new Date(e.getFullYear(),e.getMonth()+t,1)},addYears:function(e,t){return this.addMonths(e,t*12)},getDate:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},getTicks:function(e){return e.valueOf()},isSameDate:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},isSameMonth:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()},getDaysInMonth:function(e){return(new Date(e.getFullYear(),e.getMonth()+1,0)).getDate()},getWeekStartDate:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()-(e.getDay()-t+7)%7)},getDayOfYear:function(e){var t=new Date(e.getFullYear(),0,1),n=this.getTicks(e)-this.getTicks(t),r=n/864e5;return Math.floor(r)+1},getFirstDayWeekOfYear:function(e,t){var n=this.getDayOfYear(e)-1,r=e.getDay()-n%7,i;return r=(r-t+14)%7,i=(n+r)/7,Math.floor(i)+1},getDayOfWeek:function(e,t){return(e.getDay()-t+7)%7},getWeekOfYearFullDays:function(e,t,n,r){var i=this.getDayOfYear(e)-1,s=this.getDayOfWeek(e,n)-i%7;return s=(n-s+14)%7,s&&s>=r&&(s-=7),s=i-s,s>=0?Math.floor(s/7)+1:this.getWeekOfYearFullDays(this.addDays(e,-(i+1)),t,n,r)},getWeekOfYear:function(e,t,n){switch(t){case"firstDay":return this.getFirstDayWeekOfYear(e,n);case"firstFullWeek":return this.getWeekOfYearFullDays(e,t,n,7);case"firstFourDayWeek":return this.getWeekOfYearFullDays(e,t,n,4)}return this.getFirstDayWeekOfYear(e,n)},getDateToken:function(e){return e.getFullYear()+"_"+e.getMonth()+"_"+e.getDate()}},f=function(){function e(e,t){this.calendar=e;if(t===undefined||a.isSameDate(t,new Date(1900,0,1)))t=new Date;this.displayDate=t,this.id=this.calendar._getId()+"_"+this.calendar._getMonthID(t),this.isFirst=!1,this.isLast=!1,this.showPreview=!1,this.culture=this.calendar._getCulture(),this._calcDates(this.displayDate)}return e.prototype._calcDates=function(e){var t=a.getDaysInMonth(e);this._startDateInMonth=new Date(e.getFullYear(),e.getMonth(),1),this._endDateInMonth=a.addDays(this._startDateInMonth,t-1),this._startDate=a.getWeekStartDate(this._startDateInMonth,this.culture.calendar.firstDay),this._endDate=a.addDays(this._startDate,this.calendar.options.dayRows*this.calendar.options.dayCols-1)},e.prototype._isFirstMonth=function(){var e=this.calendar.getDisplayDate();return a.isSameMonth(this._startDateInMonth,e)},e.prototype._isLastMonth=function(){var e=this.calendar.getDisplayDate();return e=new Date(e.getFullYear(),e.getMonth(),1),e=a.addMonths(e,this.calendar.options.monthCols*this.calendar.options.monthRows-1),a.isSameMonth(this._startDateInMonth,e)},e.prototype.getStartDate=function(){return this._startDate},e.prototype.getEndDate=function(){return this._endDate},e.prototype._getMonthDate=function(){return this._startDateInMonth===undefined,this._startDateInMonth},e.prototype._setMonthDate=function(e){this._calcDates(e)},e.prototype._getWeekDayText=function(e,t){t=t||"short";var n=this.culture.calendar.days,r="";switch(t){case"full":r=n.names[e];break;case"firstLetter":r=n.names[e].substring(0,1);break;case"abbreviated":r=n.namesAbbr[e];break;default:r=n.namesShort[e]}return r},e.prototype._getRowCount=function(){var e=this.calendar.options;return e.showWeekDays?e.dayRows+1:e.dayRows},e.prototype._getColCount=function(){var e=this.calendar.options;return e.showWeekNumbers?e.dayCols+1:e.dayCols},e.prototype._getDayType=function(e){var t=this.calendar.options,n=i.general,r=e.getDay(),s=r===6||r===0,o=e<t.minDate||e>t.maxDate,u=e<this._startDateInMonth||e>this._endDateInMonth,f=o||this.calendar._getDisabledDates().contains(e),l=this.calendar._getSelectedDates().contains(e),c=new Date,h=a.isSameDate(e,c),p=!1;return s&&(n|=i.weekEnd),h&&(n|=i.today),f&&(n|=i.disabled),u&&(n|=i.otherMonth),o&&(n|=i.outOfRange),l&&(n|=i.selected),p&&(n|=i.custom),u&&!t.showOtherMonthDays&&(n|=i.gap),n},e.prototype._refreshDate=function(e){if(e<this._startDate||e>this._endDate)return;var t=this.calendar.options,r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),i=Date.UTC(this._startDate.getFullYear(),this._startDate.getMonth(),this._startDate.getDate()),s=Math.floor(Math.abs(r-i)/864e5),o=Math.floor(s/this.calendar.options.dayCols),u=Math.floor(s%this.calendar.options.dayCols),a,f,l,c;t.showWeekNumbers&&u++,t.showWeekDays&&o++,a=n("#"+this.id,this.calendar.element).get(0),a&&o<a.rows.length&&(f=a.rows[o],u<f.cells.length&&(l=f.cells[u],c=this._getDayType(e),n(l).attr("daytype",c.toString()),this.calendar._refreshDayCell(l)))},e.prototype._fillDayCell=function(e,t,n){var r=this.calendar.options,s=null,o=t.getDate().toString(),u=this.calendar._formatDate(r.toolTipFormat||"dddd, MMMM dd, yyyy",t),a=this._getDayType(t),f=this.calendar._isSelectable(a),l=this.calendar._getCellClassName(a,t,n);o=r.showDayPadding&&o.length===1?"0"+o:o,e.writeBeginTag("td"),e.writeAttribute("daytype",a.toString()),f&&(e.writeAttribute("title",u),e.writeAttribute("aria-label",u)),e.writeAttribute("date",t.toDateString()),e.writeAttribute("class",l.cssCell),e.writeAttribute("role","gridcell"),f||e.writeAttribute("aria-disabled","true"),e.writeTagRightChar(),a&i.gap?e.write("&#160;"):s&&s.content?e.write(s.content):(e.writeBeginTag("a"),e.writeAttribute("class",l.cssText),e.writeAttribute("href","#"),e.writeAttribute("onclick","return false;"),e.writeTagRightChar(),e.write(o),e.writeEndTag("a")),e.writeEndTag("td")},e.prototype.getHtml=function(e){e=!!e;var t=this.calendar.options,n=t.wijCSS,r=!!this.calendar.element.data("preview.wijcalendar"),i=new u,s,o,f,l,c,h,p,d,v,m,g,y;!e&&t.showTitle&&i.write(this.calendar._getHeaderHtml(this._startDateInMonth,this.isFirst,this.isLast)),!e&&!r&&this.showPreview&&(i.writeBeginTag("div"),i.writeAttribute("class","wijmo-wijcalendar-prevpreview-button"),i.writeAttribute("role","button"),i.writeAttribute("aria-haspopup","true"),i.writeAttribute("id","prevPreview"),i.writeTagRightChar(),i.writeBeginTag("a"),i.writeAttribute("class",n.icon+" "+n.uiIconGripDottedVertical),i.writeAttribute("href","#"),i.writeAttribute("title",t.prevPreviewTooltip),i.writeAttribute("aria-label",t.prevPreviewTooltip),i.writeAttribute("onclick","return false;"),i.writeTagRightChar(),i.write("&#160;"),i.writeEndTag("a"),i.writeEndTag("div")),i.writeBeginTag("table"),i.writeAttribute("id",this.id),i.writeAttribute("class",n.datepickerCalendar+" wijmo-wijcalendar-table"),i.writeAttribute("role","grid"),i.writeAttribute("summary",this.calendar._getTitleText(this._startDateInMonth)),i.writeAttribute("onselectstart","return false;"),i.writeTagRightChar();if(t.showWeekDays){i.writeFullBeginTag("thead"),i.writeBeginTag("tr"),i.writeTagRightChar(),t.showWeekNumbers&&(i.writeBeginTag("th"),i.writeAttribute("id",this.id+"_ms"),i.writeAttribute("class",n.uiDatepickerWeekCol+" wijmo-wijcalendar-monthselector"+(t.selectionMode.month?" wijmo-wijcalendar-selectable":"")),i.writeAttribute("role","columnheader"),i.writeTagRightChar(),!!t.selectionMode.month&&!r?(i.writeBeginTag("a"),i.writeAttribute("class",n.icon+" "+n.iconArrowRightDown),i.writeAttribute("style","display: block;"),i.writeSelfClosingTagEnd()):i.write(t.weekString?t.weekString:"Wk"),i.writeEndTag("th")),f=this._startDate.getDay(),l=this._startDate;for(s=0;s<t.dayCols;s++)c=f===6||f===0,h=s+(t.showWeekNumbers?1:0),p=this._getWeekDayText(f,t.weekDayFormat),d=this._getWeekDayText(f,"full"),i.writeBeginTag("th"),i.writeAttribute("id",this.id+"_cs_"+h),i.writeAttribute("class",n.datepickerWeekDay+(c?" "+n.datepickerWeekEnd:"")+(t.selectionMode.weekDay?" wijmo-wijcalendar-selectable":"")),i.writeAttribute("role","columnheader"),i.writeTagRightChar(),i.writeBeginTag("span"),i.writeAttribute("title",d),i.writeAttribute("aria-label",d),i.writeTagRightChar(),i.write(p),i.writeEndTag("span"),i.writeEndTag("th"),f=(f+1)%7,l=a.addDays(l,1);i.writeEndTag("tr"),i.writeEndTag("thead")}i.writeFullBeginTag("tbody"),v=this._startDate,m=this._startDateInMonth;for(s=0;s<t.dayRows;s++){i.writeBeginTag("tr"),i.writeTagRightChar(),t.showWeekNumbers&&(g=s+(t.showWeekDays?1:0),i.writeBeginTag("td"),i.writeAttribute("id",this.id+"_rs_"+g),i.writeAttribute("class",n.uiDatepickerWeekCol+" wijmo-wijcalendar-week-num"+(t.selectionMode.weekNumber?" wijmo-wijcalendar-selectable":"")),i.writeAttribute("role","rowheader"),i.writeTagRightChar(),y=a.getWeekOfYear(m,t.calendarWeekRule,this.culture.calendar.firstDay),i.write(y),i.writeEndTag("td"),m=a.addDays(m,t.dayCols));for(o=0;o<t.dayCols;o++)this._fillDayCell(i,v,r),v=a.addDays(v,1);i.writeEndTag("tr")}return i.writeEndTag("tbody"),i.writeEndTag("table"),!e&&!r&&this.showPreview&&(i.writeBeginTag("div"),i.writeAttribute("class","wijmo-wijcalendar-nextpreview-button"),i.writeAttribute("role","button"),i.writeAttribute("aria-haspopup","true"),i.writeAttribute("id","nextPreview"),i.writeTagRightChar(),i.writeBeginTag("a"),i.writeAttribute("class",n.icon+" "+n.uiIconGripDottedVertical),i.writeAttribute("href","#"),i.writeAttribute("title",t.nextPreviewTooltip),i.writeAttribute("aria-label",t.nextPreviewTooltip),i.writeAttribute("onclick","return false;"),i.writeTagRightChar(),i.write("&#160;"),i.writeEndTag("a"),i.writeEndTag("div")),i.toString()},e}();t.wijMonthView=f;var l=function(){function e(e,t){this._calendar=e,this._optionName=t?t:"selectedDates",this._normalize()}return e.prototype.getDates=function(){return this._calendar.options[this._optionName]===undefined&&(this._calendar.options[this._optionName]=[]),this._calendar.options[this._optionName]},e.prototype.setDates=function(e){this._calendar.options[this._optionName]=e,this._normalize()},e.prototype.getCount=function(){return this.getDates().length},e.prototype.clear=function(){this.setDates([])},e.prototype.add=function(e){this.addRange(e,e)},e.prototype.remove=function(e){this.removeRange(e,e)},e.prototype.indexOf=function(e){return this.getCount()?this._findRangeBound(e,!0,!1):-1},e.prototype.contains=function(e){return this.indexOf(e)!==-1},e.prototype.removeRange=function(e,t){if(!this.getCount())return;var n=this._findRangeBound(e,!1,!0),r=this._findRangeBound(t,!1,!1),i,s,o;if(n<0||r<0)return;if(n>r)return;i=this.getDates();if(i[r]>t)return;s=n?i.slice(0,n):[],o=r>=i.length-1?[]:i.slice(r+1),this.setDates(s.concat(o))},e.prototype.addRange=function(e,t){this.removeRange(e,t);var n=this.getDates(),r=this._findRangeBound(e,!1,!0),i=r?n.slice(0,r):[],s=n.slice(r),o=[],u;e=a.getDate(e),t=a.getDate(t);for(u=e;u<=t;u=a.addDays(u,1))o[o.length]=u;this.setDates(i.concat(o.concat(s)))},e.prototype._findRangeBound=function(e,t,n){var r=this.getDates(),i=0,s=r.length,o;while(i<s){o=i+s>>1;if(a.isSameDate(e,r[o]))return o;e<r[o]?s=o:i=o+1}return t?-1:n?i:s},e.prototype._parseDate=function(e){var t;e?typeof e=="string"&&(t=e):e=new Date;if(t){t=t.replace(/-/g,"/");try{e=new Date(t),isNaN(e)&&(e=new Date)}catch(n){e=new Date}}return e},e.prototype._normalize=function(){var e=this._calendar.options[this._optionName],t=this,r;n.isArray(e)&&(r=n.map(e,function(e,n){return t._parseDate(e)}),this._calendar.options[this._optionName]=r.sort(function(e,t){return e.getTime()-t.getTime()}))},e}();t.wijDateCollection=l;var c=function(){function e(e){this.gridType="month",this.calendar=e,e&&(this.culture=e._getCulture())}return e.prototype.select=function(e,t){var n=this.calendar.getDisplayDate();switch(this.gridType){case"month":n.setMonth(t);break;case"year":n.setFullYear(t);break;case"decade":n.setFullYear(t)}this.calendar.options.displayDate=n},e.prototype.getSelectedIndex=function(){var e=this.calendar.getDisplayDate(),t=e.getFullYear(),n=Math.floor(t/10)*10-1,r=Math.floor(t/100)*100-10;switch(this.gridType){case"month":return e.getMonth();case"year":return t-n;case"decade":return Math.floor((t-r)/10)}return 0},e.prototype.getTitle=function(){var e=this.calendar.getDisplayDate(),t=e.getFullYear(),n=Math.floor(t/10)*10-1,r=Math.floor(t/100)*100-10;switch(this.gridType){case"month":return t.toString();case"year":return n+1+" - "+(n+10);case"decade":return r+10+" - "+(r+109)}return""},e.prototype.getHtml=function(e,t){e===undefined?e=this.calendar.getDisplayDate():typeof e=="boolean"&&(t=e,e=this.calendar.getDisplayDate()),t=!!t;var n=this.calendar.options,r=3,i=4,s=new u,o=n.wijCSS,a,f,l,c,h,p,d,v,m,g,y,b,w,E;n.showTitle&&!t&&s.write(this.calendar._getHeaderHtml(null,!0,!0)),a=100/r+"%",a="30%",s.writeBeginTag("table"),s.writeAttribute("class",o.datepickerCalendar+" wijmo-wijcalendar-mygrid"),s.writeAttribute("role","grid"),s.writeAttribute("onselectstart","return false;"),s.writeTagRightChar(),f=e.getFullYear(),l=e.getFullYear()*12,c=Math.floor(f/10)*10-1,h=Math.floor(f/100)*100-10,p=this.culture.calendar.months;for(d=0;d<r;d++){s.writeBeginTag("tr"),s.writeAttribute("height",a),s.writeTagRightChar();for(v=0;v<i;v++){m=d*4+v,g=!1,y=!1,b="",w=null;switch(this.gridType){case"month":e.getMonth()===m&&(g=!0),w=m,b=p.namesAbbr[m],y=l+m<n.minDate.getFullYear()*12+n.minDate.getMonth()||l+m>n.maxDate.getFullYear()*12+n.maxDate.getMonth();break;case"year":if(m===0||m===11)y=!0;w=c+m,w<n.minDate.getFullYear()||w>n.maxDate.getFullYear()?y=!0:g=f===w,b=w.toString();break;case"decade":if(m===0||m===11)y=!0;w=h+m*10,w+10<n.minDate.getFullYear()||w>n.maxDate.getFullYear()?y=!0:g=f>=w&&f<w+10,b=w.toString()+"-<br/>"+(w+9).toString()}E=o.datepickerWeekDay,y?E=E+" "+o.datepickerOtherMonth+" "+o.prioritySecondary+" "+o.datepickerUnselectable:!n.disabledState&&!n.disabled&&(E+=" wijmo-wijcalendar-day-selectable"),E+=" "+o.stateDefault+(y?" "+o.stateDisabled:"")+(g?" "+o.stateActive+" "+o.stateHighlight:""),s.writeBeginTag("td"),s.writeAttribute("class",E),s.writeAttribute("role","gridcell"),s.writeAttribute("index",m.toString()),s.writeAttribute("value",w.toString()),s.writeAttribute("other",y.toString()),s.writeTagRightChar(),s.writeBeginTag("a"),s.writeAttribute("href","#"),s.writeTagRightChar(),s.write(b),s.writeEndTag("a"),s.writeEndTag("td")}s.writeEndTag("tr")}return s.writeEndTag("table"),s.toString()},e}();t.wijMyGrid=c})(e.calendar||(e.calendar={}));var t=e.calendar})(wijmo||(wijmo={}));