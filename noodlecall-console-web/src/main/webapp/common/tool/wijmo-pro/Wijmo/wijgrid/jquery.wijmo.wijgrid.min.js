var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";function r(e,t){var r=n.extend(!0,{},e,t);return delete r.constructor,r}var n=jQuery;t.extendWidgetOptions=r;var i=function(r){function i(){r.apply(this,arguments),this._dataOffset=0,this._scrollingState={x:null,y:null,index:0},this._windowResizeTimer=0}return __extends(i,r),i.prototype._createWidget=function(t,n){var i=t&&e.data.util.isClassInstance(t.data)&&!(typeof wijdatasource=="function"&&t.data instanceof wijdatasource)&&t.data;i&&delete t.data,r.prototype._createWidget.apply(this,arguments),i&&(t.data=i,this.option("data",i))},i.prototype._create=function(){var t=this;if(!this.element.is("table"))throw"invalid markup";this._windowResizeTimer=0,this._dataOffset=0,this._scrollingState={x:null,y:null,index:0},this._initialized=!1,this._destroyed=!1,this._rendered=!1,this._eventUID=undefined,this._dataViewWrapper=undefined,this._originalHtml=undefined,this._originalAttr=undefined,this._originalCssText=undefined,this._autoHeight=undefined,this._autoWidth=undefined,this._renderCounter=0,this.$superPanelHeader=undefined,this.$topPagerDiv=undefined,this.$bottomPagerDiv=undefined,this.$groupArea=undefined,this.__uid=undefined,this._wijDataView=undefined,this.outerDiv=undefined,this.sketchTable=undefined,this.cellFormatter=undefined,this.rowStyleFormatter=undefined,this.cellStyleFormatter=undefined,this._eventUID=e.grid.getUID(),this._spinnerIsActivated=!1,this.deficientFilters={};var r="data"in this.options,i=r&&this.options.data;r&&delete this.options.data,this.options=n.extend(!0,{},this.options),n.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(this.options),r&&(this.options.data=i),window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this._initialized=!1,this._destroyed=!1,this.mClosestCulture=Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"),this._dataViewWrapper=new e.grid.dataViewWrapper(this),this._originalHtml=this.element.html(),this._originalAttr={},this._originalCssText=this.element[0].style.cssText,this.element.addClass("wijmo-wijgrid-root"),this.element.wrap('<div class="'+this.options.wijCSS.widget+" wijmo-wijgrid "+this.options.wijCSS.content+" "+this.options.wijCSS.cornerAll+'"></div>'),this.outerDiv=this.element.parent();var s=this.element[0].style.height,o=this.element[0].style.width;s&&this.outerDiv.css("height",s),this._autoHeight=s==""||s=="auto",o&&this.outerDiv.css("width",this.element[0].style.width),this._autoWidth=o==""||o=="auto",this.element.css({height:"",width:""}),this.options.disabled&&this.disable(),this.cellFormatter=new e.grid.cellFormatterHelper,this.rowStyleFormatter=new e.grid.rowStyleFormatterHelper(this),this.cellStyleFormatter=new e.grid.cellStyleFormatterHelper(this),this._viewPortBounds({start:0,end:0}),this._allowVirtualScrolling()&&(this._viewPortBounds().start=this._scrollingState.index,this._serverSideVirtualScrolling()&&(this._dataOffset=this._scrollingState.index)),this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(e){t._initialized&&!t._destroyed&&e.target!==t.element[0]&&e.target!==t.outerDiv[0]&&t.setSize()},"wijgrid"),this._renderCounter=0},i.prototype._destroy=function(){var t,r=this;try{this._view().dispose(),this._detachEvents(!0),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._dragndropui&&(this._dragndropui.dispose(),this._dragndropui=null),this._dataViewWrapper.dispose(),e.grid.remove$dataByPrefix(this.element,this._data$prefix),this.element.wijRemoveVisibilityObserver&&this.element.wijRemoveVisibilityObserver(),this.element.insertBefore(this.outerDiv),this.outerDiv.remove(),this.element.html(this._originalHtml),n.each(this._originalAttr,function(e,t){t===undefined?r.element.removeAttr(e):r.element.attr(e,t)}),this.element.removeClass("wijmo-wijgrid-root"),this.element[0].style.cssText=this._originalCssText}finally{this._destroyed=!0}},i.prototype._init=function(){this.$superPanelHeader=null,this.$topPagerDiv=null,this.$bottomPagerDiv=null,this.$groupArea=null,this._prevHoveredSketchRowIndex=-1,this.mClosestCulture=Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"),this.options.data||(this._field("thead")||this._field("thead",e.grid.readTableSection(this.element,1)),this._field("tfoot")||this._field("tfoot",e.grid.readTableSection(this.element,3))),this._initialized=this._initialized||!1,this.ensureControl(!0)},i.prototype._setOption=function(e,t){var n=this["_preset_"+e],i=this.options[e],s,o;n!==undefined&&(t=n.apply(this,[t,i])),s=t!==i||e.toLowerCase()==="columns",r.prototype._setOption.apply(this,[e,t]),s&&(o=this["_postset_"+e],o!==undefined&&o.apply(this,[t,i]))},i.prototype.columns=function(){return this._field("columns")||[]},i.prototype.currentCell=function(n,r,i){var s,o=this._view(),u=this._rows();if(arguments.length===0)return s=this._field("currentCell"),s||this._field("currentCell",s=e.grid.cellInfo.outsideValue),s;s=typeof n!="number"?n._clone():new e.grid.cellInfo(n,r);if(!s.isEqual(e.grid.cellInfo.outsideValue)){if(!s._isValid())throw"invalid arguments";s._clip(this._getDataCellsRange(t.dataRowsRangeMode.sketch));if(s.rowIndex()>=0&&!(o._getRowInfoBySketchRowIndex(s.rowIndex()).type&e.grid.rowType.data))return}return s._setGridView(this),this._changeCurrentCell(null,s,{changeSelection:i||!1,setFocus:!1}),this._field("currentCell")},i.prototype.data=function(){return this._dataViewWrapper.dataView().getSource()},i.prototype.dataView=function(){return this._dataViewWrapper.dataView()},i.prototype.doRefresh=function(r){var i=this;n.isPlainObject(r)||(r={});var s,o=this,u=e.grid.EXPANDO,a=r&&r.virtualScrollData;if(!this._initialized)try{this._prepareColumnOptions(this.options.columns,this.options.columnsAutogenerationMode,this._dataViewWrapper.getFieldsInfo(),!0,!0)}catch(f){throw f}finally{this._ownerise(!0),this._initialized=!0}if(!a){this._rebuildLeaves();var l=t.lazy(this._dataViewWrapper.data,this._dataViewWrapper),c=this._dataViewWrapper.dataView(),h=this._prepareTotalsRequest(!0);h.length&&n.each(this._field("leaves"),function(e,t){t._totalsValue=l().totals?l().totals[t.dataKey]:undefined});if(c.count()){s=this._field("leaves");var p=new e.grid.LazySketchTable({count:function(){return c.count()},getRange:function(e,t,n,r){for(var o=0;o<t;o++){var u=e+o,a=c.item(u);n[r+o]=i._buildSketchRow({values:a,originalRowIndex:u},s)}}});(this._hasGrouping()||this._hasMerging())&&p.ensureNotLazy(),this.sketchTable=p}else{this.sketchTable=new e.grid.SketchTable;var d=l().emptyData;d&&(s=this._field("visibleLeaves"),n.each(d,function(e,t){o.sketchTable.add(o._buildSketchRowEmptyDataItem(t,s,e===d.length-1))}))}}this._onRendering(r),a?this._refreshVirtual(r):this._refresh(r),r&&n.isFunction(r.beforeOnRendered)&&r.beforeOnRendered.apply(this,[r]),this._onRendered(r),r&&n.isFunction(r.afterRefresh)&&r.afterRefresh.apply(this,[r])},i.prototype.beginEdit=function(){return this._beginEditInternal(null)},i.prototype.endEdit=function(){return this._endEditInternal(null)},i.prototype.ensureControl=function(t,r){this._loading(),n.isPlainObject(r)||(r={data:null,afterRefresh:null,beforeRefresh:null}),r._wijgridMarker=!0,this._initialized?(!r||!r.virtualScrollData)&&this._convertWidgetsToOptions():(this._prepareColumnOptions(this.options.columns,this.options.columnsAutogenerationMode,this._dataViewWrapper.isDataLoaded()&&this._dataViewWrapper.getFieldsInfo(),this._dataViewWrapper.isDataLoaded(),!1),this._dataViewWrapper.isOwnDataView()||(new e.grid.settingsManager(this)).MapDVToWG()),this._ownerise(!0),this._initialized&&r&&n.isFunction(r.beforeRefresh)&&r.beforeRefresh.apply(this),this.mAllowVirtualScrolling=undefined,t===!0?this._dataViewWrapper.load(r):(this.doRefresh(r),this._loaded())},i.prototype.getCellInfo=function(e){var t=null;return e&&(e=this._findUntilOuterDiv(e,{td:!0,th:!0}))&&(t=this._view().getAbsoluteCellInfo(e,!1)),t},i.prototype.getFilterOperatorsByDataType=function(t){return(new e.grid.filterOperatorsCache(this)).getByDataType(t||"string")},i.prototype.pageCount=function(){return this._customPagingEnabled()?Math.ceil(this.options.totalRows/this.options.pageSize)||1:this.options.allowPaging?this._dataViewWrapper.dataView().pageCount():1},i.prototype._closestCulture=function(){return this.mClosestCulture},i.prototype._serverShaping=function(){return!1},i.prototype._pageIndexForDataView=function(){return this.options.pageIndex},i.prototype.setSize=function(e,t){var r=this._view(),i={type:"",hScrollValue:null,vScrollValue:null},s=this.outerDiv,o=this._field("visibleLeaves"),u=[];r&&r.getScrollValue&&(i=r.getScrollValue());if(e||e===0)this._autoWidth=!1,s.width(e);if(t||t===0)this._autoHeight=!1,s.height(t);n.each(o,function(e,t){var i=r.getHeaderCell(e),s=r.getJoinedCols(e);n(i).css("width",""),n.each(s,function(e,t){n(t).css("width","")})}),this._view().updateSplits(i);var a=this._UIFrozener();a&&a.refresh()},i.prototype.selection=function(){var t=this._field("selection");return t||this._field("selection",t=new e.grid.selection(this)),t},i.prototype._onDataViewCurrentPositionChanged=function(e,t){var n=this._currentCellFromDataView(this.currentCell().cellIndex()),r=this.selection();n=this.currentCell(n,null,!0)},i.prototype._resetDataProperties=function(){this.options.pageIndex=0;var e=this._viewPortBounds();e.start=e.end=0},i.prototype._onDataViewLoading=function(){this._activateSpinner(),this._trigger("dataLoading")},i.prototype._onDataViewReset=function(t){(new e.grid.settingsManager(this)).MapDVToWG(),this._trigger("dataLoaded"),this.doRefresh(t),this._loaded()},i.prototype._onDataViewLoaded=function(){},i.prototype._loading=function(){this._activateSpinner(),this._trigger("loading")},i.prototype._loaded=function(){this._deactivateSpinner(),this._trigger("loaded")},i.prototype._buildSketchRow=function(n,r){var i,s,o,u,a,f,l=e.data.Expando.getFrom(n.values,!1),c=l?l[e.grid.EXPANDO]:null,h=new e.grid.SketchDataRow(n.originalRowIndex,c&&c.rowAttributes),p=c&&c.cellsAttributes;for(i=0,s=r.length;i<s;i++)o=r[i],e.grid.validDataKey(o.dataKey)&&(u=p?p[o.dataKey]:null,a=this._dataViewWrapper.getValue(n.values,o.dataKey),h.add(new t.ValueCell(this.parse(o,a),u)));return h},i.prototype._buildSketchRowEmptyDataItem=function(n,r,i){var s,o,u=new t.SketchRow(e.grid.rowType.emptyDataRow),a=r.length;for(s=0,o=n.length;s<o;s++)u.add(new t.HtmlCell(n[s],{colSpan:a>0&&i?a:1}));return u},i.prototype._prepareColumnOptions=function(r,i,s,o,u){e.grid.traverse(r,function(e){e.isBand=n.isArray(e.columns)||e.clientType==="c1band",e._originalDataKey=e.dataKey,e._originalHeaderText=e.headerText}),(new e.grid.bandProcessor).getVisibleHeight(r,!0);var a=[],f=this._originalHeaderRowData(),l=this._originalFooterRowData(),c=(i||"").toLowerCase(),h=this;o&&e.grid.columnsGenerator.generate(c,s,r),e.grid.setTraverseIndex(r),e.grid.traverse(r,function(r){r.isBand=n.isArray(r.columns)||r.clientType==="c1band",e.grid.shallowMerge(r,t.c1basefield.prototype.options),r.isBand?r.clientType="c1band":(e.grid.shallowMerge(r,t.c1field.prototype.options),r.groupInfo=r.groupInfo||{},e.grid.shallowMerge(r.groupInfo,t.c1field.prototype.options.groupInfo),r.clientType||(r.clientType="c1field")),r.isLeaf&&!r.isBand&&a.push(r)}),this._field("leaves",a),o&&n.each(a,n.proxy(function(t,r){var i=typeof r.dataKey=="number"?r.dataKey:t;(c==="merge"||r.dynamic===!0)&&r.headerText===undefined&&(h._dataViewWrapper&&h._dataViewWrapper.isBoundedToDOM()&&f&&i<f.length?r.headerText=n.trim(f[i]):e.grid.validDataKey(r.dataKey)&&(r.headerText=""+r.dataKey)),h._dataViewWrapper&&h._dataViewWrapper.isBoundedToDOM()&&l&&i<l.length&&(r._footerTextDOM=n.trim(l[i]))},this))},i.prototype._rebuildLeaves=function(){var t=[],r=[],i;this._showRowHeader()&&(i=e.grid.createDynamicField({clientType:"c1basefield",dataIndex:-1,travIdx:-1,parentVis:!0,allowMoving:!1,allowSizing:!1,allowSort:!1,isRowHeader:!0}),i.owner=this,t.push(i)),n.each(this.options.columns,function(e,n){t.push(n)}),this._columnsHeadersTable((new e.grid.bandProcessor).generateSpanTable(t,r)),this._field("leaves",r),this._onLeavesCreated()},i.prototype._onLeavesCreated=function(){var t=this._field("leaves"),r=this._dataViewWrapper.getFieldsInfo(),i,s=0,o=0,u=this;this._field("visibleLeaves",n.grep(t,function(t,u){return t.leavesIdx=u,e.grid.validDataKey(t.dataKey)?t.dataIndex=s++:t.dataIndex=-1,t.isBand||(i=r[t.dataKey],i&&(t._underlyingDataType=i.type,t._underlyingDataFormatString=i.format),n.isFunction(t.dataParser)&&(t.dataParser=new t.dataParser)),t.parentVis?(t.visLeavesIdx=o++,!0):!1}))},i.prototype._allowVirtualScrolling=function(){return this.mAllowVirtualScrolling===undefined&&(this.mAllowVirtualScrolling=!this.options.allowPaging&&this.options.allowVirtualScrolling&&this.options.staticRowIndex<0&&this.options.scrollMode!=="none"&&!this._hasMerging()),this.mAllowVirtualScrolling},i.prototype._headerRows=function(){return this._view().headerRows()},i.prototype._filterRow=function(){return this._view().filterRow()},i.prototype._rows=function(){return this._view().bodyRows()},i.prototype._localizeFilterOperators=function(t){var r=this,i=new e.grid.filterOperatorsCache(this);n.each(t,function(e,t){if(t.name){var n=i.getByName(t.name);n&&(n.displayName=t.displayName)}})},i.prototype._UIDragndrop=function(t){return!this._dragndropui&&t&&(this._dragndropui=new e.grid.uiDragndrop(this)),this._dragndropui},i.prototype._UIFrozener=function(t){return!this._frozenerui&&t&&(this._frozenerui=new e.grid.uiFrozener(this)),this._frozenerui},i.prototype._UIResizer=function(t){return!this._resizerui&&t&&(this._resizerui=new e.grid.uiResizer(this)),this._resizerui},i.prototype._UISelection=function(t){return!this._selectionui&&t&&(this._selectionui=new e.grid.uiSelection(this)),this._selectionui},i.prototype._postset_allowColMoving=function(e,t){var r=this;n.each(this.columns(),function(t,n){e?r._UIDragndrop(!0).attach(n):r._UIDragndrop(!0).detach(n)});var i=this._field("groupedWidgets");i&&n.each(i,function(t,n){e?r._UIDragndrop(!0).attach(n):r._UIDragndrop(!0).detach(n)})},i.prototype._postset_allowSorting=function(e,t){this.ensureControl(!1)},i.prototype._postset_columns=function(e,t){this._initialized=!1,this.ensureControl(!0)},i.prototype._postset_allowPaging=function(e,t){this.ensureControl(!0)},i.prototype._postset_freezingMode=function(e,t){this._frozenerui&&this._frozenerui.refresh()},i.prototype._postset_culture=function(e,t){throw"read-only"},i.prototype._postset_customFilterOperators=function(e,t){var n=this._dataViewWrapper.dataView()},i.prototype._postset_data=function(t,r){this._ownerise(!1),e.grid.traverse(this.options.columns,function(e,t){if(e.dynamic){var r=n.inArray(e,t);r>=0&&t.splice(r,1)}else e.dataKey=e._originalDataKey,e.headerText=e._originalHeaderText}),this._initialized=!1,this._dataViewWrapper&&this._dataViewWrapper.dispose(),this._dataViewWrapper=new e.grid.dataViewWrapper(this),this.ensureControl(!0)},i.prototype._postset_disabled=function(t,n){var r=this,i=this._view();e.grid.iterateChildrenWidgets(this.outerDiv,function(e,n){n!==r&&n.option("disabled",t)}),i&&i.ensureDisabledState()},i.prototype._postset_groupIndent=function(e,t){this.ensureControl(!1)},i.prototype._postset_groupAreaCaption=function(e,t){var n=this._groupedColumns();this.$groupArea&&(!n||!n.length)&&this.$groupArea.html(e||"&nbsp;")},i.prototype._postset_highlightCurrentCell=function(e,t){var n=this.currentCell();n&&n._isValid()&&this._highlightCellPosition(n,e)},i.prototype._preset_pageIndex=function(e,t){if(isNaN(e))throw"out of range";var n=this.pageCount(),r=function(e){return e>n-1&&(e=n-1),e<0&&(e=0),e},i;return e=r(e),this.options.allowPaging&&e!==t&&(i={newPageIndex:e},this._onPageIndexChanging(i)?e=r(i.newPageIndex):e=t),e},i.prototype._postset_pageIndex=function(e,t){if(this.options.allowPaging){var n={newPageIndex:e};this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onPageIndexChanged(n)):this.ensureControl(!0,{afterRefresh:function(){this._onPageIndexChanged(n)}})}},i.prototype._preset_pageSize=function(e,t){if(isNaN(e))throw"out of range";return e<=0&&(e=1),e},i.prototype._postset_pageSize=function(e,t){this._resetDataProperties(),this.options.allowPaging&&!this._customPagingEnabled()&&this.ensureControl(!0)},i.prototype._postset_pagerSettings=function(e,t){this.ensureControl(!1)},i.prototype._postset_scrollMode=function(e,t){this.ensureControl(!1)},i.prototype._postset_selectionMode=function(t,n){var r=this.selection(),i=this.currentCell(),s=this.selection().selectedCells().length();r.beginUpdate(),r.clear(),i&&i._isValid()&&s&&r._selectRange(new e.grid.cellInfoRange(i,i),!1,!1,e.grid.cellRangeExtendMode.none,null),r.endUpdate(),this._view().toggleDOMSelection(t==="none")},i.prototype._postset_showFilter=function(e,t){this.ensureControl(!1)},i.prototype._postset_showGroupArea=function(e,t){this.ensureControl(!1)},i.prototype._postset_showRowHeader=function(e,t){this.ensureControl(!1)},i.prototype._postset_staticRowIndex=function(){this.options.scrollMode!=="none"&&this.ensureControl(!1)},i.prototype._postset_staticColumnIndex=function(){this.options.scrollMode!=="none"&&this.ensureControl(!1)},i.prototype._postset_allowVirtualScrolling=function(e,t){this.ensureControl(!1)},i.prototype._preset_allowVirtualScrolling=function(e,t){if(isNaN(e)||e<0)throw"out of range";return e},i.prototype._activateSpinner=function(){if(!this._spinnerIsActivated){var e=this.options.wijCSS,t=this.outerDiv.append('<div class="wijmo-wijgrid-overlay '+e.overlay+'"></div>'+'<span class="wijmo-wijgrid-loadingtext '+e.content+" "+e.cornerAll+'">'+'<span class="'+e.icon+' ui-icon-clock"></span>'+this.options.loadingText+"</span>").find("> .wijmo-wijgrid-loadingtext");t.position({my:"center",at:"center center",of:this.outerDiv,collision:"none"}),this._spinnerIsActivated=!0}},i.prototype._customPagingEnabled=function(){return this.options.allowPaging&&this.options.totalRows>=0},i.prototype._deactivateSpinner=function(){if(this._spinnerIsActivated)try{this.outerDiv.find("> .wijmo-wijgrid-overlay, > .wijmo-wijgrid-loadingtext").remove()}finally{this._spinnerIsActivated=!1}},i.prototype._columnWidgetsFactory=function(e,t){var r,i=t.clientType;!i&&t.isBand&&(i="c1band"),t=n.extend({},t,{disabled:this.options.disabled});try{n.data(e[0],"wijgridowner",this);switch(i){case"c1basefield":r=e.c1basefield(t);break;case"c1band":r=e.c1band(t);break;default:r=e.c1field(t)}}finally{n.removeData(e[0],"wijgridowner")}return r},i.prototype._convertWidgetsToOptions=function(){this._initialized&&this._mergeWidgetsWithOptions&&(this._ownerise(!1),this._widgetsToOptions(),this._ownerise(!0))},i.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},i.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},i.prototype._prepareTotalsRequest=function(t){var r=this._field("leaves"),i,s;return!r||!this.options.showFooter?[]:(i=n.map(r,function(n,r){return!n.isBand&&e.grid.validDataKey(n.dataKey)&&n.aggregate&&n.aggregate!=="none"?t?[{column:n,aggregate:n.aggregate}]:[{dataKey:n.dataKey,aggregate:n.aggregate}]:null}),i)},i.prototype._widgetsToOptions=function(){var t=e.grid.flatten(this.options.columns);n.each(this.columns(),function(e,r){delete r.options.columns;var i=t[r.options.travIdx];n.extend(!0,i,r.options),i.filterValue=r.options.filterValue,i.filterOperator=r.options.filterOperator})},i.prototype._recreateColumnWidgets=function(){n.each(this.columns(),function(e,t){t.destroy()});var t=[],r=this._headerRows(),i,s,o,u,a,f,l;if(r&&r.length()){i=[],e.grid.traverse(this.options.columns,function(e){e.parentVis&&i.push(e)});for(s=0,o=i.length;s<o;s++)u=i[s],a=r.item(u.thY),f=e.grid.rowAccessor.getCell(a,u.thX),l=this._columnWidgetsFactory(n(f),u),t.push(l.data(e.grid.widgetName(l)))}this._field("columns",t)},i.prototype._groupedColumns=function(e){var t;e=!(t=this._field("groupedColumns"))||e;if(e){t=[];var r=this._field("leaves")||[],i=!1,s=function(e){return e.groupInfo&&e.groupInfo.position&&e.groupInfo.position!=="none"};n.each(r,function(e,n){s(n)?(i=i||n.groupedIndex===undefined,i||t.push(n)):delete n.groupedIndex}),i?n.each(r,function(e,n){s(n)&&(n.groupedIndex=t.length,t.push(n))}):(t.sort(function(e,t){return e.groupedIndex-t.groupedIndex}),n.each(t,function(e,t){t.groupedIndex=e})),this._field("groupedColumns",t)}return t||[]},i.prototype._ownerise=function(t){if(t){var n=this;e.grid.traverse(this.options.columns,function(e){e.owner=n;var t,r,i;if(t=e.groupInfo){t.owner=e;if(t.expandInfo)for(r=0,i=t.expandInfo.length;r<i;r++)t.expandInfo[r].owner=t}})}else e.grid.traverse(this.options.columns,function(e){delete e.owner;var t,n,r;if(t=e.groupInfo){delete t.owner;if(t.expandInfo)for(n=0,r=t.expandInfo.length;n<r;n++)delete t.expandInfo[n].owner}})},i.prototype._ensureRenderableBounds=function(t){return e.grid.ensureBounds(t,this._renderableRowsCount()-1)},i.prototype._ensureTotalRowsBounds=function(t){return e.grid.ensureBounds(t,this._totalRowsCount()-1)},i.prototype._ensureViewPortBoundsVisible=function(e){var t=this._renderableRowsCount();return e.end>=t&&(e.start-=e.end-t,e.end=t-1),e},i.prototype._renderableBoundsCollection=function(){return this.mRenderableBoundsCollection},i.prototype._rebuildRenderBoundsCollection=function(){var t=-1,n=-1,r=!1,i=this._totalRowsCount();this.mRenderableBoundsCollection=new e.grid.renderBoundsCollection(i-1);if(this._allowVirtualScrolling()&&this._serverSideVirtualScrolling())this.mRenderableBoundsCollection.add({start:0,end:i-1});else if(!this._allowVirtualScrolling()||!this._hasGrouping())this.mRenderableBoundsCollection.add({start:0,end:i-1});else{for(var s=0;s<this.sketchTable.count();s++){var o=this.sketchTable.row(s);o.style("display")==="none"?(t>=0&&(this.mRenderableBoundsCollection.add({start:t,end:n}),r=!1),t=n=-1):t<0?(r=!0,t=n=s):n++}r&&this.mRenderableBoundsCollection.add({start:t,end:n})}},i.prototype._refresh=function(t){(new e.grid.grouper).group(this,this.sketchTable,this._field("leaves")),(new e.grid.merger).merge(this.sketchTable,this._field("visibleLeaves")),this._rebuildRenderBoundsCollection(),this.options.scrollMode!=="none"?this.mView=new e.grid.fixedView(this,this._viewPortBounds()):this.mView=new e.grid.flatView(this,this._viewPortBounds()),this._render(),this._ownerise(!1),this._recreateColumnWidgets(),this._ownerise(!0),this.options.allowPaging&&(this.$topPagerDiv&&this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5),this.$bottomPagerDiv&&this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5))},i.prototype._refreshVirtual=function(e){var t=e.virtualScrollData,n={top:0,bottom:0};t.data&&(n=this._processVirtualData(t)),this._updateRowInfos(t,n),this._renderVirtualIntoView(t)},i.prototype._updateRowInfos=function(e,n){var r=this._viewPortBounds(),i=this._view(),s=e.newBounds,o=this._view().bodyRows(),u,a,f,l;switch(e.mode){case t.intersectionMode.reset:break;case t.intersectionMode.overlapBottom:u={start:s.start-r.start,end:r.end-r.start},f=s.start-r.start;for(a=u.start;a<=u.end;a++)l=i._getRowInfo(o.item(a),!1),l.sectionRowIndex-=f,n.top!==0&&(l.dataItemIndex+=n.top),i._setRowInfo(l.$rows,l);break;case t.intersectionMode.overlapTop:u={start:r.start-r.start,end:s.end-r.start},f=r.start-s.start;for(a=u.start;a<=u.end;a++)l=i._getRowInfo(o.item(a),!1),l.sectionRowIndex+=f,n.top!==0&&(l.dataItemIndex+=n.top),i._setRowInfo(l.$rows,l)}},i.prototype._renderVirtualIntoView=function(e){var n=this._viewPortBounds(),r=this,i,s=this._view(),o,u,a;switch(e.mode){case t.intersectionMode.reset:s._clearBody();var f=e.newBounds.end-e.newBounds.start+1;this._renderableBoundsCollection().forEachIndex(e.newBounds.start,f,function(e){i=r.sketchTable.row(e-r._dataOffset),s._insertBodyRow(i,-1,i.dataItemIndex(),e)}),s._rebuildOffsets();break;case t.intersectionMode.overlapBottom:o={start:e.newBounds.start,end:n.end};for(u=0;u<o.start-n.start;u++)s._removeBodyRow(0,!1);var f=e.newBounds.end-o.end;this._renderableBoundsCollection().forEachIndex(o.end+1,f,function(e){i=r.sketchTable.row(e-r._dataOffset),s._insertBodyRow(i,-1,i.dataItemIndex(),e)});break;case t.intersectionMode.overlapTop:o={start:n.start,end:e.newBounds.end};for(u=0;u<n.end-e.newBounds.end;u++)s._removeBodyRow(o.end-o.start+1,!1);a=0;var f=n.start-e.newBounds.start;this._renderableBoundsCollection().forEachIndex(e.newBounds.start,f,function(e){i=r.sketchTable.row(e-r._dataOffset),s._insertBodyRow(i,a++,i.dataItemIndex(),e)});break;default:}},i.prototype._processVirtualData=function(e){var n=this._dataViewWrapper,r=n.dataView().getSource(),i,s=this._field("leaves"),o,u,a,f=0,l={top:0,bottom:0},c,h=this._serverSideVirtualScrollingMargin();switch(e.mode){case t.intersectionMode.reset:this.sketchTable.clear(),n._unsafeSplice(0,r.length),this._dataOffset=e.request.index;for(o=0;o<e.data.length;o++)n._unsafePush(i=e.data[o]),this.sketchTable.add(this._buildSketchRow(n._wrapDataItem(i,o),s));break;case t.intersectionMode.overlapBottom:for(o=0;o<e.data.length;o++)n._unsafePush(i=e.data[o]),this.sketchTable.add(this._buildSketchRow(n._wrapDataItem(i,r.length-1),s));l.bottom=e.data.length;break;case t.intersectionMode.overlapTop:for(o=e.data.length-1;o>=0;o--)n._unsafeSplice(0,0,i=e.data[o]),this.sketchTable.insert(0,this._buildSketchRow(n._wrapDataItem(i,o),s));this._dataOffset=e.request.index,l.top=e.data.length}return u=this._ensureTotalRowsBounds({start:e.newBounds.start,end:e.newBounds.end}),a={start:this._dataOffset,end:this._dataOffset+r.length-1},f=a.end-u.end-h,f>0&&(l.bottom-=f,n._unsafeSplice(r.length-f,f),this.sketchTable.removeLast(f)),f=u.start-a.start-h,f>0&&(l.top-=f,n._unsafeSplice(0,f),this.sketchTable.removeFirst(f),this._dataOffset+=f),this.sketchTable.updateIndexes(),n._refreshSilent(),l},i.prototype._needToCreatePagerItem=function(){return this.options.allowPaging===!0},i.prototype._isMobileEnv=function(){return this._isMobile},i.prototype._render=function(){var e=this._view(),t=this.options,r=this.options.wijCSS,i;e.render(),i=this.outerDiv,t.scrollMode!=="none"&&(i=this.outerDiv.find("div.wijmo-wijgrid-scroller:first")),this.$superPanelHeader=null,this.$topPagerDiv&&(this.$topPagerDiv.data("wijmo-wijpager")&&this.$topPagerDiv.wijpager("destroy"),this.$topPagerDiv.remove()),this.$topPagerDiv=null,this._needToCreatePagerItem()&&(t.pagerSettings.position==="top"||t.pagerSettings.position==="topAndBottom")&&(this.$topPagerDiv||(i.prepend(this.$superPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$topPagerDiv=n('<div class="wijmo-wijgrid-header '+r.header+" "+r.cornerTop+'"></div>')))),t.showGroupArea?this._processGroupArea(i):this.$groupArea=null,this.$bottomPagerDiv&&(this.$bottomPagerDiv.data("wijmo-wijpager")&&this.$bottomPagerDiv.wijpager("destroy"),this.$bottomPagerDiv.remove()),this.$bottomPagerDiv=null,this._needToCreatePagerItem()&&(t.pagerSettings.position==="bottom"||t.pagerSettings.position==="topAndBottom")&&(this.$bottomPagerDiv||i.append(this.$bottomPagerDiv=n('<div class="wijmo-wijgrid-footer wijmo-wijsuperpanel-footer '+r.stateDefault+" "+r.cornerBottom+'"></div>')))},i.prototype._processGroupArea=function(e){var t=this,r=this._groupedColumns(),i=[];this.$groupArea=n('<div class="'+this.options.wijCSS.content+" "+this.options.wijCSS.helperClearFix+'"></div>'),r.length>0?n.each(r,function(e,r){var s=n('<a href="#"></a>').appendTo(t.$groupArea);try{n.data(s[0],"wijgridowner",t),s.c1groupedfield(n.extend({},{allowMoving:r.allowMoving,allowSort:r.allowSort,dataIndex:r.dataIndex,dataKey:r.dataKey,headerText:r.headerText,isBand:r.isBand,isLeaf:r.isLeaf,linearIdx:r.linearIdx,parentIdx:r.parentIdx,sortDirection:r.sortDirection,travIdx:r.travIdx,groupedIndex:r.groupedIndex},{disabled:t.options.disabled}))}finally{n.removeData(s[0],"wijgridowner")}i.push(s.data("wijmo-c1groupedfield"))}):this.$groupArea.addClass("wijmo-wijgrid-group-area").css("padding",0).html(this.options.groupAreaCaption||"&nbsp;"),this._field("groupedWidgets",i),this.$superPanelHeader||e.prepend(this.$superPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$groupArea),this._UIDragndrop(!0).attachGroupArea(this.$groupArea)},i.prototype._pagerSettings2PagerWidgetSettings=function(){return n.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:n.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:n.proxy(this._onPagerWidgetPageIndexChanged,this)})},i.prototype._showRowHeader=function(){return this.options.showRowHeader===!0&&this.options.staticColumnsAlignment!=="right"},i.prototype._attachEvents=function(){var e=this._view(),t=e.focusableElement(),r=this;t.bind("keydown."+this.widgetName,n.proxy(this._onKeyDown,this)),t.bind("keypress."+this.widgetName,n.proxy(this._onKeyPress,this)),n.each(e.subTables(),function(e,t){var i=t.element();i&&(i.tHead&&n(i.tHead).bind("click."+r.widgetName,n.proxy(r._onClick,r)),i.tBodies.length&&n(i.tBodies[0]).bind("click."+r.widgetName,n.proxy(r._onClick,r)).bind("dblclick."+r.widgetName,n.proxy(r._onDblClick,r)).bind("mousemove."+r.widgetName,n.proxy(r._onMouseMove,r)).bind("mouseout."+r.widgetName,n.proxy(r._onMouseOut,r)))}),n(window).bind("resize."+this.widgetName+"."+this._eventUID,n.proxy(this._onWindowResize,this))},i.prototype._detachEvents=function(e){var t=this._view(),r=this,i;this._windowResizeTimer=0,n(window).unbind("resize."+this.widgetName+"."+this._eventUID),t&&(i=t.focusableElement(),i.unbind("keydown."+this.widgetName),i.unbind("keypress."+this.widgetName),n.each(t.subTables(),function(){var e=this.element();e&&(e.tHead&&n(e.tHead).unbind("."+r.widgetName),e.tBodies.length&&n(e.tBodies[0]).unbind("."+r.widgetName))}))},i.prototype._handleSort=function(t,r){var i=this.options.columns,s=t.travIdx,o,u;t&&this.options.allowSorting&&(o=t.sortDirection==="none"?"ascending":t.sortDirection==="ascending"?"descending":"ascending",u={column:t,sortDirection:o,sortCommand:t.dataKey+" "+(o==="ascending"?"asc":"desc")},this._onColumnSorting(u)&&(t.sortDirection=u.sortDirection,r?t.sortOrder=this._customSortOrder++:(this._customSortOrder=1e3,n.each(this.columns(),function(e,t){t.options.sortOrder=0,t.options.travIdx!==s&&(!t.options.groupInfo||t.options.groupInfo.position==="none")&&(t.options.sortDirection="none")}),e.grid.traverse(i,function(e){e.sortOrder=0,e.travIdx!==s&&(!e.groupInfo||e.groupInfo.position==="none")&&(e.sortDirection="none")})),u={column:t,sortDirection:t.sortDirection,sortCommand:t.dataKey+" "+(t.sortDirection==="ascending"?"asc":"desc")},this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnSorted(u)):this.ensureControl(!0,{afterRefresh:function(){this._onColumnSorted(u)}})))},i.prototype._handleDragnDrop=function(t,r,i,s,o){var u=e.grid.getColumnByTravIdx(this.options.columns,t),a=e.grid.getColumnByTravIdx(this.options.columns,r),f=s?"groupArea":"columns",l=o?"groupArea":"columns";o?this._onColumnGrouping({drag:u.found,drop:a?a.found:null,dragSource:f,dropSource:l,at:i})&&this.ensureControl(!0,{beforeRefresh:function(){if(!a)u.found.groupedIndex=0;else switch(i){case"left":u.found.groupedIndex=a.found.groupedIndex-.5;break;case"right":u.found.groupedIndex=a.found.groupedIndex+.5}s||n.extend(!0,u.found,{groupInfo:{position:"header"}})},afterRefresh:function(){this._onColumnGrouped({drag:u.found,drop:a?a.found:null,dragSource:f,dropSource:l,at:i})}}):this._onColumnDropping({drag:u.found,drop:a.found,at:i})&&this.ensureControl(!1,{beforeRefresh:function(){u.at.splice(u.found.linearIdx,1);switch(i){case"left":u.at===a.at&&u.found.linearIdx<a.found.linearIdx?a.at.splice(a.found.linearIdx-1,0,u.found):a.at.splice(a.found.linearIdx,0,u.found);break;case"right":u.at===a.at&&u.found.linearIdx<a.found.linearIdx?a.at.splice(a.found.linearIdx,0,u.found):a.at.splice(a.found.linearIdx+1,0,u.found);break;case"center":a.found.columns.push(u.found)}e.grid.setTraverseIndex(this.options.columns)},afterRefresh:function(){this._onColumnDropped({drag:u.found,drop:a.found,at:i})}})},i.prototype._handleFilter=function(t,n,r){var i=(new e.grid.filterOperatorsCache(this)).getByName(n),s,o,u;i&&(i.arity>1?(s=this.parse(t.options,r),o=s!==null&&(e.grid.getDataType(t.options)==="string"||!isNaN(s))):o=!0,o&&(u={column:t.options,operator:i.name,value:s},this._onColumnFiltering(u)&&(t.options.filterValue=u.value,t.options.filterOperator=u.operator,this._resetDataProperties(),this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnFiltered({column:t.options})):this.ensureControl(!0,{afterRefresh:function(){this._onColumnFiltered({column:t.options})}}))))},i.prototype._handleUngroup=function(t){var r=e.grid.getColumnByTravIdx(this.options.columns,t),i;r&&r.found&&(i=r.found,this._onColumnUngrouping({column:i})&&this.ensureControl(!0,{beforeRefresh:function(){delete i.groupedIndex,n.extend(!0,i,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:i})}}))},i.prototype._onVirtualScrolling=function(e,t,r,i,s,o){var u=this;this.ensureControl(this._serverSideVirtualScrolling(),{virtualScrollData:{newBounds:e,request:t,mode:r,data:o},beforeOnRendered:function(e){var t=u._viewPortBounds();n.extend(t,e.virtualScrollData.newBounds)},afterRefresh:function(e){u._view()._adjustRowsHeights(),s&&s(i)}})},i.prototype._handleVirtualScrolling=function(e,n,r){typeof n=="undefined"&&(n=null);var i=this._view(),s=this._viewPortBounds(),o=this._ensureRenderableBounds({start:e,end:e+i.getVirtualPageSize()-1}),u=this._ensureTotalRowsBounds({start:this._dataOffset,end:this._dataOffset+this._dataViewWrapper.dataView().count()-1}),a=null,f,l=this._view().getVirtualPageSize();n?f=n:o.start>s.end||o.end<s.start?f=t.intersectionMode.reset:o.start>s.start?f=t.intersectionMode.overlapBottom:o.start<s.start?f=t.intersectionMode.overlapTop:f=o.start!==s.start||o.end!==s.end?t.intersectionMode.reset:t.intersectionMode.none;if(this._serverSideVirtualScrolling())switch(f){case t.intersectionMode.reset:a={index:e,maxCount:l};break;case t.intersectionMode.overlapBottom:o.end>u.end&&(a={index:u.end+1,maxCount:l});break;case t.intersectionMode.overlapTop:o.start<u.start&&(a={index:Math.max(0,u.start-l),maxCount:0},a.maxCount=u.start-a.index)}f!==t.intersectionMode.none&&this._onVirtualScrolling(o,a,f,e,r)},i.prototype._serverSideVirtualScrolling=function(){return!1},i.prototype._serverSideVirtualScrollingMargin=function(){var e=this._view().getVirtualPageSize()*2;return e<20&&(e=20),e},i.prototype._onColumnDropping=function(e){return this._trigger("columnDropping",null,e)},i.prototype._onColumnDropped=function(e){this._trigger("columnDropped",null,e)},i.prototype._onColumnGrouping=function(e){return this._trigger("columnGrouping",null,e)},i.prototype._onColumnGrouped=function(e){this._trigger("columnGrouped",null,e)},i.prototype._onColumnUngrouping=function(e){return this._trigger("columnUngrouping",null,e)},i.prototype._onColumnUngrouped=function(e){this._trigger("columnUngrouped",null,e)},i.prototype._onColumnFiltering=function(e){return this._trigger("filtering",null,e)},i.prototype._onColumnFiltered=function(e){this._trigger("filtered",null,e)},i.prototype._onFilterOperatorsListShowing=function(e){this._trigger("filterOperatorsListShowing",null,e)},i.prototype._onColumnSorting=function(e){return this._trigger("sorting",null,e)},i.prototype._onColumnSorted=function(e){this._trigger("sorted",null,e)},i.prototype._onCurrentCellChanged=function(t,n){var r=this.options,i=this.currentCell(),s=i.row();this._dataViewWrapper.currentPosition(s.type&e.grid.rowType.data?s.dataItemIndex:-1);if(r.scrollMode!=="none"&&i&&!i.isEqual(e.grid.cellInfo.outsideValue)){var o=i;!(o.row().type&e.grid.rowType.data)&&!o.tableCell()&&(o=i._clone(),o.cellIndex(0)),this._view().scrollTo(o)}this._trigger("currentCellChanged");var u=t&&(t.type||"").toLowerCase()||"";if(n.changeSelection){var a=this.selection(),f=this.options.selectionMode.toLowerCase(),l=n.selectionExtendMode||e.grid.cellRangeExtendMode.none;a.beginUpdate();if(u){if(i._isValid())switch(u){case"click":(!t.shiftKey||!a._multipleRangesAllowed()&&f!=="singlerange")&&a._startNewTransaction(i),t.shiftKey&&t.ctrlKey?a._clearRange(new e.grid.cellInfoRange(i,i),l):a._selectRange(new e.grid.cellInfoRange(a._anchorCell(),i),t.ctrlKey,t.shiftKey,l,null);break;case"keydown":(!t.shiftKey||!a._multipleRangesAllowed()&&f!=="singlerange")&&a._startNewTransaction(i),a._selectRange(new e.grid.cellInfoRange(a._anchorCell(),i),!1,t.shiftKey,e.grid.cellRangeExtendMode.none,null)}}else a.clear(),i._isValid()&&(a._startNewTransaction(i),a._selectRange(new e.grid.cellInfoRange(i,i),!1,!1,e.grid.cellRangeExtendMode.none,null));a.endUpdate()}u==="click"&&this._editBySingleClick()&&this._beginEditInternal(t)},i.prototype._onPageIndexChanging=function(e){return this._trigger("pageIndexChanging",null,e)},i.prototype._onPageIndexChanged=function(e){this._trigger("pageIndexChanged",null,e)},i.prototype._onPagerWidgetPageIndexChanging=function(e,t){t.handled=!0},i.prototype._onPagerWidgetPageIndexChanged=function(e,t){this._setOption("pageIndex",t.newPageIndex)},i.prototype._onRendering=function(e){var t=this._view();this._rendered=!1;if(!e.virtualScrollData){t&&t.dispose(),this._detachEvents(!1),this.element.detach(),this.element.css({"table-layout":"",width:""}),this.element.empty(),this.outerDiv.empty(),this.outerDiv.append(this.element),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null);var n=this._field("currentCell");this._field("currentCellPrevCycle",n?{x:n.cellIndex(),y:n.rowIndex()}:{x:-1,y:-1}),this._field("currentCell",null)}this._trigger("rendering")},i.prototype._onRendered=function(t){var r=this._view(),i,s=this.selection().selectedCells().length()>0;this._rendered=!0;if(!t.virtualScrollData){this._field("selection",null),this._setAttr(r.focusableElement(),"tabIndex",0);var o=this._field("currentCellPrevCycle");i=this._currentCellFromDataView(o.x),!i._isValid()&&this.options.showSelectionOnRender&&(i=this._getFirstDataRowCell(0)),this.currentCell(i,null,!0),this._attachEvents(),this._UISelection(!0);var u=new e.grid.uiResizer(this);n.each(this.columns(),function(e,t){var n=t.options;n.visible&&n.parentVis&&n.isLeaf&&u.addElement(t)}),this._resizerui=u,r.updateSplits(this._scrollingState),this.options.scrollMode!=="none"&&(this._frozenerui=new e.grid.uiFrozener(this))}else this.currentCell(this.currentCell(),null,!1),this.selection()._ensureSelection();this._renderCounter++,this._trigger("rendered")},i.prototype._onClick=function(t){if(!this._canInteract()||!t.target)return;var r=this._view(),i=this._findUntilOuterDiv(t.target,{td:!0,th:!0}),s,o,u=e.grid.cellRangeExtendMode.none,a,f;if(i){if(n(t.target).hasClass("wijmo-wijgrid-grouptogglebtn"))return this._onGroupBtnClick(t),t.stopPropagation(),!1;s=n(i).closest("tr");if(!s.length)return;o=r.getAbsoluteCellInfo(i,!1);if(s.hasClass("wijmo-wijgrid-datarow")||s.hasClass("wijmo-wijgrid-headerrow")){if(o.cellIndex()<0||o.rowIndex()<0)o.rowIndex()>=0?(o=new e.grid.cellInfo(0,o.rowIndex()),u=e.grid.cellRangeExtendMode.row):(o=this._getFirstDataRowCell(o.cellIndex()),u=e.grid.cellRangeExtendMode.column);o=r.getAbsoluteCellInfo(i,!0),this._changeCurrentCell(t,o,{changeSelection:!0,setFocus:!n(t.target).is(":focus"),selectionExtendMode:u})}var l={cell:o};this._trigger("cellClicked",null,l)}},i.prototype._onDblClick=function(e){this._editBySingleClick()||this._beginEditInternal(e)},i.prototype._onGroupBtnClick=function(r){if(!this._canInteract())return;var i=n(r.target).closest("tr"),s=e.grid.groupHelper,o=s.getGroupInfo(i[0]),u,a,f=this;o&&(u=s.getColumnByGroupLevel(this._field("leaves"),o.level),u&&(a=u.groupInfo.expandInfo[o.index],a.isExpanded?a.collapse():a.expand(r.shiftKey),this._allowVirtualScrolling()&&(this._rebuildRenderBoundsCollection(),this._view().vsUI._changeVisibleRowsCount(this._renderableBoundsCollection().capacity()),this._ensureViewPortBoundsVisible(this._viewPortBounds()),this._handleVirtualScrolling(this._viewPortBounds().start,t.intersectionMode.reset)),this.setSize()))},i.prototype._onKeyDown=function(r){if(!this._canInteract())return!0;var i=r.target.tagName.toLowerCase(),s=this.currentCell(),o=e.getKeyCodeEnum();if(i!=="input"&&i!=="option"&&i!=="select"&&i!=="textarea"||n(r.target).closest("tr.wijmo-wijgrid-datarow").length!==0){if(this.options.allowEditing){if((r.which===o.ESCAPE||r.which===113)&&s._isValid()&&s._isEdit())return this._endEditInternal(r),!1;if(r.which===113)return this._beginEditInternal(r),!1}if(!this.options.allowKeyboardNavigation)return!0;var u;switch(r.which){case o.DOWN:case o.PAGE_DOWN:case o.UP:case o.PAGE_UP:case o.LEFT:case o.RIGHT:case o.HOME:case o.END:case o.TAB:if(this._canMoveToAnotherCell(r.target,r.which)){var a=this._getDataCellsRange(t.dataRowsRangeMode.renderable);u=this._getNextCurrentCell(a,s,r.keyCode,r.shiftKey)}}if(u){var f=u._isRendered(),l=this._renderableBoundsCollection().getRenderedIndex(u.rowIndex()),c,h,p=this._allowVirtualScrolling()&&l-this._viewPortBounds().start>=this._rows().length()-1,d=this;return this._allowVirtualScrolling()&&(!f||p&&(c=this._view().getVisibleAreaBounds(!0))&&(h=u.row().$rows)&&h.offset().top+h.outerHeight()>c.top+c.height)?(u.rowIndex()>s.rowIndex()&&(l-=this._rows().length()-1,l+=1),this._view().vsUI.scrollTo(l,function(){d._changeCurrentCell(r,u,{changeSelection:!0,setFocus:!0}),n(d._view().focusableElement()).focus()})):this._changeCurrentCell(r,u,{changeSelection:!0,setFocus:!0}),!1}return!0}return!0},i.prototype._onKeyPress=function(e){if(this._canInteract()&&this.options.allowEditing){var t=e.which,r=this.currentCell();if(t&&r._isValid()&&!r._isEdit()){var i=e.target.tagName.toLowerCase();if(i!=="input"&&i!=="option"&&i!=="select"&&i!=="textarea"){var s=n(e.target).closest(".wijmo-wijgrid");if(s.length&&s[0]===this.outerDiv[0]&&n.wij.charValidator.isPrintableChar(String.fromCharCode(t)))return this._beginEditInternal(e),!1}}}},i.prototype._onMouseMove=function(t){var r=this._view(),i=this._frozenerui,s,o,u,a,f,l=e.grid.renderState;if(!this.options.highlightOnHover||!this._canInteract()||i&&i.inProgress())return;s=this._findUntilOuterDiv(t.target,{td:!0,th:!0});if(s){o=n(s).closest("tr");if(!o.length||!o.hasClass("wijmo-wijgrid-datarow")&&!o.hasClass("wijmo-wijgrid-headerrow"))return;u=r.getAbsoluteCellInfo(s,!0);var c=u.rowIndex();c!==this._prevHoveredSketchRowIndex&&(this._prevHoveredSketchRowIndex!==undefined&&r._isRowRendered(this._prevHoveredSketchRowIndex)>=0&&(f=r._getRowInfoBySketchRowIndex(this._prevHoveredSketchRowIndex),f&&(r._changeRowRenderState(f,l.hovered,!1),this.rowStyleFormatter.format(f))),this._prevHoveredSketchRowIndex=c,c>=0&&(f=r._getRowInfoBySketchRowIndex(c),f&&(r._changeRowRenderState(f,l.hovered,!0),this.rowStyleFormatter.format(f))))}},i.prototype._onMouseOut=function(t){if(!this._canInteract())return;var r=this._findUntilOuterDiv(t.relatedTarget,{tr:!0});if(!r||!n(r).hasClass("wijmo-wijgrid-datarow")){var i=this._prevHoveredSketchRowIndex,s=this._view();if(i>=0){var o=s._getRowInfoBySketchRowIndex(i);o&&o.$rows&&(s._changeRowRenderState(o,e.grid.renderState.hovered,!1),this.rowStyleFormatter.format(o)),this._prevHoveredSketchRowIndex=-1}}},i.prototype._onWindowResize=function(e){var t=this;this._windowResizeTimer>0&&(window.clearTimeout(this._windowResizeTimer),this._windowResizeTimer=0),this._windowResizeTimer!==-1&&(this._windowResizeTimer=window.setTimeout(function(){t._windowResizeTimer=-1;try{!t._destroyed&&t._initialized&&t.element.parent().length&&t.setSize()}finally{t._windowResizeTimer=0}},50))},i.prototype._fieldResized=function(e,t,n){t<0&&(t=0),n<=0&&(n=1);var r={column:e.options,oldWidth:t,newWidth:n};if(this._trigger("columnResizing",null,r)!==!1){if(isNaN(r.newWidth)||r.newWidth<0)r.newWidth=1;e.option("width",r.newWidth);var i={column:e.options};this._trigger("columnResized",null,i)}},i.prototype._changeCurrentCell=function(r,i,s){var o=this.currentCell(),u=this._getDataCellsRange(t.dataRowsRangeMode.sketch),a,f,l=this.options.highlightCurrentCell,c;if(u._isValid()&&u._containsCellInfo(i)||i.isEqual(e.grid.cellInfo.outsideValue))if(o.cellIndex()!==i.cellIndex()||o.rowIndex()!==i.rowIndex()){a={cellIndex:i.cellIndex(),rowIndex:i.rowIndex(),oldCellIndex:o.cellIndex(),oldRowIndex:o.rowIndex()};if(!this._trigger("currentCellChanging",null,a))return!1;f=!1;if(!this.options.allowEditing||!o._isEdit()||(f=this._endEditInternal(null))){u._containsCellInfo(o)&&(l&&this._highlightCellPosition(o,!1),(c=o.tableCell())&&n(c).removeAttr("tabIndex")),o=i._clone(),o._setGridView(this),l&&this._highlightCellPosition(o,!0);if(c=o.tableCell())n(c).attr("tabIndex",0),s.setFocus&&!o._isEdit()&&this._view().focusableElement().focus();this._field("currentCell",o),this._onCurrentCellChanged(r,s)}}else l&&this._highlightCellPosition(o,!0),(c=o.tableCell())&&n(c).attr("tabIndex",0),r&&!o._isEdit()&&this._editBySingleClick()&&this._beginEditInternal(r);return!0},i.prototype._highlightCellPosition=function(t,r){if(t&&t._isValid()){var i=t.cellIndexAbs(),s=t.rowIndexAbs(),o=e.grid.renderState,u=this._view(),a,f,l;f=u.getHeaderCell(i),f&&(a=u._getRowInfo(this._headerRows().item(t.column().thY)),f=n(f),l=u._changeCellRenderState(f,o.current,r),this.cellStyleFormatter.format(f,i,t.column(),a,l)),t._isRendered()&&(f=u.getJoinedRows(s,0),f&&(a=u._getRowInfo(f),u._changeRowRenderState(a,o.current,r),this.rowStyleFormatter.format(a)),f=u.getCell(i,s),f&&(f=n(f),l=u._changeCellRenderState(f,o.current,r),this.cellStyleFormatter.format(f,i,t.column(),a,l)))}},i.prototype._beginEditInternal=function(t){if(this._canInteract()&&this.options.allowEditing){var n=this.currentCell().column(),r;if(n&&!n.readOnly)return r=(new e.grid.cellEditorHelper).currentCellEditStart(this,t),r,r}return!1},i.prototype._endEditInternal=function(t){if(this._canInteract()&&this.options.allowEditing){var n=(new e.grid.cellEditorHelper).currentCellEditEnd(this,t);return n&&!this._allowVirtualScrolling()&&this._view().ensureHeight(this.currentCell().rowIndex()),n}return!1},i.prototype._onViewInsertEmptyRow=function(e,t,n,r,i){return null},i.prototype._onViewCreateEmptyCell=function(e,t,n){return null},i.prototype._onViewCellRendered=function(e,t,n,r){},i.prototype._onViewRowRendered=function(e){},i.prototype._getDataParser=function(t){return t.dataParser||e.data.defaultParsers[t.dataType]||e.data.defaultParsers.string},i.prototype.parse=function(t,r){var i=e.grid.getDataType(t),s=e.grid.getDataType(t);return n.isFunction(r)&&(r=r()),r=e.data.convert(r,i,s,{culture:this.mClosestCulture,format:t.dataFormatString||t._underlyingDataFormatString,nullString:this.options.nullString,parser:t.dataParser}),r},i.prototype.toStr=function(t,n){var r=this._dataViewWrapper.dataView(),i=e.grid.getDataType(t),s="string";return n=e.data.convert(n,i,s,{culture:this.mClosestCulture,format:t.dataFormatString||t._underlyingDataFormatString,nullString:this.options.nullString,parser:t.dataParser}),n},i.prototype.parseFailed=function(e,t,n,r){return t},i.prototype._funcOptions=function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","cellClicked","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]},i.prototype._canInteract=function(){return!this.options.disabled},i.prototype._canMoveToAnotherCell=function(t,r){var i=t.tagName.toLowerCase(),s,o,u,a;switch(i){case"input":if(n(t).hasClass("wijgridinput")){var f=t;return f.type==="text"?(s=f.value.length,o=(new e.grid.domSelection(f)).getSelection(),u=e.getKeyCodeEnum(),a=r===u.TAB||r===u.UP||r===u.DOWN||r===u.PAGE_DOWN||r===u.PAGE_UP||o.length===0&&(o.start===0&&(r===u.LEFT||r===u.HOME)||o.end>=s&&(r===u.RIGHT||r===u.END)),a):!0}return!1;case"textarea":case"select":return!1}return!0},i.prototype._editBySingleClick=function(){var e=(this.options.editingInitOption||"").toLowerCase();switch(e){case"click":case"doubleclick":break;case"auto":default:e=this._isMobileEnv()?"click":"doubleclick"}return e==="click"},i.prototype._getDataToAbsOffset=function(){var e=0,t=0,n=this._headerRows();return this._showRowHeader()&&e++,n&&(t+=n.length()),this._filterRow()&&t++,{x:e,y:t}},i.prototype._currentCellFromDataView=function(t){var n=this._dataViewWrapper.currentPosition(),r=new e.grid.cellInfo(t,this._dataViewDataRowIndexToGrid(n),null);return r.rowIndex()<0?r.cellIndex(-1):r.cellIndex()<0&&r.cellIndex(0),r},i.prototype._dataViewDataRowIndexToGrid=function(t){var n=e.grid.rowType,r=this._view(),i=this._rows(),s,o,u;if(t<0)return-1;for(s=0,o=i.length();s<o;s++){u=r._getRowInfo(i.item(s));if(u.type&n.data&&u.dataItemIndex===t)return u.sectionRowIndex}return-1},i.prototype._getDataCellsRange=function(n,r){typeof r=="undefined"&&(r=!1);var i=0,s=0,o=this._field("visibleLeaves").length-1,u;switch(n){case t.dataRowsRangeMode.rendered:if(this._rendered){u=this._rows().length()-1;break};case t.dataRowsRangeMode.sketch:u=this._totalRowsCount()-1;break;case t.dataRowsRangeMode.renderable:u=this._renderableRowsCount()-1}this._showRowHeader()&&o--,r&&u>0&&u--;if(o<0||u<0)i=s=o=u=-1;return new e.grid.cellInfoRange(new e.grid.cellInfo(i,s,null),new e.grid.cellInfo(o,u,null))},i.prototype._getDataItem=function(e){return this.dataView().item(e)},i.prototype._getFirstDataRowCell=function(t){var n,r,i,s=this._view(),o=this._rows(),u=e.grid.rowType;for(n=0,r=o.length();n<r;n++){i=s._getRowInfo(o.item(n));if(i.type&u.data)return new e.grid.cellInfo(t,n)}return e.grid.cellInfo.outsideValue},i.prototype._getNextCurrentCell=function(t,n,r,i){var s=n.cellIndex(),o=n.rowIndex(),u=e.getKeyCodeEnum(),a=this.sketchTable,f=this._renderableBoundsCollection().getRenderedIndex(o),l=this._renderableBoundsCollection(),c,h=r===u.TAB,p=function(e,t,n,r){typeof r=="undefined"&&(r=!1);var i=e?l.forEachIndex:l.forEachIndexBackward,s=0,o=null;return i.call(l,t,-1,function(e){var t=a.row(e),i=t.isDataRow();if((!r||i)&&t.style("display")!=="none"){o=e;if(++s>=n)return!1}}),o};switch(r){case u.ENTER:case u.DOWN:(c=p(true,f+1,1))!=null&&(o=c);break;case u.PAGE_DOWN:(c=p(true,f+1,this._pageSizeKey))!=null&&(o=c);break;case u.UP:(c=p(false,f-1,1))!=null&&(o=c);break;case u.PAGE_UP:(c=p(false,f-1,this._pageSizeKey))!=null&&(o=c);break;case u.TAB:i?(s--,s<t.topLeft().cellIndex()&&(s=t.bottomRight().cellIndex(),(c=p(false,f-1,1,true))!=null?o=c:(c=p(false,l.capacity()-1,1,true))!=null&&(o=c))):(s++,s>t.bottomRight().cellIndex()&&(s=t.topLeft().cellIndex(),(c=p(true,f+1,1,true))!=null?o=c:(c=p(true,0,1,true))!=null&&(o=c)));break;case u.END:s=t.bottomRight().cellIndex();break;case u.HOME:s=t.topLeft().cellIndex();break;case u.LEFT:s>t.topLeft().cellIndex()&&s--;break;case u.RIGHT:s<t.bottomRight().cellIndex()&&s++}return new e.grid.cellInfo(s,o,this)},i.prototype._findUntilOuterDiv=function(e,t){var n=e,r,i,s=null;for(;n;n=n.parentNode){i=n.nodeName.toLowerCase();if(i){if(n===this.outerDiv[0]){r=n;break}t[i]&&(s=n)}}return r?s:null},i.prototype._getStaticIndex=function(e){var n,r=this._getDataCellsRange(t.dataRowsRangeMode.rendered);return this._hasSpannedCells()?-1:(e?n=Math.min(this.options.staticRowIndex,r.bottomRight().rowIndex()):n=Math.min(this.options.staticColumnIndex,r.bottomRight().cellIndex()),n<-1&&(n=-1),n)},i.prototype._getStaticOffsetIndex=function(e){var t=0;return e?this._showRowHeader()&&t++:(t=this._columnsHeadersTable().length,this.options.showFilter&&t++),t},i.prototype._getRealStaticColumnIndex=function(){var e,t,n=this._getStaticOffsetIndex(!0),r=this._getStaticIndex(!1),i,s;i=r+n;if(r>=0){e=this._field("visibleLeaves"),t=e.length,s=i;for(;i<t;i++)if(e[i].parentIdx===-1){i>s&&i--;break}i>=t&&(i=t-1)}return i},i.prototype._getRealStaticRowIndex=function(){var e=this._getStaticOffsetIndex(!1);return this._getStaticIndex(!0)+e},i.prototype._hasMerging=function(){var e=this._field("leaves"),t,n,r,i=!1;if(e)for(t=0,n=e.length;t<n&&!i;t++)r=e[t],i=i||r.parentVis&&r.rowMerge!=="none";return i},i.prototype._hasGrouping=function(){var e=this._field("leaves"),t,n,r,i=!1;for(t=0,n=e.length;t<n&&!i;t++)r=e[t],i=r.groupInfo&&r.groupInfo.position!=="none";return i},i.prototype._hasSpannedCells=function(){return this._hasGrouping()||this._hasMerging()},i.prototype._columnsHeadersTable=function(e){return arguments.length&&this._field("columnsHeadersTable",e),this._field("columnsHeadersTable")},i.prototype._view=function(){return this.mView},i.prototype._originalFooterRowData=function(){var e=this._field("tfoot");return e&&e.length?e[0]:null},i.prototype._originalHeaderRowData=function(){var e=this._field("thead");return e&&e.length?e[0]:null},i.prototype._setAttr=function(e,t,r){var i=this;return e===this.element?arguments.length===2?(n.each(t,function(t,n){t in i._originalAttr||(i._originalAttr[t]=e.attr(t))}),e.attr(t)):(t in this._originalAttr||(this._originalAttr[t]=e.attr(t)),e.attr(t,r)):arguments.length===3?e.attr(t,r):e.attr(t)},i.prototype._totalRowsCount=function(){return this.sketchTable.count()},i.prototype._renderableRowsCount=function(){return this._renderableBoundsCollection().capacity()},i.prototype._trackScrollingPosition=function(e,t){this._scrollingState.x=e,this._scrollingState.y=t},i.prototype._trackScrollingIndex=function(e){this._scrollingState.index=e},i.prototype._uid=function(){return this.__uid===undefined&&(this.__uid=e.grid.getUID()),"wijgrid"+this.__uid},i.prototype._viewPortBounds=function(e){return arguments.length&&(this.mViewPortBounds=e),this.mViewPortBounds},i.prototype._viewPortBoundsOfEntirelyShownRows=function(){var e=this._viewPortBounds(),t=!1,r=e.end-e.start+1;if(this._allowVirtualScrolling()){var i=this._view();r<i.getVirtualPageSize()&&(t=!0)}return t||(e=n.extend({},e),e.end--),e},i}(e.wijmoWidget);t.wijgrid=i,i.prototype.widgetEventPrefix="wijgrid",i.prototype._data$prefix="wijgrid",i.prototype._customSortOrder=1e3,i.prototype._pageSizeKey=10,i.prototype._mergeWidgetsWithOptions=!0;var s=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},this.allowColMoving=!1,this.allowColSizing=!1,this.allowEditing=!1,this.allowKeyboardNavigation=!0,this.allowPaging=!1,this.allowSorting=!1,this.allowVirtualScrolling=!1,this.cellStyleFormatter=undefined,this.columns=[],this.columnsAutogenerationMode="merge",this.culture="",this.customFilterOperators=[],this.data=null,this.editingInitOption="auto",this.ensureColumnsPxWidth=!1,this.filterOperatorsSortMode="alphabeticalCustomFirst",this.freezingMode="none",this.groupAreaCaption="Drag a column here to group by that column.",this.groupIndent=10,this.highlightCurrentCell=!1,this.highlightOnHover=!0,this.loadingText="Loading...",this.nullString="",this.pageIndex=0,this.pageSize=10,this.pagerSettings={mode:"numeric",pageButtonCount:10,position:"bottom"},this.readAttributesFromData=!1,this.rowHeight=-1,this.rowStyleFormatter=undefined,this.scrollMode="none",this.selectionMode="singleRow",this.showFilter=!1,this.showFooter=!1,this.showGroupArea=!1,this.showSelectionOnRender=!0,this.showRowHeader=!1,this.staticColumnIndex=-1,this.staticColumnsAlignment="left",this.staticRowIndex=-1,this.totalRows=-1,this.afterCellEdit=null,this.afterCellUpdate=null,this.beforeCellEdit=null,this.beforeCellUpdate=null,this.cellClicked=null,this.columnDragging=null,this.columnDragged=null,this.columnDropping=null,this.columnDropped=null,this.columnGrouping=null,this.columnGrouped=null,this.columnResizing=null,this.columnResized=null,this.columnUngrouping=null,this.columnUngrouped=null,this.currentCellChanging=null,this.currentCellChanged=null,this.filterOperatorsListShowing=null,this.filtering=null,this.filtered=null,this.groupAggregate=null,this.groupText=null,this.invalidCellValue=null,this.pageIndexChanging=null,this.pageIndexChanged=null,this.selectionChanged=null,this.sorting=null,this.sorted=null,this.dataLoading=null,this.dataLoaded=null,this.loading=null,this.loaded=null,this.rendering=null,this.rendered=null}return e}();i.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget("wijgrid",i.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(e){e&&(this.__attr=e)}return e.prototype.attrs=function(){return this.__attr},e.prototype.ensureAttr=function(){return this.__attr=this.__attr||{},this.__attr},e.prototype.attr=function(e,t){if(arguments.length==0)return this.__attr;if(arguments.length==1)return this.__attr?this.__attr[e]:null;this.ensureAttr()[e]=t},e.prototype.style=function(e,t){if(arguments.length==0)return this.__style;if(arguments.length==1)return this.__style&&this.__style[e];this.ensureStyle()[e]=t},e.prototype.deleteStyle=function(e){this.__style&&delete this.__style[e]},e.prototype.ensureStyle=function(){return this.__style=this.__style||{},this.__style},e}();t.SketchObject=r;var i=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.visible=function(e){if(arguments.length==0)return this._visible!==!1;this._visible=e},t}(r);t.SketchCell=i;var s=function(e){function t(t,n){e.call(this,n),this.value=t}return __extends(t,e),t}(i);t.ValueCell=s;var o=function(e){function t(t,n){typeof t=="undefined"&&(t=""),e.call(this,n),this.html=t}return __extends(t,e),t.nbsp=function(){return new t("&nbsp;")},t}(i);t.HtmlCell=o;var u=function(t){function n(e,n){t.call(this,n),this.rowType=e}return __extends(n,t),n.prototype.isDataRow=function(){return(this.rowType&e.grid.rowType.data)==e.grid.rowType.data},n.prototype.dataItemIndex=function(e){return typeof e=="undefined"&&(e=0),-1},n.prototype.cellCount=function(){return this._cells?this._cells.length:0},n.prototype._ensureCells=function(){this._cells=this._cells||[]},n.prototype.add=function(e){this._ensureCells(),this._cells.push(e)},n.prototype.insert=function(e,t){this._ensureCells(),this._cells.splice(e,0,t)},n.prototype.cell=function(e){return this._cells[e]},n.prototype.valueCell=function(e){return this.cell(e)},n.prototype.removeAt=function(e){if(!this._cells)throw"Wrong index";this._cells.splice(e,1)},n.prototype.clear=function(){},n.prototype.getRowInfo=function(){return{type:this.rowType,state:null,sectionRowIndex:null,dataRowIndex:null,virtualDataItemIndex:null,dataItemIndex:this.dataItemIndex(),$rows:null}},n}(r);t.SketchRow=u;var a=function(t){function n(n,r){t.call(this,e.grid.rowType.data|(n%2==1?e.grid.rowType.dataAlt:0),r),this.originalRowIndex=n}return __extends(n,t),n.prototype.dataItemIndex=function(e){return typeof e=="undefined"&&(e=0),e+this.originalRowIndex},n.prototype.isDataRow=function(){return!0},n}(u);t.SketchDataRow=a;var f=function(t){function n(n,r){typeof n=="undefined"&&(n=!0);var i=n?e.grid.rowType.groupHeader:e.grid.rowType.groupFooter;t.call(this,i,r)}return __extends(n,t),n.prototype.getRowInfo=function(){var e=t.prototype.getRowInfo.call(this);return this.groupByValue!==undefined&&(e.groupByValue=this.groupByValue),e},n}(u);t.SketchGroupRow=f;var l=function(){function e(){this._table=[]}return e.prototype.getRawTable=function(){return this._table},e.prototype.row=function(e){return this._table[e]},e.prototype.valueAt=function(e,t){return this.row(e).valueCell(t).value},e.prototype.count=function(e){return typeof e=="number"&&(this._table.length=e),this._table.length},e.prototype.add=function(e){this._table.push(e)},e.prototype.insert=function(e,t){this._table.splice(e,0,t)},e.prototype.clear=function(){this._table.length=0},e.prototype.removeFirst=function(e){typeof e=="undefined"&&(e=1),this._table.splice(0,e)},e.prototype.removeLast=function(e){typeof e=="undefined"&&(e=1),this._table.splice(this._table.length-e,e)},e.prototype.replace=function(e,t){this._table.splice(e,1,t)},e.prototype.updateIndexes=function(){for(var e=0;e<this._table.length;e++){var t=this._table[e];this._table[e].isDataRow()&&(t.originalRowIndex=e)}},e.prototype.isLazy=function(){return!1},e.prototype.ensureNotLazy=function(){},e}();t.SketchTable=l;var c=function(e){function t(t){e.call(this),this.mIsLazy=!0,this.pageSize=30;if(t==null)throw"Row source is null";this.mSource=t,this._table.length=t.count()}return __extends(t,e),t.prototype.isLazy=function(){return this.mIsLazy},t.prototype.ensureNotLazy=function(){if(!this.isLazy())return;this.ensureRange(),this.mIsLazy=!1},t.prototype.invalidate=function(){this._table=new Array(this.mSource.count()),this.isLazy()||this.updateRange()},t.prototype.row=function(t){return e.prototype.row.call(this,t)||this.ensureRange(Math.max(0,t-this.pageSize/2),this.pageSize),e.prototype.row.call(this,t)},t.prototype.ensureRange=function(e,t){typeof e=="undefined"&&(e=0),typeof t=="undefined"&&(t=this._table.length-e);if(!this.isLazy())return;if(e<0)throw"Wrong range start";this._table.length=this.mSource.count();if(this._table.length==0){if(t>0)throw"Wrong range length";return}while(e<this._table.length&&this._table[e])e++;if(e>=this._table.length)return;var n=Math.min(e+t-1,this._table.length-1);while(n>=e&&this._table[n])n--;t=n-e+1,t>0&&this.updateRange(e,t)},t.prototype.updateRange=function(e,t){typeof e=="undefined"&&(e=0),typeof t=="undefined"&&(t=this._table.length-e);if(this.mSource==null)throw"Cannot create sketch row because source is null";this.mSource.getRange(e,t,this._table,e)},t}(l);t.LazySketchTable=c})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){var t=n.data(this.element[0],"wijgridowner");this._field("owner",t),e.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass(t.options.wijCSS.widget+" wijmo-c1basefield "+t.options.wijCSS.stateDefault),this.options.disabled&&this.disable(),t.options.allowColMoving&&t._UIDragndrop(!0).attach(this)},r.prototype._init=function(){this.element.wrapInner("<div class='wijmo-wijgrid-innercell'></div>"),this._refreshHeaderCell()},r.prototype.destroy=function(){try{t.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},r.prototype._destroy=function(){if(this._isDestroyed())return;var t=this._owner();t&&t._UIDragndrop()&&t._UIDragndrop().detach(this),e.grid.remove$dataByPrefix(this.element,this._data$prefix),this.element.removeClass(t.options.wijCSS.widget+" wijmo-c1basefield "+t.options.wijCSS.stateDefault).html(this.element.find(".wijmo-wijgrid-headertext").html())},r.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},r.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},r.prototype._setOption=function(e,n){var r=this["_preset_"+e],i=this.options[e],s,o;r!==undefined&&(n=r.apply(this,[n,i])),s=n!==i,t.prototype._setOption.apply(this,[e,n]);if(s){if(this.options.groupedIndex!==undefined){var u=this._owner()._field("groupedWidgets")[this.options.groupedIndex];u&&e in u.options&&u._setOption(e,n)}o=this["_postset_"+e],o!==undefined&&o.apply(this,[n,i])}},r.prototype._postset_allowMoving=function(e,t){},r.prototype._preset_clientType=function(e,t){throw"read-only"},r.prototype._postset_headerText=function(e,t){this._refreshHeaderCell()},r.prototype._postset_visible=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_width=function(t,n){var r=this._owner();if(r){this.options.ensurePxWidth=!0;var i=e.grid.getColumnByTravIdx(r.options.columns,this.options.travIdx);i&&(i.found.width=t,i.found.ensurePxWidth=!0),r.setSize()}},r.prototype._owner=function(){return this._field("owner")},r.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},r.prototype._canDrag=function(){return this.options.allowMoving===!0},r.prototype._canDropTo=function(t){return e.grid.isChildOf(this._owner().options.columns,t,this)?!1:!0},r.prototype._createHeaderContent=function(e){return e.html(this.options.headerText||"&nbsp;")},r.prototype._decorateHeaderContent=function(e){return e.wrapInner('<span class="wijmo-wijgrid-headertext" />')},r.prototype._refreshHeaderCell=function(){var e=this.element.children(".wijmo-wijgrid-innercell").empty();this._createHeaderContent(e),this._decorateHeaderContent(e)},r.prototype._isDestroyed=function(){return this._destroyed},r}(e.wijmoWidget);t.c1basefield=r,r.prototype._data$prefix="c1basefield";var i=function(){function e(){this.allowMoving=!0,this.allowSizing=!0,this.cellFormatter=undefined,this.dataKey=undefined,this.ensurePxWidth=undefined,this.footerText=undefined,this.headerText=undefined,this.textAlignment=undefined,this.visible=!0,this.width=undefined}return e}();t.c1basefield_options=i,r.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new i),n.wijmo.registerWidget("c1basefield",r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){t.prototype._create.apply(this,arguments);var e=this._owner();this.element.addClass(e.options.wijCSS.widget+" wijmo-c1field")},r.prototype._destroy=function(){if(this._isDestroyed())return;var e=this._owner();this.element.find("*").unbind("."+this.widgetName);if(this.$filterEditor){this.$filterEditor.closest("td").find("*").unbind("."+this.widgetName);switch(this._getInputEditorType(this.options)){case"date":this.$filterEditor.data("wijmo-wijinputdate")&&this.$filterEditor.wijinputdate("destroy");break;case"mask":this.$filterEditor.data("wijmo-wijinputmask")&&this.$filterEditor.wijinputmask("destroy");break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.data("wijmo-wijinputnumber")&&this.$filterEditor.wijinputnumber("destroy")}this.$filterEditor=null}this.element.removeClass(e.options.wijCSS.widget+" wijmo-c1field"),this._removeDropDownFilterList(),t.prototype._destroy.apply(this,arguments)},r.prototype._init=function(){t.prototype._init.apply(this,arguments),this.$filterEditor=null;var e=this._owner();this.filterRow=e._filterRow(),e.options.showFilter&&this.options.showFilter&&this.options.dataIndex>=0&&this._prepareFilterCell()},r.prototype._postset_aggregate=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_allowSort=function(e,t){this._refreshHeaderCell()},r.prototype._postset_dataType=function(e,t){throw"read-only"},r.prototype._postset_dataParser=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_dataFormatString=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_filterOperator=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_filterValue=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_groupInfo=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_rowMerge=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_showFilter=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_sortDirection=function(e,t){this.options.sortOrder=0,this._owner().ensureControl(!0)},r.prototype._postset_width=function(e,n){t.prototype._postset_width.apply(this,arguments)},r.prototype._canDropTo=function(e){return t.prototype._canDropTo.apply(this,arguments)?this.options.groupedIndex!==undefined&&e instanceof n.wijmo.c1groupedfield?!1:!0:!1},r.prototype._isSortable=function(){return e.grid.validDataKey(this.options.dataKey)},r.prototype._isSortableUI=function(){var e=this._owner();return e&&e.options.allowSorting&&this.options.allowSort&&this._isSortable()},r.prototype._decorateHeaderContent=function(e){var r=this._owner();if(!this._isSortable())t.prototype._decorateHeaderContent.apply(this,arguments);else{this._isSortableUI()?e.wrapInner('<a class="wijmo-wijgrid-headertext" href="#" role="button" />').children("a").bind("click."+this.widgetName,this,n.proxy(this._onHrefClick,this)):t.prototype._decorateHeaderContent.apply(this,arguments);switch(this.options.sortDirection){case"ascending":e.append(n('<span class="wijmo-wijgrid-sort-icon '+r.options.wijCSS.icon+" "+r.options.wijCSS.iconArrowUp+'">ascending</span>'));break;case"descending":e.append(n('<span class="wijmo-wijgrid-sort-icon '+r.options.wijCSS.icon+" "+r.options.wijCSS.iconArrowDown+'">descending</span>'))}}},r.prototype._prepareFilterCell=function(){var t=this.options.visLeavesIdx,r=this._owner(),i=null,s,o,u=this,a,f=e.grid.HTML5InputSupport.getDefaultInputType(r._isMobileEnv(),this.options);if(t>=0){r=this._owner();if(!this.filterRow)throw"exception";i=n(e.grid.rowAccessor.getCell(this.filterRow,t)),this.$filterEditor=i.find("input"),i.bind(n.support.selectstart?"selectstart":"mousedown",function(e){e.stopPropagation()}),s=r.parse(this.options,e.grid.filterHelper.getSingleValue(this.options.filterValue));if(s===null||s==="undefined")switch(e.grid.getDataType(this.options)){case"boolean":s=!1;break;case"number":case"currency":case"datetime":s=0;break;default:s=""}o={culture:r.options.culture,disabled:r.options.disabled,decimalPlaces:function(e){var t=/^(n|p|c){1}(\d*)$/.exec(e);return t&&t[2]?parseInt(t[2],10):(t=/^(d){1}(\d*)$/.exec(e),t?0:2)}(this.options.dataFormatString)};switch(a=this._getInputEditorType(this.options)){case"date":f==="text"?this.$filterEditor.wijinputdate(n.extend(o,{date:s,dateFormat:this.options.dataFormatString||undefined,showTrigger:!0})):this._createHtmlEditor(this.$filterEditor,f,e.grid.HTML5InputSupport.toStr(s||new Date,f));break;case"mask":this.$filterEditor.wijinputmask({text:s+""});break;case"numberCurrency":this.$filterEditor.wijinputnumber(n.extend(o,{type:"currency",value:s}));break;case"numberNumber":f==="text"?this.$filterEditor.wijinputnumber(n.extend(o,{value:s})):this._createHtmlEditor(this.$filterEditor,f,e.grid.HTML5InputSupport.toStr(s,f));break;case"numberPercent":this.$filterEditor.wijinputnumber(n.extend(o,{type:"percent",value:s*100}));break;default:throw e.grid.stringFormat('Unsupported editor type: "{0}"',a)}i.find(".wijmo-wijgrid-filter-trigger").attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(e){u.options.disabled||n(this).addClass(r.options.wijCSS.stateHover)}).bind("mouseleave."+this.widgetName,function(e){u.options.disabled||n(this).removeClass(r.options.wijCSS.stateHover+" "+r.options.wijCSS.stateActive)}).bind("mouseup."+this.widgetName,this,function(e){u.options.disabled||n(this).removeClass(r.options.wijCSS.stateActive)}).bind("mousedown."+this.widgetName,{column:this},this._onFilterBtnClick).bind("click."+this.widgetName,function(e){e.preventDefault()})}},r.prototype._createHtmlEditor=function(e,t,n){return e.wrap('<span class="wijgrid-input-wrapper"></span').attr("type",t).val(n)},r.prototype._onFilterBtnClick=function(t){var r=t.data.column,i=8,s=r._owner(),o,u,a,f,l,c,h,p,d=e.grid.HTML5InputSupport.getDefaultInputType(s._isMobileEnv(),r.options);if(r.options.disabled)return!1;if(r.$dropDownFilterList)return r._removeDropDownFilterList(),!1;t.target.focus(),o=e.grid.filterHelper.getSingleOperatorName(r.options.filterOperator).toLowerCase(),u=s.getFilterOperatorsByDataType(e.grid.getDataType(r.options)),a={operators:n.extend(!0,[],u),column:r.options},s._onFilterOperatorsListShowing(a),f=[],a.operators&&n.each(a.operators,function(e,t){f.push({label:t.displayName||t.name,value:t.name,selected:t.name.toLowerCase()===o})}),r.$dropDownFilterList=n('<div class="wijmo-wijgrid-filterlist"></div').appendTo(document.body).wijlist({autoSize:!0,maxItemsCount:i,selected:function(t,n){var i,o;switch(o=r._getInputEditorType(r.options)){case"date":d==="text"?i=r.$filterEditor.wijinputdate("option","date")||new Date:i=e.grid.HTML5InputSupport.parse(r.$filterEditor.val(),d)||new Date;break;case"mask":i=r.$filterEditor.wijinputmask("option","text");break;case"numberNumber":if(d!=="text"){i=e.grid.HTML5InputSupport.parse(r.$filterEditor.val(),d)||0;break};case"numberCurrency":case"numberPercent":i=r.$filterEditor.wijinputnumber("option","value"),o==="numberPercent"&&(i/=100)}r._removeDropDownFilterList(),s._handleFilter(r,n.item.value,i)}}),r.$dropDownFilterList.css("z-index",e.grid.getZIndex(s.outerDiv,9999)),r.$dropDownFilterList.wijlist("setItems",f).wijlist("renderList"),h=r.$dropDownFilterList.width()|150,r.$dropDownFilterList.width(f.length>i?h+20:h).wijlist("refreshSuperPanel").position({of:n(this),my:"left top",at:"left bottom"}),r.$dropDownFilterList.$button=n(this),p=r.$dropDownFilterList.eventUID=e.grid.getUID(),n(document).bind("mousedown."+r.widgetName+"."+p,{column:r},r._onDocMouseDown)},r.prototype._onDocMouseDown=function(e){var t=n(e.target),r=t.parents(".wijmo-wijgrid-filterlist:first"),i=t.is(".wijmo-wijgrid-filter-trigger")?t:t.parents(".wijmo-wijgrid-filter-trigger:first");i.length&&i[0]===e.data.column.$dropDownFilterList.$button[0]||r.length&&r[0]===e.data.column.$dropDownFilterList[0]||e.data.column._removeDropDownFilterList()},r.prototype._onHrefClick=function(e){if(e.data.options.disabled)return!1;if(e.data.options.allowSort){var t=e.data._owner();t._handleSort(e.data.options,e.ctrlKey)}return!1},r.prototype._removeDropDownFilterList=function(){if(this.$dropDownFilterList){var e=this.$dropDownFilterList.eventUID;this.$dropDownFilterList.remove(),this.$dropDownFilterList=null,n(document).unbind("mousedown."+this.widgetName+"."+e,this._onDocMouseDown)}},r.prototype._getInputEditorType=function(t){switch(e.grid.getDataType(t)){case"number":return t.dataFormatString&&t.dataFormatString.indexOf("p")===0?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"mask"}},r}(t.c1basefield);t.c1field=r;var i=function(e){function t(){e.apply(this,arguments),this.aggregate="none",this.allowSort=!0,this.dataType=undefined,this.inputType=undefined,this.dataParser=undefined,this.dataFormatString=undefined,this.filterOperator="nofilter",this.filterValue=undefined,this.groupInfo={expandInfo:[],level:undefined,groupSingleRow:!0,collapsedImageClass:n.wijmo.wijCSS.iconArrowRight,expandedImageClass:n.wijmo.wijCSS.iconArrowRightDown,position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},this.readOnly=!1,this.rowMerge="none",this.showFilter=!0,this.sortDirection="none",this.valueRequired=!1}return __extends(t,e),t}(t.c1basefield_options);t.c1field_options=i,r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i),n.wijmo.registerWidget("c1field",n.wijmo.c1basefield,r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){e.prototype._create.apply(this,arguments);var t=this._owner();this.element.addClass(t.options.wijCSS.widget+" wijmo-c1band")},t.prototype._canDropTo=function(t){return e.prototype._canDropTo.apply(this,arguments)?!(t instanceof n.wijmo.c1groupedfield):!1},t}(t.c1basefield);t.c1band=r;var i=function(e){function t(){e.apply(this,arguments),this.columns=[]}return __extends(t,e),t}(t.c1field_options);r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i),n.wijmo.registerWidget("c1band",n.wijmo.c1basefield,r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){var t=n.data(this.element[0],"wijgridowner");this._field("owner",t),e.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass("wijmo-wijgrid-group-button "+t.options.wijCSS.stateDefault+" "+t.options.wijCSS.cornerAll),this.options.disabled&&this.disable(),t.options.allowColMoving&&t._UIDragndrop(!0).attach(this)},r.prototype._init=function(){this._refreshHeaderCell()},r.prototype.destroy=function(){try{t.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},r.prototype._destroy=function(){if(this._isDestroyed())return;this.element.find("*").unbind("."+this.widgetName);var t=this._owner();t&&t._dragndrop(!1)&&t._dragndrop(!1).detach(this),e.grid.remove$dataByPrefix(this.element,this._data$prefix)},r.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},r.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},r.prototype._setOption=function(e,n){var r=this["_preset_"+e],i=this.options[e],s,o;r!==undefined&&(n=r.apply(this,[n,i])),s=n!==i,t.prototype._setOption.apply(this,[e,n]),s&&(o=this["_postset_"+e],o!==undefined&&o.apply(this,[n,i]))},r.prototype._postset_headerText=function(e,t,n){this._refreshHeaderCell()},r.prototype._postset_allowSort=function(e,t,n){this._refreshHeaderCell()},r.prototype._owner=function(){return this._field("owner")},r.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},r.prototype._canDrag=function(){return this.options.allowMoving===!0},r.prototype._canDropTo=function(t){return t instanceof n.wijmo.c1groupedfield?e.grid.isChildOf(this._owner().options.columns,t,this)?!1:!0:!1},r.prototype._isSortable=function(){return e.grid.validDataKey(this.options.dataKey)},r.prototype._isSortableUI=function(){var e=this._owner();return e&&e.options.allowSorting&&this.options.allowSort&&this._isSortable()},r.prototype._refreshHeaderCell=function(){var e=this._owner().options.wijCSS,t=n('<span class="wijmo-wijgrid-group-button-close '+e.stateDefault+" "+e.cornerAll+'"><span class="'+e.icon+" "+e.iconClose+'"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);this.element.html(this.options.headerText||"").prepend(t),this._isSortableUI()&&this.element.bind("click."+this.widgetName,this,n.proxy(this._onHrefClick,this));if(this._isSortable())switch(this.options.sortDirection){case"ascending":this.element.append(n('<span class="wijmo-wijgrid-group-button-sort '+e.icon+" "+e.iconArrowUp+'"></span>'));break;case"descending":this.element.append(n('<span class="wijmo-wijgrid-group-button-sort '+e.icon+" "+e.iconArrowDown+'"></span>'))}},r.prototype._onCloseClick=function(e){var t=e.data.options;return t.disabled||e.data._owner()._handleUngroup(e.data.options.travIdx),!1},r.prototype._onHrefClick=function(t){var n=t.data._owner(),r=t.data.options,i;return!r.disabled&&r.allowSort&&(i=e.grid.search(n.columns(),function(e){return e.options.travIdx===r.travIdx}),i=i.found?i.found.options:e.grid.getColumnByTravIdx(n.options.columns,r.travIdx).found,i&&n._handleSort(i,t.ctrlKey)),!1},r.prototype._isDestroyed=function(){return this._destroyed},r}(e.wijmoWidget);t.c1groupedfield=r,r.prototype._data$prefix="c1groupedfield",r.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},allowMoving:!0,allowSort:!0,headerText:undefined,sortDirection:"none"}),n.wijmo.registerWidget("c1groupedfield",r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function i(e){var t=[];return s(e,t),t}function s(e,t){var n,r,i,o;if(e)for(n=0,r=e.length;n<r;n++)i=e[n],i.options&&(i=i.options),o=i.columns,o&&o.length?s(o,t):t.push(i)}function o(e,t){var n,r,i,s=null;if(e&&t>=0)for(n=0,r=e.length;n<r&&!s;n++){i=e[n],i.options&&(i=i.options);if(i.travIdx===t)return{found:i,at:e};i.columns&&(s=this.getColumnByTravIdx(i.columns,t))}return s}function u(e,t,n){t.options&&(t=t.options),n.options&&(n=n.options);if(n.isBand&&t.parentIdx>=0){if(t.parentIdx===n.travIdx)return!0;if(t.parentIdx>n.travIdx){var r=this.flatten(e);for(;;){t=r[t.parentIdx];if(t.travIdx===n.travIdx)return!0;if(t.parentIdx===-1)break}}}return!1}function a(e){var t=[];return f(e,t),t}function f(e,t){var n,r,i;if(e)for(n=0,r=e.length;n<r;n++)i=e[n],i.isLeaf&&t.push(i),i.columns&&f(i.columns,t)}function l(e){return c(e,0,-1)}function c(e,t,n){var r,i,s;if(e)for(r=0,i=e.length;r<i;r++)s=e[r],s.options&&(s=s.options),s.linearIdx=r,s.travIdx=t++,s.parentIdx=n,s.columns&&(t=c(s.columns,t,t-1));return t}function h(t){var n=[];return e.grid.traverse(t,function(e){n.push(e)}),n}function p(t,r){var i,s,o;if(t&&n.isFunction(r))for(i=0;i<t.length;i++){o=t[i],o.options&&(o=o.options),s=t.length,r(o,t);if(t.length!==s){i--;continue}o.columns&&e.grid.traverse(o.columns,r)}}var n=jQuery,r=function(){function t(){}return t.prototype.generateSpanTable=function(e,t){this._height=this._width=this._inc=this._shift=0,this._table=[],this._traverseList=[],this._savedXPos=[];var n=this._generateSpanTable(e,t,!0);return n},t.prototype._generateSpanTable=function(t,n,r){var i,s,o=this;this._height=this.getVisibleHeight(t,r),n=n||[],e.grid.traverse(t,function(e){e.isLeaf&&n.push(e),o._traverseList.push(e)}),this._width=n.length;for(i=0;i<this._height;i++){this._table[i]=[];for(s=0;s<this._width;s++)this._table[i][s]={column:null,colSpan:0,rowSpan:0}}return this._setTableValues(t,0,0),this._table},t.prototype.getVisibleHeight=function(e,t){var r,i,s,o,u=0;if(n.isArray(e))for(r=0,i=e.length;r<i;r++)o=this.getVisibleHeight(e[r],t),u=Math.max(u,o);else{s=e.visible===undefined?!0:e.visible,e.parentVis=s&&t;if(e.isBand){for(r=0,i=e.columns.length;r<i;r++)o=this.getVisibleHeight(e.columns[r],e.parentVis),u=Math.max(u,o);if(!e.parentVis)return u;e.isLeaf=u===0,u++}else e.isLeaf=!0,e.parentVis&&(u=1)}return u},t.prototype._getVisibleParent=function(e){while(e){e=this._traverseList[e.parentIdx];if(e&&(e.parentVis||e.parentVis===undefined))return e}return null},t.prototype._setTableValues=function(e,t,r){var i,s,o,u,a,f;if(n.isArray(e))for(i=0,s=e.length;i<s;i++)this._setTableValues(e[i],t,r);else{if(e.travIdx===undefined)throw"undefined travIdx";o=r+this._shift,e.parentVis&&(u=o+this._inc,this._table[t][u].column=e,this._savedXPos[e.travIdx]=u);if(e.isBand)for(i=0,s=e.columns.length;i<s;i++)this._setTableValues(e.columns[i],t+1,r);e.parentVis?this._shift-o===0?(this._table[t][this._savedXPos[e.travIdx]].rowSpan=this._height-t,this._shift++):this._table[t][this._savedXPos[e.travIdx]].colSpan=this._shift-o:!e.isBand&&this._height>0&&(f=this._getVisibleParent(e),a=f?f.isLeaf:!1,a&&this._inc++,t>=this._height&&(t=this._height-1),u=r+this._shift+this._inc,this._table[t][u].column=e,a||(f&&this._savedXPos[f.travIdx]===u&&this._shiftTableElements(u,t),this._inc++))}},t.prototype._shiftTableElements=function(e,t){var n;for(n=0;n<t;n++)this._table[n][e+1]=this._table[n][e],this._table[n][e]={column:null,colSpan:0,rowSpan:0},this._table[n][e+1].column&&this._savedXPos[this._table[n][e+1].column.travIdx]++},t}();t.bandProcessor=r,t.getAllLeaves=i,t.getColumnByTravIdx=o,t.isChildOf=u,t.getLeaves=a,t.setTraverseIndex=l,t.flatten=h,t.traverse=p})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._dvFilteringSettings=undefined,this._dvPagingSettings=undefined,this._dvSortingSettings=undefined,this._wgFilteringSettings=undefined,this._wgPagingSettings=undefined,this._wgSortingSettings=undefined;if(!t)throw"exception";this._wijgrid=t,this._dataView=t._dataViewWrapper.dataView(),this._filterCache=new e.grid.filterOperatorsCache(t)}return t.prototype.compareSettings=function(){var t=!0,n,r,i,s;t=(n=this.DVPagingSettings())===(r=this.WGPagingSettings()),!t&&n&&r&&(t=n.pageSize===r.pageSize&&n.pageIndex===r.pageIndex);if(t){t=(n=this.DVSortingSettings())===(r=this.WGSortingSettings());if(!t&&n&&r&&(s=n.length)===r.length){t=!0;for(i=0;i<s&&t;i++)t=n[i].dataKey===r[i].dataKey&&n[i].sortDirection===r[i].sortDirection}}return t&&(n=this.DVFilteringSettings(),r=this.WGFilteringSettings(),t=e.grid.compareObj(n,r)),t},t.prototype.DVFilteringSettings=function(){function e(t,r){var i;n.each(t,function(t,s){typeof s=="string"?i=s:n.isArray(s)?e(s,r):(r.filterValue.push(s.value),r.filterOperator.push({name:s.originalOperator||s.operator,condition:i}))})}if(this._dvFilteringSettings===undefined){var t=[],r=this._dataView.filter();r&&n.each(r,function(r,i){var s={dataKey:r};n.isArray(i)?(s.filterValue=[],s.filterOperator=[],e(i,s)):n.isPlainObject(i)?(s.filterValue=i.value,s.filterOperator=i.originalOperator||i.operator||"Equals"):(s.filterValue=i,s.filterOperator="Equals"),t.push(s)}),this._dvFilteringSettings=t.length?t:null}return this._dvFilteringSettings},t.prototype.DVPagingSettings=function(){if(this._dvPagingSettings===undefined){var t=e.grid.asPagedDataView(this._dataView);if(t){var n=t.pageSize();this._dvPagingSettings=n>0?{pageSize:t.pageSize(),pageIndex:t.pageIndex()}:null}}return this._dvPagingSettings},t.prototype.DVSortingSettings=function(){if(this._dvSortingSettings===undefined){var t=[],r=e.data.sorting.compile(this._dataView.sort()).normalized;r&&n.each(r,function(e,n){n!==null&&t.push({dataKey:typeof n=="string"?n:n.property,sortDirection:n.asc||n.asc===undefined?"ascending":"descending"})}),this._dvSortingSettings=t.length?t:null}return this._dvSortingSettings},t.prototype.WGFilteringSettings=function(){if(this._wgFilteringSettings===undefined){var t=[],r=this._wijgrid._field("leaves"),i=this;r&&n.each(r,function(n,r){if(e.grid.validDataKey(r.dataKey)&&r.filterOperator){var s=e.grid.deepExtend({},{foo:r.filterValue}).foo,o=e.grid.deepExtend({},{foo:r.filterOperator}).foo,u=e.grid.filterHelper.verify(o,s,r.dataType,i._filterCache);u&&t.push({owner:r,dataKey:r.dataKey,filterValue:u.filterValue,filterOperator:u.filterOperator})}}),this._wgFilteringSettings=t.length?t:null}return this._wgFilteringSettings},t.prototype.WGPagingSettings=function(){return this._wgPagingSettings===undefined&&(this._wgPagingSettings=this._wijgrid.options.allowPaging?{pageSize:this._wijgrid.options.pageSize,pageIndex:this._wijgrid.options.pageIndex}:null),this._wgPagingSettings},t.prototype.WGSortingSettings=function(){if(this._wgSortingSettings===undefined){var t={},r=[],i=this._wijgrid._groupedColumns(!0),s=this._wijgrid._field("leaves")||[],o=function(t){return!t.isBand&&e.grid.validDataKey(t.dataKey)},u=0;n.each(i,function(e,n){o(n)&&(n.sortDirection==="none"&&(n.sortDirection="ascending"),t[n.dataKey]={dataKey:n.dataKey,sortDirection:n.sortDirection,sortOrder:u++})}),u++,n.each(s,function(e,n){o(n)&&(n.sortDirection==="ascending"||n.sortDirection==="descending")&&(t[n.dataKey]||(t[n.dataKey]={dataKey:n.dataKey,sortDirection:n.sortDirection,sortOrder:(n.sortOrder||0)+u}))}),n.each(t,function(e,t){r.push(t)}),r.sort(function(e,t){return e.sortOrder-t.sortOrder}),n.each(r,function(e,t){delete t.sortOrder}),this._wgSortingSettings=r.length?r:null}return this._wgSortingSettings},t.prototype.MapWGToDV=function(){var t=this,r={},i,s;this._mapPagingParams()&&(i=this.WGPagingSettings())?(r.pageIndex=i.pageIndex,r.pageSize=i.pageSize):r.pageSize=-1;if(this._mapSortingParams()){r.sort=[];if(i=this.WGSortingSettings())r.sort=[],n.each(i,function(e,t){r.sort.push({property:t.dataKey,asc:t.sortDirection==="ascending"})})}this._wijgrid.deficientFilters={};if(this._mapFilteringParams()){n.each(this._wijgrid._field("leaves"),function(n,r){e.grid.validDataKey(r.dataKey)&&r.filterOperator===undefined^r.filterValue===undefined&&(t._wijgrid.deficientFilters[r.dataKey]={filterOperator:r.filterOperator,filterValue:r.filterValue})}),r.filter={};if(i=this.WGFilteringSettings())r.filter=this._convertFilterToDV(i);n.isEmptyObject(r.filter)&&(r.filter=null)}return r},t.prototype.MapDVToWG=function(){var t,r={},i=this._mapSortingParams(),s=this._mapPagingParams(),o=this._mapFilteringParams(),u=e.grid.asPagedDataView(this._dataView),a=this;n.each(this._wijgrid._field("leaves"),function(e,t){i&&(t.sortOrder=0,t.sortDirection="none"),o&&(t.filterOperator="nofilter",t.filterValue=undefined),r[t.dataKey]=t}),s&&u&&(this._wijgrid.options.pageSize=u.pageSize(),this._wijgrid.options.pageIndex=u.pageIndex()),i&&(t=this.DVSortingSettings())&&n.each(t,function(e,t){var n;if(n=r[t.dataKey])n.sortDirection=t.sortDirection,n.sortOrder=e}),o&&((t=this.DVFilteringSettings())&&n.each(t,function(e,t){var i;if(i=r[t.dataKey])i.filterValue=t.filterValue,i.filterOperator=t.filterOperator,n.isPlainObject(i.filterOperator)&&(i.filterOperator=i.filterOperator.name),delete a._wijgrid.deficientFilters[i.dataKey]}),n.each(this._wijgrid.deficientFilters,function(e,t){r[e].filterOperator=t.filterOperator,r[e].filterValue=t.filterValue}))},t.prototype._mapPagingParams=function(){return this._wijgrid.options.allowPaging&&!this._wijgrid._customPagingEnabled()&&!this._wijgrid._serverShaping()},t.prototype._mapSortingParams=function(){return!this._wijgrid._serverShaping()},t.prototype._mapFilteringParams=function(){return!this._wijgrid._serverShaping()},t.prototype.makeProxyFilter=function(t,r,i,s){i=i.toLowerCase();var o=this,u=t.dataType==="datetime",a={originalOperator:undefined,property:r,operator:i,value:s},f=this._filterCache.getByNameInt(i),l=e.data.filtering.ops[i];if(i!=="nofilter"&&(f.isCustom||u)){a.originalOperator=a.operator;if(f.isCustom)a.operator=n.extend(!0,{},f.op),a.operator.apply=a.operator.operator;else{a.operator=n.extend(!0,{},l);var c=t.inputType?e.grid.TimeUnitConverter.convertInputType(t.inputType):e.grid.TimeUnitConverter.convertFormatString(t.dataFormatString||"d");a.operator.apply=function(n,r){return n instanceof Date||(n=o._wijgrid.parse(t,n)),r instanceof Date||(r=o._wijgrid.parse(t,r)),e.grid.TimeUnitConverter.cutDate(n,c),e.grid.TimeUnitConverter.cutDate(r,c),l.apply(n,r)}}}return a},t.prototype._convertFilterToDV=function(e){var t={},r=this;return n.each(e,function(e,i){var s=i.dataKey,o=[],u="and",a,f,l,c;if(!n.isPlainObject(i))return;f=i.filterOperator,l=i.filterValue;if(f==null)return;n.isArray(f)||(f=[f]),n.isArray(l)||(l=[l]);if(f.length!=l.length)throw"The number of filter operators must match the number of filter values";if(f.length==0)return;n.each(f,function(e,t){function h(){c.length>1?c.splice(0,0,"or"):c=c[0]}function p(){u==null&&(u=a,o.splice(0,0,a))}var f;typeof t=="string"&&(t={name:t});if(!n.isPlainObject(t)||!t.name)throw"Invalid filter operator";f=l[e],n.isArray(f)||(f=[f]),c=n.map(f,function(e){return r.makeProxyFilter(i.owner,s,t.name,e)}),u=null,a=t.condition||"or",o.length<=1||u==a?c.length==1||o.length<=1||u=="or"?(o=o.concat(c),p()):(h(),o.push(c),p()):(h(),o=[o,c],p())}),n.each(o,function(e,t){n.isArray(t)&&t.length==2&&(o[e]=t[1])}),o.length==2&&typeof (o[0]==="string")&&o.shift(),o.length==1&&(o=o[0]),t[s]=o}),t},t}();t.settingsManager=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function i(e){return e&&"pageCount"in e?e:null}function s(e){return e&&"commitEdit"in e?e:null}var n=jQuery,r=function(){function t(e){this._domSource=null,this._ignoreAllEvents=!1,this._ignoreChangeEvent=!1,this._ignoreCurrentChangedEvent=!1,this._sharedDataItems=null,this._userData=null,this._totals=null,this._changeTimer=0,this._toDispose=[],this._isOwnDataView=!1,this._isWijdatasource=!1,this._isDynamicWijdatasource=!1,this._wijgrid=e,this._createDataViewWrapper()}return t.prototype.data=function(){var t=this._getDataViewInst(),n=e.grid.asPagedDataView(t);return{data:this._getSharedDataItems(),totalRows:n!=null?n.totalItemCount():(t.getSource()||[]).length,totals:this._getTotals(),emptyData:this.isBoundedToDOM()?this._domSource.emptyData:null}},t.prototype.dataView=function(){return this._getDataViewInst()},t.prototype.dispose=function(){var e=this._getDataViewInst();this._propChangeListener.dispose(),n.each(this._toDispose,function(e,t){t.dispose()}),e&&this._isOwnDataView&&e.dispose(),this._wijgrid._wijDataView=null},t.prototype.ignoreChangeEvent=function(e){if(!arguments.length)return this._ignoreChangeEvent;this._ignoreChangeEvent=e===!0},t.prototype.ignoreCurrentChangedEvent=function(e){if(!arguments.length)return this._ignoreCurrentChangedEvent;this._ignoreCurrentChangedEvent=e===!0},t.prototype.isDataLoaded=function(){var e=this._getDataViewInst();return e.isLoaded()},t.prototype.isOwnDataView=function(){return this._isOwnDataView},t.prototype.getFieldsInfo=function(){var e=this._getDataViewInst();return this._propDescriptorsToFieldsInfo(e.getProperties())},t.prototype._propDescriptorsToFieldsInfo=function(e){var t={};return e&&n.each(e,function(e,n){if(n.name==="$$hash"||n.name==="$$hashKey")return;t[n.name]={name:n.name,type:n.type||"string"}}),t},t.prototype.isBoundedToDOM=function(){return this._domSource!==null},t.prototype.load=function(t){this._userData=t;var n=this._getDataViewInst();n||(this._createDataViewWrapper(),n=this._getDataViewInst()),this._onDataViewLoading();var r=new e.grid.settingsManager(this._wijgrid);if(this._needToLoad(r)){var i=r.MapWGToDV(),s=!1;this._isWijdatasource&&!this._isDynamicWijdatasource&&n.isLoaded()&&(s=!0),this.ignoreCurrentChangedEvent(!0),n.refresh(i,s)}else this.isDataLoaded()&&(this._onDataViewLoaded(),this._onDataViewReset())},t.prototype.currentPosition=function(e){var t=this._getDataViewInst();if(!arguments.length)return t.currentPosition();this.ignoreCurrentChangedEvent(!0);try{t.currentPosition(e)}finally{this.ignoreCurrentChangedEvent(!1)}},t.prototype.getValue=function(e,t){var n=this._getDataViewInst();return typeof t=="number"&&(t+=""),n.getProperty(e,t)},t.prototype.setValue=function(e,t,n){var r=this._getDataViewInst();this.ignoreChangeEvent(!0);try{typeof t=="number"&&(t+=""),r.setProperty(e,t,n)}finally{this.ignoreChangeEvent(!1)}},t.prototype.makeDirty=function(){this._propChangeListener.removeAll(),this._totals=null,this._sharedDataItems=null},t.prototype._createDataViewWrapper=function(){var t,r=this._wijgrid.options.data,i=this._getDataViewInst(),s=!1;if(i)return;r||(this._domSource=this._processDOM(this._wijgrid.element,this._wijgrid.options.readAttributesFromData),r=this._domSource.items),s=typeof wijdatasource!="undefined"&&r instanceof wijdatasource,this._isOwnDataView=n.isArray(r)||s,this._isWijdatasource=!!this._isOwnDataView&&!!s,this._isDynamicWijdatasource=!!(this._isOwnDataView&&s&&r.dynamic);if(this._isOwnDataView){!this._domSource&&this._wijgrid.options.readAttributesFromData&&this._moveAttributesToExpando(r);var o=this.isBoundedToDOM()&&e.grid.getTableSection(this._wijgrid.element,e.grid.rowScope.body);i=e.grid.GridDataView.create(e.data.asDataView(this._parseOwnData(r,o)))}else i=r;this._wijgrid._wijDataView=i,this._toDispose.push(i.isLoading.subscribe(n.proxy(this._onDataViewLoadingInternal,this))),this._toDispose.push(i.isLoaded.subscribe(n.proxy(this._onDataViewLoadedInternal,this))),this._toDispose.push(i.subscribe(n.proxy(this._onDataViewChangeInternal,this))),this._toDispose.push(i.currentPosition.subscribe(n.proxy(this._onDataViewCurrentChangedInternal,this))),this._propChangeListener=new e.grid.propChangeListener(n.proxy(this._onPropertyChanged,this))},t.prototype._parseOwnData=function(t,r){var i=this;if(t&&t.length){var s=n.extend(!0,[],this._wijgrid.options.columns),o=e.data.ArrayDataViewBase._getProps(t[0])||[],u=this._propDescriptorsToFieldsInfo(o),a=[];this._wijgrid._prepareColumnOptions(s,"merge",u,!0,!0),e.grid.traverse(s,function(t){e.grid.getDataType(t)!=="string"&&e.grid.validDataKey(t.dataKey)&&a.push(t)}),a.length&&r&&n.each(t,function(t,n){e.grid.dataViewWrapper._parseDataItem(i._wijgrid,n,r&&r.rows[t],a)})}return t},t._parseDataItem=function(t,r,i,s){return n.each(s,function(e,n){var s=r[n.dataKey],o=t.parse(n,s);if(isNaN(o)){var u=null;i&&(u=i.cells[n.dataKey]),o=t.parseFailed(n,s,r,u)}r[n.dataKey]=o}),r},t.prototype._getDataViewInst=function(){return this._wijgrid._wijDataView},t.prototype._needToLoad=function(e){var t=this._getDataViewInst();return this._isDynamicWijdatasource||this._isWijdatasource&&!t.isLoaded()?!0:this._isOwnDataView&&!this._isWijdatasource&&this.isDataLoaded()?!0:this.isDataLoaded()||t.isLoading()?!e.compareSettings():!0},t.prototype._validateSettings=function(e){if(!this._isOwnDataView&&this._wijgrid.options.allowPaging&&(e.DVPagingSettings()||{}).pageSize!==(e.WGPagingSettings()||{}).pageSize)throw"The pageSize option of the external dataView can't be changed."},t.prototype._onDataViewLoadingInternal=function(e){if(this._ignoreAllEvents)return;e&&(this._userData||this._onDataViewLoading())},t.prototype._onDataViewLoadedInternal=function(e){if(this._ignoreAllEvents)return;e&&this._onDataViewLoaded()},t.prototype._onDataViewChangeInternal=function(e){var t=this;if(this._ignoreAllEvents||this._ignoreChangeEvent)return;if(e.changes){if(e.length&&e[0].entityState()==="detached")return;n.each(e.changes,function(e,n){switch(n.changeType){case"remove":t._propChangeListener.remove(n.index);break;case"add":t._propChangeListener.insert(n.index,n.element)}})}this._onDataViewChange.apply(this,arguments)},t.prototype._onDataViewCurrentChangedInternal=function(){if(this._ignoreAllEvents||this._ignoreCurrentChangedEvent)return;this._onDataViewCurrentChanged.apply(this,arguments)},t.prototype._onDataViewReset=function(){try{this.ignoreCurrentChangedEvent(!1),this.makeDirty(),this._wijgrid._onDataViewReset(this._userData)}finally{this._userData=null}},t.prototype._onPropertyChanged=function(e){var t=this;this._changeTimer>0&&(window.clearTimeout(this._changeTimer),this._changeTimer=0),this._changeTimer!=-1&&(this._changeTimer=window.setTimeout(function(){t._changeTimer=-1,t._wijgrid._destroyed||t._onDataViewChange(),t._changeTimer=0},100))},t.prototype._onDataViewChange=function(e){this._onDataViewReset()},t.prototype._onDataViewCurrentChanged=function(e,t){this._wijgrid._onDataViewCurrentPositionChanged(e,t)},t.prototype._onDataViewLoading=function(){this._wijgrid._onDataViewLoading()},t.prototype._onDataViewLoaded=function(){this._wijgrid._onDataViewLoaded()},t.prototype._getSharedDataItems=function(){if(!this._sharedDataItems){var e=this._getDataViewInst(),t=e.count();this._sharedDataItems=[];var n=!0;for(var r=0;r<t;r++){var i=e.item(r);n&&!this._propChangeListener.insert(r,i)&&r===0&&(n=!1),this._sharedDataItems.push(this._wrapDataItem(i,r))}}return this._sharedDataItems||(this._sharedDataItems=[]),this._sharedDataItems},t.prototype._getTotals=function(){if(!this._totals){var e=this._getDataViewInst();this._totals=this._prepareTotals(e,this._wijgrid._prepareTotalsRequest(!0))}return this._totals||(this._totals={}),this._totals},t.prototype._prepareTotals=function(t,n){if(!n||n.length===0)return{};var r,i,s,o,u=[],a={};for(r=0,i=n.length;r<i;r++)u.push(new e.grid.tally);for(r=0,i=t.count();r<i;r++)for(s=0,o=u.length;s<o;s++)u[s].add(this._wijgrid.parse(n[s].column,this.getValue(r,n[s].column.dataKey)));for(r=0,i=u.length;r<i;r++)a[n[r].column.dataKey]=u[r].getValueString(n[r].column);return a},t.prototype._processDOM=function(t,r){var i={items:[],emptyData:[],header:e.grid.readTableSection(t,e.grid.rowScope.head)};return e.grid.getTableSectionLength(t,2)===1&&n(e.grid.getTableSectionRow(t,2,0)).hasClass("wijmo-wijgrid-emptydatarow")?i.emptyData=e.grid.readTableSection(t,e.grid.rowScope.body):i.items=e.grid.readTableSection(t,e.grid.rowScope.body,r),i},t.prototype._moveAttributesToExpando=function(t){n.each(t,function(t,r){var i=e.data.Expando.getFrom(r,!0),s;s=i[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:{}},r.rowAttributes&&(s.rowAttributes=r.rowAttributes,delete r.rowAttributes),n.each(r,function(e,t){n.isArray(t)&&(s.cellsAttributes[e]=t[1],r[e]=t[0])})})},t.prototype._wrapDataItem=function(e,t){return{values:e,originalRowIndex:t}},t.prototype._refreshSilent=function(){var e=this._getDataViewInst();if(e)try{this._ignoreAllEvents=!0,e.refresh()}finally{this._ignoreAllEvents=!1}},t.prototype._unsafeReplace=function(t,n){var r=this._getDataViewInst();r instanceof e.grid.GridDataView||"operation is not supported",r._unsafeReplace(t,n)},t.prototype._unsafeSplice=function(t,n,r){var i=this._getDataViewInst();i instanceof e.grid.GridDataView||"operation is not supported",arguments.length===2?i._unsafeSplice(t,n):i._unsafeSplice(t,n,r)},t.prototype._unsafePush=function(t){var n=this._getDataViewInst();n instanceof e.grid.GridDataView||"operation is not supported",n._unsafePush(t)},t}();t.dataViewWrapper=r,t.asPagedDataView=i,t.asEditableDataView=s;var o=function(){function e(e){this._subscriptions=[],this._callback=e}return e.prototype.insert=function(e,t){var r=null,i=this;return n.each(t,function(e,t){i._isValidPropName(e)&&t&&n.isFunction(t.subscribe)&&(r=r||[],r.push(t.subscribe(i._callback)))}),r?(this._subscriptions.length<e&&(this._subscriptions.length=e),this._subscriptions.splice(e,0,r),!0):!1},e.prototype.remove=function(e){var t=this._subscriptions[e];t&&n.each(t,function(e,n){n.dispose(),t[e]=null}),this._subscriptions[e]=null,this._subscriptions.splice(e,1)},e.prototype.removeAll=function(){var e,t;while(e=this._subscriptions.length)this.remove(e-1);this._subscriptions=[]},e.prototype.dispose=function(){this.removeAll()},e.prototype._isValidPropName=function(e){return e&&typeof e=="string"?e.match(/^entityState|jQuery/)===null:!0},e}();t.propChangeListener=o})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(t,n,r,i,s){this.cr=new e.grid.cellRange(-1,-1),this.isExpanded=!1,this._value=-1,this._sum=-1,this._position="none",this._hasHeaderOrFooter=!0,t!==undefined&&(this.isExpanded=t),n!==undefined&&(this.cr=n),r!==undefined&&(this._sum=r),i!==undefined&&(this._position=i),s!==undefined&&(this._hasHeaderOrFooter=s)}return r.prototype.isSubRange=function(e){return this.cr.r1>=e.cr.r1&&this.cr.r2<=e.cr.r2},r.prototype.toString=function(){return this.cr.r1+"-"+this.cr.r2},r.prototype.getHeaderImageClass=function(e){var n=this.owner;return n?e?n.expandedImageClass||t.c1field.prototype.options.groupInfo.expandedImageClass:n.collapsedImageClass||t.c1field.prototype.options.groupInfo.collapsedImageClass:null},r.prototype.collapse=function(){var t,n,r,i,s;(t=this.owner)&&(n=t.owner)&&(r=n.owner)&&(i=r._field("leaves"),e.grid.groupHelper.isParentExpanded(i,this.cr,t.level)&&t.position!=="footer"&&t.outlineMode!=="none"&&(s=e.grid.groupHelper.getGroupedColumnsCount(i),this._collapse(r,r._rows(),i,this,s,r._allowVirtualScrolling())))},r.prototype.expand=function(t){var n,r,i,s,o;(n=this.owner)&&(r=n.owner)&&(i=r.owner)&&(s=i._field("leaves"),e.grid.groupHelper.isParentExpanded(s,this.cr,n.level)&&(o=e.grid.groupHelper.getGroupedColumnsCount(s),this._expand(i,i._rows(),s,this,o,t,!0,i._allowVirtualScrolling())))},r.prototype._collapse=function(t,n,r,i,s,o){var u=i.owner,a=i.cr.r1,f=i.cr.r2,l,c,h,p,d;switch(u.position){case"header":case"headerAndFooter":this._toggleSketchRowVisibility(t.sketchTable.row(i.cr.r1),undefined),o||this._toggleRowVisibility(n.item(i.cr.r1),undefined,!1),a++}for(l=a;l<=f;l++)this._toggleSketchRowVisibility(t.sketchTable.row(l),!1),o||this._toggleRowVisibility(n.item(l),!1);i.isExpanded=!1,o||this._updateHeaderIcon(n,i);for(l=u.level+1;l<=s;l++){h=e.grid.groupHelper.getChildGroupRanges(r,i.cr,l-1);for(d=0,c=h.length;d<c;d++){p=h[d],p.isExpanded=!1;switch(p.owner.position){case"header":case"headerAndFooter":this._toggleSketchRowVisibility(t.sketchTable.row(p.cr.r1),!1),o||this._toggleRowVisibility(n.item(p.cr.r1),undefined,!1)}o||this._updateHeaderIcon(n,p)}}},r.prototype._expand=function(t,n,r,i,s,o,u,a){var f=i.owner,l=i.cr.r1,c=i.cr.r2,h,p,d,v,m;switch(f.position){case"header":this._toggleSketchRowVisibility(t.sketchTable.row(l),!0),a||this._toggleRowVisibility(n.item(l),!0,u||o),l++;break;case"footer":this._toggleSketchRowVisibility(t.sketchTable.row(c),!0),a||this._toggleRowVisibility(n.item(c),!0),c--;break;case"headerAndFooter":this._toggleSketchRowVisibility(t.sketchTable.row(l),!0),a||this._toggleRowVisibility(n.item(l),!0,u||o),u&&(this._toggleSketchRowVisibility(t.sketchTable.row(c),!0),a||this._toggleRowVisibility(n.item(c),!0)),l++,c--}if(!u)return;i.isExpanded=!0,a||this._updateHeaderIcon(n,i);if(i.owner.level===s)for(h=l;h<=c;h++)this._toggleSketchRowVisibility(t.sketchTable.row(h),!0),a||this._toggleRowVisibility(n.item(h),!0);else{d=e.grid.groupHelper.getChildGroupRanges(r,i.cr,i.owner.level);if(d.length&&l!==d[0].cr.r1)for(h=l;h<d[0].cr.r1;h++)this._toggleSketchRowVisibility(t.sketchTable.row(h),!0),a||this._toggleRowVisibility(n.item(h),!0);if(o)for(h=0,p=d.length;h<p;h++)v=d[h],this._expand(t,n,r,v,s,o,!0,a);else for(h=0,p=d.length;h<p;h++)v=d[h],m=v.owner.position==="footer"||v.owner.outlineMode==="none"?!0:!1,this._expand(t,n,r,v,s,!1,m,a)}},r.prototype._toggleRowVisibility=function(e,t,n){e&&(e[0]&&(t!==undefined&&(e[0].style.display=t?"":"none",e[0]["aria-hidden"]=t?"false":"true"),n!==undefined&&(e[0]["aria-expanded"]=n?"true":"false")),e[1]&&(t!==undefined&&(e[1].style.display=t?"":"none",e[1]["aria-hidden"]=t?"false":"true"),n!==undefined&&(e[1]["aria-expanded"]=n?"true":"false")))},r.prototype._toggleSketchRowVisibility=function(e,t){e&&t!==undefined&&(t?e.deleteStyle("display"):e.style("display","none"))},r.prototype._updateHeaderIcon=function(e,t){if(t.owner.position!=="footer"){var r=e.item(t.cr.r1);r&&n.each(r,function(e,r){if(r){var i=n(r).find("div.wijmo-wijgrid-grouptogglebtn:first-child");i&&i.length&&(i.toggleClass(t.getHeaderImageClass(!t.isExpanded),!1),i.toggleClass(t.getHeaderImageClass(t.isExpanded),!0))}})}},r}();t.groupRange=r;var i=function(){function r(){this._groupRowIdx=0}return r.prototype.group=function(e,t,n){this._grid=e,this._sketchTable=t,this._leaves=n,this._groupRowIdx=0;try{this._group()}finally{delete this._grid,delete this._sketchTable,delete this._leaves}},r.prototype._group=function(){var e=this;n.each(this._leaves,function(e,t){t.groupInfo&&(delete t.groupInfo.level,delete t.groupInfo.expandInfo)});var t=this._grid._groupedColumns(!0),r=1;if(t.length==0)return;this._sketchTable.ensureNotLazy(),n.each(t,function(t,n){e._groupRowIdx=0,n.groupInfo&&n.groupInfo.position&&n.groupInfo.position!=="none"&&n.dataIndex>=0&&(n.groupInfo.level=r,n.groupInfo.expandInfo=[],e._processRowGroup(n,r++))})},r.prototype._processRowGroup=function(t,r){var i=0,s=!0;n.each(this._leaves,function(e,t){if(t.parentVis)return i=e,!1});for(var o=0;o<this._sketchTable.count();o++){var u=this._sketchTable.row(o);if(!u.isDataRow())continue;var a=this._getGroupCellRange(o,t,r),f=!0,l=t.groupInfo.outlineMode==="startCollapsed",c,h,p,d;if(l||e.grid.groupHelper.isParentCollapsed(this._leaves,a,r)){if(t.groupInfo.groupSingleRow===!1&&a.r1===a.r2)continue;f=!1}if(r&&this._grid.options.groupIndent)for(var v=a.r1;v<=a.r2;v++)this._addIndent(this._sketchTable.row(v).cell(i),r);s=t.groupInfo.groupSingleRow!==!1||a.r1!==a.r2;switch(t.groupInfo.position){case"header":p=this._addGroupRange(t.groupInfo,a,f,s);for(var m=a.r1;m<=a.r2;m++)u=this._sketchTable.row(m),u.attr("aria-level",r+1),f||(u.style("display","none"),u.attr("aria-hidden",!0));if(!s)break;this._updateByGroupRange(p,r),d=e.grid.groupHelper.isParentCollapsed(this._leaves,p.cr,r),c=this._buildGroupRow(p,a,!0,d),this._sketchTable.insert(a.r1,c),c.attr("arial-level",r),c.attr("aria-expanded",f),d&&(c.style("display","none"),c.attr("aria-hidden",!0)),o=a.r2+1;break;case"footer":p=this._addGroupRange(t.groupInfo,a,!0,s);if(!s)break;this._updateByGroupRange(p,r),h=this._buildGroupRow(p,a,!1,!1),h.attr("aria-level",r),this._sketchTable.insert(a.r2+1,h),o=a.r2+1,d=e.grid.groupHelper.isParentCollapsed(this._leaves,p.cr,r),d&&(h.style("display","none"),h.attr("aria-hidden",!0));break;case"headerAndFooter":p=this._addGroupRange(t.groupInfo,a,f,s);for(m=a.r1;m<=a.r2;m++)u=this._sketchTable.row(m),u.attr("aria-level",r+1),f||(u.style("display","none"),u.attr("aria-hidden",!0));if(!s)break;this._updateByGroupRange(p,r),d=e.grid.groupHelper.isParentCollapsed(this._leaves,p.cr,r),c=this._buildGroupRow(p,a,!0,d),h=this._buildGroupRow(p,a,!1,!1),this._sketchTable.insert(a.r2+1,h),h.attr("aria-level",r);if(d||!f)h.style("display","none"),h.attr("aria-hidden",!0);this._sketchTable.insert(a.r1,c),c.attr("aria-level",r),c.attr("aria-expanded",f),d&&(h.style("display","none"),h.attr("aria-hidden",!0)),o=a.r2+2;break;default:throw e.grid.stringFormat('Unknown Position value: "{0}"',t.groupInfo.position)}this._groupRowIdx++}},r.prototype._buildGroupRow=function(n,r,i,s){var o=n.owner,u=o.owner,a=u.owner,f=(i?"GH":"GF")+this._groupRowIdx+"-"+o.level,l=new e.grid.SketchGroupRow(i,{id:f}),c=undefined,h="",p="",d,v,d,m,g,y,b,w,E;u.dataIndex>=0&&(c=this._sketchTable.valueAt(r.r1,u.dataIndex))!==null&&(h=a.toStr(u,c)),l.groupByValue=c,this._grid._showRowHeader()&&l.add(t.HtmlCell.nbsp()),d=new t.HtmlCell,i&&o.outlineMode!=="none"&&(n.isExpanded?d.html='<div class="'+a.options.wijCSS.icon+" "+n.getHeaderImageClass(!0)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>':d.html='<div class="'+a.options.wijCSS.icon+" "+n.getHeaderImageClass(!1)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>'),l.add(d),u.aggregate&&u.aggregate!=="none"&&(p=this._getAggregate(r,u,u,i,h)),m=i?o.headerText:o.footerText;if(m==="custom")g={data:this._sketchTable.getRawTable(),column:u,groupByColumn:o.owner,groupText:h,text:"",groupingStart:r.r1,groupingEnd:r.r2,isGroupHeader:i,aggregate:p},this._grid._trigger("groupText",null,g)&&(m=g.text);else{if(m===undefined||m===null){i&&(m="{1}: {0}");if(p||p===0)m=m?m+" {2}":"{2}"}m=e.grid.stringFormat(m,h,u&&u.headerText?u.headerText:"",p.toString())}m||(m="&nbsp;"),d.html+="<span>"+m+"</span>",this._addIndent(d,o.level-1),y=1,b=this._grid._showRowHeader()?1:0,w=!0;for(;b<this._leaves.length;b++){v=this._leaves[b];if(v.parentVis){if(w){w=!1;continue}if(v.dynamic!==!0&&v.aggregate&&v.aggregate!=="none")break;y++}}for(;b<this._leaves.length;b++)v=this._leaves[b],v.parentVis&&(E=this._getAggregate(r,v,o.owner,i,h),!E&&E!==0&&(E="&nbsp;"),l.add(new t.HtmlCell(E.toString(),{groupInfo:{leafIndex:v.leavesIdx,purpose:e.grid.groupRowCellPurpose.aggregateCell}})));return d.ensureAttr().colSpan=y,d.ensureAttr().groupInfo={leafIndex:u.leavesIdx,purpose:e.grid.groupRowCellPurpose.groupCell},l},r.prototype._getAggregate=function(t,n,r,i,s){var o="",u,a,f;if(!n.aggregate||n.aggregate==="none")return o;if(n.aggregate==="custom")u={data:this._sketchTable.getRawTable(),column:n,groupByColumn:r,groupText:s,text:"",groupingStart:t.r1,groupingEnd:t.r2,isGroupHeader:i},this._grid._trigger("groupAggregate",null,u)&&(o=u.text);else{a=new e.grid.tally;for(f=t.r1;f<=t.r2;f++)a.add(this._sketchTable.valueAt(f,n.dataIndex));o=a.getValueString(n)}return o},r.prototype._getGroupCellRange=function(t,n,r){var i=n.leavesIdx,s,o=new e.grid.cellRange(t,i),u=e.grid.groupHelper.getParentGroupRange(this._leaves,o,r),a,f,l;s=this._sketchTable.row(t);if(s.isDataRow()){a=s.valueCell(n.dataIndex).value,a instanceof Date&&(a=a.getTime());for(o.r2=t,l=this._sketchTable.count()-1;o.r2<l;o.r2++){if(!this._sketchTable.row(o.r2+1).isDataRow()||u&&o.r2+1>u.cr.r2)break;f=this._sketchTable.valueAt(o.r2+1,n.dataIndex),f instanceof Date&&(f=f.getTime());if(a!==f)break}}return o},r.prototype._addGroupRange=function(t,n,r,i){var s=null,o=e.grid.groupHelper.getChildGroupIndex(n,t.expandInfo),u,a,f,l;return o>=0&&o<t.expandInfo.length?s=t.expandInfo[o]:(u=new e.grid.cellRange(n.r1,n.r1,n.r2,n.r2),a=t.position==="footer"||!i?!0:r&&t.outlineMode!=="startCollapsed",s=new e.grid.groupRange(a,u,-1,t.position,i),s.owner=t,t.expandInfo.push(s)),s&&i&&(f=n.r1,l=n.r2,t.position==="headerAndFooter"&&(l+=2),t.position!=="headerAndFooter"&&l++,s.cr.r2=l),s},r.prototype._updateByGroupRange=function(e,t){var n,r,i,s,o,u,a;for(n=0,r=this._leaves.length;n<r;n++){i=this._leaves[n].groupInfo;if(i&&i.level<t){s=i.expandInfo?i.expandInfo.length:0;for(o=0;o<s;o++)u=i.expandInfo[o],a=e.position==="headerAndFooter"?2:1,u.cr.r1>=e.cr.r1&&(u.cr.r1!==e.cr.r1||u.position!=="footer")&&(u.cr.r1+=a),u.cr.r2>=e.cr.r1&&(u.cr.r2+=a)}}},r.prototype._addIndent=function(e,t){var n;t>0&&(n=this._grid.options.groupIndent)&&(e.ensureStyle().paddingLeft=n*t+"px")},r}();t.grouper=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t._getGroupInfoRegExp=new RegExp(".*G([HF]){1}(\\d+)-(\\d+)$"),t.getGroupInfo=function(n){if(n){var r=e.grid.groupHelper._getGroupInfoRegExp.exec(n.id),i,s,o;if(r)return i=parseInt(r[3],10),s=parseInt(r[2],10),o=r[1]==="H",{level:i,index:s,isHeader:o,toString:function(){return(o?"GH":"GF")+s+"-"+i}}}return null},t.getColumnByGroupLevel=function(t,n){var r,i,s;for(r=0,i=t.length;r<i;r++){s=t[r];if(s.groupInfo&&s.groupInfo.level===n)return s}return null},t.getGroupedColumnsCount=function(t){var n=0,r,i,s;for(r=0,i=t.length;r<i;r++)s=t[r].groupInfo,s&&(s.position==="header"||s.position==="headerAndFooter"||s.position==="footer")&&n++;return n},t.getChildGroupIndex=function(t,n){var r=0,i=n.length-1,s,o;while(r<=i){s=(i-r>>1)+r,o=n[s].cr.r1-t.r1;if(o===0)return s;o<0?r=s+1:i=s-1}return r},t.getParentGroupIndex=function(n,r){var i=e.grid.groupHelper.getChildGroupIndex(n,r);return i>0&&i--,i<r.length?i:-1},t.getChildGroupRanges=function(n,r,i){var s=[],o=e.grid.groupHelper.getColumnByGroupLevel(n,i+1);if(o){var u=o.groupInfo.expandInfo,a=e.grid.groupHelper.getChildGroupIndex(r,u);for(var f=a,l=u.length;f<l;f++){var c=u[f];if(!(c.cr.r2<=r.r2))break;s.push(c)}}return s},t.getParentGroupRange=function(n,r,i){i===undefined&&(i=65535);if(i-2>=0)for(var s=n.length-1;s>=0;s--){var o=n[s].groupInfo;if(!o||!o.expandInfo||o.level<0||o.level!==i-1)continue;var u=e.grid.groupHelper.getParentGroupIndex(r,o.expandInfo);if(u>=0)return o.expandInfo[u]}return null},t.isParentCollapsed=function(n,r,i){if(i===1)return!1;for(var s=i;s>1;s--){var o=e.grid.groupHelper.getParentGroupRange(n,r,s);if(o&&!o.isExpanded)return!0;r=o.cr}return!1},t.isParentExpanded=function(n,r,i){if(i===1)return!0;for(var s=i;s>1;s--){var o=e.grid.groupHelper.getParentGroupRange(n,r,s);if(o&&o.isExpanded)return!0;r=o.cr}return!1},t}();t.groupHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(e,t,n,r){switch(arguments.length){case 2:this.r1=this.r2=e,this.c1=this.c2=t;break;case 4:this.r1=e,this.r2=n,this.c1=t,this.c2=r;break;default:this.r1=0,this.r2=0,this.c1=0,this.c2=0}}return e.prototype.isSingleCell=function(){return this.r1===this.r2&&this.c1===this.c2},e}();t.cellRange=r;var i=function(){function t(){}return t.prototype.merge=function(e,t){this._leaves=t,this._data=e;try{this._merge()}finally{delete this._data,delete this._leaves}},t.prototype._merge=function(){var e,t,n,r=!0;for(e=0,t=this._leaves.length;e<t;e++)n=this._leaves[e],n.dataIndex>=0&&!n.isBand&&(n.rowMerge==="free"||n.rowMerge==="restricted")&&(r&&(this._data.ensureNotLazy(),r=!1),this._mergeColumn(n))},t.prototype._mergeColumn=function(e){var t=e.dataIndex,n,r,i,s,o,u;for(r=0,i=this._data.count();r<i;r++){n=this._data.row(r);if(!n.isDataRow())continue;s=this._getCellRange(r,e);if(s.r1!==s.r2){o=s.r2-s.r1+1,this._data.row(s.r1).cell(t).ensureAttr().rowSpan=o;for(u=s.r1+1;u<=s.r2;u++)this._data.row(u).cell(t).visible(!1)}r=s.r2}},t.prototype._getCellRange=function(t,n){var r=n.dataIndex,i,s=new e.grid.cellRange(t,r),o=(this._data.valueAt(t,r)||"").toString(),u=this._data.count(),a,f,l;for(s.r2=t;s.r2<u-1;s.r2++){i=this._data.row(s.r2+1);if(!i.isDataRow()||(i.valueCell(r).value||"").toString()!==o)break}return a=n.leavesIdx,a>0&&n.rowMerge==="restricted"&&(f=this._leaves[a-1],f.dataIndex>=0&&(l=this._getCellRange(t,f),s.r1=Math.max(s.r1,l.r1),s.r2=Math.min(s.r2,l.r2))),s},t}();t.merger=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function c(t,r){var i,s,o;if(n.isArray(t)&&n.isArray(r)){if(t.length===r.length){o=!0;for(i=0,s=t.length;i<s&&o;i++)o=e.grid.compareObj(t[i],r[i]);return o}}else{if(n.isPlainObject(t)&&n.isPlainObject(r)){for(i in t)if(t.hasOwnProperty(i)&&!e.grid.compareObj(t[i],r[i]))return!1;for(i in r)if(r.hasOwnProperty(i)&&!e.grid.compareObj(t[i],r[i]))return!1;return!0}t instanceof Date&&(t=t.getTime()),r instanceof Date&&(r=r.getTime())}return t===r}function h(e){var t=[];for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];var r,i;if(!e)return"";for(r=0,i=t.length;r<i;r++)e=e.replace(new RegExp("\\{"+r+"\\}","gm"),t[r]);return e}function p(e){return e&&!(e<0)||e===0}function d(e){return e&&e instanceof Date?!isNaN(e.getTime()):!1}function v(e){return e.dataType||e._underlyingDataType||"string"}function m(e,t){e&&t&&e.find(".ui-widget").each(function(e,r){return n.each(n(r).data(),function(n,r){r.widgetName&&t(e,r)}),!0})}function g(e,t){var r=[];n.each(e.data(),function(e){e.indexOf(t)===0&&r.push(e)}),n.each(r,function(t,n){e.removeData(n)})}function b(e){return n.extend(!0,{},t.c1basefield.prototype.options,t.c1field.prototype.options,{dynamic:!0,isLeaf:!0,isBand:!1,parentIdx:-1},e)}function w(e,t){if(e){var r=e.nodeType?n(e):e,i=r.offset();if(i)return t?{top:i.top,left:i.left,width:r[0].clientWidth||0,height:r[0].clientHeight||0}:{top:i.top,left:i.left,width:r.outerWidth(),height:r.outerHeight()}}return null}function E(e,t){return e&&(e.start<0&&(e.start=0),e.end<0&&(e.end=0),e.start=Math.min(e.start,t),e.end=Math.min(e.end,t)),e}function S(t,n,r){n===undefined&&(n=3);if(t&&n!==0){if(!r&&t.nodeType===3)return t.nodeValue;if(t.nodeType===1){switch(t.type){case"button":case"text":case"textarea":case"select-one":return t.value;case"checkbox":return t.checked.toString()}var i="",s=0,o;while(o=t.childNodes[s++])i+=e.grid._getDOMText(o,n-1);return i}}return""}function x(e,t,r,i){var s=e.jquery||n.isArray(e),o,u,a,f=t+r;if(arguments.length===3)return s?n.data(e[0],f):n.data(e,f);if(s){for(o=0,u=e.length;o<u;o++)a=n.data(e[o],f,i);return a}return n.data(e,f,i)}function T(e,t){if(t&&e){var n,r,i;for(n in t)t.hasOwnProperty(n)&&(r=t[n],i=typeof r,(i==="string"||i==="boolean"||i==="number")&&e[n]===undefined&&(e[n]=r))}}function N(e){return e&&typeof e=="object"&&!(e instanceof Date)}function C(e,t){var r,i,s=n.isFunction(t);for(r in e)if(e.hasOwnProperty(r)){i=s?t(e[r]):e[r]===t;if(i===!0)return{at:r,found:e[r]}}return{at:null,found:null}}function k(e,t){if(e){var n,r,i=0,s={},o,u;for(n=0,r=e.attributes.length;n<r;n++)u=e.attributes[n].name,u&&(!t||!t(u))&&(o=e.getAttribute(u),u==="style"&&(o=typeof o=="object"?o.cssText:o),!o&&u==="class"&&(o=e.getAttribute("className")),o&&typeof o!="function"&&(s[u]=o,i++));if(i)return s}return null}function L(t,r){var i,s,o,u,a;if(t){typeof r!="object"&&!n.isFunction(r)&&(r={});for(i in t){s=t[i],o=r[o];if(s===r)continue;s&&(n.isPlainObject(s)||(u=n.isArray(s)))?(u?(u=!1,a=o&&n.isArray(o)?o:[]):a=o&&n.isPlainObject(o)?o:{},r[i]=e.grid.deepExtend(s,a)):r[i]=s}}return r}function A(e,t){return e&&e.jquery&&(e=e[0]),e?arguments.length===1?n.data(e,"wijgridwidgetName"):n.data(e,"wijgridwidgetName",t):undefined}function M(e,t){typeof t=="undefined"&&(t=99);var r=0;return e&&n.ui&&n.fn.zIndex&&(r=e.zIndex(),r&&r++),Math.max(r,t)}function _(e,t,n){return e>t&&e<t+n}function D(t,n,r,i,s,o){return e.grid.isOverAxis(t,r,s)&&e.grid.isOverAxis(n,i,o)}function H(){return"uid"+P++}var n=jQuery;t.EXPANDO="__wijgrid",function(e){e._map=[],e.header=1,e.data=2,e.dataAlt=4,e.filter=8,e.groupHeader=16,e.groupFooter=32,e.footer=64,e.emptyDataRow=128}(t.rowType||(t.rowType={}));var r=t.rowType;(function(e){e._map=[],e.none=0,e.rendering=1,e.current=2,e.hovered=4,e.selected=8})(t.renderState||(t.renderState={}));var i=t.renderState;(function(e){e._map=[],e.table=0,e.head=1,e.body=2,e.foot=3})(t.rowScope||(t.rowScope={}));var s=t.rowScope;(function(e){e._map=[],e.none=0,e.column=1,e.row=2})(t.cellRangeExtendMode||(t.cellRangeExtendMode={}));var o=t.cellRangeExtendMode;(function(e){e._map=[],e.createIfNull=0,e.createAlways=1,e.dispose=2})(t.objectMode||(t.objectMode={}));var u=t.objectMode;(function(e){e._map=[],e.groupCell=0,e.aggregateCell=1})(t.groupRowCellPurpose||(t.groupRowCellPurpose={}));var a=t.groupRowCellPurpose;(function(e){e._map=[],e.sketch=0,e.rendered=1,e.renderable=2})(t.dataRowsRangeMode||(t.dataRowsRangeMode={}));var f=t.dataRowsRangeMode;(function(e){e._map=[],e.none=0,e.overlapTop=1,e.overlapBottom=2,e.reset=3})(t.intersectionMode||(t.intersectionMode={}));var l=t.intersectionMode;t.compareObj=c,t.stringFormat=h,t.validDataKey=p,t.validDate=d,t.getDataType=v,t.iterateChildrenWidgets=m,t.remove$dataByPrefix=g;var y=function(){function e(e){this._dom=e}return e.prototype.getSelection=function(){var e=0,t=0,n;return this._dom.selectionStart!==undefined?(e=this._dom.selectionStart,t=this._dom.selectionEnd):document.selection&&(n=document.selection.createRange().duplicate(),t=n.text.length,e=Math.abs(n.moveStart("character",-this._dom.value.length)),t+=e),{start:e,end:t,length:t-e}},e.prototype.setSelection=function(e){if(this._dom.selectionStart!==undefined)this._dom.setSelectionRange(e.start,e.end);else{var t=this._dom.createTextRange();t.collapse(!0),t.moveStart("character",e.start),t.moveEnd("character",e.end),t.select()}},e.prototype.toggleSelection=function(e){var t=n(this._dom),r="onselectstart"in this._dom;e?r?t.unbind(".wijgrid-disableSelection"):t.css({MozUserSelect:"",WebkitUserSelect:""}):r?t.bind("selectstart.wijgrid-disableSelection",function(e){e.preventDefault()}):t.css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})},e}();t.domSelection=y,t.createDynamicField=b,t.bounds=w,t.ensureBounds=E,t._getDOMText=S,t.dataPrefix=x,t.shallowMerge=T,t.isCustomObject=N,t.search=C,t.getAttributes=k,t.deepExtend=L,t.widgetName=A;var O=function(){function t(){}return t._requiresExtendedSupport={date:"",datetime:"","datetime-local":"",month:"",time:""},t.isExtendSupportRequired=function(n){return n=(n||"").toLowerCase(),n in e.grid.HTML5InputSupport._requiresExtendedSupport},t.getDefaultInputType=function(n,r){var i=r.inputType;if(!i){i="text";if(n)switch(e.grid.getDataType(r)){case"number":case"currency":i="number";break;case"datetime":i="datetime"}}return i},t.toStr=function(n,r){var i=n;r=(r||"").toLowerCase();if(e.grid.HTML5InputSupport.isExtendSupportRequired(r))switch(r){case"datetime":i=n?i=Globalize.format(n,"yyyy-MM-ddTHH:mm:ssZ"):"";break;case"datetime-local":i=n?i=Globalize.format(n,"yyyy-MM-ddTHH:mm:ss"):"";break;case"date":i=n?i=Globalize.format(n,"yyyy-MM-dd"):"";break;case"month":i=n?i=Globalize.format(n,"yyyy-MM"):"";break;case"time":i=n?i=Globalize.format(n,"HH:mm:ss"):""}else i=n+"";return i},t.parse=function(n,r){var i,s=function(t){return t=new Date(t),e.grid.validDate(t)||(t=null),t};r=(r||"").toLowerCase();if(e.grid.HTML5InputSupport.isExtendSupportRequired(r))switch(r){case"datetime":i=Globalize.parseDate(n,"yyyy-MM-ddTHH:mm:ssZ")||Globalize.parseDate(n,"yyyy-MM-ddTHH:mmZ")||s(n);break;case"datetime-local":i=Globalize.parseDate(n,"yyyy-MM-ddTHH:mm:ss")||Globalize.parseDate(n,"yyyy-MM-ddTHH:mm")||s(n);break;case"date":i=Globalize.parseDate(n,"yyyy-MM-dd")||s(n);break;case"month":i=Globalize.parseDate(n,"yyyy-MM");break;case"time":i=Globalize.parseDate(n,"HH:mm:ss")||Globalize.parseDate(n,"HH:mm");break;case"number":i=parseFloat(n)}else i=n;return i},t.extend=function(t,n,r){if(!t)t=n;else{r=(r||"").toLowerCase();switch(r){case"date":t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate());break;case"month":t.setFullYear(n.getFullYear(),n.getMonth());break;case"time":t.setHours(n.getHours()),t.setMinutes(n.getMinutes()),t.setSeconds(n.getSeconds());break;default:t=n}}return t},t}();t.HTML5InputSupport=O,t.getZIndex=M,t.isOverAxis=_,t.isOver=D;var P=0;t.getUID=H,n.extend(n.wijmo.wijgrid,{rowType:e.grid.rowType,renderState:e.grid.renderState,bounds:e.grid.bounds})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){function i(e,t){var n=!1,r;return function(){return n||(r=t?e.call(t):e(),n=!0),r}}(function(e){e._map=[],e.Millisecond=1,e.Second=2,e.Minute=4,e.Hour=8,e.Day=16,e.Month=32,e.Year=64,e.DATE=e.Year|e.Month|e.Day,e.TIME=e.Hour|e.Minute|e.Second|e.Millisecond,e.ALL=e.DATE|e.TIME})(t.TimeUnit||(t.TimeUnit={}));var n=t.TimeUnit,r=function(){function t(){}return t.convertInputType=function(n){var r=e.grid.TimeUnitConverter.convertInputTypeToFormatString(n),i=e.grid.TimeUnitConverter.convertFormatString(r);return i},t.convertInputTypeToFormatString=function(t){switch((t||"").toLowerCase()){case"datetime":case"datetime-local":return"f";case"date":return"d";case"month":return"Y";case"time":return"t"}return""},t.convertFormatString=function(t){var r=0;if(t){if(t.length===1)switch(t[0]){case"t":return n.Hour|n.Minute;case"T":return n.TIME;case"d":case"D":return n.DATE;case"Y":return n.Month|n.Year;case"M":return n.Month|n.Day;case"f","F","S":return n.ALL}var i,s;(i=t.indexOf("'"))>=0&&(s=t.lastIndexOf("'"))>=0&&i!==s&&(t=t.substr(0,i)+t.substring(s+1,t.length-1));for(var o=0,u=t.length;o<u;o++)switch(t[o]){case"d":r|=n.Day;break;case"M":r|=n.Month;break;case"y":r|=n.Year;break;case"m":r|=n.Minute;break;case"h":case"H":r|=n.Hour;break;case"s":r|=n.Second;break;case"f":r|=n.Millisecond}}return r||n.ALL},t.cutDate=function(t,r){return t&&(r=~r,r&n.Millisecond&&t.setMilliseconds(0),r&n.Second&&t.setSeconds(0),r&n.Minute&&t.setMinutes(0),r&n.Hour&&t.setHours(0),r&n.Day&&t.setDate(1),r&n.Month&&t.setMonth(0),r&n.Year&&t.setFullYear(0)),t},t}();t.TimeUnitConverter=r,t.lazy=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(){}return e.NoFilterOp={applicableTo:null,name:"NoFilter",displayName:"No filter",arity:1,operator:function(){return!0}},e}(),i=function(){function t(t){this._cache={};var i=this;this._wijgrid=t,this._addOperator(null,r.NoFilterOp),n.each(e.data.filtering.ops,function(e,t){i._addOperator(e,t)}),n.each(t.options.customFilterOperators,function(e,t){i._addOperator(null,t,!0)})}return t.prototype.getByName=function(e){var t=this.getByNameInt(e);return t?t.op:null},t.prototype.getByNameInt=function(e){return this._cache[(e||"").toLowerCase()]},t.prototype.getByDataType=function(e){var t=[],r;n.each(this._cache,function(r,i){var s=i.op;(!s.applicableTo||n.inArray(e,s.applicableTo)>=0)&&t.push(i)});switch(this._wijgrid.options.filterOperatorsSortMode.toLowerCase()){case"alphabetical":t.sort(this._sortAlpha);break;case"alphabeticalcustomfirst":t.sort(this._sortAlphaCustomFirst);break;case"alphabeticalembeddedFirst":t.sort(this._sortAlphaEmbeddedFirst);break;case"none":break;default:}return r=n.map(t,function(e,t){return e.op}),r},t.prototype._addOperator=function(e,t,n){typeof n=="undefined"&&(n=!1),e&&!t.name&&(t.name=e),e=(e||t.name).toLowerCase(),this._cache[e]||(this._cache[e]={op:t,isCustom:n===!0})},t.prototype._sortAlpha=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaEmbeddedFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return 1;if(t.isCustom)return-1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaCustomFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return-1;if(t.isCustom)return 1}return n===r?0:n<r?-1:1},t}();t.filterOperatorsCache=i;var s=function(){function t(){}return t.marker="_wijgrid",t.getSingleValue=function(t){return n.isArray(t)&&(t=t[0],n.isArray(t)&&(t=t[0])),t},t.getSingleOperatorName=function(t){return n.isArray(t)&&(t=t[0]),t.name||t||""},t.verify=function(r,i,s,o){if(r)if(n.isArray(r)){var u,a,f=[],l=[];n.isArray(i)||(i=[i]);for(u=0,a=r.length;u<a;u++)e.grid.filterHelper._verifySingleOp(r[u],i[u],s,o)&&(f.push({name:r[u].name||r[u],condition:r[u].condition||"or"}),l.push(i?i[u]:undefined));if(f.length)return{filterOperator:f,filterValue:l}}else if(e.grid.filterHelper._verifySingleOp(r,i,s,o))return{filterOperator:r,filterValue:i};return null},t._verifySingleOp=function(r,i,s,o){if(r&&(r=r.name||r)){var u;r=(r||"").toLowerCase();if((r!=="nofilter"||i!==undefined)&&(u=o.getByName(r)))if(u.applicableTo===null||n.inArray(s||"string",u.applicableTo)>=0)if(u.arity===1||u.arity>1&&e.grid.filterHelper.getSingleValue(i)!==undefined)return!0}return!1},t}();t.filterHelper=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function r(t,n){t&&!t.nodeType&&(t=t[0]);if(t)switch(n){case e.grid.rowScope.head:return t.tHead;case e.grid.rowScope.body:if(t.tBodies)return t.tBodies[0]||null;break;case e.grid.rowScope.foot:return t.tFoot;default:return t}return null}function i(e,t){var n;return e&&!e.nodeType&&(e=e[0]),e&&(n=this.getTableSection(e,t))?n.rows.length:0}function s(e,t,n){var r;return e&&!e.nodeType&&(e=e[0]),e&&(r=this.getTableSection(e,t))?r.rows[n]||null:null}function o(t,r,i){var s,o,u,a,f,l,c,h,p=[],d=function(e){return e=e.toLowerCase(),e==="rowspan"||e==="colspan"},v;t&&!t.nodeType&&(t=t[0]);if(t&&(v=this.getTableSection(t,r)))for(s=0,o=v.rows.length;s<o;s++){f=v.rows[s],l=[],i&&(c=e.data.Expando.getFrom(l,!0),h=c[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:e.grid.getAttributes(f)||{}});for(u=0,a=f.cells.length;u<a;u++)l[u]=n.trim(f.cells[u].innerHTML),i&&(h.cellsAttributes[u]=e.grid.getAttributes(f.cells[u],d)||{});p[s]=l}return p}function u(t){var n=t.parentNode.parentNode;switch(n.tagName.toLowerCase()){case"thead":return e.grid.rowScope.head;case"tbody":return e.grid.rowScope.body;case"tfoot":return e.grid.rowScope.foot}return null}var n=jQuery;t.getTableSection=r,t.getTableSectionLength=i,t.getTableSectionRow=s,t.readTableSection=o,t.determineSection=u;var a=function(){function t(e,t,n,r){this._width=0,this._table=e,this._offsets=[],r&&this.ensureColGroup(),n&&this.ensureTBody(),t||this._buildOffsets()}return t.prototype.element=function(){return this._table},t.prototype.width=function(){return this._width},t.prototype.getCellIdx=function(e,t){return e<this._width?this._offsets[t][e].cellIdx:-1},t.prototype.getColumnIdx=function(e,t){if(typeof e!="number"){var n=e;e=n.cellIndex,t=n.parentNode.rowIndex}return e<this._width?this._offsets[t][e].colIdx:-1},t.prototype.clearSection=function(t){var n,r,i=e.grid.getTableSection(this._table,t);switch(t){case e.grid.rowScope.body:n=this.getSectionLength(e.grid.rowScope.table),r=n+this.getSectionLength(t)-1;break;case e.grid.rowScope.foot:n=this.getSectionLength(e.grid.rowScope.table)+this.getSectionLength(e.grid.rowScope.head),r=n+this.getSectionLength(t)-1;break;default:n=0,r=this.getSectionLength(t)-1}while(i.rows.length)i.deleteRow(0);this._offsets.splice(n,r-n+1)},t.prototype.getSectionLength=function(t){return e.grid.getTableSectionLength(this._table,t)},t.prototype.getSectionRow=function(t,n){return e.grid.getTableSectionRow(this._table,n,t)},t.prototype.forEachColumnCellNatural=function(e,t,n){var r,i,s,o;for(r=0,i=this._table.rows.length;r<i;r++){s=this._table.rows[r];if(e<s.cells.length){o=t(s.cells[e],r,n);if(o!==!0)return o}}return!0},t.prototype.forEachColumnCell=function(e,t,n){var r,i,s,o,u;for(r=0,i=this._offsets.length;r<i;r++){s=this._table.rows[r],o=this.getCellIdx(e,r);if(o>=0){u=t(s.cells[o],r,n);if(u!==!0)return u}}return!0},t.prototype.forEachRowCell=function(e,t,n){var r=this._table.rows[e],i,s,o;for(i=0,s=r.cells.length;i<s;i++){o=t(r.cells[i],i,n);if(o!==!0)return o}return!0},t.prototype.colGroupTag=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||null},t.prototype.colTags=function(){var e=this.colGroupTag();return e&&e.getElementsByTagName("col")||[]},t.prototype.ensureTBody=function(){return this._table.tBodies&&this._table.tBodies[0]||this._table.appendChild(document.createElement("tbody"))},t.prototype.ensureTHead=function(){return this._table.tHead&&this._table.tHead[0]||this._table.createTHead()},t.prototype.ensureTFoot=function(){return this._table.tFoot&&this._table.tFoot[0]||this._table.createTFoot()},t.prototype.ensureColGroup=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||this._table.appendChild(document.createElement("colgroup"))},t.prototype.appendCol=function(e){var t=this.ensureColGroup();return e&&t.appendChild(e)||t.appendChild(document.createElement("col"))},t.prototype.removeOffset=function(e){if(e>=0&&e<this._offsets.length){if(e<0||!e&&e!==0)e=this._offsets.length-1;this._offsets.splice(e,1)}},t.prototype.insertOffset=function(e){var t,n;if(this._width>0){t=[];for(n=0;n<this._width;n++)t.push({cellIdx:n,colIdx:n});if(e<0||!e&&e!==0)e=this._offsets.length;this._offsets.splice(e,0,t)}},t.prototype.rebuildOffsets=function(){this._offsets=[],this._width=0,this._buildOffsets()},t.prototype._buildOffsets=function(){var e=[],t,n,r,i,s,o,u,a,f,l;for(n=0,r=this._table.rows.length;n<r;n++){t=[],this._offsets[n]=t,i=this._table.rows[n];for(s=0,o=0,u=i.cells.length;s<u;s++,o++){a=i.cells[s];for(;e[o]>1;o++)e[o]--,t[o]={cellIdx:-1,colIdx:-1};e[o]>1||(e[o]=a.rowSpan),t[o]={cellIdx:s,colIdx:-1},t[s].colIdx=o,f=a.colSpan;for(;f>1;f--)t[++o]={cellIdx:-1,colIdx:-1}}l=e.length;for(;o<l;o++)e[o]--,t[o]={cellIdx:-1,colIdx:-1};this._width=Math.max(this._width,l)}},t}();t.htmlTableAccessor=a})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e,t,n,r,i){typeof n=="undefined"&&(n=null),typeof r=="undefined"&&(r=!1),typeof i=="undefined"&&(i=!0),this.__isEdit=!1,this._wijgrid=n,this._virtualize=i,r?(this._ci=e-this._wijgrid._getDataToAbsOffset().x,this._ri=t-this._wijgrid._getDataToAbsOffset().y,this._virtualize&&(this._ri=this._wijgrid._renderableBoundsCollection().getAbsIndex(this._ri+this._wijgrid._viewPortBounds().start))):(this._ci=e,this._ri=t)}return t.outsideValue=new t(-1,-1,null),t.prototype.cellIndexAbs=function(){return this._ci+this._wijgrid._getDataToAbsOffset().x},t.prototype.rowIndexAbs=function(){var e=this._virtualize?this._wijgrid._renderableBoundsCollection().getRenderedIndex(this._ri)-this._wijgrid._viewPortBounds().start:this._ri;return e+=this._wijgrid._getDataToAbsOffset().y,e},t.prototype.cellIndex=function(e){if(!arguments.length)return this._ci;this._ci=e},t.prototype.column=function(){return this._wijgrid&&this._isValid()?this._wijgrid._field("visibleLeaves")[this.cellIndexAbs()]:null},t.prototype.container=function(){var e=this.tableCell(),t;if(e){t=n(e).children("div.wijmo-wijgrid-innercell");if(t)return t}return null},t.prototype.isEqual=function(e){return e&&e.rowIndex()===this.rowIndex()&&e.cellIndex()===this.cellIndex()},t.prototype.row=function(){var e=null,t=null;if(this._wijgrid){if(this._virtualize)return this._wijgrid._view()._getRowInfoBySketchRowIndex(this.rowIndex());e=this._wijgrid._view().rows().item(this.rowIndexAbs()),e&&e.length&&(t=this._wijgrid._view()._getRowInfo(e))}return t},t.prototype.rowIndex=function(e){if(!arguments.length)return this._ri;this._ri=e},t.prototype.tableCell=function(){if(this._wijgrid&&this._isValid())if(!this._virtualize||this._isRendered())return this._wijgrid._view().getCell(this.cellIndexAbs(),this.rowIndexAbs());return null},t.prototype.value=function(t){var n,r,i;if(this._wijgrid&&this._isValid()){r=this.row();if(r.type&e.grid.rowType.data){n=this.column();if(arguments.length===0)return i=this._wijgrid._dataViewWrapper.getValue(r.data,n.dataKey),this._wijgrid.parse(n,i);t=this._wijgrid.parse(n,t);if(t===null&&n.valueRequired||e.grid.getDataType(n)!=="string"&&isNaN(t))throw"invalid value";this._wijgrid._dataViewWrapper.setValue(r.dataItemIndex,n.dataKey,t);var s=this._wijgrid.sketchTable.row(this.rowIndex()),o=s.cell(n.dataIndex);o.value=t}}},t.prototype.toString=function(){return this.cellIndex()+":"+this.rowIndex()},t.prototype._clip=function(e,t){typeof t=="undefined"&&(t=!1);var n=!1,r;return t?(this.cellIndexAbs()<(r=e.topLeft().cellIndexAbs())&&(n=!0,this._ci=e.topLeft().cellIndex()),this.cellIndexAbs()>(r=e.bottomRight().cellIndexAbs())&&(n=!0,this._ci=e.bottomRight().cellIndex()),this.rowIndexAbs()<(r=e.topLeft().rowIndexAbs())&&(n=!0,this._ri=e.topLeft().rowIndex()),this.rowIndexAbs()>(r=e.bottomRight().rowIndexAbs())&&(n=!0,this._ri=e.bottomRight().rowIndex())):(this.cellIndex()<(r=e.topLeft().cellIndex())&&(n=!0,this._ci=r),this.cellIndex()>(r=e.bottomRight().cellIndex())&&(n=!0,this._ci=r),this.rowIndex()<(r=e.topLeft().rowIndex())&&(n=!0,this._ri=r),this.rowIndex()>(r=e.bottomRight().rowIndex())&&(n=!0,this._ri=r)),n},t.prototype._clone=function(){return new e.grid.cellInfo(this.cellIndex(),this.rowIndex(),this._wijgrid,!1,this._virtualize)},t.prototype._isValid=function(){return this.cellIndex()>=0&&this.rowIndex()>=0},t.prototype._isRendered=function(){var e=this._wijgrid._view()._isRowRendered(this.rowIndex());return e>=0},t.prototype._isEdit=function(e){if(!arguments.length)return this.__isEdit;this.__isEdit=e},t.prototype._setGridView=function(e){this._wijgrid=e},t}();t.cellInfo=r;var i=function(){function t(e,t){if(!e||!t)throw"invalid arguments";this._topLeft=e._clone(),this._bottomRight=t._clone()}return t.prototype.bottomRight=function(){return this._bottomRight},t.prototype.isEqual=function(e){return e&&this._topLeft.isEqual(e.topLeft())&&this._bottomRight.isEqual(e.bottomRight())},t.prototype.topLeft=function(){return this._topLeft},t.prototype.toString=function(){return this._topLeft.toString()+" - "+this._bottomRight.toString()},t.prototype._isIntersect=function(e){var t,n,r,i;if(e){t=e.bottomRight().rowIndex()-e.topLeft().rowIndex()+1,n=this._bottomRight.rowIndex()-this._topLeft.rowIndex()+1;if(e.topLeft().rowIndex()+t-this._topLeft.rowIndex()<t+n)return r=e.bottomRight().cellIndex()-e.topLeft().cellIndex()+1,i=this._bottomRight.cellIndex()-this._topLeft.cellIndex()+1,e.topLeft().cellIndex()+r-this._topLeft.cellIndex()<r+i}return!1},t.prototype._isValid=function(){return this._topLeft._isValid()&&this._bottomRight._isValid()},t.prototype._clip=function(e,t){typeof t=="undefined"&&(t=!1);var n=this._topLeft._clip(e,t),r=this._bottomRight._clip(e,t);return n||r},t.prototype._clone=function(){return new t(this._topLeft._clone(),this._bottomRight._clone())},t.prototype._containsCellInfo=function(e){return e&&e.cellIndex()>=this._topLeft.cellIndex()&&e.cellIndex()<=this._bottomRight.cellIndex()&&e.rowIndex()>=this._topLeft.rowIndex()&&e.rowIndex()<=this._bottomRight.rowIndex()},t.prototype._containsCellRange=function(e){return e&&this._containsCellInfo(e.topLeft())&&this._containsCellInfo(e.bottomRight())},t.prototype._extend=function(t,n){return t===e.grid.cellRangeExtendMode.column?(this._topLeft.rowIndex(n.topLeft().rowIndex()),this._bottomRight.rowIndex(n.bottomRight().rowIndex())):t===e.grid.cellRangeExtendMode.row&&(this._topLeft.cellIndex(n.topLeft().cellIndex()),this._bottomRight.cellIndex(n.bottomRight().cellIndex())),this},t.prototype._normalize=function(){var e=this._topLeft.cellIndex(),t=this._topLeft.rowIndex(),n=this._bottomRight.cellIndex(),r=this._bottomRight.rowIndex();this._topLeft.cellIndex(Math.min(e,n)),this._topLeft.rowIndex(Math.min(t,r)),this._bottomRight.cellIndex(Math.max(e,n)),this._bottomRight.rowIndex(Math.max(t,r))},t.prototype._height=function(){return this._bottomRight.rowIndex()-this._topLeft.rowIndex()},t.prototype._width=function(){return this._bottomRight.cellIndex()-this._topLeft.cellIndex()},t}();t.cellInfoRange=i,n.extend(n.wijmo.wijgrid,{cellInfo:e.grid.cellInfo,cellInfoRange:e.grid.cellInfoRange})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(e,t){this._rowHeaderSize=22,this.mIsRendered=!1,this._sizesAdjCache={th:0,col:0,subTable:0};if(!e)throw"'wijgrid' must be specified";this._wijgrid=e,this._bounds=t,this._wijgrid.element.addClass("wijmo-wijgrid-table")}return r.prototype.dispose=function(){this.toggleDOMSelection(!0),this._wijgrid.element.removeClass("wijmo-wijgrid-table")},r.prototype.ensureDisabledState=function(){var e="wijmo-wijgrid-disabled "+this._wijgrid.options.wijCSS.stateDisabled,t=this._wijgrid.options.disabled,r=this;n.each(this.subTables(),function(i,s){if(s){var o=n(s.element());t?(o.addClass(e),r._wijgrid._setAttr(o,"aria-disabled",!0)):(o.removeClass(e),r._wijgrid._setAttr(o,"aria-disabled",!1))}})},r.prototype.ensureWidth=function(e,t,n){this._setColumnWidth(e,t)},r.prototype.ensureHeight=function(e){},r.prototype.getScrollValue=function(){return null},r.prototype.getVisibleAreaBounds=function(e){throw"not implemented"},r.prototype.getVisibleContentAreaBounds=function(){throw"not implemented"},r.prototype.getFixedAreaVisibleBounds=function(){throw"not implemented"},r.prototype.isRendered=function(){return this.mIsRendered},r.prototype.render=function(){this._ensureRenderBounds(),this._preRender(),this._renderContent(),this._postRender()},r.prototype.toggleDOMSelection=function(t){n.each(this.subTables(),function(n,r){(new e.grid.domSelection(r.element())).toggleSelection(t)}),(new e.grid.domSelection(this._wijgrid.outerDiv)).toggleSelection(t)},r.prototype.updateSplits=function(e){throw"not implemented"},r.prototype.bodyRows=function(){if(!this._bodyRowsAccessor){if(!this.isRendered())throw"not rendered yet";this._bodyRowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.body,0,0)}return this._bodyRowsAccessor},r.prototype.filterRow=function(){if(this._wijgrid.options.showFilter){if(!this.isRendered())throw"not rendered yet";var t=new e.grid.rowAccessor(this,e.grid.rowScope.head,0,0);return t.item(t.length()-1)}return null},r.prototype.footerRow=function(){if(this._wijgrid.options.showFooter){if(!this.isRendered())throw"not rendered yet";var t=new e.grid.rowAccessor(this,e.grid.rowScope.foot,0,0);return t.item(0)}},r.prototype.headerRows=function(){var t;if(!this._headerRowsAccessor){if(!this.isRendered())throw"not rendered yet";t=this._wijgrid.options.showFilter?1:0,this._headerRowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.head,0,t)}return this._headerRowsAccessor},r.prototype.rows=function(){if(!this._rowsAccessor){if(!this.isRendered())throw"not rendered yet";this._rowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.table,0,0)}return this._rowsAccessor},r.prototype.focusableElement=function(){throw"not implemented"},r.prototype.forEachColumnCell=function(e,t,n){throw"not implemented"},r.prototype.forEachRowCell=function(e,t,n){throw"not implemented"},r.prototype.getAbsoluteCellInfo=function(e,t){throw"not implemented"},r.prototype.getAbsoluteRowIndex=function(e){throw"not implemented"},r.prototype.getCell=function(e,t){throw"not implemented"},r.prototype.getColumnIndex=function(e){throw"not implemented"},r.prototype.getHeaderCell=function(e){throw"not implemented"},r.prototype.getJoinedCols=function(e){throw"not implemented"},r.prototype.getJoinedRows=function(e,t){throw"not implemented"},r.prototype.getJoinedTables=function(e,t){throw"not implemented"},r.prototype.subTables=function(){throw"not implemented"},r.prototype._getMappedScrollMode=function(){var e=this._wijgrid.options.scrollMode,t="auto",n="auto";switch(e){case"horizontal":t="hidden",n="visible";break;case"vertical":t="visible",n="hidden";break;case"both":t="visible",n="visible"}return{vScrollBarVisibility:t,hScrollBarVisibility:n}},r.prototype._postRender=function(){this.mIsRendered=!0,this.ensureDisabledState(),this._sizesAdjCache.col=0,this._sizesAdjCache.th=0,this._sizesAdjCache.subTable=0;var e=this._wijgrid._field("visibleLeaves");if(e.length>0){var t=this.getHeaderCell(0),r=this.getJoinedCols(0);t&&(this._sizesAdjCache.th=n(t).leftBorderWidth()+n(t).rightBorderWidth()),r&&r.length&&(this._sizesAdjCache.col=n(r[0]).leftBorderWidth()+n(r[0]).rightBorderWidth())}var i=this.subTables()[0];this._sizesAdjCache.subTable=n(i.element()).leftBorderWidth()+n(i.element()).rightBorderWidth()},r.prototype._preRender=function(){this.mIsRendered=!1},r.prototype._ensureRenderBounds=function(){var e=this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch);this._bounds.start=0,this._bounds.end=e.bottomRight().rowIndex()},r.prototype._renderContent=function(){this._renderCOLS(),this._renderHeader(),this._wijgrid.options.showFilter&&this._renderFilter(),this._renderBody(),this._wijgrid.options.showFooter&&this._renderFooter()},r.prototype._renderCOLS=function(){var e=this._wijgrid._field("visibleLeaves"),t,n,r,i;for(r=0,i=e.length;r<i;r++)t=e[r],n=this._createCol(t,r),this._appendCol(n,t,r)},r.prototype._renderHeader=function(){var t=e.grid.rowType,n=this._wijgrid._columnsHeadersTable(),r,i,s;if(n&&(i=n.length))for(r=0;r<i;r++)s=this._insertEmptyRow(t.header,r,-1,-1,-1,undefined),this._renderRow(s,null,n[r])},r.prototype._renderFilter=function(){var t=this._insertEmptyRow(e.grid.rowType.filter,-1,-1,-1,-1,undefined);this._renderRow(t,this._wijgrid._field("visibleLeaves"),null)},r.prototype._renderBody=function(){var t=e.grid.rowType,n=this._wijgrid._field("visibleLeaves"),r=this._wijgrid.sketchTable,i=-1,s=0,o=0,u=this._wijgrid._dataOffset,a=this;this._bounds.start>=0&&this._bounds.end>=0&&this._wijgrid._renderableBoundsCollection().forEachIndex(this._bounds.start,this._bounds.end-this._bounds.start+1,function(e){var t=r.row(e-u),f=t.isDataRow(),l=t.groupByValue,c=a._insertEmptyRow(t.rowType,o++,f?++i:-1,t.dataItemIndex(),t.dataItemIndex(s),l);a._renderRow(c,n,t)})},r.prototype._renderFooter=function(){var t=this._insertEmptyRow(e.grid.rowType.footer,-1,-1,-1,-1,undefined);this._renderRow(t,this._wijgrid._field("visibleLeaves"),null)},r.prototype._insertEmptyRow=function(t,n,r,i,s,o){var u=this._wijgrid._onViewInsertEmptyRow.apply(this._wijgrid,arguments),a=this._insertRow(t,n,u);return this._createRowInfo(a,t,e.grid.renderState.rendering,n,r,i,s,o)},r.prototype._createEmptyCell=function(t,n,r){var i=e.grid.rowType,s=this._wijgrid._onViewCreateEmptyCell.apply(this._wijgrid,arguments);return this._createCell(t.type,s)},r.prototype._insertRow=function(e,t,n){throw"not implemented"},r.prototype._createCell=function(t,r){var i=e.grid.rowType,s;r||(t===i.header?r=document.createElement("th"):r=document.createElement("td"));if(t!==i.filter){s=document.createElement("div"),s.className="wijmo-wijgrid-innercell";if(r.firstChild)while(r.firstChild)s.appendChild(r.firstChild);r.appendChild(s)}return n(r)},r.prototype._appendCell=function(e,t,n){throw"not implemented"},r.prototype._createCol=function(e,t){throw"not implemented"},r.prototype._appendCol=function(e,t,n){throw"not implemented"},r.prototype._renderRow=function(t,n,r){var i=e.grid.rowType,s,o;switch(t.type){case i.filter:this._renderFilterRow(t,n);break;case i.footer:this._renderFooterRow(t,n);break;case i.header:this._renderHeaderRow(t,r);break;case i.data:case i.data|i.dataAlt:this._renderDataRow(t,n,r),s=r.attr(),o=r.style();break;case i.emptyDataRow:case i.groupHeader:case i.groupFooter:this._renderSpannedRow(t,n,r),s=r.attr(),o=r.style();break;default:throw"unknown rowType"}this._rowRendered(t,s,o)},r.prototype._renderCell=function(t,r,i,s,o,u,a){var f=this._createEmptyCell(t,o.dataIndex,o),l=t.type===e.grid.rowType.filter?f:n(f[0].firstChild);this._appendCell(t,r,f),s?l.html(i):this._wijgrid.cellFormatter.format(f,l,o,i,t),this._cellRendered(t,f,r,o,u,a)},r.prototype._renderDataRow=function(e,t,n){var r,i,s,o,u,a,f;for(r=0,i=t.length;r<i;r++){s=t[r],o=s.dataIndex;if(o<0)a=null,f=null,u=null;else{var l=n.cell(o);if(!l||!l.visible())continue;u=this._wijgrid.toStr(s,l.value),a=l.attr(),f=l.style()}this._renderCell(e,r,u,!1,s,a,f)}},r.prototype._renderFilterRow=function(t,n){var r,i,s;for(r=0,i=n.length;r<i;r++)s=n[r],this._renderCell(t,r,e.grid.filterHelper.getSingleValue(s.filterValue),!1,s)},r.prototype._renderFooterRow=function(e,t){var n,r;for(n=0,r=t.length;n<r;n++)this._renderCell(e,n,"",!1,t[n])},r.prototype._renderHeaderRow=function(e,t){var n,r,i=0,s;for(n=0,r=t.length;n<r;n++)s=t[n],s.column&&s.column.parentVis&&(s.column.thX=i++,s.column.thY=e.sectionRowIndex,this._renderCell(e,n,s.column.headerText,!1,s.column,{colSpan:s.colSpan,rowSpan:s.rowSpan}))},r.prototype._renderSpannedRow=function(t,n,r){var i,s,o=Math.min(n.length,r.cellCount());for(i=0;i<o;i++){var u=t.type===e.grid.rowType.emptyDataRow,a=r.cell(i);this._renderCell(t,i,a.html,u,n[i],a.attr(),a.style())}},r.prototype._cellRendered=function(t,n,r,i,s,o){this._wijgrid.cellStyleFormatter.format(n,r,i,t,e.grid.renderState.rendering,s,o),this._changeCellRenderState(n,e.grid.renderState.rendering,!1),this._wijgrid._onViewCellRendered(t,n,r,i)},r.prototype._rowRendered=function(t,n,r){this._wijgrid.rowStyleFormatter.format(t,n,r),t.state&=~e.grid.renderState.rendering,this._setRowInfo(t.$rows,t),this._wijgrid._onViewRowRendered(t)},r.prototype._isBodyRow=function(t){var n=e.grid.rowType,r=t.type;return r&n.data||r===n.groupHeader||r===n.groupFooter||r===n.emptyDataRow},r.prototype._changeRowRenderState=function(e,t,n){n?e.state|=t:e.state&=~t,this._setRowInfo(e.$rows,e)},r.prototype._changeCellRenderState=function(t,n,r){var i=e.grid.dataPrefix,s=this._wijgrid._data$prefix,o=i(t,s,"renderState");return r?(n=o|n,i(t,s,"renderState",n)):(n=o&~n,i(t,s,"renderState",n)),n},r.prototype._adjustWidthArray=function(e,t,r,i){var s=this._sumWidthArray(e),o=this._sumWidthArray(t),u=[],a,f=0,l,c,h=!0;if(s<=r){n.extend(!0,u,e);if(s===r||i)return u;a=r-s}else{n.extend(!0,u,t);if(o>=r)return u;a=r-o}return n.each(u,function(e,t){t.real||f++}),f!==0&&(l=Math.floor(a/f),c=a-l*f,n.each(u,function(e,t){t.real||(t.width+=l,h&&(t.width+=c,h=!1))})),u},r.prototype._getColumnWidth=function(e){var t,r,i,s,o,u,a,f,l,c,h;r=this._wijgrid._field("visibleLeaves")[e];if(r._realWidth!==undefined)t={width:r._realWidth,real:!0};else if(r.isRowHeader)t={width:this._rowHeaderSize,real:!0};else{var p=0;i=this.getJoinedTables(!0,e),s=i[2];for(o=0;o<2;o++){u=i[o];if(u!==null){a=u.element().rows;if(h=a.length){for(c=h-1,l=null;c>=0;c--)if(a[c].cells.length===u.width()){l=a[c];break}l&&(f=l.cells[s],p=Math.max(p,n(f).outerWidth()))}}}t={width:p,real:!1}}return t},r.prototype._setColumnWidth=function(e,t){var r=this.getHeaderCell(e),i=this.getJoinedCols(e),s;if(t){var o=this;r&&(s=t-this._sizesAdjCache.th,s<0&&(s=0),r.style.width=s+"px"),n.each(i,function(e,n){n&&(s=t-o._sizesAdjCache.col,s<0&&(s=0),n.style.width=s+"px")})}},r.prototype._setTableWidth=function(e,t,r,i){var s,o,u=this;n.each(e,function(e,n){n[0].style.tableLayout="fixed",n[0].style.width=t-u._sizesAdjCache.subTable+"px"}),s=e[0].outerWidth(),o=s-t,o!==0&&this._setColumnWidth(i,r-o)},r.prototype._sumWidthArray=function(e,t,r){var i=0;return n.each(e,function(e,n){if(t!==undefined&&r!==undefined&&(e<t||e>r))return!0;i+=n.width}),i},r.prototype._clearBody=function(){n.each(this.subTables(),function(e,t){t.clearSection(2)})},r.prototype._rebuildOffsets=function(){n.each(this.subTables(),function(e,t){t.rebuildOffsets()})},r.prototype._removeBodyRow=function(t,n){var r=e.grid.rowType,i=this._wijgrid._rows(),s,o,u,a,f;t>=0&&t<(o=i.length())&&(u=this._getRowInfo(i.item(t),!1),a=this.getAbsoluteRowIndex(u.$rows[0]),u.$rows.remove(),f=this.getJoinedTables(!1,a),f[0]&&f[0].removeOffset(f[2]),f[1]&&f[1].removeOffset(f[2]))},r.prototype._insertBodyRow=function(t,n,r,i){var s=this._wijgrid._field("visibleLeaves"),o=e.grid.rowType,u=this._wijgrid._view(),a=this._wijgrid._rows(),f=a.length(),l=t.isDataRow(),c,h,p;if(n<0||n>=f||!n&&n!==0)n=f;return c=this._insertEmptyRow(t.rowType,n,-1,r,i,t.groupByValue),this._renderRow(c,s,t),h=this.getAbsoluteRowIndex(c.$rows[0]),p=this.getJoinedTables(!1,h),p[0]&&p[0].insertOffset(h),p[1]&&p[1].insertOffset(h),c},r.prototype._findRowInfo=function(e){var t=this.bodyRows(),r=0,i=t.length(),s;if(n.isFunction(e))for(r=0;r<i;r++){s=this._getRowInfo(t.item(r));if(e(s)===!0)return s}return null},r.prototype._setRowInfo=function(t,n){var r="$rows"in n,i="data"in n,s,o;r&&(s=n.$rows,delete n.$rows),i&&(o=n.data,delete n.data),e.grid.dataPrefix(t,this._wijgrid._data$prefix,"rowInfo",n),r&&(n.$rows=s),i&&(n.data=o)},r.prototype._getRowInfo=function(t,r){typeof r=="undefined"&&(r=!0);var i=this._wijgrid,s=t[1]?n(t):n(t[0]),o=e.grid.dataPrefix(s,i._data$prefix,"rowInfo"),u;o.$rows=s;if(r&&o.dataItemIndex>=0&&o.type&e.grid.rowType.data)try{o.data=i._getDataItem(o.dataItemIndex)}catch(a){o.data=null}return o},r.prototype._getRowInfoBySketchRowIndex=function(e,t){typeof t=="undefined"&&(t=!0);var n=this._isRowRendered(e);if(n>=0){var r=this.bodyRows().item(n);return r?this._getRowInfo(r,t):null}var i=this._wijgrid.sketchTable.row(e),s=i.getRowInfo();if(t&&s.dataItemIndex>=0&&i.isDataRow())try{s.data=this._wijgrid._getDataItem(s.dataItemIndex)}catch(o){s.data=null}return s},r.prototype._createRowInfo=function(t,r,i,s,o,u,a,f){var l,c={type:r,state:i,sectionRowIndex:s,dataRowIndex:o,dataItemIndex:u,virtualDataItemIndex:a,$rows:t?n(t):null};return f!==undefined&&(c.groupByValue=f),u>=0&&r&e.grid.rowType.data&&(c.data=this._wijgrid._getDataItem(u)),c},r.prototype._isRowRendered=function(e){var t=this._wijgrid._renderableBoundsCollection().getRenderedIndex(e);return t>=0&&t>=this._bounds.start&&t<=this._bounds.end?t-this._bounds.start:-1},r}();t.baseView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(e,n){t.call(this,e,n),this._dataTable=null,this._contentArea=null}return __extends(r,t),r.prototype.ensureWidth=function(e,r,i){var s=n(this._dataTable.element()),o=s.width()+r-i;t.prototype.ensureWidth.call(this,e,r,i),this._setTableWidth([s],o,r,e)},r.prototype.getVisibleAreaBounds=function(t){var n=e.grid.bounds(this._dataTable.element(),t);return n},r.prototype.getVisibleContentAreaBounds=function(){return this.getVisibleAreaBounds()},r.prototype.updateSplits=function(e){var t=this,r=this._wijgrid,i=r.options,s=r.element,o=[],u=[],a=[],f=r._field("visibleLeaves"),l=r.outerDiv,c,h;s.css({"table-layout":"",width:"auto"}),n.each(f,function(e,n){var r,s=n.width;if(s||s===0){r=typeof s=="string"&&s.length>1&&s[s.length-1]==="%",r?s=l.width()*parseFloat(s)/100:s=parseFloat(s);if(n.ensurePxWidth||n.ensurePxWidth===undefined&&i.ensureColumnsPxWidth)n._realWidth=s;t._setColumnWidth(e,s)}}),n.each(f,function(e,n){o.push(t._getColumnWidth(e))}),s.css("width","1px"),n.each(f,function(e,n){u.push(t._getColumnWidth(e))}),c=l.width(),a=this._adjustWidthArray(o,u,c,i.ensureColumnsPxWidth),n.each(a,function(e,n){var r=f[e];if(r._realWidth!==undefined){delete r._realWidth;return}t._setColumnWidth(e,n.width)}),s.css("table-layout","fixed"),h=a.length-1;if(h!==-1){var p=l.width()-c;a[h].width+=p,this._setTableWidth([s],this._sumWidthArray(a,0,h),a[h].width,h)}},r.prototype.focusableElement=function(){return n(this._dataTable.element())},r.prototype.forEachColumnCell=function(e,t,n){return this._dataTable.forEachColumnCell(e,t,n)},r.prototype.forEachRowCell=function(e,t,n){return this._dataTable.forEachRowCell(e,t,n)},r.prototype.getAbsoluteCellInfo=function(t,n){return new e.grid.cellInfo(this.getColumnIndex(t),t.parentNode.rowIndex,this._wijgrid,!0,n)},r.prototype.getAbsoluteRowIndex=function(e){return e.rowIndex},r.prototype.getCell=function(e,t){var n=this._dataTable.getCellIdx(e,t),r;if(n>=0){r=this.getJoinedRows(t,0);if(r[0])return r[0].cells[n]}return null},r.prototype.getColumnIndex=function(e){return this._dataTable.getColumnIdx(e)},r.prototype.getHeaderCell=function(t){var n=this._wijgrid._field("visibleLeaves")[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.thY),n.thX):null},r.prototype.getJoinedCols=function(e){var t=n(this._dataTable.element()).find("> colgroup");return t.length&&e<t[0].childNodes.length?[t[0].childNodes[e],null]:[null,null]},r.prototype.getJoinedRows=function(e,t){return[this._dataTable.getSectionRow(e,t),null]},r.prototype.getJoinedTables=function(e,t){return[this._dataTable,null,t]},r.prototype.subTables=function(){return[this._dataTable]},r.prototype._preRender=function(){t.prototype._preRender.call(this),this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0],!0,!0,!0)},r.prototype._postRender=function(){this._wijgrid.element.find("> tbody").addClass(this._wijgrid.options.wijCSS.content),this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0]),this._wijgrid._setAttr(this._wijgrid.element,{role:"grid",cellpadding:"0",border:"0",cellspacing:"0"}),this._wijgrid.element.css("border-collapse","separate"),t.prototype._postRender.call(this)},r.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s;switch(t){case i.header:case i.filter:s=this._dataTable.ensureTHead();break;case i.footer:s=this._dataTable.ensureTFoot();break;default:s=this._dataTable.ensureTBody()}return r?[s.appendChild(r)]:(n>s.rows.length&&(n=-1),[s.insertRow(n)])},r.prototype._rowRendered=function(e,n,r){var i=e.$rows[0];!i.cells.length&&this._isBodyRow(e)?i.parentNode.removeChild(i):t.prototype._rowRendered.call(this,e,n,r)},r.prototype._appendCell=function(e,t,n){e.$rows[0].appendChild(n[0])},r.prototype._createCol=function(e,t){return[document.createElement("col")]},r.prototype._appendCol=function(e,t,n){this._dataTable.appendCol(e[0])},r}(t.baseView);t.flatView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(e,i){t.call(this,e,i),this._verScrollBarSize=18,this._viewTables={},this._splitAreas={},this._rowHeight=r.defaultRowHeight,this.element=e.element,this._staticDataRowIndex=e._getStaticIndex(!0),this._staticRowIndex=e._getRealStaticRowIndex(),this._staticColumnIndex=e._getRealStaticColumnIndex(),this._staticAllColumnIndex=this._staticColumnIndex===-1?-1:e._field("visibleLeaves")[this._staticColumnIndex].leavesIdx,this._mouseWheelHandler=n.proxy(this._onMouseWheel,this)}return __extends(r,t),r.defaultRowHeight=19,r.prototype.dispose=function(){t.prototype.dispose.call(this),this._wijgrid.outerDiv.unbind("mousewheel",this._mouseWheelHandler)},r.prototype.ensureWidth=function(e,r,i){var s=this._wijgrid,o=s.options,u=this._staticColumnIndex,a=e<=u,f=n(this._viewTables.nw.element()),l=n(this._viewTables.ne.element()),c=n(this._viewTables.sw.element()),h=n(this._viewTables.se.element()),p=a?[f,c]:[l,h],d=(a?f.width():l.width())+r-i,v=this.getScrollValue();this._destroySuperPanel(),t.prototype.ensureWidth.call(this,e,r,i),this._setTableWidth(p,d,r,e);try{u>=0?o.splitDistanceX=f[0].offsetWidth:o.splitDistanceX=0}catch(m){}this._updateSplitAreaBounds(0),this._adjustRowsHeights();try{this._staticRowIndex>=0?o.splitDistanceY=Math.max(f[0].offsetHeight,l[0].offsetHeight):o.splitDistanceY=0}catch(m){}this._updateSplitAreaBounds(1),this.refreshPanel(v);var g=s._UIFrozener();g&&g.refresh()},r.prototype.ensureHeight=function(e){var t,r=this._wijgrid,i=r.options,s=n(this._viewTables.nw.element()),o=n(this._viewTables.ne.element()),u=n(this._viewTables.sw.element()),a=n(this._viewTables.se.element()),f=this.getScrollValue(),l;this._destroySuperPanel(),arguments.length>0&&(t=this.getJoinedRows(e,2),this._setRowHeight(t,this._getRowHeight(t))),a.css("height",""),u.css("height",""),l=Math.max(a.height(),u.height()),a.height(l),u.height(l);try{this._staticRowIndex>=0?i.splitDistanceY=Math.max(s[0].offsetHeight,o[0].offsetHeight):i.splitDistanceY=0}catch(c){}this._updateSplitAreaBounds(1),this.refreshPanel(f);var h=r._UIFrozener();h&&h.refresh()},r.prototype.getScrollValue=function(){var e=this._getSuperPanel();return e?{x:e.options.hScroller.scrollValue,y:e.options.vScroller.scrollValue}:null},r.prototype.getPanelContentWrapper=function(){return this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-contentwrapper:first")},r.prototype.getVisibleAreaBounds=function(t){var n=e.grid.bounds(this.getPanelContentWrapper(),t);return n||(n=e.grid.bounds(this._wijgrid.outerDiv,t)),n},r.prototype.getVisibleContentAreaBounds=function(){var t=this.getVisibleAreaBounds(),n=e.grid.bounds(this._viewTables.nw.element())||{},r=e.grid.bounds(this._viewTables.ne.element())||{},i=e.grid.bounds(this._viewTables.sw.element())||{},s=e.grid.bounds(this._viewTables.se.element())||{},o={top:t.top,left:t.left,width:Math.max(n.width+r.width,i.width+s.width),height:Math.max(n.height+i.height,r.height+s.height)};return o.width=Math.min(t.width,o.width),o.height=Math.min(t.height,o.height),o},r.prototype.getRowAreaHeight=function(){var e=this.getPanelContentWrapper();e.length==0&&(e=this._wijgrid.outerDiv);var t=e.height(),i=this._wijgrid.options.splitDistanceY;i&&(t-=i);if(this._wijgrid.options.showFooter){var s,o=this.isRendered()&&(s=this.footerRow())?n(s).height():r.defaultRowHeight;t-=o}return t},r.prototype.getVirtualPageSize=function(){return Math.ceil(this.getRowAreaHeight()/this._rowHeight)},r.prototype.getFixedAreaVisibleBounds=function(){var t=this.getVisibleAreaBounds(),n=e.grid.bounds(this._splitAreas.ne),r=e.grid.bounds(this._splitAreas.nw),i=null,s=null;if(n.height||r.height)i={left:t.left,top:t.top,width:t.width,height:Math.min(n.height||r.height,t.height)};return r.width&&(s={left:r.left,top:t.top,width:Math.min(r.width,t.width),height:t.height}),[i,s]},r.prototype.refreshPanel=function(t){var i=this,s=this._wijgrid,o=s.options,u=this._getGridWidth(o.scrollMode),a=this._getMappedScrollMode(),f=this._testNeedVBar(s.outerDiv,s.element,n(this._viewTables.ne.element()),o.scrollMode,s._autoHeight),l=f&&!p,c=t?t.x:null,h=t?t.y:null,p=n.support.isTouchEnabled&&n.support.isTouchEnabled(),d=s._rows().item(0);this._rowHeight=d&&d[0]?n(d[0]).outerHeight():r.defaultRowHeight,this._splitAreas.ne.width(u-o.splitDistanceX-(l?this._verScrollBarSize:0)),o.staticColumnsAlignment==="right"&&(this._splitAreas.nw.css({left:"",right:l?this._verScrollBarSize:0}),this._splitAreas.sw.css({left:"",right:l?this._verScrollBarSize:0})),this._scroller.data("wijmo-wijsuperpanel")?this._scroller.wijsuperpanel("paintPanel"):(this._wijgrid._allowVirtualScrolling()&&(this.vsUI=new e.grid.uiVirtualScroller(s,this._splitAreas.se,o.splitDistanceY,this._rowHeight)),this._scroller.wijsuperpanel({disabled:s.options.disabled,scroll:n.proxy(this._onScroll,this),bubbleScrollingEvent:!0,customScrolling:this._wijgrid._allowVirtualScrolling(),vScroller:{scrollBarVisibility:a.vScrollBarVisibility,scrollValue:t?t.y:null},hScroller:{scrollBarVisibility:a.hScrollBarVisibility,scrollValue:t?t.x:null},hScrollerActivating:function(e,t){var n;if(s._autoHeight){n=s.element.height()+o.splitDistanceY-t.contentLength;if(n>0)return i._scroller.height(i._scroller.height()+n),i._scroller.wijsuperpanel("paintPanel"),!1}i._splitAreas.sw.height(t.contentLength-o.splitDistanceY)}}),this._wijgrid._allowVirtualScrolling()&&this.vsUI.attach(this._scroller)),this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer, .wijmo-wijsuperpanel-vbarcontainer").css("zIndex",5),this._wijgrid._allowVirtualScrolling()&&this._wijgrid._handleVirtualScrolling(this._bounds.start)},r.prototype.scrollTo=function(e){if(!e.tableCell())return;var t=this._wijgrid,r=t.options,i=this._getSuperPanel(),s=e.tableCell(),o=s.nodeType?n(s):s,u=null,a=null;if(i&&o.is(":visible")){var f=i.getContentElement(),l=f.parent(),c=parseInt((f.css("left")+"").replace("px",""),10)*-1,h=parseInt((f.css("top")+"").replace("px",""),10)*-1,p=l.outerWidth()-r.splitDistanceX,d=l.outerHeight()-r.splitDistanceY,v=o.position(),m=v.left,g=v.top,y=o.outerWidth(),b=o.outerHeight(),w=t._getStaticIndex(!0),E=t._getStaticIndex(!1),S=e.rowIndex(),x=e.cellIndex();S<=w?x<=E?(u=0,a=0):(m+=c,m+y>c+p&&(c=u=m+y-p),m<c&&(u=m),a=0):x<=E?(g+=this._splitAreas.sw.scrollTop(),g+b>h+d&&(h=a=g+b-d),g<h&&(a=g),u=0):(m-=r.splitDistanceX,g+b>h+d&&(h=a=g+b-d),m+y>c+p&&(c=u=m+y-p),g<h&&(a=g),m<c&&(u=m)),u!==null&&i.hScrollTo(u),a!==null&&(this._wijgrid._allowVirtualScrolling()||i.vScrollTo(a))}},r.prototype.updateSplits=function(e){var t=this._wijgrid,r=t.options,i,s=this,o=[],u=[],a=[],f=this._staticColumnIndex,l,c=r.scrollMode,h=t._field("visibleLeaves"),p=n(this._viewTables.se.element()),d=n(this._viewTables.ne.element()),v=n(this._viewTables.sw.element()),m=n(this._viewTables.nw.element()),g=t.outerDiv,y,b,w;this._destroySuperPanel(),g.unbind("mousewheel",this._mouseWheelHandler);if((y=s._viewTables.se.element().tBodies)&&(y=y[0])){w=!1;for(b=0;b<y.rows.length;b++)if(!n(y.rows[b]).hasClass("wijmo-wijgrid-groupheaderrow")){w=!0;break}w||t.element.css("width","100%")}n.each([p,d,v,m],function(e,t){t.css({"table-layout":"",width:""})}),n.each(h,function(e,t){var n,i=t.width;if(i||i===0){n=typeof i=="string"&&i.length>1&&i[i.length-1]==="%",n?i=g.width()*parseFloat(i)/100:i=parseFloat(i);if(t.ensurePxWidth||t.ensurePxWidth===undefined&&r.ensureColumnsPxWidth)t._realWidth=i;s._setColumnWidth(e,i)}}),n.each(h,function(e,t){a.push(s._getColumnWidth(e))}),n.each([m,d,v,p],function(e,t){t.css({width:"1px"})}),n.each(h,function(e,t){u.push(s._getColumnWidth(e))}),i=g.width(),o=this._adjustWidthArray(a,u,i,r.ensureColumnsPxWidth),n.each(o,function(e,t){var n=h[e];if(n._realWidth!==undefined){delete n._realWidth;return}s._setColumnWidth(e,t.width)}),f>=0&&(l=f,this._setTableWidth([m,v],this._sumWidthArray(o,0,l),o[l].width,l));try{f>=0?r.splitDistanceX=m[0].offsetWidth:r.splitDistanceX=0}catch(E){}this._updateSplitAreaBounds(0),r.ensureColumnsPxWidth||d.parent().width(i-r.splitDistanceX),l=o.length-1,l!==-1&&this._setTableWidth([d,p],this._sumWidthArray(o,f+1,l),o[l].width,l),this._adjustRowsHeights();try{this._staticRowIndex>=0?r.splitDistanceY=Math.max(m[0].offsetHeight,d[0].offsetHeight):r.splitDistanceY=0}catch(E){}this._updateSplitAreaBounds(1);if(!r.ensureColumnsPxWidth&&this._testNeedVBar(t.outerDiv,p,d,c,t._autoHeight)){i-=this._verScrollBarSize,o=this._adjustWidthArray(a,u,i,r.ensureColumnsPxWidth),n.each(o,function(e,t){t.real||s._setColumnWidth(e,t.width)}),f>=0&&(l=f,this._setTableWidth([m,v],this._sumWidthArray(o,0,l),o[l].width,l));try{f>=0?r.splitDistanceX=m[0].offsetWidth:r.splitDistanceX=0}catch(E){}this._updateSplitAreaBounds(0),d.parent().width(i-r.splitDistanceX),l=o.length-1,l!==-1&&this._setTableWidth([d,p],this._sumWidthArray(o,f+1,l),o[l].width,l),this._adjustRowsHeights();try{this._staticRowIndex>=0?r.splitDistanceY=Math.max(m[0].offsetHeight,d[0].offsetHeight):r.splitDistanceY=0}catch(E){}this._updateSplitAreaBounds(1)}this.refreshPanel(e),g.bind("mousewheel",n.proxy(this._mouseWheelHandler,this))},r.prototype._clearBody=function(){t.prototype._clearBody.call(this)},r.prototype.bodyRows=function(){var e=t.prototype.bodyRows.call(this);return e},r.prototype.focusableElement=function(){return this._wijgrid.outerDiv},r.prototype.forEachColumnCell=function(e,t,n){var r=this.getJoinedTables(!0,e),i,s;if(r[0]!==null){i=r[2],s=r[0].forEachColumnCell(i,t,n);if(s!==!0)return s;if(r[1]!==null){s=r[1].forEachColumnCell(i,t,n);if(s!==!0)return s}}return!0},r.prototype.forEachRowCell=function(e,t,n){var r=this.getJoinedTables(!1,e),i=r[0],s=r[1],o,u;if(i!==null){o=r[2];if(o<i.element().rows.length){u=i.forEachRowCell(o,t,n);if(u!==!0)return u}if(s!==null&&o<s.element().rows.length){u=s.forEachRowCell(o,t,n);if(u!==!0)return u}}return!0},r.prototype.getAbsoluteCellInfo=function(t,n){return new e.grid.cellInfo(this.getColumnIndex(t),this.getAbsoluteRowIndex(t.parentNode),this._wijgrid,!0,n)},r.prototype.getAbsoluteRowIndex=function(e){var t=e.rowIndex,n=e.parentNode;while(n&&n.tagName&&n.tagName.toLowerCase()!=="table")n=n.parentNode;return n===this._viewTables.nw.element()||n===this._viewTables.ne.element()?t:t+this._staticRowIndex+1},r.prototype.getCell=function(e,t){var n=this.getJoinedTables(!1,t),r,i,s,o,u;if(n[0]!==null){r=this.getJoinedTables(!0,e);if(r[0]!==null){i=n[2],s=r[2],o=null,n[1]!==null?o=e===s?n[0]:n[1]:o=n[0],u=o.getCellIdx(s,i);if(u>=0)return o.element().rows[i].cells[u]}}return null},r.prototype.getColumnIndex=function(e){var t=null,n=null,r=!1,i;for(t=e.parentNode;t.tagName.toLowerCase()!=="table";t=t.parentNode);if(t!==null){t===this._viewTables.nw.element()?n=this._viewTables.nw:t===this._viewTables.ne.element()?(n=this._viewTables.ne,r=!0):t===this._viewTables.sw.element()?n=this._viewTables.sw:t===this._viewTables.se.element()&&(n=this._viewTables.se,r=!0);if(n!==null)return i=n.getColumnIdx(e),r&&(i+=this._staticColumnIndex+1),i}return-1},r.prototype.getHeaderCell=function(t){var n=this._wijgrid._field("visibleLeaves")[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.thY),n.thX):null},r.prototype.getJoinedCols=function(e){var t=[],r=this.getJoinedTables(!0,e),i=r[2];return r.splice(r.length-1,1),n.each(r,function(e,r){t.push(r?n(r.element()).find("col")[i]:null)}),t},r.prototype.getJoinedRows=function(e,t){var n=null,r=null,i=null,s=null,o=this._staticRowIndex,u=this._staticColumnIndex,a=this._wijgrid._field("visibleLeaves").length-1,f=this._rowsCountRaw()-1,l=o===f,c=o<0,h=!l&&!c,p=0;if(l||h)u>=0&&u<a?(i=this._viewTables.nw,s=this._viewTables.ne):i=u<0?this._viewTables.ne:this._viewTables.nw,p=i.getSectionLength(t),e<p&&(n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t)));if(c||h&&n===null)c||(e-=p),u>=0&&u<a?(i=this._viewTables.sw,s=this._viewTables.se):i=u<0?this._viewTables.se:this._viewTables.sw,n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t));return n===null&&r===null?null:[n,r]},r.prototype.getJoinedTables=function(e,t){var n=null,r=null,i=t,s=this._wijgrid,o=this._staticRowIndex,u=this._staticColumnIndex;return e?(t<=u?(n=this._viewTables.nw,r=this._viewTables.sw):(n=this._viewTables.ne,r=this._viewTables.se,i-=u+1),o<0&&(n=null),o===this._rowsCountRaw()-1&&(r=null)):(t<=o?(n=this._viewTables.nw,r=this._viewTables.ne):(n=this._viewTables.sw,r=this._viewTables.se,i-=o+1),u<0&&(n=null),u===s._field("leaves").length-1&&(r=null)),n===null&&(n=r,r=null),[n,r,i]},r.prototype.subTables=function(){return[this._viewTables.nw,this._viewTables.ne,this._viewTables.sw,this._viewTables.se]},r.prototype._getGridWidth=function(e){var t=this._wijgrid,r=t.element.outerWidth(!0)+t.options.splitDistanceX,i=t.outerDiv.innerWidth();return this._testNeedVBar(t.outerDiv,t.element,n(this._viewTables.ne.element()),e,t._autoHeight)&&(r+=this._verScrollBarSize),r>i&&(r=i),r},r.prototype._getSuperPanel=function(){return this._scroller?this._scroller.data("wijmo-wijsuperpanel"):null},r.prototype._ensureRenderBounds=function(){if(this._wijgrid._allowVirtualScrolling()){this._wijgrid._ensureRenderableBounds(this._bounds),this._bounds.end=this._bounds.start+this.getVirtualPageSize()-1;if(this._wijgrid._serverSideVirtualScrolling()){var e=this._bounds.end-this._bounds.start+1-this._wijgrid.sketchTable.count();e>0&&(this._bounds.end-=e)}this._wijgrid._ensureRenderableBounds(this._bounds)}else t.prototype._ensureRenderBounds.call(this)},r.prototype._renderContent=function(){t.prototype._renderContent.call(this)},r.prototype._preRender=function(){t.prototype._preRender.call(this);var r=document.createDocumentFragment(),i=e.grid.htmlTableAccessor;this._wijgrid.outerDiv.wrapInner('<div class="wijmo-wijgrid-fixedview"><div class="wijmo-wijgrid-scroller"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>'),this._scroller=this._wijgrid.outerDiv.find(".wijmo-wijgrid-scroller"),this._scroller.css("padding",0),this._scroller.after(this._splitAreas.nw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.ne=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.sw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._splitAreas.se=this._scroller.find(".wijmo-wijgrid-split-area-se:first"),this._viewTables={nw:new i(r.appendChild(document.createElement("table")),!0,!0,!0),ne:new i(r.appendChild(document.createElement("table")),!0,!0,!0),sw:new i(r.appendChild(document.createElement("table")),!0,!0,!0),se:new i(r.appendChild(this._wijgrid.element[0]),!0,!0,!0)}},r.prototype._postRender=function(){var r,i,s,o,u=e.grid.htmlTableAccessor,a=this;this._viewTables={nw:new u(r=this._viewTables.nw.element()),ne:new u(i=this._viewTables.ne.element()),sw:new u(s=this._viewTables.sw.element()),se:new u(o=this._viewTables.se.element())},this._splitAreas.nw.empty().append(r),this._splitAreas.ne.empty().append(i),this._splitAreas.sw.empty().append(s),this._splitAreas.se.empty().append(o),n.each(this._viewTables,function(e,t){var r=n(t.element());a._wijgrid._setAttr(r,{role:"grid",border:"0",cellpadding:"0",cellspacing:"0"}),r.addClass("wijmo-wijgrid-table").css("border-collapse","separate").find("> tbody").addClass(a._wijgrid.options.wijCSS.content)}),t.prototype._postRender.call(this)},r.prototype._rowsCountRaw=function(){var e=this._viewTables.nw.element(),t=this._viewTables.ne.element(),n=this._viewTables.sw.element(),r=this._viewTables.se.element(),i;return i=Math.max(e.rows.length,t.rows.length)+Math.max(n.rows.length,r.rows.length),i},r.prototype._createCol=function(e,t){return[document.createElement("col"),document.createElement("col")]},r.prototype._appendCol=function(e,t,n){n<=this._staticColumnIndex?(this._viewTables.nw.appendCol(e[0]),this._viewTables.sw.appendCol(e[1])):(this._viewTables.ne.appendCol(e[0]),this._viewTables.se.appendCol(e[1]))},r.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s,o,u=this._viewTables;switch(t){case i.header:case i.filter:s=u.nw.ensureTHead(),o=u.ne.ensureTHead();break;case i.footer:s=u.sw.ensureTFoot(),o=u.se.ensureTFoot();break;default:n<=this._staticDataRowIndex?(s=u.nw.ensureTBody(),o=u.ne.ensureTBody()):(n-=this._staticDataRowIndex+1,s=u.sw.ensureTBody(),o=u.se.ensureTBody())}return r?[s.appendChild(r),o.appendChild(r.cloneNode(!1))]:[s.insertRow(n>s.rows.length?-1:n),o.insertRow(n>o.rows.length?-1:n)]},r.prototype._rowRendered=function(e,r,i){var s=e.$rows[0],o=e.$rows[1];!s.cells.length&&this._isBodyRow(e)&&(s.parentNode.removeChild(s),s=null),!o.cells.length&&this._isBodyRow(e)&&(o.parentNode.removeChild(o),o=null);if(s||o){if(!s||!o)e.$rows=s?n(s):n(o);t.prototype._rowRendered.call(this,e,r,i)}},r.prototype._appendCell=function(t,n,r){var i=t.type!==e.grid.rowType.header?this._staticColumnIndex:this._staticAllColumnIndex;n<=i?t.$rows[0].appendChild(r[0]):t.$rows[1].appendChild(r[0])},r.prototype._getRowHeight=function(e,t){if(e[0]&&e[1]){var r=e[0],i=e[1],s=n(r),o=n(i),u,a,f,l=function(e){var t,r=e[0],i;for(t=0;t<r.cells.length;t++){i=r.cells[t];if(!i.rowSpan||i.rowSpan===1)return n(i).outerHeight()}return e.height()};return(f=n.data(r,"customHeight"))?u=a=parseInt(f):(s.css("height",""),o.css("height",""),t?(u=l(s),a=l(o)):(u=s.height(),a=o.height())),Math.max(u,a)}return null},r.prototype._setRowHeight=function(e,t){if(e[0]&&e[1]){var r=[n(e[0]),n(e[1])],i;if(t===null)return;t+=1,n.each(r,function(e,n){n.height(t),i=t-n.height(),i&&n.height(t+i)})}},r.prototype._adjustRowHeight=function(){var e=this._wijgrid,t=this._staticColumnIndex,n=e._field("visibleLeaves").length-1,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=[];if(t>-1&&t<n){r=this._staticRowIndex,i=this._rowsCountRaw()-1,s=this._viewTables;if(r>-1&&r<=i){o=s.ne.element(),u=o.parentNode,a=s.nw.element(),f=a.parentNode,g=a.rows,y=o.rows,d=g.length;for(v=0;v<d;v++)b.push(this._getRowHeight([g[v],y[v]],!0))}if(r>=-1&&r<i){l=s.se.element(),c=l.parentNode,h=s.sw.element(),p=h.parentNode,g=h.rows,y=l.rows,d=g.length;for(v=0;v<d;v++)b.push(this._getRowHeight([g[v],y[v]]))}r>-1&&r<=i&&(f.removeChild(a),u.removeChild(o)),r>=-1&&r<i&&(p.removeChild(h),c.removeChild(l));if(r>-1&&r<=i){g=a.rows,y=o.rows,d=g.length;for(v=0,m=0;v<d;v++)this._setRowHeight([g[v],y[v]],b[m++])}if(r>=-1&&r<i){g=h.rows,y=l.rows,d=g.length;for(v=0;v<d;v++)this._setRowHeight([g[v],y[v]],b[m++])}r>-1&&r<=i&&(f.appendChild(a),u.appendChild(o)),r>=-1&&r<i&&(p.appendChild(h),c.appendChild(l))}},r.prototype._adjustRowsHeights=function(){var e=n(this._viewTables.sw.element()),t=n(this._viewTables.se.element()),r;t.css("height",""),e.css("height",""),this._adjustRowHeight(),r=Math.max(t.height(),e.height()),e.height(r),t.height(r)},r.prototype._destroySuperPanel=function(){this._scroller.data("wijmo-wijsuperpanel")&&(this.vsUI&&this.vsUI.dispose(),this._scroller.wijsuperpanel("destroy"))},r.prototype._onScroll=function(e,t){var n=this._getSuperPanel();this._wijgrid._allowVirtualScrolling()?t.dir==="h"&&(this._setFixedAreaPosition(n.getContentElement(),t.dir,t.position,t.animationOptions,!1),this._setFixedAreaPosition(this._splitAreas.ne,t.dir,t.position,t.animationOptions,!0)):this._setFixedAreaPosition(t.dir==="h"?this._splitAreas.ne:this._splitAreas.sw,t.dir,t.position,t.animationOptions,!0),this._wijgrid._trackScrollingPosition(n.options.hScroller.scrollValue,n.options.vScroller.scrollValue)},r.prototype._onMouseWheel=function(t,r){var i,s=r>0?"top":"bottom",o=!1,u;this._wijgrid._canInteract()&&(i=this.getFixedAreaVisibleBounds(),n.each(i,function(n,r){if(r&&e.grid.isOver(t.pageY,t.pageX,r.top,r.left,r.height,r.width))return o=!0,!1}),o&&this._scroller.data("wijmo-wijsuperpanel")&&(u=this._scroller.wijsuperpanel("option","vScroller").scrollValue,this._scroller.wijsuperpanel("doScrolling",s),u!==this._scroller.wijsuperpanel("option","vScroller").scrollValue&&(t.stopPropagation(),t.preventDefault())))},r.prototype._setFixedAreaPosition=function(e,t,n,r,i){var s={},o;t==="h"?o=i?"scrollLeft":"left":o=i?"scrollTop":"top",i||(n=-n),r?(s[o]=n,e.animate(s,r)):i?e[0][o]=n:e.css(o,n)},r.prototype._testNeedVBar=function(e,t,n,r,i){var s,o=this._wijgrid,u=n.width()+o.options.splitDistanceX,a=t.height()+o.options.splitDistanceY,f=e.width(),l=e.height(),c,h=0,p=0;return this._wijgrid._allowVirtualScrolling()&&o._totalRowsCount()>1?!0:(o.$superPanelHeader!==null&&(h=o.$superPanelHeader.outerHeight(!0)),o.$bottomPagerDiv!==null&&(p=o.$bottomPagerDiv.outerHeight(!0)),c=l-h-p,r==="both"||r==="vertical"?s=!0:s=r==="auto"&&(a>c||!i&&u>f&&a>c-this._verScrollBarSize),s)},r.prototype._updateSplitAreaBounds=function(e){var t=this._wijgrid,n=t.options,r,i,s=0,o=0;if(e===0||e===2)this._splitAreas.nw.width(n.splitDistanceX),this._splitAreas.sw.width(n.splitDistanceX),t.options.staticColumnsAlignment==="right"?(this._splitAreas.se.css("marginRight",n.splitDistanceX),this._splitAreas.ne.css("marginRight",n.splitDistanceX)):(this._splitAreas.se.css("marginLeft",n.splitDistanceX),this._splitAreas.ne.css("marginLeft",n.splitDistanceX));if(e===1||e===2)this._scroller.css("height",""),this._splitAreas.se.css("marginTop",0),r=t.outerDiv.height(),t._autoHeight?this._scroller.height(r+n.splitDistanceY):this._scroller.height(r),this._splitAreas.nw.height(n.splitDistanceY),this._splitAreas.ne.height(n.splitDistanceY),t.$superPanelHeader!==null&&(s=t.$superPanelHeader.outerHeight(!0)),t.$bottomPagerDiv!==null&&(o=t.$bottomPagerDiv.outerHeight(!0)),i=r-s-o,t.$superPanelHeader!==null&&(this._splitAreas.nw.css("top",s+"px"),this._splitAreas.ne.css("top",s+"px")),t._autoHeight?this._splitAreas.sw.height(i):this._splitAreas.sw.height(i-n.splitDistanceY),this._splitAreas.sw.css("top",n.splitDistanceY+s),this._splitAreas.se.css("marginTop",n.splitDistanceY)},r}(t.baseView);t.fixedView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(e){this._updates=0,this._selectedColumns=null,this._selectedRows=null,this._extend_rules={singlecell:[0,0,0],singlecolumn:[1,1,1],singlerow:[2,2,2],singlerange:[0,1,2],multicolumn:[1,1,1],multirow:[2,2,2],multirange:[0,1,2]};if(!e)throw"invalid arguments";this._wijgrid=e,this._addedCells=new i(e),this._removedCells=new i(e),this._selectedCells=new i(e),this._addedDuringCurTransactionCells=new i(e)}return r.prototype.selectedCells=function(){return this._selectedCells},r.prototype.addColumns=function(e,t){!t&&t!==0&&(t=e),this.addRange(e,0,t,16777215)},r.prototype.addRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._selectRange(s,!1,!0,e.grid.cellRangeExtendMode.none,null),this.endUpdate()},r.prototype.addRows=function(e,t){!t&&t!==0&&(t=e),this.addRange(0,e,16777215,t)},r.prototype.removeRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._clearRange(s,e.grid.cellRangeExtendMode.none),this.endUpdate()},r.prototype.removeColumns=function(e,t){!t&&t!==0&&(t=e),this.removeRange(e,0,t,16777215)},r.prototype.removeRows=function(e,t){!t&&t!==0&&(t=e),this.removeRange(0,e,16777215,t)},r.prototype.clear=function(){this.beginUpdate(),this._removedCells._clear(),this._removedCells._addFrom(this._selectedCells),this.endUpdate()},r.prototype.selectAll=function(){this.beginUpdate(),this._selectRange(this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch),!1,!1,e.grid.cellRangeExtendMode.none,null),this.endUpdate()},r.prototype.beginUpdate=function(){this._updates++},r.prototype.endUpdate=function(){if(this._updates>0){this._updates--;if(this._updates===0){this.doSelection();if(this._addedCells.length()||this._removedCells.length())this._selectedColumns!==null&&this._selectedColumns.UnderlyingDataChanged(),this._selectedRows!==null&&this._selectedRows.UnderlyingDataChanged(),this._wijgrid._trigger("selectionChanged",null,{addedCells:this._addedCells,removedCells:this._removedCells});this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._removedCells._clear()}}},r.prototype._multipleRangesAllowed=function(){var e=this._wijgrid.options.selectionMode;return e&&((e=e.toLowerCase())==="multicolumn"||e==="multirow"||e==="multirange")},r.prototype._anchorCell=function(){return this.__anchorCell},r.prototype._startNewTransaction=function(t){t&&(this.__anchorCell=t._clone(),this._addedDuringCurTransactionCells=new e.grid.cellInfoOrderedCollection(this._wijgrid))},r.prototype._clearRange=function(e,n){var r=this._wijgrid.options.selectionMode.toLowerCase(),i,s,o,u,a,f,l,c,h,p=this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch);if(e._isValid()&&r!=="none"&&this._selectedCells.length()>0){i=e._clone(),i._normalize(),i._clip(p);if(!e._isValid())return;i._extend(this._extend_rules[r][n],p),this.beginUpdate();for(l=0,c=this._selectedCells.length();l<c;l++)h=this._selectedCells.item(l),i._containsCellInfo(h)&&this._removedCells._add(h);this.endUpdate()}},r.prototype._selectRange=function(n,r,i,s,o){var u=this._wijgrid.options.selectionMode.toLowerCase(),a,f=this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch);if(u!=="none"&&n._isValid()){a=n._clone(),a._normalize(),a._clip(f);if(!a._isValid())return;this.beginUpdate(),this._multipleRangesAllowed()?r||i?i&&(this._removedCells._clear(),this._removedCells._addFrom(this._addedDuringCurTransactionCells)):this.clear():this.clear();switch(u){case"singlecell":case"singlecolumn":case"singlerow":a=o===null?new e.grid.cellInfoRange(a.topLeft(),a.topLeft()):new e.grid.cellInfoRange(o,o)}a._extend(this._extend_rules[u][s],f),this.doRange(a,!0),this.endUpdate()}},r.prototype._ensureSelection=function(){var e=this._wijgrid._view(),t=-2,n;for(var r=0;r<this._selectedCells.length();r++){var i=this._selectedCells.item(r);i._isRendered()&&(t!==i.rowIndex()&&(n=i.row(),t=i.rowIndex()),this.selectCell(i,n,e,!0))}},r.prototype.doSelection=function(){var t=this._wijgrid._view(),n,r,i,s,o,u,a=e.grid.renderState,f,l,c=-1;for(n=0,r=this._removedCells.length();n<r;n++)i=this._removedCells.item(n),this._addedCells.indexOf(i)<0?(c!==i.rowIndex()&&(f=i.row(),c=i.rowIndex()),this.selectCell(i,f,t,!1),this._selectedCells._remove(i),this._addedDuringCurTransactionCells._remove(i)):(this._removedCells._removeAt(n),n--,r--);c=-1;for(n=0,r=this._addedCells.length();n<r;n++)i=this._addedCells.item(n),u=this._selectedCells.indexOf(i),u<0?(c!==i.rowIndex()&&(f=i.row(),c=i.rowIndex()),this.selectCell(i,f,t,!0),this._selectedCells._insertUnsafe(i,~u),this._addedDuringCurTransactionCells._add(i)):(this._addedCells._removeAt(n),n--,r--)},r.prototype.selectCell=function(t,r,i,s){if(t._isRendered()){var o=this._wijgrid._viewPortBounds(),u=i.getCell(t.cellIndexAbs(),t.rowIndexAbs());if(u){var a=n(u),f=i._changeCellRenderState(a,e.grid.renderState.selected,s===!0);this._wijgrid.cellStyleFormatter.format(a,t.cellIndex(),t.column(),r,f)}}},r.prototype.doRange=function(t,n){var r=t.topLeft().cellIndex(),i=t.topLeft().rowIndex(),s=t.bottomRight().cellIndex(),o=t.bottomRight().rowIndex(),u,a,f,l,c=this._wijgrid._view(),h,p,d=this._wijgrid._viewPortBounds();if(n){u=this._addedCells.length(),p=this._wijgrid._rows();for(a=i;a<=o;a++){h=c._getRowInfoBySketchRowIndex(a);if(h.type&e.grid.rowType.data)for(f=r;f<=s;f++)l=new e.grid.cellInfo(f,a),u===0?this._addedCells._appendUnsafe(l):this._addedCells._add(l)}}else{u=this._removedCells.length();for(a=i;a<=o;a++)for(f=r;f<=s;f++)l=new e.grid.cellInfo(f,a),u===0?this._removedCells._appendUnsafe(l):this._removedCells._add(l)}},r}();t.selection=r;var i=function(){function t(e){this._clear=function(){this._list.length=0};if(!e)throw"invalid arguments";this._wijgrid=e,this._list=[]}return t.prototype.item=function(e){return this._list[e]},t.prototype.length=function(){return this._list.length},t.prototype.indexOf=function(e,t){arguments.length===1&&(t=e.rowIndex(),e=e.cellIndex());var n=0,r=this._list.length-1,i,s,o;while(n<=r){i=n+(r-n>>1),s=this._list[i],o=s.rowIndex()-t,o===0&&(o=s.cellIndex()-e);if(o<0)n=i+1;else{if(!(o>0))return i;r=i-1}}return~n},t.prototype.toString=function(){var e="",t,n;for(t=0,n=this._list.length;t<n;t++)e+=this._list[t].toString()+"\n";return e},t.prototype._add=function(e){var t=this.indexOf(e);return t<0?(this._list.splice(~t,0,e),e._setGridView(this._wijgrid),!0):!1},t.prototype._addFrom=function(e){if(e){var t=e.length(),n=this._list.length,r;if(n===0){this._list.length=t;for(r=0;r<t;r++)this._list[r]=e.item(r),this._list[r]._setGridView(this._wijgrid)}else for(r=0;r<t;r++)this._add(e.item(r))}},t.prototype._appendUnsafe=function(e){this._list[this._list.length]=e,e._setGridView(this._wijgrid)},t.prototype._insertUnsafe=function(e,t){this._list.splice(t,0,e)},t.prototype._remove=function(e){var t=this.indexOf(e);return t>=0?(this._list.splice(t,1),!0):!1},t.prototype._removeAt=function(e){this._list.splice(e,1)},t.prototype._getColumnsIndicies=function(){var e=[],t=this._list.length,n,r,i;if(t){n=[];for(r=0;r<t;r++)n[this._list[r].cellIndex()]=1;t=n.length,i=0;for(r=0;r<t;r++)n[r]&&(e[i++]=r)}return e},t.prototype._getSelectedRowsIndicies=function(){var e=[],t=this._list.length,n,r,i;if(t){n=[];for(r=0;r<t;r++)n[this._list[r].rowIndex()]=1;t=n.length,i=0;for(r=0;r<t;r++)n[r]&&(e[i++]=r)}return e},t.prototype._rectangulate=function(){var t=this._list.length,n=4294967295,r=4294967295,i=0,s=0,o,u;if(t){for(o=0;o<t;o++)u=this._list[o],n=Math.min(n,u.cellIndex()),r=Math.min(r,u.rowIndex()),i=Math.max(i,u.cellIndex()),s=Math.max(s,u.rowIndex());return new e.grid.cellInfoRange(new e.grid.cellInfo(n,r),new e.grid.cellInfo(i,s))}return null},t}();t.cellInfoOrderedCollection=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(t){this._gap_to_start=10,this._inProgress=!1,this._additionalEventsAttached=!1,this._wijgrid=t,this._evntFormat="{0}."+this._wijgrid.widgetName+".selectionui",this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._view=this._wijgrid._view(),this._rootElement=this._view.focusableElement(),this._visLeavesLen=this._wijgrid._field("visibleLeaves").length,this._rootElement.bind(this._eventKey("mousedown"),n.proxy(this._onGridMouseDown,this))}return r.prototype.dispose=function(){this._rootElement.unbind(this._eventKey("mousedown"),this._onGridMouseDown),this._detachAdditionalEvents()},r.prototype._onGridMouseDown=function(e){if(!this._wijgrid._canInteract()||this._wijgrid.options.selectionMode.toLowerCase()==="none")return;var t=this._view.getVisibleContentAreaBounds(),r={x:e.pageX,y:e.pageY},i=e.target&&e.target.tagName!==undefined?e.target.tagName.toLowerCase():undefined,s=n(e.target);(!i||s.is("td.wijgridtd, th.wijgridtd, div.wijmo-wijgrid-innercell"))&&r.x>t.left&&r.x<t.left+t.width&&r.y>t.top&&r.y<t.top+t.height&&(this._attachAdditionalEvents(),this._startPos=r,this._startCellInfo=this._coordToDataCellInfo(this._startPos))},r.prototype._onDocumentMouseMove=function(r){if(!this._startCellInfo||!this._startCellInfo._isValid())return;var i={x:r.pageX,y:r.pageY},s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=this._wijgrid._view(),w=this._wijgrid._rows(),E=e.grid.renderState;this._inProgress||(this._inProgress=Math.abs(this._startPos.x-i.x)>this._gap_to_start||Math.abs(this._startPos.y-i.y)>this._gap_to_start);if(this._inProgress){s=this._coordToDataCellInfo(i);if(!s._isValid())return;this._endCellInfo=s,u=new e.grid.cellInfoRange(this._startCellInfo,this._endCellInfo),u._normalize(),u._clip(this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch));if(u._isValid()&&!u.isEqual(this._prevMouseMoveRange)){this._prevMouseMoveRange=u,a=new e.grid.cellInfoOrderedCollection(this._wijgrid),f=u.bottomRight().rowIndex(),l=u.bottomRight().cellIndex();for(c=u.topLeft().rowIndex();c<=f;c++){m=b._getRowInfoBySketchRowIndex(c);if(m.type&e.grid.rowType.data)for(h=u.topLeft().cellIndex();h<=l;h++)a._appendUnsafe(new e.grid.cellInfo(h,c))}g=-1;for(p=0,d=this._addedCells.length();p<d;p++)o=this._addedCells.item(p),a.indexOf(o)<0&&(this._wijgrid.selection().selectedCells().indexOf(o)<0&&(h=this._view.getCell(o.cellIndexAbs(),o.rowIndexAbs()),h&&(g!==o.rowIndex()&&(m=o.row(),g=o.rowIndex()),v=n(h),y=b._changeCellRenderState(v,E.selected,!1),this._wijgrid.cellStyleFormatter.format(v,o.cellIndex(),o.column(),m,y))),this._addedCells._removeAt(p),p--,d--);g=-1;for(p=0,d=a.length();p<d;p++)o=a.item(p),this._addedCells.indexOf(o)<0&&this._wijgrid.selection().selectedCells().indexOf(o)<0&&this._addedCells._add(o)&&(h=this._view.getCell(o.cellIndexAbs(),o.rowIndexAbs()),h&&(g!==o.rowIndex()&&(m=o.row(),g=o.rowIndex()),v=n(h),y=b._changeCellRenderState(v,E.selected,!0),this._wijgrid.cellStyleFormatter.format(v,o.cellIndex(),o.column(),m,y)))}}},r.prototype._onDocumentMouseUp=function(t){this._detachAdditionalEvents();if(this._inProgress){this._inProgress=!1;if(this._prevMouseMoveRange&&this._prevMouseMoveRange._isValid()){this._wijgrid._changeCurrentCell(t,this._endCellInfo,{changeSelection:!1,setFocus:!1}),(!t.shiftKey||!this._wijgrid.selection()._multipleRangesAllowed()&&this._wijgrid.options.selectionMode.toLowerCase()!=="singleRange")&&this._wijgrid.selection()._startNewTransaction(this._startCellInfo),this._wijgrid.selection().beginUpdate(),this._wijgrid.selection()._selectRange(this._prevMouseMoveRange,t.shiftKey,t.ctrlKey,e.grid.cellRangeExtendMode.none,this._endCellInfo),this._wijgrid.selection().endUpdate();var r=this._wijgrid._view(),i=-1,s,o=e.grid.renderState;for(var u=0,a=this._addedCells.length();u<a;u++){var f=this._addedCells.item(u);if(this._wijgrid.selection().selectedCells().indexOf(f)<0){var l=r.getCell(f.cellIndexAbs(),f.rowIndexAbs());if(l!==null){i!==f.rowIndex()&&(s=f.row(),i=f.rowIndex());var c=n(l),h=r._changeCellRenderState(c,o.selected,!1);this._wijgrid.cellStyleFormatter.format(c,f.cellIndex(),f.column(),s,h)}}}return this._addedCells._clear(),this._startCellInfo=this._endCellInfo=this._prevMouseMoveRange=null,!1}}},r.prototype._attachAdditionalEvents=function(){if(!this._additionalEventsAttached)try{this._view.toggleDOMSelection(!1),n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this))}finally{this._additionalEventsAttached=!0}},r.prototype._detachAdditionalEvents=function(){if(this._additionalEventsAttached)try{this._view.toggleDOMSelection(!0),n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp)}finally{this._additionalEventsAttached=!1}},r.prototype._eventKey=function(t){return e.grid.stringFormat(this._evntFormat,t)},r.prototype._coordToDataCellInfo=function(t){var n=0,r=this._visLeavesLen-1,i=0,s=-1,o,u=new e.grid.rowAccessor(this._view,2,0,0),a,f,l,c;while(n<=r){i=(r-n>>1)+n,o=e.grid.bounds(this._view.getHeaderCell(i)),o||(f=u.item(0),o=e.grid.bounds(e.grid.rowAccessor.getCell(f,i)));if(!o)break;if(t.x<o.left)r=i-1;else{if(!(t.x>o.left+o.width)){s=i;break}n=i+1}}if(s===-1)return e.grid.cellInfo.outsideValue;u=new e.grid.rowAccessor(this._view,0,0,0),a=-1,n=0,r=u.length()-1,i=0;while(n<=r){i=(r-n>>1)+n,f=u.item(i),o=e.grid.bounds(e.grid.rowAccessor.getCell(f,0));if(t.y<o.top)r=i-1;else{if(!(t.y>o.top+o.height)){a=i;break}n=i+1}}return a===-1?e.grid.cellInfo.outsideValue:(c=new e.grid.cellInfo(s,a,this._wijgrid,!0),c)},r}();t.uiSelection=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(e,t,n,r){this._view=e,this._scope=t,this._offsetBottom=r,this._offsetTop=n}return e.prototype.item=function(e){var t=this.length();return e<t?this._view.getJoinedRows(e+this._offsetTop,this._scope):null},e.prototype.length=function(){var e=this._view.getJoinedTables(!0,0),t=0,n;if(n=e[0])t=n.getSectionLength(this._scope);if(n=e[1])t+=n.getSectionLength(this._scope);return t-=this._offsetTop+this._offsetBottom,t<0&&(t=0),t},e.iterateCells=function(t,n,r){if(t&&n){var i=0,s,o,u,a,f,l;for(s=0,o=t.length;s<o;s++){u=t[s];if(u)for(a=0,f=u.cells.length;a<f;a++){l=n(u.cells[a],i++,r);if(l!==!0)return}}}},e.getCell=function(t,n){var r,i;if(t&&(r=t[0])){i=r.cells.length;if(n<i)return r.cells[n];n-=i;if(r=t[1]){i=r.cells.length;if(n<i)return r.cells[n]}}return null},e.cellsCount=function(t){var n=0,r;if(t&&(r=t[0])){n=r.cells.length;if(r=t[1])n+=r.cells.length}return n},e}();e.rowAccessor=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){this._timeout=25}return t.prototype.currentCellEditStart=function(t,r){var i=!1,s=t.currentCell(),o=t._view(),u,a,f,l;if(s._isValid()&&!s._isEdit()&&s.column().dataIndex>=0){u=s.row();if(u){l=u.type;if(l&e.grid.rowType.data){a={cell:s,event:r,handled:!1};if(i=t._trigger("beforeCellEdit",null,a))a.handled||(i=this._defaultBeforeCellEdit(t,a));i&&(s._isEdit(!0),t._showRowHeader()&&(f=n(u.$rows[0].cells[0]).children("div.wijmo-wijgrid-innercell"),f.length&&(f.empty(),f.append(n("<div>&nbsp;</div>").addClass(t.options.wijCSS.icon+" ui-icon-pencil")))))}}}return i},t.prototype.currentCellEditEnd=function(t,r){var i=t.currentCell(),s=i.column(),o=!1,u=t._view(),a,f,l,c,h,p,d=e.getKeyCodeEnum(),v;if(!i._isValid()||!i._isEdit())return;a=i.row();if(a){f=a.type;if(!(f&e.grid.rowType.data))return o;l=r&&r.which===d.ESCAPE;if(!r||!l){var m={cell:i,value:undefined};if(o=t._trigger("beforeCellUpdate",null,m)){m.value===undefined&&(m.value=this._getCellValue(t,i)),c=m.value,h=i.value();try{v=this._getHTMLInputElementType(i),e.grid.HTML5InputSupport.isExtendSupportRequired(v)?(m.value=e.grid.HTML5InputSupport.parse(m.value,v),m.value=e.grid.HTML5InputSupport.extend(h,m.value,v)):m.value=t.parse(i.column(),m.value),c=m.value}catch(g){m.value=c}e.grid.getDataType(s)==="datetime"&&(c instanceof Date&&(c=c.getTime()),h instanceof Date&&(h=h.getTime()));if(c!==h){try{i.value(m.value)}catch(g){var y={cell:i,value:m.value};o=!1,t._trigger("invalidCellValue",null,y)}if(o){var b={cell:i};t._trigger("afterCellUpdate",null,b)}}}}else o=!0;if(o){var w={cell:i,event:r,handled:!1};t._trigger("afterCellEdit",null,w),w.handled||(o=this._defaultAfterCellEdit(t,w)),o&&i._isEdit(!1),t._showRowHeader()&&n(a.$rows[0].cells[0]).children("div.wijmo-wijgrid-innercell").html("&nbsp;"),window.setTimeout(function(){t._destroyed||(i=t.currentCell(),(p=i.tableCell())?n(p).attr("tabIndex",0).focus():n(t._view().focusableElement()).focus())},this._timeout)}}return o},t.prototype._defaultBeforeCellEdit=function(t,r){var i=r.cell.column(),s=!1,o,u,a,f,l,c,h=e.getKeyCodeEnum(),p=e.grid.HTML5InputSupport.getDefaultInputType(t._isMobileEnv(),i);if(i.dataIndex>=0){o=r.cell.value(),s=!0;try{a=r.cell.container();if(e.grid.getDataType(i)==="boolean"){var d=a.children("span");d.length&&d.prop("disabled")&&(n.data(d[0],"disabledSpan",!0),d.prop("disabled",!1)),f=a.find(":checkbox"),f.prop("disabled",!1),f.focus(),r.event&&r.event.type==="keypress"&&f.one("keyup",function(e){e.which===h.SPACE&&(e.preventDefault(),f[0].checked=!o)})}else{f=n("<input />").attr("type",p).addClass("wijgridinput wijmo-wijinput "+t.options.wijCSS.stateFocus).bind("keydown",t,n.proxy(this._checkBoxOrInputKeyDown,this)),f.bind(n.support.selectstart?"selectstart":"mousedown",function(e){e.stopPropagation()});if(r.event&&r.event.type==="keypress"&&r.event.which)f.val(String.fromCharCode(r.event.which));else switch(e.grid.getDataType(i)){case"currency":case"number":if(o!==null){f.val(o);break};case"datetime":if(e.grid.HTML5InputSupport.isExtendSupportRequired(p)){f.val(e.grid.HTML5InputSupport.toStr(o,p));break};default:f.val(t.toStr(i,o))}a.empty().append(f),l=f.val().length,p==="text"&&(new e.grid.domSelection(f[0])).setSelection({start:l,end:l}),f.focus(),setTimeout(function(){f.focus()},this._timeout*2)}}catch(v){alert(v.message),s=!1}}return s},t.prototype._defaultAfterCellEdit=function(t,r){var i=r.cell.column(),s=!1,o,u,a,f,l;if(i.dataIndex>=0){s=!0,l=t._view();try{o=r.cell.container(),u=t.toStr(i,r.cell.value()),f=l._getRowInfoBySketchRowIndex(r.cell.rowIndex());if(e.grid.getDataType(i)==="boolean"){var c=o.children("span"),h=c.length&&n.data(c[0],"disabledSpan");a=o.find(":checkbox"),u==="true"?a.attr("checked","checked"):a.removeAttr("checked"),h&&(c.prop("disabled",!0),a.prop("disabled",!0))}else t.cellFormatter.format(n(r.cell.tableCell()),o,i,u,f)}catch(p){alert("defaultAfterCellEdit: "+p.message),s=!1}}return s},t.prototype._checkBoxOrInputKeyDown=function(t){var n=e.getKeyCodeEnum();if(t.which===n.ENTER){var r=t.data;if(r)return r._endEditInternal(t),!1}},t.prototype._getCellValue=function(e,t){var n=t.container().find(":input:first"),r=null;return n.length&&(r=n.attr("type")==="checkbox"?n[0].checked:n.val()),r},t.prototype._getHTMLInputElementType=function(e){return e.container().find(":input:first").attr("type")},t}();t.cellEditorHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t._div=document.createElement("div"),t.prototype.format=function(t,r,i,s,o){o.type&e.grid.rowType.footer&&(i.aggregate&&i.aggregate!=="none"?s=e.grid.stringFormat(i.footerText||"{0}",i._totalsValue||""):s=i.footerText||i._footerTextDOM||"");var u=!0,a=null,f={$container:r,column:i,formattedValue:s,row:o,afterDefaultCallback:null},l=i.owner,c=e.grid.rowType;if((o.type&c.data||o.type===c.groupFooter||o.type===c.groupHeader)&&l._allowVirtualScrolling()){var h=l.options.rowHeight>0?l.options.rowHeight:0;r.css({overflow:"hidden",height:h||e.grid.fixedView.defaultRowHeight})}n.isFunction(i.cellFormatter)&&(u=!i.cellFormatter(f));if(u){if(o.type===e.grid.rowType.groupHeader||o.type===e.grid.rowType.groupFooter)a=this._defFormatGroupCell;else switch(e.grid.getDataType(i)){case"boolean":a=this._boolFormatter;break;default:a=this._textFormatter}a&&(a.call(this,f),n.isFunction(f.afterDefaultCallback)&&f.afterDefaultCallback(f))}},t.prototype._textFormatter=function(t){var n;switch(t.row.type){case e.grid.rowType.filter:this._defFormatFilterCell(t);break;default:this._updateHTML(t)}},t.prototype._boolFormatter=function(t){var n,r,i="disabled='disabled'",s,o,u=e.grid.rowType,a=e.getKeyCodeEnum();switch(t.row.type){case u.data:case u.data|u.dataAlt:n=t.column.owner,r=n.options.allowEditing&&t.column.readOnly!==!0,r&&(i=""),n.parse(t.column,n._dataViewWrapper.getValue(t.row.data,t.column.dataKey))===!0?t.$container.html("<input class='wijgridinput' type='checkbox' checked='checked' "+i+" />"):t.$container.html("<input class='wijgridinput' type='checkbox' "+i+" />"),r&&t.$container.children("input").bind("mousedown",function(e){s=t.$container.parent()[0],o=n.currentCell(),o.tableCell()!==s&&n._onClick({target:s}),o._isEdit()||n.beginEdit()}).bind("keydown",function(e){if(e.which===a.ENTER)return n._endEditInternal(e),!1});break;default:this._textFormatter(t)}},t.prototype._defFormatFilterCell=function(e){var t=e.column.owner,n=t.options.wijCSS;e.$container.addClass(n.widget+" "+n.stateDefault),e.column.dataIndex>=0&&!e.column.isBand&&e.column.showFilter?e.$container.html('<table cellPadding="0" cellSpacing="0" class="wijmo-wijgrid-filter '+n.cornerAll+'"><tr><td style="width:100%"><input type="text" class="wijmo-wijgrid-filter-input" style="width:100%" /></td><td class="wijmo-wijgrid-filter-trigger '+n.cornerRight+" "+n.stateDefault+'"><span class="'+n.icon+" "+n.iconArrowDown+'"></span></td></tr></table>'):e.$container.html("&nbsp;")},t.prototype._defFormatGroupCell=function(e){this._updateHTML(e)},t.prototype._updateHTML=function(t){var n=t.$container[0];if(n.firstChild)while(n.firstChild)n.removeChild(n.firstChild);e.grid.cellFormatterHelper._div.innerHTML=t.formattedValue||"&nbsp;";while(e.grid.cellFormatterHelper._div.firstChild)n.appendChild(e.grid.cellFormatterHelper._div.firstChild)},t}();t.cellFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){this.MIN_WIDTH=5,this._elements=[],this._gap=10,this._step=1,this._inProgress=!1,this._hoveredField=null,this._startLocation=null,this._lastLocation=null,this._proxy=null,this._wijgrid=e,this._evntFormat="{0}."+this._wijgrid.widgetName+".resizer"}return t.prototype.addElement=function(e){e&&e.element&&(e.element.bind(this._eventKey("mousemove"),n.proxy(this._onMouseMove,this)).bind(this._eventKey("mousedown"),n.proxy(this._onMouseDown,this)).bind(this._eventKey("mouseout"),n.proxy(this._onMouseOut,this)),this._elements.push(e))},t.prototype.dispose=function(){var e=this;n.each(this._elements,function(t,n){n.element.unbind(e._eventKey("mousemove"),e._onMouseMove).unbind(e._eventKey("mousedown"),e._onMouseDown).unbind(e._eventKey("mouseout"),e._onMouseOut)}),this._detachDocEvents()},t.prototype.inProgress=function(){return this._inProgress},t.prototype._onMouseMove=function(e){if(!this._inProgress){var t=this._getFieldByPos({x:e.pageX,y:e.pageY});t&&t._canSize()&&this._wijgrid._canInteract()?(t.element.css("cursor","e-resize"),this._hoveredField=t,e.stopPropagation()):this._onMouseOut(e)}},t.prototype._onMouseOut=function(e){this._inProgress||this._hoveredField&&(this._hoveredField.element.css("cursor",""),this._hoveredField=null)},t.prototype._onMouseDown=function(t){this._hoveredField=this._getFieldByPos({x:t.pageX,y:t.pageY});if(this._hoveredField&&this._hoveredField._canSize()&&this._wijgrid._canInteract())try{this._hoveredField.element.css("cursor",""),this._docCursor=document.body.style.cursor,document.body.style.cursor="e-resize",this._startLocation=this._lastLocation=e.grid.bounds(this._hoveredField.element),this._proxy=n('<div class="wijmo-wijgrid-resizehandle '+this._wijgrid.options.wijCSS.stateHightlight+'">&nbsp;</div>');var r=this._wijgrid._view().getVisibleAreaBounds();this._proxy.css({left:t.pageX,top:this._startLocation.top,height:r.height+r.top-this._startLocation.top}),n(document.body).append(this._proxy)}finally{this._attachDocEvents(),this._inProgress=!0,t.stopPropagation()}},t.prototype._onDocumentMouseMove=function(e){var t=this._step*Math.round((e.pageX-this._lastLocation.left)/this._step);this._lastLocation={left:this._lastLocation.left+t,top:e.pageY,width:undefined,height:undefined},this._proxy.css("left",this._lastLocation.left)},t.prototype._onDocumentMouseUp=function(e){try{document.body.style.cursor=this._docCursor,this._proxy.remove(),this._startLocation!==this._lastLocation&&this._wijgrid._fieldResized(this._hoveredField,this._startLocation.width,Math.max(this._lastLocation.left-this._startLocation.left,this.MIN_WIDTH))}finally{this._hoveredField=null,this._proxy=null,this._detachDocEvents(),this._inProgress=!1}},t.prototype._onSelectStart=function(e){e.preventDefault()},t.prototype._attachDocEvents=function(){this._inProgress||(n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this)),n.fn.disableSelection&&n(document.body).disableSelection(),"onselectstart"in document&&n(document.body).bind("selectstart",this._onSelectStart))},t.prototype._detachDocEvents=function(){this._inProgress&&(n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp),n.fn.enableSelection&&n(document.body).enableSelection(),"onselectstart"in document&&n(document.body).unbind("selectstart",this._onSelectStart))},t.prototype._getFieldByPos=function(t){var n,r,i,s,o;for(n=0,r=this._elements.length;n<r;n++){i=this._elements[n],s=e.grid.bounds(i.element),o=e.grid.isOver(t.y,t.x,s.top,s.left+s.width-this._gap,s.height,this._gap);if(o)return i}return null},t.prototype._eventKey=function(t){return e.grid.stringFormat(this._evntFormat,t)},t}();t.uiResizer=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._scope_guid="scope_"+e.grid.getUID(),this._dragEnd=!1,this.mZIndex=1e3,this._wijgrid=t,this._wijCSS=this._wijgrid.options.wijCSS,this._wrapHtml='<div class="'+this._wijCSS.widget+" wijmo-wijgrid "+this._wijCSS.content+" "+this._wijCSS.cornerAll+'">'+'<table class="wijmo-wijgrid-root wijmo-wijgrid-table">'+'<tr class="wijmo-wijgrid-headerrow">'+"</tr>"+"</table>"+"</div>"}return t.prototype.attachGroupArea=function(e){var t,r=this;if(!n.ui.droppable||!n.ui.draggable)return;e.droppable({scope:this._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(r._wijgrid.options.allowColMoving){t=r._getWijFieldInstance(e);if(t)return t instanceof n.wijmo.c1groupedfield&&t.options.groupedIndex===r._wijgrid._groupedColumns().length-1?!1:!t.options.isBand&&(t.options.groupedIndex===undefined||t instanceof n.wijmo.c1groupedfield)}return!1},drop:function(e,n){!r._isInElement(e,n.draggable)&&(t=r._getWijFieldInstance(n.draggable))&&(r._dragEnd=!0)},over:function(t,n){var i=r._wijgrid._field("groupedWidgets").length;r._dropTargetRedirected=i>0,r._droppableWijField=i>0?r._wijgrid._field("groupedWidgets")[i-1]:e,e.data("thisDroppableWijField",r._droppableWijField)},out:function(t,n){r._droppableWijField===e.data("thisDroppableWijField")&&(r._droppableWijField=null)}})},t.prototype.attach=function(t){var r,i,s=this;if(!n.ui.droppable||!n.ui.draggable)return;if(!t||!(r=t.element))return;r.draggable({helper:function(i){var o;return t instanceof n.wijmo.c1groupedfield?o=r.clone():o=r.clone().wrap(s._wrapHtml).width(r.width()).height(r.height()).closest(".wijmo-wijgrid"),o.addClass("wijmo-wijgrid-dnd-helper").css("z-index",s.mZIndex=e.grid.getZIndex(s._wijgrid.outerDiv,1e3)),o},appendTo:"body",scope:s._scope_guid,drag:function(e,n){s._hideArrows();if(s._droppableWijField&&!s._isInElement(e,r)){var i=s._droppableWijField.element;i||(i=s._droppableWijField),s._showArrows(i,s._getPosition(t,s._droppableWijField,e,n))}},start:function(r,i){if(s._wijgrid._canInteract()&&s._wijgrid.options.allowColMoving&&(s._wijgrid._UIResizer()==null||!s._wijgrid._UIResizer().inProgress())){var o=t.options,u=t.options.travIdx,a=t instanceof n.wijmo.c1groupedfield,f=a?"groupArea":"columns";a&&(o=e.grid.search(s._wijgrid.columns(),function(e){return e.options.travIdx===u}),o=o.found?o.found.options:e.grid.getColumnByTravIdx(s._wijgrid.options.columns,u).found);if(t._canDrag()&&s._wijgrid._trigger("columnDragging",null,{drag:o,dragSource:f}))return s._wijgrid._trigger("columnDragged",null,{drag:o,dragSource:f}),!0}return!1},stop:function(e,r){s._hideArrows();try{s._dragEnd&&(s._droppableWijField.element?s._wijgrid._handleDragnDrop(t.options.travIdx,s._droppableWijField.options.travIdx,s._getPosition(t,s._droppableWijField,e,r),t instanceof n.wijmo.c1groupedfield,s._droppableWijField instanceof n.wijmo.c1groupedfield):s._wijgrid._handleDragnDrop(t.options.travIdx,-1,"left",t instanceof n.wijmo.c1groupedfield,!0))}finally{s._droppableWijField=null,s._dragEnd=!1}}}).droppable({hoverClass:s._wijCSS.stateHover,scope:s._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(s._wijgrid.options.allowColMoving&&r[0]!==e[0]){i=s._getWijFieldInstance(e);if(i)return i._canDropTo(t)}return!1},drop:function(e,t){if(i=s._getWijFieldInstance(t.draggable))s._dragEnd=!0},over:function(e,n){s._dropTargetRedirected=!1,s._droppableWijField=t,r.data("thisDroppableWijField",s._droppableWijField)},out:function(e,n){s._droppableWijField===t.element.data("thisDroppableWijField")&&(s._droppableWijField=null)}})},t.prototype.detach=function(e){var t;e&&(t=e.element)&&(t.data("ui-draggable")&&t.draggable("destroy"),t.data("ui-droppable")&&t.droppable("destroy"))},t.prototype.dispose=function(){this._$topArrow&&(this._$topArrow.remove(),this._$topArrow=null),this._$bottomArrow&&(this._$bottomArrow.remove(),this._$bottomArrow=null)},t.prototype._getWijFieldInstance=function(t){var n=e.grid.widgetName(t);if(!n)throw"widgetName is undedined";return t.data(n)},t.prototype._showArrows=function(e,t){this._topArrow().css("z-index",this.mZIndex).show().position({my:"center",at:t+" top",of:e,collision:"none"}),this._bottomArrow().css("z-index",this.mZIndex).show().position({my:"center",at:t+" bottom",of:e,collision:"none"})},t.prototype._hideArrows=function(){this._topArrow().hide(),this._bottomArrow().hide()},t.prototype._topArrow=function(){return this._$topArrow||(this._$topArrow=n("<div />").addClass("wijmo-wijgrid-dnd-arrow-top").append(n("<span />").addClass(this._wijCSS.icon+" ui-icon-arrowthick-1-s")).hide().appendTo(document.body)),this._$topArrow},t.prototype._bottomArrow=function(){return this._$bottomArrow||(this._$bottomArrow=n("<div />").addClass("wijmo-wijgrid-dnd-arrow-bottom").append(n("<span />").addClass(this._wijCSS.icon+" ui-icon-arrowthick-1-n")).hide().appendTo(document.body)),this._$bottomArrow},t.prototype._isInElement=function(t,n){var r=e.grid.bounds(n,!1);return t.pageX>r.left&&t.pageX<r.left+r.width&&t.pageY>r.top&&t.pageY<r.top+r.height},t.prototype._getPosition=function(t,r,i,s){if(!r.element)return"left";if(this._dropTargetRedirected)return"right";var o=e.grid.bounds(r.element,!1),u=o.width/6,a=o.left+o.width/2,f="right",l;return i.pageX<a&&(f="left"),r instanceof n.wijmo.c1groupedfield?(t instanceof n.wijmo.c1groupedfield&&(l=r.options.groupedIndex-t.options.groupedIndex,Math.abs(l)===1&&(f=l<0?"left":"right")),f):(l=r.options.linearIdx-t.options.linearIdx,r.options.isBand&&t.options.parentIdx!==r.options.travIdx&&Math.abs(i.pageX-a)<u?"center":(t.options.parentIdx===r.options.parentIdx&&Math.abs(l)===1&&(f=l<0?"left":"right"),f))},t}();t.uiDragndrop=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i,s,o,u,a){var f=e.grid.renderState,l=e.grid.rowType,c=s.type,h,p=null;r===0&&this._wijgrid._showRowHeader()&&(i=null);if(c===l.groupHeader||c===l.groupFooter)i=null,u&&(p=u.groupInfo)&&(i=this._wijgrid._field("leaves")[p.leafIndex]);h={$cell:t,state:o,row:s,column:i,_cellIndex:r,_purpose:p?p.purpose:undefined},o===f.rendering?this._renderingStateFormatter(h,u,a):(this._currentStateFormatter(h,o&f.current),this._selectedStateFormatter(h,o&f.selected)),n.isFunction(this._wijgrid.options.cellStyleFormatter)&&this._wijgrid.options.cellStyleFormatter(h)},t.prototype._renderingStateFormatter=function(t,n,r){var i=e.grid.rowType,s,o,u=t.column,a=t.row.type;switch(a){case i.header:t.$cell.addClass("wijgridth");break;default:t.$cell.addClass("wijgridtd")}if(a&i.data&&u&&u.textAlignment)switch(u.textAlignment.toLowerCase()){case"left":t.$cell.addClass("wijalign-left");break;case"right":t.$cell.addClass("wijalign-right");break;case"center":t.$cell.addClass("wijalign-center")}if(n)for(s in n)if(n.hasOwnProperty(s)){o=n[s];if(!(s!=="colSpan"&&s!=="rowSpan"||o>1))continue;s==="class"?t.$cell.addClass(o):t.$cell.attr(s,o)}if(r)for(s in r)if(r.hasOwnProperty(s)){if(s==="paddingLeft"){t.$cell.children(".wijmo-wijgrid-innercell").css(s,r[s]);continue}t.$cell.css(s,r[s])}if(t._cellIndex===0&&this._wijgrid._showRowHeader())t.$cell.attr({role:"rowheader",scope:"row"}).addClass(this._wijgrid.options.wijCSS.stateDefault+" "+this._wijgrid.options.wijCSS.content+" wijmo-wijgrid-rowheader");else switch(a){case i.header:t.$cell.attr({role:"columnheader",scope:"col"});break;case i.footer:t.$cell.attr({role:"columnfooter",scope:"col"});break;default:t.$cell.attr("role","gridcell")}a&i.data&&t._cellIndex>=0&&u&&(t.$cell.attr("headers",window.escape(u.headerText)),u.readOnly&&t.$cell.attr("aria-readonly",!0),u.dataIndex>=0&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))),(a===i.groupHeader||a===i.groupFooter)&&u&&t._purpose===e.grid.groupRowCellPurpose.aggregateCell&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))},t.prototype._currentStateFormatter=function(t,n){var r=e.grid.rowType;n?(t.$cell.addClass(this._wijgrid.options.wijCSS.stateActive),t.row.type===r.header?t.$cell.addClass("wijmo-wijgrid-current-headercell"):t.$cell.addClass("wijmo-wijgrid-current-cell")):(t.$cell.removeClass(this._wijgrid.options.wijCSS.stateActive),t.row.type===r.header?t.$cell.removeClass("wijmo-wijgrid-current-headercell"):t.$cell.removeClass("wijmo-wijgrid-current-cell"))},t.prototype._hoveredStateFormatter=function(e,t){t},t.prototype._selectedStateFormatter=function(e,t){t?e.$cell.addClass(this._wijgrid.options.wijCSS.stateHightlight).attr("aria-selected","true"):e.$cell.removeClass(this._wijgrid.options.wijCSS.stateHightlight).removeAttr("aria-selected")},t}();t.cellStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i){var s=e.grid.renderState,o=e.grid.rowType,u=t.state,a=t;u===s.rendering?this._renderingStateFormatter(a,r,i):(this._currentStateFormatter(a,(u&s.current)!==0),this._hoveredStateFormatter(a,(u&s.hovered)!==0),this._selectedStateFormatter(a,(u&s.selected)!==0)),n.isFunction(this._wijgrid.options.rowStyleFormatter)&&this._wijgrid.options.rowStyleFormatter(a)},t.prototype._renderingStateFormatter=function(t,r,i){var s="wijmo-wijgrid-row "+this._wijgrid.options.wijCSS.content,o="wijmo-wijgrid-row "+this._wijgrid.options.wijCSS.content,u=e.grid.rowType,a;t.$rows.attr("role","row");if(r)for(a in r)r.hasOwnProperty(a)&&(a==="class"?t.$rows.addClass(r[a]):(t.$rows.attr(a,r[a]),t.$rows[0].style.height&&t.$rows.each(function(){return n.data(this,"customHeight",this.style.height),!0})));if(i)for(a in i)i.hasOwnProperty(a)&&t.$rows.css(a,i[a]);switch(t.type&~u.dataAlt){case u.header:s="wijmo-wijgrid-headerrow";break;case u.data:s=o+" wijmo-wijgrid-datarow",t.type&u.dataAlt&&(s+=" wijmo-wijgrid-alternatingrow");break;case u.emptyDataRow:s=o+" wijmo-wijgrid-emptydatarow";break;case u.filter:s="wijmo-wijgrid-filterrow";break;case u.groupHeader:s=o+" wijmo-wijgrid-groupheaderrow";break;case u.groupFooter:s=o+" wijmo-wijgrid-groupfooterrow";break;case u.footer:s="wijmo-wijgrid-footerrow "+this._wijgrid.options.wijCSS.stateHightlight;break;default:throw e.grid.stringFormat("unknown rowType: {0}",t.type)}t.$rows.addClass(s)},t.prototype._currentStateFormatter=function(e,t){this._wijgrid._showRowHeader()&&(t?n(e.$rows[0].cells[0]).addClass(this._wijgrid.options.wijCSS.stateActive+" wijmo-wijgrid-current-rowheadercell"):n(e.$rows[0].cells[0]).removeClass(this._wijgrid.options.wijCSS.stateActive+" wijmo-wijgrid-current-rowheadercell"))},t.prototype._hoveredStateFormatter=function(e,t){t?e.$rows.addClass(this._wijgrid.options.wijCSS.stateHover):e.$rows.removeClass(this._wijgrid.options.wijCSS.stateHover)},t.prototype._selectedStateFormatter=function(e,t){t},t}();t.rowStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(){this._sum=0,this._sum2=0,this._cntNumbers=0,this._cntStrings=0,this._cntDates=0,this._max=0,this._min=0,this._minDate=0,this._maxDate=0}return e.prototype.add=function(e){if(e===null||e==="")return;var t,n=e instanceof Date?"datetime":typeof e;t=e.toString(),this._cntStrings++===0&&(this._minString=this._maxString=t),t<this._minString&&(this._minString=t),t>this._maxString&&(this._maxString=t),n==="number"?(this._cntNumbers++===0&&(this._min=this._max=e),this._sum+=e,this._sum2+=e*e,e<this._min&&(this._min=e),e>this._max&&(this._max=e)):n==="datetime"&&(t=e.getTime(),this._cntDates++===0&&(this._minDate=this._maxDate=t),t<this._minDate&&(this._minDate=t),t>this._maxDate&&(this._maxDate=t))},e.prototype.getValueString=function(e){var t=e.owner;if(!this._cntNumbers||e.dataType!=="number"&&e.dataType!=="currency"){if(this._cntDates&&e.dataType==="datetime")switch(e.aggregate){case"max":return t.toStr(e,new Date(this._maxDate));case"min":return t.toStr(e,new Date(this._minDate));case"count":return this._cntStrings+""}if(this._cntStrings)switch(e.aggregate){case"max":return this._maxString;case"min":return this._minString;case"count":return this._cntStrings+""}return""}var n=this._getValue(e.aggregate);return t.toStr(e,n)},e.prototype._getValue=function(e){switch(e){case"average":return this._cntNumbers===0?0:this._sum/this._cntNumbers;case"count":return this._cntStrings;case"max":return this._max;case"min":return this._min;case"sum":return this._sum;case"std":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("var"));case"stdPop":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("varPop"));case"var":if(this._cntNumbers<=1)return 0;return this._getValue("varPop")*this._cntNumbers/(this._cntNumbers-1);case"vapPop":if(this._cntNumbers<=1)return 0;var t=this._sum/this._cntNumbers;return this._sum2/this._cntNumbers-t*t}return 0},e}();e.tally=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._docEventsUID="wijgridfrozener"+e.grid.getUID(),this._docEventsAttached=!1,this._newStaticIndex=-1,this._staticColumnIndex=-1,this._staticRowIndex=-1,this._staticOffsetH=0,this._staticOffsetV=0,this._inProgress=!1,this._wijgrid=t,this.refresh()}return t.prototype.inProgress=function(){return this._inProgress},t.prototype.refresh=function(){this.dispose();var t=this._wijgrid.options.freezingMode;if(t!=="none"){this._$outerDiv=this._wijgrid.outerDiv.find(".wijmo-wijgrid-fixedview"),this._superPanel=this._wijgrid._view()._getSuperPanel(),this._staticOffsetH=this._wijgrid._getStaticOffsetIndex(!1),this._staticOffsetV=this._wijgrid._getStaticOffsetIndex(!0),this._staticColumnIndex=this._wijgrid._getStaticIndex(!1),this._staticRowIndex=this._wijgrid._getStaticIndex(!0),this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds();var n=e.grid.bounds(this._$outerDiv.find(".wijmo-wijgrid-split-area-nw")),r=e.grid.bounds(this._$outerDiv);(t==="both"||t==="columns")&&(this._wijgrid.options.staticColumnsAlignment!=="right"||this._staticColumnIndex>=0)&&this._createVBar(this._visibleBounds,n,r),(t==="both"||t==="rows")&&!this._wijgrid._serverSideVirtualScrolling()&&this._createHBar(this._visibleBounds,n,r)}},t.prototype.dispose=function(){this._$hBar&&(this._$hBar.remove(),this._$hBar=null),this._$vBar&&(this._$vBar.remove(),this._$vBar=null),this._$proxy&&(this._$proxy.remove(),this._$proxy=null),this._$outerDiv=null,this._superPanel=null,this._detachDocEvents()},t.prototype._createVBar=function(e,t,r){var i=this._wijgrid.options.staticColumnsAlignment!=="right",s=i?t.width+t.left:t.left-2,o=this;s<=e.left+e.width&&(this._$vBar=n("<div><div></div></div>").addClass("wijmo-wijgrid-freezing-handle-v").addClass(i?"":"not-allowed").css({left:s-r.left,top:t.top-r.top,height:e.height+e.top-t.top}).bind("mousedown",function(e){e.data=!0,o._onBarMouseDown.apply(o,arguments)}).appendTo(this._$outerDiv),this._$vBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:0,height:"100%"}))},t.prototype._createHBar=function(e,t,r){var i=t.top+t.height,s=this._wijgrid.options.staticColumnsAlignment!=="right",o=this;i<=e.top+e.height&&(this._$hBar=n("<div><div></div></div>").addClass("wijmo-wijgrid-freezing-handle-h").css({left:s?t.left-r.left:0,top:i-r.top,width:s?e.width+e.left-t.left:e.width}).bind("mousedown",function(e){e.data=!1,o._onBarMouseDown.apply(o,arguments)}).appendTo(this._$outerDiv),this._$hBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:"100%",height:0}))},t.prototype._onBarMouseDown=function(e){if(this._wijgrid.options.disabled||this._wijgrid.options.staticColumnsAlignment==="right"&&e.data)return!1;this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds(),this._newStaticIndex=e.data?this._staticColumnIndex:this._staticRowIndex,this._$proxy=n('<div class="wijmo-wijgrid-resizehandle '+this._wijgrid.options.wijCSS.header+'"></div>').appendTo(document.body),this._attachDocEvents(e.data),this._inProgress=!0,e.stopPropagation()},t.prototype._onDocumentMouseMove=function(e){e.data&&this._superPanel.options.hScroller.scrollValue?this._superPanel.hScrollTo(0):!e.data&&this._superPanel.options.vScroller.scrollValue&&this._superPanel.vScrollTo(0),this._showPosition(e)},t.prototype._onDocumentMouseUp=function(e){try{this._$proxy&&this._$proxy.remove(),this._detachDocEvents(),e.data?this._newStaticIndex!==this._staticColumnIndex&&this._wijgrid.option("staticColumnIndex",this._newStaticIndex):this._newStaticIndex!==this._staticRowIndex&&this._wijgrid.option("staticRowIndex",this._newStaticIndex)}finally{this._$proxy=null,this._inProgress=!1}},t.prototype._attachDocEvents=function(e){if(!this._docEventsAttached)try{n.fn.disableSelection&&n(document.body).disableSelection(),this._wijgrid._view().toggleDOMSelection(!1),n(document).bind(this._docEventKey("mousemove"),e,n.proxy(this._onDocumentMouseMove,this)).bind(this._docEventKey("mouseup"),e,n.proxy(this._onDocumentMouseUp,this))}finally{this._docEventsAttached=!0}},t.prototype._detachDocEvents=function(){if(this._docEventsAttached)try{n.fn.enableSelection&&n(document.body).enableSelection(),this._wijgrid._view().toggleDOMSelection(!0),n(document).unbind("."+this._docEventsUID)}finally{this._docEventsAttached=!1}},t.prototype._docEventKey=function(t){return e.grid.stringFormat("{0}.{1}",t,this._docEventsUID)},t.prototype._showPosition=function(t){var n,r,i,s,o,u,a,f,l=this._wijgrid.options.staticColumnsAlignment!=="right";if(t.data){f=e.grid.bounds(this._$vBar);if(Math.abs(t.pageX-(f.left+f.width/2))<f.width){this._$proxy.hide();return}if(n=this._getFieldByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(n.element),i=r.left+r.width/2,s=n.options.visLeavesIdx-this._staticOffsetV,o=Math.max(s-1,-1),u=t.pageX<i?o!==this._staticColumnIndex:s===this._staticColumnIndex,a=u?r.left:r.left+r.width;if(!e.grid.isOverAxis(a,this._visibleBounds.left-1,this._visibleBounds.width+2))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:a,top:r.top,width:3,height:this._visibleBounds.height+this._visibleBounds.top-r.top})}}else{f=e.grid.bounds(this._$hBar);if(Math.abs(t.pageY-(f.top+f.height/2))<f.height){this._$proxy.hide();return}if(n=this._getRowByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(n),i=r.top+r.height/2,s=this._wijgrid._view().getAbsoluteRowIndex(n)-this._staticOffsetH,o=Math.max(s-1,-1),u=t.pageY<i?o!==this._staticRowIndex:s===this._staticRowIndex,a=u?r.top:r.top+r.height;if(!e.grid.isOverAxis(a,this._visibleBounds.top-1,this._visibleBounds.height+2))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:l?r.left:this._visibleBounds.left,top:a,width:l?this._visibleBounds.width+this._visibleBounds.left-r.left:this._visibleBounds.width,height:3})}}},t.prototype._getFieldByPos=function(t){var n=this._wijgrid.columns(),r,i,s,o,u;for(r=0,i=n.length;r<i;r++){s=n[r],o=s.options;if(o.isLeaf){u=e.grid.bounds(s.element);if(e.grid.isOverAxis(t.x,u.left,u.width))return s}}return null},t.prototype._getRowByPos=function(t){var r=this._wijgrid._rows(),i,s,o,u;for(i=0,s=r.length();i<s;i++){o=r.item(i)[0],u=e.grid.bounds(n(o));if(e.grid.isOverAxis(t.y,u.top,u.height))return o}return null},t}();t.uiFrozener=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t.generate=function(r,i,s){switch(r){case"append":t._processAppendMode(i,s);break;case"merge":t._processMergeMode(i,s);break;case"none":break;default:throw e.grid.stringFormat('Unsupported value: "{0}"',r)}},t._processAppendMode=function(i,s){var o={};e.grid.traverse(s,function(t){t.dynamic&&e.grid.validDataKey(t.dataKey)&&(o[t.dataKey]=!0)}),n.each(i,function(e,n){if("name"in n&&!o[n.name]){var r=t._createAutoField(n);s.push(r)}})},t._processMergeMode=function(i,s){var o=[],u;e.grid.traverse(s,function(t){if(t.isLeaf&&!t.isBand){var n=t.dataKey;e.grid.validDataKey(n)?i[n]!==undefined&&delete i[n]:n!==null&&o.push(t)}}),o.length&&(u=0,n.each(i,function(e,t){var n=o[u++];n&&(n.dataKey=t.name,delete i[e])})),n.each(i,function(e,n){var r=t._createAutoField(n);s.push(r)})},t._createAutoField=function(n){return e.grid.createDynamicField({dataKey:n.name})},t}();t.columnsGenerator=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(e,t,n,r){this._timer=0,this._timeout=50,this._ignoreScrollEvents=!1,this._debounceScrolledEvent=!0,this._wijgrid=e,this._fixedAreaHeight=n,this._$content=t,this._view=this._wijgrid._view(),this._N=this._wijgrid._renderableRowsCount(),this._rowHeight=r,this._updateContentHeight();var i=this._wijgrid.outerDiv.height()+this._N*this._rowHeight;this._view._splitAreas.sw.height(i)}return e.prototype.scrollTo=function(e,t){this._debounceScrolledEvent=!1,this._completeListener=t,this._panelInst.vScrollTo(e*this._panelInst.options.vScroller.scrollSmallChange,!0)},e.prototype._updateContentHeight=function(){this._$content.height(this._rowHeight*this._N)},e.prototype.attach=function(e){this._$scroller=e,this._panelInst=e.data("wijmo-wijsuperpanel"),this._updateContentHeight(),this._updateVerticalScroller(),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelScrolled,this)),e.bind("wijsuperpanelscrolling.wijgrid",t.proxy(this._onSuperpanelScrolling,this)),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelPostScrolled,this))},e.prototype._updateVerticalScroller=function(){var e=Math.max(0,this._N-(this._view.getVirtualPageSize()-1));this._setVerticalScrollerOptions(1,e)},e.prototype._setVerticalScrollerOptions=function(e,t){var n=this._panelInst.options.vScroller;n.scrollSmallChange=e,n.scrollLargeChange=e*4,t+=n.scrollLargeChange-1,n.scrollMax=t,this._panelInst.option("vScroller",n)},e.prototype._changeVisibleRowsCount=function(e){this._N=e,this._updateContentHeight(),this._updateVerticalScroller()},e.prototype.dispose=function(){this._$scroller.unbind(".wijgrid"),this._clearTimer()},e.prototype._clearTimer=function(){window.clearTimeout(this._timer),this._timer=0},e.prototype._onSuperpanelScrolling=function(e,t){if(this._ignoreScrollEvents||t.dir!=="v")return;if(this._timer===-1)return!1},e.prototype._onSuperpanelScrolled=function(e,n){var r=this;if(this._ignoreScrollEvents||n.dir!=="v")return;this._timer>0&&this._clearTimer(),this._timer!==-1&&(this._timer=window.setTimeout(function(){r._timer=-1;var e=Math.floor(n.newValue/r._panelInst.options.vScroller.scrollSmallChange),i=r._view._bounds.start;e<0&&(e=0),e>=r._N&&(e=r._N-1),e!==i?(r._debounceScrolledEvent=!0,r._wijgrid._handleVirtualScrolling(e,null,t.proxy(r._scrollingCompleted,r))):(r._debounceScrolledEvent=!0,r._log(),r._clearTimer())},this._debounceScrolledEvent?this._timeout:0))},e.prototype._scrollingCompleted=function(e){this._wijgrid._trackScrollingIndex(e),this._log(),this._completeListener&&(this._completeListener(),this._completeListener=null),this._clearTimer()},e.prototype._onSuperpanelPostScrolled=function(){t.isFunction(this._postScrolled)&&this._postScrolled.apply(this,arguments)},e.prototype._log=function(){},e}();e.uiVirtualScroller=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=function(){function e(e){this._items=[],this._capacity=null,this._maxRowIndex=e}return e.prototype.add=function(e){this._capacity=null;var t=this._items.length,n;if(!t||(n=this._items[t-1]).end<e.start)t&&e.start-n.end===1?n.end=e.end:this._items.push(e);else{var r=this._binSearchByStartVal(e.start),i=this._binSearchByEndVal(e.end),s=r<0?~r:r,o=i<0?~i:i,u=r>=0||s>0&&e.start<=this._items[s-1].end,a=i>=0||o<t&&e.end<=this._items[o].end&&e.end>=this._items[o].start,f;u?a?r>=0?(this._items[o].start=this._items[s].start,(f=o-s)&&this._items.splice(s,f)):(this._items[o].start=this._items[s-1].start,(f=o-s+1)&&this._items.splice(s-1,f)):r>=0?(this._items[s].end=e.end,(f=o-s-1)&&this._items.splice(s,f)):(this._items[s-1].end=e.end,(f=o-s)&&this._items.splice(s,f)):a?(this._items[o].start=e.start,(f=o-s)&&this._items.splice(s,f)):this._items.splice(s,o-s,e)}},e.prototype.remove=function(e){this._capacity=null;var t=this._items.length;if(t){var n=this._binSearchByStartVal(e.start),r=this._binSearchByEndVal(e.end),i=n<0?~n:n,s=r<0?~r:r,o=n>=0||i>0&&e.start<=this._items[i-1].end,u=r>=0||s<t&&e.end<=this._items[s].end&&e.end>=this._items[s].start;if(o)if(u){var a=n>=0?n:i-1,f=r>=0?r:s;if(n>=0&&r>=0)this._items.splice(i,s-i+1);else if(n>=0)this._items[s].start=e.end+1,this._items.splice(i,s-i);else if(r>=0)a===f?this._items[i-1].end=e.start-1:(this._items[i].end=e.start-1,this._items.splice(i,s-i+1));else if(a===f){var l=this._items[i-1].end;this._items[i-1].end=e.start-1,this._items.splice(i,0,{start:e.end+1,end:l})}else this._items[i-1].end=e.start-1,this._items[s].start=e.end+1,this._items.splice(i,s-i)}else n>=0?this._items.splice(i,s-i):(this._items[i].end=e.start-1,this._items.splice(i,s-i-1));else u?r>=0?this._items.splice(i,s-i+1):(this._items[s].start=e.end+1,this._items.splice(i,s-i)):this._items.splice(i,s-i)}},e.prototype.clear=function(){this._capacity=0,this._items=[]},e.prototype.item=function(e){return this._items[e]},e.prototype.forEachIndex=function(e,t,n){if(e<0)return;var r=this._items.length,i=this._getIteratorStateFor(e),s=0,o=!0,u=!1;if(i){var a=i.j;for(var f=i.i;f<r&&!u;f++){var l=this._items[f];o||(a=l.start);for(a;a<=l.end&&!u;a++){if(++s>t&&t!==-1)return;u=n(a)===!1}o=!1}}},e.prototype.forEachIndexBackward=function(e,t,n){if(e<0)return;var r=this._items.length,i=this._getIteratorStateFor(e),s=0,o=!0,u=!1;if(i){var a=i.j;for(var f=i.i;f>=0&&!u;f--){var l=this._items[f];o||(a=l.end);for(a;a>=l.start&&!u;a--){if(++s>t&&t!==-1)return;u=n(a)===!1}o=!1}}},e.prototype._getIteratorStateFor=function(e){var t=this._items.length,n=0;for(var r=0;r<t;r++){var i=this._items[r];n+=i.end-i.start+1;var s=n-e;if(s>=0)return{i:r,j:i.end-s+1}}return null},e.prototype.getAbsIndex=function(e){for(var t=0,n=this._items.length;t<n;t++){var r=this._items[t],i=r.end-r.start;if(e<=i)return r.start+e;e-=i+1}return-1},e.prototype.getRenderedIndex=function(e){var t=this.hasAbsIndex(e);if(t>=0){var n=0;for(var r=0;r<t;r++){var i=this._items[r];n+=i.end-i.start+1}return n+(e-this._items[t].start)}return-1},e.prototype.hasAbsIndex=function(e){if(this._items.length){var t=this._binSearchByStartVal(e);if(t>=0)return t;t=~t;if(t>0&&e<=this._items[t-1].end)return t-1}return-1},e.prototype.length=function(){return this._items.length},e.prototype.capacity=function(){if(this._capacity===null){var e=0;for(var t=0,n=this._items.length;t<n;t++){var r=this._items[t];e+=r.end-r.start+1}this._capacity=e}return this._capacity},e.prototype.truncate=function(e,t){this.truncateByStart(e),this.truncateByStart(t)},e.prototype.truncateByCount=function(e){var t=0;if(e===0)this._items=[];else for(var n=0,r=this._items.length;n<r;n++){var i=this._items[n];t+=i.end-i.start+1;if(t>=e){t>e&&(i.end-=t-e),this._items.splice(n+1,this._items.length-(n+1));break}}},e.prototype.truncateByStart=function(e,t){var n=this._binSearchByStartVal(e),r=this._items.length;n<0?(n=~n,n<r?n>0&&this._items[n-1].end>=e?(this._items[n-1].start=e,this._items.splice(0,n-1)):(t&&(this._items[n].start=e),this._items.splice(0,n)):this._items=[]):this._items.splice(0,n)},e.prototype.truncateByEnd=function(e,t){var n=this._binSearchByEndVal(e),r=this._items.length;n<0?(n=~n,n<r?(this._items[n].end=e,this._items.splice(n+1,this._items.length-n+1)):this._items=[]):this._items.splice(n+1,this._items.length-n+1)},e.prototype.deleteFromTop=function(e){var t=0,n=0;for(t=0;t<this._items.length;t++){var r=this._items[t];n+=r.end-r.start+1;if(n>=e)break}n>=e&&(this._items[t].start=n-e+1),this._items.splice(0,t)},e.prototype.deleteFromBottom=function(e){var t=0,n=0;for(t=this._items.length-1;t>=0;t--){var r=this._items[t];n+=r.end-r.start+1;if(n>=e)break}n>=e&&(this._items[t].start=n-e+1),this._items.splice(t,this._items.length-t)},e.prototype._binSearchByStartVal=function(e){var t=0,n=this._items.length-1;while(t<=n){var r=n+t>>1,i=this._items[r].start-e;if(i===0)return r;i<0?t=r+1:n=r-1}return~t},e.prototype._binSearchByEndVal=function(e){var t=0,n=this._items.length-1;while(t<=n){var r=n+t>>1,i=this._items[r].end-e;if(i<0)t=r+1;else{if(!i)return r;n=r-1}}return~t},e}();e.renderBoundsCollection=t})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){function r(n,r,i,s){function u(t){return s.parser=s.parser||e.defaultParsers[t],!s.parser&&n!=null&&e.errors.noParser(t),s.parser}var o=n;s=t.extend({nullString:"",format:""},s),r=r||n!=null&&typeof n,i=i||r;if(!i)return n;if(i=="string")return u(r),s.parser?s.parser.toStr(n,s.culture,s.format,s.nullString,!0):n;u(i);if(!s.parser)return n;n=s.parser.parse(n,s.culture,s.format,s.nullString,!0);if(isNaN(n)&&n!=null&&e.util.isNumeric(n)){if(s.ignoreError)return o;e.errors.cantConvert(i,o)}return n}function i(t){return function(){return n||e.util.logError(e.errors.noGlobalize.create().message),t.apply(this,arguments)}}var t=jQuery,n=Globalize;e.convert=r,e.defaultParsers={string:{parse:function(e,t,n,r,i){switch(e){case null:return null;case r:if(i)return null;case undefined:case"&nbsp":return"";default:return""+e}},toStr:function(e,t,n,r,i){return e===null&&i?r:""+e}},number:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:n.parseFloat(e,10,t.name)},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"n",t.name)}},currency:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:(o==="string"&&(e=e.replace(t.numberFormat.currency.symbol,"")),n.parseFloat(e,10,t.name))},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"c",t.name)}},datetime:{parse:function(e,t,r,i,s){var o;if(e instanceof Date)return e;if(!e||e==="&nbsp;"||e===i&&s)return null;o=/^\/Date\((\d+)\)\/$/.exec(e);if(o)return new Date(parseInt(o[1],10));var u=n.parseDate(e,r,t.name);if(u==null||isNaN(u))u=Date.parse(e),u=isNaN(u)?NaN:new Date(u);return u},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"d",t.name)}},"boolean":{parse:function(e,n,r,i,s){var o=typeof e;if(o==="number")return e!=0;if(o==="boolean")return e;o==="string"&&(e=t.trim(e));if(!e||e==="&nbsp;"||e===i&&s)return null;switch(e.toLowerCase()){case"true":return!0;case"false":return!1}return NaN},toStr:function(e,t,n,r,i){return e===null&&i?r:e?"true":"false"}}},t.each(e.defaultParsers,function(e,t){t.parse=t.parse&&i(t.parse),t.toStr=t.toStr&&i(t.toStr)})})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(t){(function(n){function r(r){function i(r){var s=[];if(r.length===0)return s;var o=n.Connective.AND;return e.util.each(r,function(r,u){if(r==0&&e.util.isString(u)){var a=u.toLowerCase();if(a==n.Connective.AND||a==n.Connective.OR){o=a;return}}if($.isArray(u)){u=i(u);if(!u)return;if(u[0]===o||u.length==2){u.shift(),s=s.concat(u);return}}else{var f=t.normalizeCondition(u);if(!f)return;f.property=u.property,u=f}s.push(u)}),s.length==0?null:(s.unshift(o),s)}return i(r)}function i(t){if(!$.isArray(t))return null;var i={isEmpty:!0,original:t,normalized:r(t),func:null};return i.normalized==null?i.func=function(e){return!0}:(i.isEmpty=!1,i.func=function(t){function r(i){var s=i[0]===n.Connective.AND,o=s?e.util.every:e.util.some;return o(i,function(n,i){if(i===0)return s;if($.isArray(n))return r(n);var o=e.util.getProperty(t,n.property);return n.op.apply(o,n.value)})}return r(i.normalized)}),i}function s(t){return i(t)||e.filtering.compile(t)}n.Connective={AND:"and",OR:"or"},n.compile=s})(t.extended||(t.extended={}));var n=t.extended})(e.filtering||(e.filtering={}));var t=e.filtering})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=e.data,i=r.filtering.extended,s=function(){function e(e){this.real=e,this._updatingFilter=!1,this._overrideFilter(),this._makeMemberProxies()}return e.prototype._overrideFilter=function(){var e=this;this.filter=r.observable(this.real.filter()),this.filter.subscribe(function(t){e.real.filter()!==t&&!e._updatingFilter&&e.refresh({filter:t})}),this.real.filter.subscribe(function(t){t!==e._lastSetFilter&&e.filter(t)})},e.prototype.refresh=function(e,t){typeof t=="undefined"&&(t=!1),e=n.extend({},e);var r=e.filter;e.filter=this._coerceFilter(e.filter),this._lastSetFilter=e.filter,this._updatingFilter=!0;try{n.isFunction(e.filter)&&!n.isFunction(r)?this.filter(r):this.filter(e.filter)}finally{this._updatingFilter=!1}return this.real.refresh(e,t)},e.prototype._makeMemberProxies=function(){var e=this;r.util.each(this.real,function(t,r){if(!n.isFunction(r)||e[t]||t.charAt(0)==="_")return;e[t]=n.isFunction(r.subscribe)?r:function(){return r.apply(e.real,arguments)}})},e.create=function(n){return new e(n)},e.prototype._convertComplexPropertyFilterToExtendedFilterFormat=function(e){var t=[];return n.each(e,function(e,s){if(!n.isArray(s))s=[s];else{var o=r.util.isString(s[0])&&s[0].toLowerCase();if(o===i.Connective.AND||o===i.Connective.OR){t.push(s);return}}var u=[];n.each(s,function(t,n){var i=r.filtering.normalizeCondition(n);i&&(i.property=e,u.push(i))}),u.length>0&&t.push(u)}),t.length>0?t:null},e.prototype._coerceFilter=function(e){if(n.isArray(e))return i.compile(e).func;if(!n.isPlainObject(e))return e;e=n.extend(!0,{},e);var t={};n.each(e,function(i,s){n.isArray(s)||(s=[s]);if(t){var o=r.util.isString(s[0])&&s[0].toLowerCase();if(s.length==1||s.length==2&&(o==="and"||o==="or")){t[i]=s[s.length-1];return}}e[i]=s,t=null});if(t)return t;var s=this._convertComplexPropertyFilterToExtendedFilterFormat(e);return i.compile(s).func},e.prototype._unsafeReplace=function(e,t){this.real.sourceArray[e]=t,this.real.local[e]=t},e.prototype._unsafeSplice=function(e,t,n){arguments.length===2?(this.real.sourceArray.splice(e,t),this.real.local.splice(e,t)):(this.real.sourceArray.splice(e,t,n),this.real.local.splice(e,t,n))},e.prototype._unsafePush=function(e){this.real.sourceArray.push(e),this.real.local.push(e)},e}();t.GridDataView=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));