var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijgallery",i="wijmo-wijgallery",s="wijmo-wijgallery-",o=s+"selected",u=s+"button-",a=s+"button",f="wijmo-wijgallery-thumbs-pointer-{0}",l="wijmo-wijgallery-flashwrapper",c='<div class="wijmo-wijgallery-frame"><div class="wijmo-wijgallery-content"></div></div>',h='<div class="wijmo-wijgallery-thumbs"></div>',p="<a><span></span></a>",d='<div class="wijmo-wijgallery-frame-{0}"><a href="#" class="wijmo-wijgallery-frame-link"></a></div>',v="<div></div>",m="li.wijmo-wijcarousel-item";!window.S&&window.swfobject&&(window.S={flash:window.swfobject});var g=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(e,t){var r=this,i=r.options,s,o,u,a;if(e==="framePosition"||e==="thumbnailPosition"||e==="transitions"||e==="pagingPosition")n.extend(!0,i[e],t);else{u=i[e],n.Widget.prototype._setOption.apply(r,arguments);switch(e){case"disabled":r._handleDisabledOption(t,r.element);break;case"thumbnailOrientation":r.thumbs[r.thumbWidgetName]({orientation:t});break;case"thumbsDisplay":r.thumbs[r.thumbWidgetName]({display:t});break;case"autoPlay":r[t?"play":"pause"]();break;case"showCounter":case"showTimer":case"showControls":s=e.replace(/show/i,"").toLowerCase(),o=e.replace(/show/i,"_create"),t!==u&&(t===!0?r[s]?r[s].jquery&&r[s].show():r[o]():r[s].hide());break;case"showCaption":t?(r._createCaption(r.size),a=r._loadCaption(r.images[r.currentIdx]),a.show()):r.element.find(".wijmo-wijgallery-caption,.wijmo-wijgallery-text").remove();break;case"showPager":case"thumbsLength":case"thumbnailDirection":case"showControlsOnHover":case"mode":case"data":r._wijdestroy(),r._create();break;default:}}},t.prototype._handleDisabledOption=function(e,t){var n=this;n.pager&&!n.pager.is(":hidden")?n.pager.wijpager("option","disabled",e):n.thumbs&&!n.thumbs.is(":hidden")&&n.thumbs[n.thumbWidgetName]({disabled:e})},t.prototype._initLi=function(e){var t=e.children("a:eq(0)"),r=e.find("img:eq(0)"),i=e.find("span:eq(0)"),s={url:null,thumbUrl:null,title:r.attr("alt"),caption:undefined};return t.length&&t.attr("href")?(s.url=t.attr("href"),s.title||(s.title=t.attr("title"))):r.length&&(s.url=r.attr("src")),i.length?s.caption=i:r.attr("title")&&(s.caption=n("<span>").html(r.attr("title"))),s.thumbUrl=r.attr("src"),s},t.prototype._initStatus=function(){var e=this,t;e.images=[],e.ul=e.element.children("ul"),t=e.ul.children("li"),e._count=t.length,t.each(function(t){var r=e._initLi(n(this));e.images.push(r)})},t.prototype._createMarkupFromData=function(){var e=this,t=e.options,r=t.data,i=e.element,s=i.children("ul:eq(0)");e.images=r,s.length?s.empty():s=n("<ul>").appendTo(i),e.ul=s,n.each(r,function(e,t){var r=n("<a>"),i=n("<li>"),o=n("<img>");t.url&&r.attr("href",t.url),t.thumbUrl&&o.attr("src",t.thumbUrl),t.title&&o.attr("alt"),r.append(o).appendTo(i),i.appendTo(s)}),e._count=r.length},t.prototype._create=function(){var e=this,t=e.options;e.container=e.element,e.container.addClass([i,t.wijCSS.widget].join(" ")),e.currentThumbIdx=0,e.currentIdx=-1,e.timerCount=0,window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),t.showPager?(t.pagingPosition=!0,t.thumbnails=!1):t.thumbnails=!0,t.data&&t.data.length?e._createMarkupFromData():e._initStatus(),t.loadCallback&&n.isFunction(t.loadCallback)&&e._trigger("loadCallback",null,e),e._createDom(),t.autoPlay&&e._play(!0),t.showControlsOnHover&&(e.frame.find(".wijmo-wijpager,.wijmo-wijgallery-button-next,.wijmo-wijgallery-counter,.wijmo-wijgallery-button-previous").hide(),!e.isPlaying&&e.timer&&e.timer.hide()),t.disabled&&e.disable(),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijgallery")},t.prototype._createDom=function(){var e=this,t=e.options;t.thumbnails?e._createThumbnails():e.ul.hide(),e._createFrame(),t.control&&e._createControls(),t.showCounter&&e._createCounter(),t.showTimer&&e._createTimer(),t.showPager&&e._createPager()},t.prototype._getFrameSize=function(){var e=this,t=e.options.thumbnailOrientation==="horizontal",n=e.element.height()-(t?e.thumbs?e.thumbs.outerHeight(!0):0:0),r=e.element.width()-(t?0:e.thumbs?e.thumbs.outerWidth(!0):0);return{w:r<2||!r?750:r,h:n<2||!n?300:n}},t.prototype._createFrame=function(){var e=this,t=e.options,r,i,s=e._getFrameSize(),o=t.thumbnailDirection==="after";e.frame=n(c).addClass(t.wijCSS.content+" "+t.wijCSS.helperClearFix)[o?"prependTo":"appendTo"](e.container).setOutWidth(s.w-1).setOutHeight(s.h).wrap('<div class="wijmo-wijgallery-framewrapper">'),e.size=s,r=e.frame.width(),i=e.frame.height(),e.frameWrapper=e.frame.parent(),t.thumbnailOrientation==="vertical"&&e.frameWrapper.addClass("wijmo-wijgallery-framewrapper-vertical"),t.showControlsOnHover&&(n.browser.msie&&parseInt(n.browser.version)>9&&(e.frame.data("previousBtnShown",!1),e.frame.data("nextBtnShown",!1)),e.frame.bind("mouseenter."+e.widgetName,function(){if(e.options.disabled)return;e._showControls("controls")}).bind("mouseleave."+e.widgetName,function(){if(e.options.disabled)return;e._hideControls("controls"),n.browser.msie&&parseInt(n.browser.version)>9&&n.each(["previous","next"],function(t,n){e.frame.data(n+"BtnShown")&&(e._hideControls(n),e.frame.data(n+"BtnShown",!1))})})),e.content=e.frame.children("div.wijmo-wijgallery-content"),t.mode==="img"&&e._createFrameMask(),e._createPrevNextBtn(),e._createCaption(s),e._createLoading(),e.last=n('<div class="'+t.wijCSS.overlay+' wijmo-wijgallery-last"></div>').appendTo(e.content).width(r).height(i).css({"line-height":s.h+"px"}),e.current=n('<div class="'+t.wijCSS.overlay+' wijmo-wijgallery-current"></div>').appendTo(e.content).width(r).height(i).css({"line-height":s.h+"px"}),e._show(0)},t.prototype._createControls=function(){var e=this,t=e.options,r={collision:"none",of:e.container,my:"center bottom",at:"center bottom"};t.control&&(e.controls=n(t.control).css({position:"absolute"}).appendTo(e.container),n.extend(r,t.controlPosition),e.controls.position(r))},t.prototype._createLoading=function(){var e=this;e.loading=n("<div></div>").addClass("wijmo-wijgallery-loading").appendTo(e.content),e.loading.css({left:(e.content.width()-e.loading.width())/2,top:(e.content.height()-e.loading.height())/2}),e.loading.hide()},t.prototype._createFrameMask=function(){var e=this,t=e.options;n.each(["previous","next"],function(r,i){var s=n(d.replace(/\{0\}/,i)).appendTo(e.frame),o=s.children("a");n.browser.msie&&parseInt(n.browser.version)<=9&&s.css({"background-color":"#fff"}),t.showControlsOnHover&&!(n.browser.msie&&parseInt(n.browser.version)>9)&&s.bind("mouseenter."+e.widgetName,function(){if(e.options.disabled)return;e._showControls(i)}).bind("mouseleave."+e.widgetName,function(){if(e.options.disabled)return;e._hideControls(i)}),n.browser.msie&&parseInt(n.browser.version)>9||o.bind("click."+e.widgetName,function(t){if(e.options.disabled)return;e[i](),t.preventDefault()})}),n.browser.msie&&parseInt(n.browser.version)>9&&e.frame.bind("click."+e.widgetName,function(t){if(e.options.disabled)return;var r=".wijmo-wijgallery-frame-",i=t.clientX,s=t.clientY;n.each(["previous","next"],function(o,u){var a=r+u,f=e.frame.find(a);f.length>0&&e._checkPositionInElement({X:i,Y:s},n(f[0]))&&(e[u](),t.preventDefault())})}),t.showControlsOnHover&&n.browser.msie&&parseInt(n.browser.version)>9&&e.frame.bind("mousemove."+e.widgetName,function(t){if(e.options.disabled)return;var r=".wijmo-wijgallery-frame-",i=t.clientX,s=t.clientY;n.each(["previous","next"],function(t,o){var u=r+o,a=e.frame.find(u);a.length>0&&(e._checkPositionInElement({X:i,Y:s},n(a[0]))?e.frame.data(o+"BtnShown")||(e._showControls(o),e.frame.data(o+"BtnShown",!0)):e.frame.data(o+"BtnShown")&&(e._hideControls(o),e.frame.data(o+"BtnShown",!1)))})})},t.prototype._createCounter=function(){var e=this,t=e.options;if(!t.showCounter){e.counter&&(e.counter.remove(),e.counter=undefined);return}e.counter||(e.counter=n("<div></div>").addClass("wijmo-wijgallery-counter "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerTL).appendTo(e.frame)),e._refreshCounter()},t.prototype._refreshCounter=function(){var e=this,t=e.options,r;if(!e.counter)return;e.counter.empty(),t.counter&&(r=t.counter.replace(/\[i\]/,e.currentIdx+1),r=r.replace(/\[n\]/,e._count),n("<span></span>").text(r).appendTo(e.counter))},t.prototype._createPrevNextBtn=function(){var e=this,t=e.options.wijCSS;n.each(["next","previous"],function(r,i){var s=i==="next"?t.iconArrowRight:t.iconArrowLeft,o;o=e.frame.find(".wijmo-wijgallery-frame-"+i);if(!o.length||e.options.mode!=="img")o=e.frame;e[i+"Btn"]=n(e._createBtn(u+i,s)).appendTo(o),n.browser.msie&&parseInt(n.browser.version)>9&&e.options.mode==="img"||e[i+"Btn"].bind("click."+e.widgetName,n.proxy(e[i],e)),e._applyBtnStyle(i)})},t.prototype._applyBtnStyle=function(e){var t=this,n=t.options,r=e==="next",i=t[e+"Btn"],s=r?"right center":"left center",o=s,u=n.wijCSS,a=r?u.cornerLeft:u.cornerRight,f=e==="next"?t.currentIdx>=t._count:t.currentIdx<=0,l={collision:"none",of:t.frame,my:o,at:s};i.addClass(a).position(l),f?i.removeClass(u.stateHover).addClass(u.stateDisabled):i.hasAllClasses(u.stateDisabled)&&i.removeClass(u.stateDisabled)},t.prototype._createCaption=function(e){var t=this,r=t.options,i=r.wijCSS;r.showCaption&&(t.overlay=n(v).addClass([i.content,i.helperClearFix,"wijmo-wijgallery-caption"].join(" ")).width(e.w).appendTo(t.content),t.caption=n(v).addClass([i.content,i.helperClearFix,"wijmo-wijgallery-text"].join(" ")).width(e.w).appendTo(t.content))},t.prototype._loadCaption=function(e){var t=this,r=e.caption,i,s=n("<span></span>"),o=t.element.find(".wijmo-wijgallery-text,.wijmo-wijgallery-caption");return r&&(o.show(),r.jquery&&r.show(),s.html(r),t.caption.empty().append(s),i=s.outerHeight(!0),o.height(i),n.browser.msie&&o.height(s.css("display","block").outerHeight(!0))),o.hide(),o},t.prototype._showCaption=function(e){var t=this;e&&e.caption&&(t.caption.length&&t.caption.fadeIn(500),t.overlay.length&&t.overlay.show().animate({opacity:.5},500))},t.prototype._createTooltip=function(e){var t=this,r=t.options.wijCSS,i=e||"bottom";t.pointer=n("<div>").addClass([r.content,r.stateDefault,f.replace(/\{0\}/,i)].join(" ")),t.pointer.appendTo(t.thumbsWrapper).hide()},t.prototype._createThumbnails=function(){var e=this,t=e.options,r=t.thumbnailDirection==="after",i="wijmo-wijgallery-thumbs-{0}",s=t.thumbnailOrientation==="horizontal",o=r?s?"bottom":"right":s?"top":"left";e.thumbPosition=o,e.thumbs=n(h).appendTo(e.container).addClass(t.wijCSS.content).addClass(s?"wijmo-wijcarousel-horizontal-multi":"wijmo-wijcarousel-vertical-multi"),s?e.thumbs.css({height:t.thumbsLength+"px"}).setOutWidth(e.element.width()):e.thumbs.css({width:t.thumbsLength+"px"}).setOutHeight(e.element.height()),e.ul.appendTo(e.thumbs),e.ul.children("li").each(function(t,r){var i=n(r).children("a"),s=e.images[t],o=s.thumbUrl;i.length||(i=n(r).wrapInner("<a>").children("a"),i.attr("href",o))}),n[e.namespace][e.thumbWidgetName]&&(e.thumbs.addClass(i.replace(/\{0\}/,o)).find("li").addClass(t.wijCSS.stateDefault).hover(function(){n(this).addClass(t.wijCSS.stateHover)},function(){n(this).removeClass(t.wijCSS.stateHover)}),e.thumbsWrapper=e.thumbs[e.thumbWidgetName]({display:t.thumbsDisplay,step:t.thumbsDisplay-1,itemPadding:"0 10px",showCaption:t.showThumbnailCaptions,orientation:t.thumbnailOrientation,loop:!1,itemClick:function(t,n){var r=n.index;e.show(r),t.preventDefault()},afterScroll:function(t,n){e.currentThumbIdx=n.firstIndex,e.activeLi&&e.activeLi.is("li")&&e.activeLi.index()>=n.firstIndex&&e.activeLi.index()<=n.lastIndex&&e._highlightThumb(e.activeLi),e.isScrolling=!1},beforeScroll:function(n,r){e.isScrolling=!0,t.mode==="swf"||t.mode==="flv"?e.pointer.hide():e.pointer.fadeOut(100)}}).wrap('<div class="wijmo-wijgallery-thumbswrapper">').parent(),s||e.thumbsWrapper.addClass("wijmo-wijgallery-thumbswrapper-vertical"),e._createTooltip(o))},t.prototype._calculatePosition=function(e,t,n,r,i,s){var o=this;o.thumbPosition==="bottom"?(e.left=e.left+(r-t)/2+s,e.top=e.top-n):o.thumbPosition==="top"?(e.left=e.left+(r-t)/2+s,e.top=e.top+i+2*s):o.thumbPosition==="left"?(e.left=e.left+r+2*s,e.top=e.top+(i-n)/2+s):o.thumbPosition==="right"&&(e.left=e.left-t,e.top=e.top+(i-n)/2+s)},t.prototype._highlightThumb=function(e){var t=this,n,r,i,s,u,a,f=[o,t.options.wijCSS.stateActive].join(" ");e&&e.length&&(e.siblings("li."+o).removeClass(f),e.addClass(f),n=t.pointer.outerWidth(!0),r=t.pointer.outerHeight(!0),i=e.width(),s=e.height(),u=e.offset(),a=5,t._calculatePosition(u,n,r,i,s,a),t.pointer.fadeIn(100),t.pointer.offset(u))},t.prototype._getSelector=function(e,t){var n,r=".wijmo-wijgallery-button-",i=".wijmo-wijpager,.wijmo-wijgallery-counter";return t&&(i+=",.wijmo-wijgallery-timerbar"),e==="next"||e==="previous"?n=r+e:e==="controls"?n=i:n=i+","+r+"next,"+r+"previous",n},t.prototype._showControls=function(e){var t=this,r;r=t._getSelector(e,!t.isPlaying&&t.timer),t.frame.find(r).stop(!0,!0).fadeIn(400,function(){n(this).css("opacity","")})},t.prototype._hideControls=function(e){var t=this,n;n=t._getSelector(e,!t.isPlaying&&t.timer),this.frame.find(n).stop(!0,!0).fadeOut(600)},t.prototype._createPager=function(){var e=this,t=e.options,r,i=t.thumbsDisplay,s=1,o=e.currentIdx,u=e.currentIdx,a={collision:"none",of:e.container,my:"right top",at:"right bottom"};t.thumbnails?(r=n("<div></div>").appendTo(e.thumbs),i!==0&&(s=Math.ceil(e._count/i),o=Math.ceil(e.currentIdx/i)),e.pager=r.wijpager({pageCount:s,pageIndex:o,pageButtonCount:s,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;(u<r*i||u>=(r+1)*i)&&e.thumbs[e.thumbWidgetName]("scrollTo",r*i),t.preventDefault()}}).css({position:"absolute"})):(r=n("<div></div>").appendTo(e.container),e.pager=r.wijpager({pageCount:e._count,pageIndex:e.currentIdx,pageButtonCount:e._count,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;e._show(r)}}).css({position:"absolute"}),n.extend(a,t.pagingPosition),e.pager.addClass("wijmo-wijgallery-pager").position(a))},t.prototype._createBtn=function(e,t){var r=n(p),i=this.options;return r.addClass(i.wijCSS.stateDefault+" "+e).attr("role","button").bind("mouseover"+this.widgetName,function(){if(n(this).hasAllClasses(i.wijCSS.stateDisabled))return;n(this).addClass(i.wijCSS.stateHover)}).bind("mouseout"+this.widgetName,function(){if(n(this).hasAllClasses(i.wijCSS.stateDisabled))return;n(this).removeClass(i.wijCSS.stateHover)}),r.children("span:eq(0)").addClass(i.wijCSS.icon+" "+t),r},t.prototype._createTimer=function(){var e=this,t=e.options;e._createPausePlay(),e.progressBar=n("<div></div>").addClass("wijmo-wijgallery-timerbar-inner "+t.wijCSS.cornerAll).css({width:"0%"}).attr("role","progressbar"),e.timer=n("<div></div>").addClass("wijmo-wijgallery-timerbar "+t.wijCSS.cornerAll).appendTo(e.frame).append(e.progressBar).append(e.playPauseBtn)},t.prototype._createPausePlay=function(){var e=this,t=e.options;e.playPauseBtn=n(e._createBtn(a,t.autoPlay?t.wijCSS.iconPause:t.wijCSS.iconPlay)).bind("wijclick."+e.widgetName,function(){if(!n(this).hasAllClasses(t.wijCSS.stateDisabled)){var r=n(this).children("span:eq(0)");e[r.hasAllClasses(t.wijCSS.iconPlay)?"play":"pause"]()}})},t.prototype._show=function(e){var t=this,r=t.images[e],i,s,o,u=t._getFrameSize(),a=t.options,f=a.mode;if(t.currentIdx===e)return;r&&n.isPlainObject(r)&&(t.loading.delay(500).fadeIn(100),o=t.last.children("img,div."+l),o.length&&o.remove(),f==="swf"||f==="flv"?(t.last.hide(),t.current.empty(),t._wrapFlash(t.current,f,r.url),t.picture=t.current.children("div."+l),t._setCurrentStates(e),t.loading.stop().hide(),t._thumbsScroll(e)):f==="img"?(t.picture&&t.picture.length&&t.last.append(t.picture.unbind("load")),t.current.hide(),t.last.show(),t.picture=n("<img>").attr({src:r.url,alt:r.title}).appendTo(t.current).data("itemIndex",e),n.browser.msie&&t.picture[0].hasAttribute("complete")?t._imageLoaded(t,u):t.picture.bind("load",function(){t._imageLoaded(t,u)})):f==="iframe"&&(t.current.is(":hidden")?(i=t.current,s=t.last):(i=t.last,s=t.current),t.picture=n("<iframe></iframe>").addClass("wijmo-wijgallery-iframe").attr({frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"auto",allowtransparency:"true",src:r.url}).hide().appendTo(i).data("itemIndex",e).bind("load",function(){var e=n(this),r=e.data("itemIndex");t.loading.stop().hide(),t.pointer&&t.pointer.fadeOut(100),t._setCurrentStates(r),r!==undefined&&(a.showCaption,e.show(),s.fadeOut(function(){s.empty()}),i.fadeIn())})))},t.prototype._imageLoaded=function(e,t){var n=e.picture.attr("role","img"),r=n.data("itemIndex"),i=n[0].naturalWidth||n.width(),s=n[0].naturalHeight||n.height(),o=e.images[r];e.loading.stop().hide(),e.pointer&&e.pointer.fadeOut(100),i>t.w||s>t.h?i/s>t.w/t.h?n.css({width:"100%"}):n.css({height:"100%"}):i<t.w&&s<t.h&&n.addClass(e.options.wijCSS.stateDefault).addClass("wijmo-wijgallery-small-image"),r!==undefined&&(e.options.showCaption&&e.caption&&e._loadCaption(o),e._animate(r))},t.prototype._animate=function(e){var t=this,r=t.options,i=r.transitions,s=r.thumbnailOrientation==="horizontal",o,u,a,f,l,c,h=i.animated,p=i.duration;if(!t.last.children().length){t._setCurrentStates(e),t.last.hide(),t.current.show();return}l={index:t.currentIdx,to:e,toImg:t.images[e]};if(!t._trigger("beforeTransition",null,l))return;h?h==="slide"?(o=t.size.w,u=t.size.h,t.current.show(),c=t.currentIdx>e?!0:!1,a=n.createWrapper(t.last).css({overflow:"hidden",width:s?o*2:o,height:s?u:u*2,left:s?c?-o:0:0,top:s?0:c?-u:0}),a[c?"prepend":"append"](t.current),a.animate({left:s?c?0:-o:0,top:s?0:c?0:-u},p,function(){t.last.parent().is(".ui-effects-wrapper")&&t.last.unwrap(),t.last.hide(),t._setCurrentStates(e)})):n.mobile?(f=p/2,t.last.fadeOut(f,function(){t.current.stop(!0,!0).fadeIn(f,function(){t._setCurrentStates(e)})})):h==="explode"||h==="scale"||h==="blind"||h==="fold"?(t.current.css({position:"absolute"}),t.current.stop(!0,!0).show(h,p,function(){t.last.hide(),t._setCurrentStates(e)})):h==="size"?(t.last.hide(),t.current.stop(!0,!0).show(h,p,function(){t.last.hide(),t._setCurrentStates(e)})):(f=p/2,t.last.hide(h,f,function(){t.last.hide(),t.current.stop(!0,!0).show(h,f,function(){t._setCurrentStates(e)})})):(t.last.hide(),t.current.show(),t._setCurrentStates(e)),t._thumbsScroll(e)},t.prototype._thumbsScroll=function(e){var t,n=this,r=n.options;n.thumbs&&n.thumbs[n.thumbWidgetName]&&(r.scrollWithSelection?(t=e-Math.ceil(r.thumbsDisplay/2)+1,e>0&&e<n._count-1&&n.thumbs[n.thumbWidgetName]("scrollTo",t)):e>r.thumbsDisplay+n.currentThumbIdx-1?n.thumbs[n.thumbWidgetName]("scrollTo",e-r.thumbsDisplay+1):e<n.currentThumbIdx&&n.thumbs[n.thumbWidgetName]("scrollTo",e))},t.prototype._setCurrentStates=function(e){var t=this,n=t.options,r,i,s;s=t.currentIdx,t.currentIdx=e,r=e+1<t._count,t.isPlaying&&r?(t.timeout=null,t.isPlaying=!1,t._play()):t.progressBar&&t.pause(),e+1>=t._count?t.nextBtn.add(t.playPauseBtn).removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.nextBtn.add(t.playPauseBtn).removeClass(n.wijCSS.stateDisabled),e<=0?t.previousBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.previousBtn.removeClass(n.wijCSS.stateDisabled),n.showCaption&&t._showCaption(t.images[e]),t.thumbs&&t.thumbs[t.thumbWidgetName]?(t.activeLi=t.thumbs.find(m).eq(e),t.isScrolling||t._highlightThumb(t.activeLi)):t.pager&&t.pager.is(":wijmo-wijpager")&&t.pager.wijpager("option","pageIndex",e),t._refreshCounter(),t._clearCss(),i={last:s,index:t.currentIdx,toImg:t.images[t.currentIdx]},t._trigger("afterTransition",null,i)},t.prototype._clearCss=function(){this.current.css({position:"",visibility:""})},t.prototype._resetState=function(){var e=this;e._stopAnimation(),e.isPlaying&&e.progressBar&&(e.progressBar.stop(),e.progressBar.css({width:"0%"}))},t.prototype._stopAnimation=function(){var e=this,t;t=e.content.find(".ui-effects-wrapper"),t.length&&t.stop(!0,!0),e.current.stop(!0,!0),e.last.stop(!0,!0)},t.prototype._checkPositionInElement=function(e,t){return e.X>=t.offset().left&&e.X<t.offset().left+t.width()&&e.Y>=t.offset().top&&e.Y<t.offset().top+t.height()},t.prototype.count=function(){return this._count},t.prototype._wijdestroy=function(){var e=this,t=e.options.wijCSS;e.frame.unwrap().remove(),e.options.thumbnails?n[e.namespace][e.thumbWidgetName]&&(e.thumbs[e.thumbWidgetName]("destroy"),e.element.find("li").unbind().removeClass(t.stateActive).filter("."+o).removeClass(o),e.thumbs.children("ul").unwrap().unwrap()):(e.pager&&e.pager.length&&e.pager.remove(),e.element.find("ul").css({display:""})),e.pointer&&e.pointer.remove(),e.element.removeClass([i,t.widget,t.content,t.cornerAll].join(" "))},t.prototype.destroy=function(){this._wijdestroy(),n.Widget.prototype.destroy.apply(this)},t.prototype.show=function(e){var t=this;t._resetState(),t._show(e)},t.prototype.next=function(){var e=this,t;if(e.options.disabled)return;e._resetState(),t=e.currentIdx+1,t<e._count&&e._show(t)},t.prototype.previous=function(){var e=this,t;if(e.options.disabled)return;e._resetState(),t=e.currentIdx-1,t>=0&&e._show(t)},t.prototype.play=function(){this._play()},t.prototype._play=function(e){var t=this,n=t.options;if(t.isPlaying||n.disabled)return;if(n.interval===0)return t.pause();if(e){t.isPlaying=!0;return}if(n.showTimer&&t.progressBar)t.progressBar.css({width:"0%"}),t.playPauseBtn.children("span:eq(0)").removeClass(n.wijCSS.iconPlay).addClass(n.wijCSS.iconPause),t.progressBar.animate({width:"100%"},n.interval,null,function(){t._show(t.currentIdx+1)});else{if(t.timeout)return;t.timeout=window.setTimeout(function(){t.timerCount<=1&&t.next(),t.timerCount--},n.interval),t.timerCount++}t.isPlaying=!0},t.prototype.pause=function(){var e=this,t=e.options;if(t.showTimer&&e.progressBar)e.progressBar.stop(),e.progressBar.css({width:"0%"}),e.playPauseBtn.children("span:eq(0)").removeClass(t.wijCSS.iconPause).addClass(t.wijCSS.iconPlay);else{if(e.timeout===null)return;window.clearTimeout(e.timeout),e.timeout=null}e.isPlaying=!1},t.prototype.add=function(e,t){var r=this,i,s,o;if(typeof e=="string")i=n(e),o=r._initLi(i);else if(e.jquery)i=e,o=r._initLi(i);else{if(!n.isPlainObject(e))return;o=e}!t||t>r._count?s=r._count:t<0?s=0:s=t,r.images.splice(s,0,o),r._count++,r.thumbs&&r.thumbs[r.thumbWidgetName]&&r.thumbs[r.thumbWidgetName]("add",i,t)},t.prototype.remove=function(e){var t=this,n;isNaN(e)||e>t._count?n=t._count:e<0?n=0:n=e,t.images.splice(n,1),t._count--,t.thumbs&&t.thumbs[t.thumbWidgetName]&&t.thumbs[t.thumbWidgetName]("remove",e);if(t.currentIdx==e)t.current.children("img").remove(),t.last.children("img").remove(),t.picture=null,t.currentIdx=-1,t.show(e);else if(t.currentIdx>e){var r=t.currentIdx;t.currentIdx=-1,t.show(r)}},t.prototype._getExt=function(e){var t,n,r=/[0-9a-z]+$/i,i=e.indexOf("?");return i>-1&&(e=e.substring(0,i)),n=e.match(r),n&&(t=n[0].toLowerCase()),t},t.prototype._getPlayerName=function(e){if(e.indexOf("#")===0||e.indexOf("#")>0&&e.indexOf(document.location.href)===0)return"inline";var t=["bmp","gif","jpg","jpeg","png"],r=["swf"],i=["flv","m4v"],s=["dv","mov","moov","movie","mp4","avi","mpg","mpeg"],o=["asf","avi","mpg","mpeg","wm","wmv"],u=this._getExt(e);if(u){if(n.inArray(u,t)>=0)return"img";if(n.inArray(u,r)>=0)return"swf";if(n.inArray(u,i)>=0)return"flv";if(n.inArray(u,o)>=0)return"wmp";if(n.inArray(u,s)>=0)return"qt"}return"unknown"},t.prototype._wrapFlash=function(e,t,r){var i=this,s=i.options,o=r,u,a="100%",f="100%",c=s.flashInstall,h=s.flashVersion,p=s.flashVars,d=s.flashParams,v=i._newId();t==="flv"&&(o=s.flvPlayer,p=n.extend({file:r,width:a,height:f,autostart:s.autoPlayMovies?"true":"false",controlbar:s.showMovieControls?"bottom":"none",backcolor:"0x000000",frontcolor:"0xCCCCCC",lightcolor:"0x557722"},s.flashVars),d=n.extend({autostart:s.autoPlayMovies?"true":"false",allowscriptaccess:"always"},s.flashParams)),u=n("<div/>").addClass(l).appendTo(e),n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",v).appendTo(u),S.flash.embedSWF(o,v,a,f,h,c,p,d)},t.prototype._newId=function(){var e="a|b|c|d|e|f|g|h|i|j|k|l|m|n|o|p|q|r|s|t|u|v|w|x|y|z",t=[],n="",r;t=e.split("|");for(r=0;r<16;r++)n+=t[Math.round(Math.random()*25)];return n},t}(e.wijmoWidget);t.wijgallery=g,g.prototype.thumbWidgetName="wijcarousel";var y=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-a",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-b",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijgallery')",this.autoPlay=!1,this.scrollWithSelection=!1,this.showTimer=!0,this.interval=5e3,this.showCaption=!0,this.showThumbnailCaptions=!1,this.data=[],this.showControls=!1,this.control="",this.controlPosition={},this.showCounter=!0,this.counter="[i] of [n]",this.showPager=!1,this.pagingPosition={},this.thumbnailOrientation="horizontal",this.thumbnailDirection="after",this.transitions={animated:"slide",duration:1e3,easing:null},this.showControlsOnHover=!0,this.thumbsDisplay=5,this.thumbsLength=100,this.beforeTransition=null,this.afterTransition=null,this.loadCallback=null,this.showMovieControls=!1,this.autoPlayMovies=!0,this.flashParams={bgcolor:"#000000",allowfullscreen:!0,wmode:"transparent"},this.flashVars={},this.flashVersion="9.0.115",this.flvPlayer="player\\player.swf",this.flashInstall="player\\expressInstall.swf",this.mode="img"}return e}();g.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new y),n.wijmo.registerWidget("wijgallery",g.prototype)})(e.gallery||(e.gallery={}));var t=e.gallery})(wijmo||(wijmo={}));