var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijeditor",i=alert,s=window,o=document,u=parseInt,a,f,l,c=[],h=null,p=!0,d=!0,v=0,m=[],g=null,y=null,b="setButtonDisabled",w="setButtonsDisabled",E="setButtonChecked",S="setButtonsChecked",x="form",T="imagebutton",N="textarea",C="button",k="textbox",L="list",A="passwordfield",O="dropdownlist",M="hiddenfield",_="radio",D="checkbox",P="insertcol",H="insertrow",B="insertcell",j="splitcell",F="mergecell",I="deletecol",q="deleterow",R="deletecell",U="justifyleft",z="justifycenter",W="justifyright",X="justifyfull",V="borders",$="insertorderedlist",J="insertunorderedlist",K="outdent",Q="indent",G="backcolor",Y="fontcolor",Z="bold",et="italic",tt="strikethrough",nt="underline",rt="subscript",it="superscript",st="template",ot="removeformat",ut="insertbreak",at="insertparagraph",ft="insertprintpagebreak",lt="inserthorizontalrule",ct="tablebutton",ht="inserttable",pt="edittable",dt="wysiwyg",vt="split",mt="code",gt="wordwrap",yt="fullscreen",bt="undo",wt="redo",Et="preview",St="cleanup",xt="cut",Tt="copy",Nt="paste",Ct="selectall",kt="media",Lt="specialchar",At="datetime",Ot="find",Mt="inspect",_t="save",Dt="spelling",Pt="imagebrowser",Ht="link",Bt="xx-small",jt="x-small",Ft="small",It="medium",qt="large",Rt="x-large",Ut="xx-large",zt="fontname",Wt="fontsize",Xt="blockquote",Vt="insertcode",$t="wijmo-wijribbon",Jt=$t+"-bigbutton",Kt=$t+"-dropdownbutton",Qt=$t+"-splitbutton",Gt=$t+"-list",Yt=$t+"-save",Zt=$t+"-save16",en=$t+"-undo",tn=$t+"-redo",nn=$t+"-preview",rn=$t+"-cleanup",sn=$t+"-cut",on=$t+"-copy",un=$t+"-paste",an=$t+"-selectall",fn=$t+"-bgcolor",ln=$t+"-color",cn=$t+"-bold",hn=$t+"-italic",pn=$t+"-underline",dn=$t+"-strike",vn=$t+"-sub",mn=$t+"-sup",gn=$t+"-template",yn=$t+"-removeformat",bn=$t+"-justifyleft",wn=$t+"-justifycenter",En=$t+"-justifyright",Sn=$t+"-justifyfull",xn=$t+"-borders",Tn=$t+"-orderlist",Nn=$t+"-unorderlist",Cn=$t+"-outdent",kn=$t+"-indent",Ln=$t+"-inspect",An=$t+"-find",On=$t+"-table",Mn=$t+"-inserttable",_n=$t+"-edittable",Dn=$t+"-insertcol",Pn=$t+"-insertrow",Hn=$t+"-insertcell",Bn=$t+"-splitcell",jn=$t+"-mergecell",Fn=$t+"-deletecol",In=$t+"-deleterow",qn=$t+"-deletecell",Rn=$t+"-insertbreak",Un=$t+"-insertparagraph",zn=$t+"-insertprintpagebreak",Wn=$t+"-inserthr",Xn=$t+"-form",Vn=$t+"-textarea",$n=$t+"-textbox",Jn=$t+"-password",Kn=$t+"-hiddenfield",Qn=$t+"-imagebutton",Gn=$t+"-button",Yn=$t+"-listbox",Zn=$t+"-dropdownlist",er=$t+"-radio",tr=$t+"-checkbox",nr=$t+"-link",rr=$t+"-link16",ir=$t+"-imagebrowser",sr=$t+"-media",or=$t+"-specialchar",ur=$t+"-datetime",ar=$t+"-blockquote",fr=$t+"-insertcode",lr=$t+"-modes",cr=$t+"-designview",hr=$t+"-sourceview",pr=$t+"-splitview",dr=$t+"-wordwrap",vr=$t+"-fullscreen",mr="wijmo-wijeditor",gr=mr+"-container",yr=mr+"-header",br=mr+"-content",wr=mr+"-footer",Er=mr+"-pathselector",Sr=mr+"-fullscreen",xr=mr+"-dialog",Tr=xr+"-hr",Nr=xr+"-buttons",Cr=xr+"-button",kr=xr+"-text",Lr=mr+"-imagedlg",Ar=Lr+"-content",Or=Lr+"-fields",Mr=Lr+"-imagefield",_r=Lr+"-imagelist",Dr=Lr+"-preview",Pr=Lr+"-imagesrc",Hr=Lr+"-imagealt",Br=Lr+"-imagewidth",jr=Lr+"-imageheight",Fr=Lr+"-css",Ir=Lr+"-hideimagelist",qr=mr+"-templatedlg",Rr=qr+"-toplabels",Ur=qr+"-topleftlabel",zr=qr+"-toprightlabel",Wr=qr+"-content",Xr=qr+"-templatelist",Vr=qr+"-preview",$r=qr+"-templateinfo",Jr=qr+"-nameinfo",Kr=qr+"-descriptioninfo",Qr=qr+"-fields",Gr=qr+"-name",Yr=qr+"-description",Zr=qr+"-buttons",ei=qr+"-delete",ti=qr+"-save",ni=mr+"-linkdlg",ri=ni+"-address",ii=ni+"-linktype",si=ni+"-anchor",oi=ni+"-text",ui=ni+"-target",ai=ni+"-css",fi=ni+"-src",li=ni+"-width",ci=ni+"-height",hi=ni+"-imagecontainer",pi=ni+"-linkicontype",di=mr+"-codedlg",vi=di+"-source",mi=di+"-sourcelabel",gi=mr+"-taginsdlg",yi=gi+"-caption",bi=gi+"-taglabel",wi=gi+"-tagtext",Ei=gi+"-filterempty",Si=gi+"-attribs",xi=gi+"-attriblist",Ti=gi+"-innerhtml",Ni=gi+"-css",Ci=mr+"-colordlg",ki=Ci+"-picker",Li=Ci+"-color",Ai=mr+"-tabledlg",Oi=Ai+"-rows",Mi=Ai+"-columns",_i=Ai+"-width",Di=Ai+"-height",Pi=Ai+"-border",Hi=Ai+"-cellpadding",Bi=Ai+"-cellspacing",ji=Ai+"-csstext",Fi=Ai+"-bgcolor",Ii=mr+"-previewdlg",qi=Ii+"-caption",Ri=Ii+"-navigator",Ui=Ii+"-prev",zi=Ii+"-next",Wi=Ii+"-printall",Xi=Ii+"-printone",Vi=Ii+"-ok",$i=Ii+"-printdocument",Ji=Ii+"-previewiframe",Ki=mr+"-cleanupdlg",Qi=Ki+"-caption",Gi=Ki+"-document",Yi=Ki+"-actions",Zi=mr+"-finddlg",es=Zi+"-find",ts=Zi+"-replace",ns=mr+"-mediadlg",rs=ns+"-type",is=ns+"-src",ss=ns+"-width",os=ns+"-height",us=mr+"-specialchardlg",as=us+"-chars",fs=us+"-preview",ls=us+"-content",cs=us+"-list",hs=us+"_label",ps=us+"-punctuation",ds=us+"-symbols",vs=us+"-diacritics",ms="wijmo-formatspan",gs="."+Nr+" input:first",ys="."+Nr+" input:last",bs="."+Nr+" input[value='OK']",ws="."+Nr+" input[engValue='Cancel']",Es=["Bold","Italic","UnderLine","StrikeThrough","SubScript","SuperScript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Border","NumberedList","BulletedList","Outdent","Indent"],Ss=["Bold","Italic","Link","BlockQuote","StrikeThrough","InsertDate","InsertImage","NumberedList","BulletedList","InsertCode"],xs=["Bold","Italic","StrikeThrough","UnderLine","ForeColor","FontSize","Link","InsertImage","NumberedList","BulletedList","BlockQuote"],Ts={Form:{name:"form",tip:"Form",css:Xn},Image:{name:"imagebutton",tip:"Image Button",css:Qn},TextArea:{name:"textarea",tip:"TextArea",css:Vn},Button:{name:"button",tip:"Button",css:Gn},TextBox:{name:"textbox",tip:"TextBox",css:$n},List:{name:"list",tip:"ListBox",css:Yn},PasswordField:{name:"passwordfield",tip:"Password Field",css:Jn},DropDownList:{name:"dropdownlist",tip:"DropDownList",css:Zn},HiddenField:{name:"hiddenfield",tip:"Hidden Field",css:Kn},Radio:{name:"radio",tip:"RadioButton",css:er},CheckBox:{name:"checkbox",tip:"CheckBox",css:tr},InsertColumn:{name:"insertcol",tip:"Insert Column",css:Dn},InsertRow:{name:"insertrow",tip:"Insert Row",css:Pn},InsertCell:{name:"insertcell",tip:"Insert Cell",css:Hn},SplitCell:{name:"splitcell",tip:"Split Cell",css:Bn},MergeCell:{name:"mergecell",tip:"Merge Cell",css:jn},DeleteColumn:{name:"deletecol",tip:"Delete Column",css:Fn},DeleteRow:{name:"deleterow",tip:"Delete Row",css:In},DeleteCell:{name:"deletecell",tip:"Delete Cell",css:qn},JustifyLeft:{name:"justifyleft",tip:"Justify Left",css:bn,grpname:"alignment"},JustifyCenter:{name:"justifycenter",tip:"Justify Center",css:wn,grpname:"alignment"},JustifyRight:{name:"justifyright",tip:"Justify Right",css:En,grpname:"alignment"},JustifyFull:{name:"justifyfull",tip:"Justify Full",css:Sn,grpname:"alignment"},Border:{name:"borders",tip:"Border",css:xn},NumberedList:{name:"insertorderedlist",tip:"Numbered List",css:Tn,grpname:"list"},BulletedList:{name:"insertunorderedlist",tip:"Bulleted List",css:Nn,grpname:"list"},Outdent:{name:"outdent",tip:"Outdent",css:Cn,grpname:"block"},Indent:{name:"indent",tip:"Indent",css:kn,grpname:"block"},BackColor:{name:"backcolor",tip:"Background Color",css:fn},ForeColor:{name:"fontcolor",tip:"Font Color",css:ln},Bold:{name:"bold",tip:"Bold",css:cn},Italic:{name:"italic",tip:"Italic",css:hn},StrikeThrough:{name:"strikethrough",tip:"Strikethrough",css:dn},UnderLine:{name:"underline",tip:"Underline",css:pn},SubScript:{name:"subscript",tip:"Subscript",css:vn},SuperScript:{name:"superscript",tip:"Superscript",css:mn},Template:{name:"template",tip:"Template",css:gn},RemoveFormat:{name:"removeformat",tip:"RemoveFormat",css:yn},InsertBreak:{name:"insertbreak",tip:"Insert Break",css:Rn},InsertParagraph:{name:"insertparagraph",tip:"Insert Paragraph",css:Un},InsertPrint:{name:"insertprintpagebreak",tip:"Insert Print Page Break",css:zn},InsertHR:{name:"inserthorizontalrule",tip:"Insert Horizontal Line",css:Wn},Table:{name:"tablebutton",tip:"Table",css:On},InsertTable:{name:"inserttable",tip:"Insert Table",css:Mn},EditTable:{name:"edittable",tip:"Edit Table",css:_n},Wysiwyg:{name:"wysiwyg",tip:"Design View",css:cr,grpname:"modes"},Split:{name:"split",tip:"Split View",css:pr,grpname:"modes"},Code:{name:"code",tip:"Source View",css:hr,grpname:"modes"},Wordwrap:{name:"wordwrap",tip:"Wordwrap",css:dr},FullScreen:{name:"fullscreen",tip:"Fullscreen",css:vr},Undo:{name:"undo",tip:"Undo",css:en},Redo:{name:"redo",tip:"Redo",css:tn},Preview:{name:"preview",tip:"Preview",css:nn},Cleanup:{name:"cleanup",tip:"Clean up",css:rn},Cut:{name:"cut",tip:"Cut",css:sn},Copy:{name:"copy",tip:"Copy",css:on},Paste:{name:"paste",tip:"Paste",css:un},SelectAll:{name:"selectall",tip:"Select All",css:an},Media:{name:"media",tip:"Media",css:sr},InsertSpecialChar:{name:"specialchar",tip:"Insert Special Character",css:or},InsertDate:{name:"datetime",tip:"Insert Date Time",css:ur},Find:{name:"find",tip:"Find And Replace",css:An,text:"Find"},Inspect:{name:"inspect",tip:"Tag Inspect",css:Ln,text:"Inspect"},Save:{name:"save",tip:"Save",css:Yt,text:"Save"},Spelling:{name:"spelling",tip:"Form",css:""},InsertImage:{name:"imagebrowser",tip:"Image Browser",css:ir},Link:{name:"link",tip:"Link",css:nr,text:"Link"},FontName:{name:"fontname",tip:"Font Name",css:Kt},FontSize:{name:"fontsize",tip:"Font Size",css:Kt},BlockQuote:{name:"blockquote",tip:"Block Quote",css:ar},InsertCode:{name:"insertcode",tip:"Insert Code",css:fr}},Ns=function(){var e=this,t=[];e.append=function(e){t.push(e)},e.toString=function(){return t.join("")},e.dispose=function(){t=null}},Cs=function(e){this.text=e,this.render=function(){return this.text}},ks=function(e,t,r){var i=this,s={br:!0,img:!0,hr:!0,input:!0};i.tagName=e||"div",i.attributes=r||{},i.innerText=t||"",i.children=[],n.isPlainObject(t)&&(i.innerText="",i.attributes=t),i._isShortTag=!1,s[i.tagName]===!0&&(i._isShortTag=!0),i.render=function(){var e=new Ns,t="";return e.append(i._renderBeginTag(i.tagName,i.attributes)),i.innerText!==""&&e.append(i.innerText),i.children.length>0&&n.each(i.children,function(t,n){e.append(n.render())}),e.append(i._renderEndTag(i.tagName)),t=e.toString(),e.dispose(),t},i.add=function(e){this.children.push(e)},i._renderBeginTag=function(e,t){var r=new Ns,i="";return r.append("<"),r.append(e),n.each(t,function(e,t){r.append(" "),r.append(e),r.append("="),r.append('"'),r.append(t?t.toString():""),r.append('"')}),this._isShortTag?r.append(" "):r.append(">"),i=r.toString(),r.dispose(),i},i._renderEndTag=function(e){var t=new Ns,n="";return this._isShortTag?t.append("/>"):(t.append("</"),t.append(e),t.append(">")),n=t.toString(),t.dispose(),n}},Ls=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.wijeditor=function(){this._curPageIdx=0,this.tRange=null,this.txtFoundInIE=!1,this.txtFoundInNoneIE=!1},t.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n));if(e.element.is("input"))return;e.id_prefix="wijeditor-"+e.element.attr("id")+"-",e.$ribbon=undefined,e.$modes=undefined,e._editorify(),e._initElements(),s.setTimeout(function(){e.options.disabled&&e._handleDisabledOption(!0,e.editor)},40),e._continueSavingInputTextForUndo=!1,e.element.is(":hidden")&&e.editor.wijAddVisibilityObserver&&e.editor.wijAddVisibilityObserver(function(t){if(n.contains(e.editor[0],t.target))return;e._getContent().wijsplitter("option","splitterDistance")===-1&&e._getContent().wijsplitter("option","splitterDistance",100),e.refresh(),e.editor.wijRemoveVisibilityObserver&&e.editor.wijRemoveVisibilityObserver()},"wijeditor")},t.prototype._contextMenuWidgetName=function(){return"wijmenu"},t.prototype._createBigButton=function(e,t,n,r){var i=this,s=i._createElement("button",{title:e,name:n,"class":Jt});return s.add(i._createDiv(t)),s.add(i._createSpan("",r)),s},t.prototype._createTextButton=function(e,t,n){return this._createElement("button",n,{title:e,name:t})},t.prototype._createButton=function(e,t,n,r){var i=this,s;return r?(s=i._createElement("button",{title:e,name:n}),s.add(i._createSpan(t)),s.add(i._createSpan("",r)),s):i._createElement("button",{title:e,name:n,"class":t})},t.prototype._createTextRadioButton=function(e,t,n,r,i){var s=this,o=[];return o.push(s._createElement("input",{id:t+n,type:"radio",name:r})),o.push(s._createElement("label",i,{"for":t+n,title:e,name:n})),o},t.prototype._createImageRadioButton=function(e,t,n,r,i){var s=this,o=[];return o.push(s._createElement("input",{id:t+r,type:"radio",name:i})),o.push(s._createElement("label",{"for":t+r,title:e,name:r,"class":n})),o},t.prototype._createImageCheckButton=function(e,t,n,r){var i=this,s=[];return s.push(i._createElement("input",{id:t+r,type:"checkbox"})),s.push(i._createElement("label",{"for":t+r,title:e,name:r,"class":n})),s},t.prototype._createRibbonList=function(){return this._createSpan(Gt)},t.prototype._createDropdownButton=function(e,t,r,i,s){var o=this,u=o._createElement("div",{title:e,"class":Kt}),a=o._createElement("ul");return u.add(o._createTextButton(e,t,r)),u.add(a),n.each(i,function(e,r){var i=o._createElement("li"),u=o._createTextRadioButton(r.tip,s,r.name,t,r.text);n.each(u,function(e,t){i.add(t)}),a.add(i)}),u},t.prototype._createSplitButton=function(e,t,r,i,s){var o=this,u=o._createElement("div",{title:e,"class":Qt}),a=o._createElement("ul");return u.add(o._createBigButton(e,t,r,i)),u.add(o._createElement("button",{"class":Jt})),u.add(a),n.each(s,function(e,t){var n=o._createElement("li");n.add(o._createButton(t.tip,t.css,t.name,t.text)),a.add(n)}),u},t.prototype._createButtonByCommand=function(e){var t=this,n,r=Ts[e],i;if(!r)return;i=r.name;switch(i){case Xt:case x:case T:case N:case C:case k:case L:case A:case O:case M:case _:case D:case P:case H:case B:case j:case F:case I:case q:case R:case ot:case ut:case at:case ft:case yt:case bt:case wt:case xt:case Tt:case Nt:case At:case gt:case G:case Y:case Et:case St:case kt:case Lt:case st:case Pt:case Vt:case lt:case Ct:n=t._createButton(r.tip,r.css,i);break;case Ot:case Mt:n=t._createButton(r.tip,r.css,i,r.text);break;case V:case rt:case it:case Z:case et:case nt:case tt:n=t._createImageCheckButton(r.tip,t.id_prefix,r.css,i);break;case dt:case vt:case mt:case U:case z:case W:case X:case K:case Q:case $:case J:n=t._createImageRadioButton(r.tip,t.id_prefix,r.css,i,r.grpname);break;case ct:n=t._createSplitButton("Table",On,ct,"Table",[{tip:"Insert Table",css:Mn,name:ht,text:"Insert"},{tip:"Edit Table",css:_n,name:pt,text:"Edit"}]);break;case _t:t.options.mode==="ribbon"?n=t._createBigButton(r.tip,r.css,i,r.text):n=t._createButton(r.tip,Zt,i);break;case Ht:t.options.mode==="ribbon"?n=t._createBigButton(r.tip,r.css,i,r.text):n=t._createButton(r.tip,rr,i);break;case zt:n=t._createDropdownButton("Font Name",zt,"Font Name",[{tip:"Arial",name:"fn1",text:"Arial"},{tip:"Courier New",name:"fn2",text:"Courier New"},{tip:"Garamond",name:"fn3",text:"Garamond"},{tip:"Tahoma",name:"fn4",text:"Tahoma"},{tip:"Times New Roman",name:"fn5",text:"Times New Roman"},{tip:"Verdana",name:"fn6",text:"Verdana"},{tip:"Wingdings",name:"fn7",text:"Wingdings"}],t.id_prefix);break;case Wt:n=t._createDropdownButton("Font Size",Wt,"Font Size",[{tip:"VerySmall",name:"xx-small",text:"VerySmall"},{tip:"Smaller",name:"x-small",text:"Smaller"},{tip:"Small",name:"small",text:"Small"},{tip:"Medium",name:"medium",text:"Medium"},{tip:"Large",name:"large",text:"Large"},{tip:"Larger",name:"x-large",text:"Larger"},{tip:"VeryLarge",name:"xx-large",text:"VeryLarge"}],t.id_prefix);break;case Dt:}return n},t.prototype._createActionGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(e._createButtonByCommand("Save")),t.add(n),n.add(e._createButtonByCommand("Undo")),n.add(e._createButtonByCommand("Redo")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Preview")),n.add(e._createButtonByCommand("Cleanup")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Cut")),n.add(e._createButtonByCommand("Copy")),n.add(e._createButtonByCommand("Paste")),n.add(e._createButtonByCommand("SelectAll")),t.add(e._createElement("div","Actions")),t},t.prototype._createFontGroup=function(){var e=this,t=e._createElement("li"),r=e._createRibbonList();return t.add(e._createButtonByCommand("FontName")),t.add(e._createButtonByCommand("FontSize")),t.add(r),r.add(e._createButtonByCommand("BackColor")),r.add(e._createButtonByCommand("ForeColor")),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("Bold"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Italic"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("UnderLine"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("StrikeThrough"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("SubScript"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("SuperScript"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),r.add(e._createButtonByCommand("Template")),r=e._createRibbonList(),t.add(r),r.add(e._createButtonByCommand("RemoveFormat")),t.add(e._createElement("div","Font")),t},t.prototype._createParaGroup=function(){var e=this,t=e._createElement("li"),r=e._createRibbonList();return t.add(r),n.each(e._createButtonByCommand("JustifyLeft"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("JustifyCenter"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("JustifyRight"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("JustifyFull"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("Border"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("NumberedList"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("BulletedList"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("Outdent"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Indent"),function(e,t){r.add(t)}),t.add(e._createElement("div","Paragraph")),t},t.prototype._createReviewGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("Inspect")),t.add(e._createButtonByCommand("Find")),t.add(e._createElement("div","Review")),t},t.prototype._createTablesGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(e._createButtonByCommand("Table")),t.add(n),n.add(e._createButtonByCommand("InsertColumn")),n.add(e._createButtonByCommand("InsertRow")),n.add(e._createButtonByCommand("InsertCell")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("SplitCell")),n.add(e._createButtonByCommand("MergeCell")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("DeleteColumn")),n.add(e._createButtonByCommand("DeleteRow")),n.add(e._createButtonByCommand("DeleteCell")),t.add(e._createElement("div","Tables")),t},t.prototype._createBreaksGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("InsertBreak")),t.add(e._createButtonByCommand("InsertParagraph")),t.add(e._createButtonByCommand("InsertPrint")),t.add(e._createButtonByCommand("InsertHR")),t.add(e._createElement("div","Breaks")),t},t.prototype._createFormsGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(n),n.add(e._createButtonByCommand("Form")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("TextArea")),n.add(e._createButtonByCommand("TextBox")),n.add(e._createButtonByCommand("PasswordField")),n.add(e._createButtonByCommand("HiddenField")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Image")),n.add(e._createButtonByCommand("Button")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("List")),n.add(e._createButtonByCommand("DropDownList")),n.add(e._createButtonByCommand("Radio")),n.add(e._createButtonByCommand("CheckBox")),t.add(e._createElement("div","Forms")),t},t.prototype._createSpecialGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("Link")),t.add(e._createButtonByCommand("InsertImage")),t.add(e._createButtonByCommand("Media")),t.add(e._createButtonByCommand("InsertSpecialChar")),t.add(e._createButtonByCommand("InsertDate")),t.add(e._createElement("div","Special")),t},t.prototype._getDefaultRibbonMarkup=function(){var e=this,t=e._createElement("div"),n=e._createElement("ul"),r=e._createElement("li"),i=e._createElement("li"),s=e._createElement("div",{id:e.id_prefix+"format"}),o=e._createElement("div",{id:e.id_prefix+"insert"}),u=e._createElement("ul"),a=e._createElement("ul");return t.add(n),t.add(s),t.add(o),n.add(r),n.add(i),r.add(e._createElement("a","Format",{href:"#"+e.id_prefix+"format"})),i.add(e._createElement("a","Insert",{href:"#"+e.id_prefix+"insert"})),s.add(u),u.add(e._createActionGroup()),u.add(e._createFontGroup()),u.add(e._createParaGroup()),u.add(e._createReviewGroup()),o.add(a),a.add(e._createTablesGroup()),a.add(e._createBreaksGroup()),a.add(e._createFormsGroup()),a.add(e._createSpecialGroup()),t.render()},t.prototype._getRibbonModesMarkup=function(){var e=this,t=e._createDiv(lr),r=e._createRibbonList(),i=e.element.find(".wijeditor-footer"),s,o,u,a,f;return i.length>0&&(s=n(i.find("."+cr)),s.length>0&&(Ts.Wysiwyg.tip=s.attr("title")||Ts.Wysiwyg.tip),o=n(i.find("."+pr)),o.length>0&&(Ts.Split.tip=o.attr("title")||Ts.Split.tip),u=n(i.find("."+hr)),u.length>0&&(Ts.Code.tip=u.attr("title")||Ts.Code.tip),a=n(i.find("."+dr)),s.length>0&&(Ts.Wordwrap.tip=a.attr("title")||Ts.Wordwrap.tip),f=n(i.find("."+vr)),s.length>0&&(Ts.FullScreen.tip=f.attr("title")||Ts.FullScreen.tip),i.remove()),t.add(r),n.each(e._createButtonByCommand("Wysiwyg"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Code"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Split"),function(e,t){r.add(t)}),t.add(e._createButtonByCommand("Wordwrap")),t.add(e._createButtonByCommand("FullScreen")),t.render()},t.prototype._getSimpleToolBar=function(e){var t=this,r,i=t._createDiv("");return n.each(e,function(e,s){r=t._createButtonByCommand(s),r&&(n.inArray(s,Es)!==-1?n.each(r,function(e,t){i.add(t)}):i.add(r))}),i.render()},t.prototype._editorify=function(){var e=this,t=e.element,r=t.width(),i=t.height(),s=e.options,o=s.mode,u,a,f,l,c,h,p;e._oriStyle=t.attr("style"),e._oriContent=t.html(),e._oriEleWidth=r,e._oriEleHeight=i,t.is("textarea")?(o==="ribbon"?e.$ribbon=n(e._getDefaultRibbonMarkup()):o==="bbcode"?e.$ribbon=n(e._getSimpleToolBar(xs)):s.simpleModeCommands&&s.simpleModeCommands.length!==0?(f=n.grep(s.simpleModeCommands,function(e,t){return e!=="Table"},undefined),e.$ribbon=n(e._getSimpleToolBar(f))):e.$ribbon=n(e._getSimpleToolBar(Ss)),s.text&&t.val(s.text),e.sourceView=t,e.editor=t.wrap("<div></div>").parent(),e.editor.width(r).height(i)):(e.editor=t,e.$ribbon=t.children(":eq(0)"),h=t.children(":eq(1)"),h.is("textarea")?(s.text&&h.val(s.text),e.sourceView=h):(s.text?p=s.text:p=h.html(),h.remove(),e.sourceView=n("<textarea></textarea>").val(p))),u=n("<div class='"+gr+"'></div>"),e.dialog=n("<div class ='"+mr+"'></div>"),e.subDialog=n("<div class ='"+mr+"'></div>"),e.editor.addClass(mr).addClass(e.options.wijCSS.widget).append(u).append(e.dialog).append(e.subDialog),e._createMenuMarkUp(e,s),e.$ribbon.wrap("<a href='javascript:void(null)'></a>").parent().appendTo("<div class='"+yr+" ui-widget-header ui-helper-clearfix ui-corner-top'></div>").parent().appendTo(u),a=n("<div class='"+br+"'></div>").appendTo(u),e.designView=n("<iframe frameborder='0'></iframe>"),e.designView.wrap("<div></div>").parent().appendTo(a),e.sourceView.wrap("<div></div>").parent().appendTo(a),l=[e.$ribbon],e.$modes=n(e._getRibbonModesMarkup()),s.showFooter&&(c=n("<div class='"+wr+" "+"ui-widget ui-widget-content ui-state-default'></div>"),u.append(c),c.append("<div class='"+Er+"'></div>"),e.$modes.appendTo(c),l.push(e.$modes)),n.each(l,function(t,n){n.wijribbon({click:function(t,n){e._ribbonCommand(n.commandName,n.name),e._trigger("commandButtonClick",t,n)}})})},t.prototype._createMenuMarkUp=function(e,t){t.customContextMenu&&!n.browser.webkit&&(e.contextMenu=n("<ul><li _c1buttoncmd='cut'><a>"+this.localizeString("contextMenuCut","Cut")+"</a></li>"+"<li _c1buttoncmd='copy'><a>"+this.localizeString("contextMenuCopy","Copy")+"</a></li>"+"<li _c1buttoncmd='paste'><a>"+this.localizeString("contextMenuPaste","Paste")+"</a></li></ul>"),n("<a href='#'></a>").append(e.contextMenu).appendTo(e.editor))},t.prototype._handleDisabledOption=function(e,t){var r=this;e?(r.disabledDiv||(r.disabledDiv=r._createDisabledDiv(t)),n("body").focus(),r.disabledDiv.appendTo(r.editor)):r.disabledDiv&&(r.disabledDiv.remove(),r.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r=e?e:t.element,i=r.outerWidth(),s=r.outerHeight();return n("<div></div>").addClass("ui-state-disabled").css({"z-index":"99999",position:"relative","background-color":"lightgray",width:i,height:s,left:0,top:-s})},t.prototype._initElements=function(){var e=this,t=e.options,n=e.element.height()-e._getHeader().outerHeight(!0)-e._getFooter().outerHeight(!0),r={};e._getContent().height(n).wijsplitter({showExpander:!1,orientation:"horizontal",panel1:{scrollBars:"none",collapsed:!1},panel2:{scrollBars:"none",collapsed:!0}}),e.sourceView.css("width","").css("height",""),e._addHandlerToDesignView(),e._addDefaultFontStyleToDesignView(),e._createWijMenu(),(!t.showPathSelector||e.options.mode==="bbcode")&&e._getPathSelector().hide(),e._ribbonCommand(t.editorMode),t.fullScreenMode&&e._setFullScreen(t.fullScreenMode),r[wt]=!0,r[bt]=!0,e.$ribbon.wijribbon(w,r),e._handleWinDocumentKeyDown()},t.prototype._handleWinDocumentKeyDown=function(){var e=this;n(document).keydown(function(t){if(e.options.disabled)return;switch(t.keyCode){case 27:e._escActionAssociated()}})},t.prototype._setOption=function(e,t){var r=this,i=r.options,s=i.mode,o=r.$ribbon.parent(),u=i.customContextMenu;n.Widget.prototype._setOption.apply(r,arguments);if(e==="fullScreenMode")i.fullScreenMode=t,r._setFullScreen(t);else if(e==="showPathSelector")i.showPathSelector=t,t?r._getPathSelector().show():r._getPathSelector().hide();else if(e==="editorMode")i.editorMode=t,r._ribbonCommand(t);else if(e==="fullScreenContainerSelector")i.fullScreenContainerSelector=t,r.options.fullScreenMode&&r._setFullScreen(!0);else if(e==="disabled")r._handleDisabledOption(t,r.editor);else if(e==="showFooter")t?n("."+wr).is(":visible")||n("."+wr).show():n("."+wr).is(":visible")&&n("."+wr).hide();else if(e==="commandButtonClick")i.commandButtonClick=t;else if(e==="text")i.text=t,r.setText(t);else if(e==="customContextMenu"){if(u===t)return;t?(r.contextMenu||r._createMenuMarkUp(r,i),r._createWijMenu()):(r.contextMenu[r._contextMenuWidgetName()]("destroy").remove(),r.contextMenu=undefined)}else e==="mode"&&t!==s&&(r.$ribbon.wijribbon("destroy"),r.$ribbon.remove(),t==="ribbon"?r.$ribbon=n(r._getDefaultRibbonMarkup()):t==="bbcode"?r.$ribbon=n(r._getSimpleToolBar(xs)):r.$ribbon=n(r._getSimpleToolBar(Ss)),o.append(r.$ribbon),r.$ribbon.wijribbon({click:function(e,t){r._ribbonCommand(t.commandName,t.name),r._trigger("commandButtonClick",e,t)}}),r._ribbonCommand(i.editorMode))},t.prototype._getHeader=function(){return n("."+yr,this.editor)},t.prototype._getContent=function(){return n("."+br,this.editor)},t.prototype._getFooter=function(){return n("."+wr,this.editor)},t.prototype._getPathSelector=function(){return n("."+Er,this.editor)},t.prototype._getModes=function(){return n("."+lr,this.editor)},t.prototype._getDesignView=function(){return this.designView},t.prototype._getDesignViewWindow=function(){var e=this.designView;return e&&e.length>0?e[0].contentWindow:null},t.prototype._getDesignViewDocument=function(){var e=this._getDesignViewWindow();return e?e.document:null},t.prototype._getDesignViewText=function(){var e=this._getDesignViewDocument();return e&&e.body&&e.body.innerHTML?e.body.innerHTML:""},t.prototype._setDesignViewText=function(e){var t=this,n=this._getDesignViewDocument();this.options.mode==="bbcode"&&(e=t._convertBBCodeToHtml(e)),n&&n.body&&(n.body.innerHTML=e),t.options.text=e},t.prototype._getDialog=function(){return this.dialog},t.prototype._getSubDialog=function(){return this.subDialog},t.prototype._initContentDocument=function(){var e=this,t=e.sourceView.val(),r=e._getDesignViewDocument();e.options.mode==="bbcode"&&(t=e._convertBBCodeToHtml(n.trim(t))),r.open(),r.write('<html style="width:100%;height:100%;'+(e.options.enabled?"cursor:text;":"")+'"><head><title></title><style id="__wijStyle" '+' type="text/css" >table,td,tr{border: 1px #acacac dashed;}'+"</style></head><body>"+t+"</body></html>"),r.close(),d||n("#__wijStyle",r).prop("disabled",!d),e.element.attr("accesskey")&&(n(r.body).attr("accesskey",e.element.attr("accesskey")),e.element.removeAttr("accesskey")),m=[],m.push(t),v=0},t.prototype._addHandlerToDesignView=function(){var e=this,t=e._getDesignViewWindow(),n=t.document;e._initContentDocument(),e._loadDesignView()},t.prototype._loadDesignView=function(){var e=this,t=e._getDesignViewWindow(),r=t.document;n.browser.mozilla?setTimeout(e._setDesignModeForFF,1e3,e):e._setContentEditable(r,!0),n.browser.msie&&e._setContentSpellCheck(r,!1),e.sourceView.bind("blur."+e.widgetName,function(t){e._onSourceViewBlur()}),e.sourceView.bind("keyup."+e.widgetName,function(t){e._onSourceViewBlur()}),n.browser.mozilla?n(r).bind("blur."+e.widgetName,function(t){e._onDesignViewBlur(t)}):n(t).blur(function(t){e._onDesignViewBlur(t)}),n(r).bind("mouseup."+e.widgetName,function(t){e._onDesignViewMouseUp(t)}).bind("keydown."+e.widgetName,function(t){e._onDesignViewKeyDown(t)}).bind("keyup."+e.widgetName,function(t){e._onDesignViewKeyUp(t),e._onDesignViewBlur(t)})},t.prototype._addDefaultFontStyleToDesignView=function(){var e=this,t=e.options,r=e._getDesignViewDocument(),i=t.defaultFontName,s=t.defaultFontSize,o='<style type="text/css"> body {';if(!(i!==""&&i!==null||s!==""&&s!==null))return;i!==""&&i!==null&&(o+="font-family: "+i+";"),t.defaultFontSize!==""&&t.defaultFontSize!==null&&(o+=" font-size: "+s+";"),o+="}</style>",window.setTimeout(function(){n(o).appendTo(n("head",r))},200),e._setFontStyleButtonState(i,zt),e._setFontStyleButtonState(s,Wt)},t.prototype._setFontStyleButtonState=function(e,t){var r="";if(!e||e===null)return;n.each(this.$ribbon.wijribbon("getDropdownList",t),function(t,n){if(n.toUpperCase()===e.toUpperCase())return r=t,!1}),this.$ribbon.wijribbon(E,r,!0,t)},t.prototype._setDesignModeForFF=function(e){var t=e._getDesignViewDocument();t&&(t.designMode="on")},t.prototype.destroy=function(){var e=this;e.element.html(e._oriContent),e.element.removeAttr("tabindex"),e._oriStyle===undefined?e.element.removeAttr("style"):e.element.attr("style",e._oriStyle),e.element.insertBefore(e.editor),e.element.unbind("."+e.widgetName),e.editor.remove(),n.Widget.prototype.destroy.call(e)},t.prototype.showEditorDialog=function(e){switch(e){case ht:case st:case Pt:case Mt:case Ot:case Lt:case kt:case St:case Ht:case G:case Y:case Vt:this._ribbonCommand(e);break;default:i("Cannot find the dialog with command name '"+e+"'!")}},t.prototype.executeEditorAction=function(e,t){this._ribbonCommand(e,t)},t.prototype._isFontSizeCustomized=function(){if(h!==null)return h;var e=this.$ribbon.wijribbon("getDropdownList",Wt),t=[Bt,jt,Ft,It,qt,Rt,Ut];return h=!1,n.each(e,function(e,r){if(n.inArray(e,t)===-1)return h=!0,!1}),h},t.prototype._fontSizeCommand=function(e){var t=this,r=t._getDesignViewDocument(),i,s=4,o="font-size",a=[];t._getDesignViewWindow().getSelection&&(i=t._getDesignViewWindow().getSelection());switch(e){case Bt:s=1;break;case jt:s=2;break;case Ft:s=3;break;case It:s=4;break;case qt:s=5;break;case Rt:s=6;break;case Ut:s=7}t._isFontSizeCustomized()?n.browser.msie?t._formatFontSpan(r,o,e):(r.execCommand("FontSize",!1,s),n.each(n("font[size]",r),function(r,i){a.push(t._replaceFontWithSpan(n(i),"size",o,e))}),t._setSelection(a)):n.browser.msie&&u(n.browser.version)>=9?i&&i.rangeCount>0&&r.execCommand("FontSize",!1,s):r.execCommand("FontSize",!1,s),t.options.mode==="bbcode"&&!n.browser.msie&&t._convertFontStyleToStandTag(),t._addtoUndoBuffer()},t.prototype._fontNameCommand=function(e){var t=this,r=t._getDesignViewDocument(),i,s=t.$ribbon.wijribbon("getDropdownList",zt),o;t._getDesignViewWindow().getSelection&&(i=t._getDesignViewWindow().getSelection()),n.each(s,function(t,n){if(e===t)return o=n,!1}),n.browser.msie&&u(n.browser.version)>=9?i&&i.rangeCount>0&&r.execCommand("FontName",!1,o):r.execCommand("FontName",!1,o),t._isFontSizeCustomized()&&n.browser.msie&&t._formatFontSpan(r,"font-family",o),t._addtoUndoBuffer()},t.prototype._formatFontSpan=function(e,t,r){var i=this,s=r,o="fontFamily",u=[];t!=="font-family"&&(s="c1-temp",o="fontSize"),e.execCommand("FontName",!1,s),n.each(n("font[face='"+s+"']",e),function(e,s){var a=i._replaceFontWithSpan(n(s),"face",t,r),f,l;u.push(a),f=n("span."+ms,a);for(l=f.length-1;l>=0;l--)i._removeSpecifiedStyleSpan(n(f[l]),o,t);n.each(a,function(e,r){n.each(n(r).parents("span."+ms),function(e,s){var u=n(s);if(u.children().length>1)return!1;u.text()===n(r).text()&&i._removeSpecifiedStyleSpan(u,o,t)})})}),i._setSelection(u)},t.prototype._setSelection=function(e,t,r){var i=this._getDesignViewWindow(),s=i.document,o,u,a,f,l=0;try{n.browser.msie?(o=s.selection.createRange(),e?(n.each(e,function(e,t){l+=t.text().length}),o.moveToElementText(e[0][0]),o.collapse(!0),o.moveEnd("character",l)):(o.moveStart("textedit",-1),o.collapse(!0),o.moveStart("character",t),o.moveEnd("character",r)),o.select()):(f=i.getSelection(),o=s.createRange(),u=e[0][0],a=e[e.length-1][0],o.setStart(u,0),o.setEnd(a,a.childNodes.length),f.removeAllRanges(),f.addRange(o))}catch(c){}},t.prototype._replaceFontWithSpan=function(e,t,n,r){e.wrap("<span class = '"+ms+"' style='"+n+":"+r+"'></span>");var i=e.parent();return e.removeAttr(t),/<font\s*>/ig.test(i.html())&&(i.html(e.html()),e.remove()),i},t.prototype._removeSpecifiedStyleSpan=function(e,t,r){var i,s=!0;e[0].style[t]!==""&&e.css(r,""),i=e.attr("style"),i&&n.each(i.split(";"),function(e,t){var i=n.trim(t).toLowerCase();if(i!==""&&i.indexOf(r)!==-1)return s=!1,!1}),s&&e.replaceWith(e.html())},t.prototype._removeFormat=function(){var e=this,t=e._getDesignViewDocument(),r={};t.execCommand(ot,!1,null),e._isFontSizeCustomized()&&n.browser.msie&&e._removeFormatForIE(t),e._addtoUndoBuffer(),r[Z]=!1,r[et]=!1,r[tt]=!1,r[nt]=!1,r[rt]=!1,r[it]=!1,r[$]=!1,r[J]=!1,r[U]=!1,r[z]=!1,r[W]=!1,r[X]=!1,e.$ribbon.wijribbon(S,r)},t.prototype._removeFormatForIE=function(e){var t=e.selection.createRange(),r=t.htmlText,i=t.text,s=0,o=n(t.parentElement()),u=n(e.body),a="",f="",l="__c1temp",c="c1-temp",h="<span class='"+c+"'>"+l+"</span>",p,d,v,m,g,y;o.addClass("c1-app-parent"),t.pasteHTML(h),s=u.text().indexOf(l),p=n("span."+c,e),d=p,p.parentsUntil("body").each(function(e){if(n(this).is(".c1-app-parent"))return!1;d=n(this)}),p.html(r),v=n("span."+ms,p);for(g=v.length-1;g>=0;g--)m=n(v[g]),m.replaceWith(m.html());d.is("."+c)||d.after(p),n.each(d.parents("span."+ms),function(e,t){a+="</span>",f="<span class='"+ms+"' style = '"+n(t).attr("style")+"'>"+f}),r=p.html(),p.replaceWith(l),y=u.html().split(l),u.html(y[0]+a+r+f+y[1]),v=n("span."+ms,e);for(g=v.length-1;g>=0;g--)m=n(v[g]),m.text()===""&&m.replaceWith(m.html());n(".c1-app-parent",e).removeClass("c1-app-parent"),this._setSelection(null,s,i.length)},t.prototype._toggleFullScreen=function(){var e=this,t=e.options;t.fullScreenMode=!t.fullScreenMode,e._setFullScreen(t.fullScreenMode),e.$modes.wijribbon(E,yt,t.fullScreenMode),e.$modes.wijribbon("removeButtonHoverState",yt)},t.prototype._setFullScreen=function(e){var t=this,r=1,i=t._getHeader(),o=t._getFooter(),c=t._getContent(),h=t.options.fullScreenContainerSelector,p=n(h),d=t._getDesignViewText(),v,m,g;e?(p.length===0&&(p=n(s),h="body",t._oriDocOverFlow=n(document.documentElement).css("overflow"),n(document.documentElement).css({overflow:"hidden"}),n.browser.mozilla||window.scrollTo(0,0),n(s).bind("resize.wijeditor",function(){t._fullscreenOnWindowResize()})),v=p.width(),m=p.height()-2*r,a=t.editor.width(),f=t.editor.height(),l||(l=t.editor.parent()),t._replacedDiv||(t._replacedDiv=n("<div />")),t.editor.after(t._replacedDiv),n(h).append(t.editor),t.editor.css({width:v,height:m,position:""}).addClass(Sr),t.$ribbon.wijribbon("updateRibbonSize")):(t._replacedDiv.after(t.editor).remove(),t.editor.css({width:a,height:f,position:"static"}).removeClass(Sr),t.options.fullScreenContainerSelector||n(document.documentElement).css({overflow:t._oriDocOverFlow}),n(s).unbind("resize.wijeditor"),t.$ribbon.wijribbon("updateRibbonSize")),g=t.editor.height()-i.outerHeight(!0)-o.outerHeight(!0),c.height(g).wijsplitter("refresh"),t._addHandlerToDesignView(),t._addDefaultFontStyleToDesignView(),t._createWijMenu(),n.browser.msie&&window.setTimeout(function(){t.options.mode==="bbcode"&&(d=t._convertHtmlToBBCode(n.trim(d))),t._setDesignViewText(d),u(n.browser.version)>=9&&t.sourceView.val(d)},40)},t.prototype._createWijMenu=function(){var e=this,t=e._getDesignViewDocument();e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]({orientation:"vertical",trigger:e.designView,triggerEvent:"rtclick",showing:function(r,i){n.browser.msie&&(g=t.selection.createRange());var s=e.designView.offset(),o=n(n(e.designView)[0].contentWindow).scrollLeft(),u=n(n(e.designView)[0].contentWindow).scrollTop(),a=s.left+2-o,f=s.top-u;i.options.position={my:"left+"+a+" "+"top+"+f,at:"right top",of:r,collision:"none none"}},animation:{animated:"fade"},select:function(t,n){e._setIESelection(),e._contextMenuItemClick(t,n),e.contextMenu[e._contextMenuWidgetName()]("deactivate")}})},t.prototype._fullscreenOnWindowResize=function(){var e=this,t=e._getHeader(),r=e._getFooter(),i=e._getContent(),s,o=n(window).width(),u=n(window).height();e.editor.css({width:o,height:u}),s=e.editor.height()-t.height()-r.height(),i.height(s).wijsplitter("refresh")},t.prototype._saveText=function(e){},t.prototype._doSpellCheck=function(){},t.prototype._ribbonCommand=function(e,t){var r=this,i=r._getDesignViewDocument(),s=r._getContent(),o,u,a;if(t===zt){r._fontNameCommand(e),r._onDesignViewBlur(null);return}if(t===Wt){r._fontSizeCommand(e),r._onDesignViewBlur(null);return}r.editor.hasClass("ui-helper-hidden-accessible")||r._setIEFocus();switch(e){case Xt:n.browser.msie?(i.execCommand("FormatBlock",!1,"<ADDRESS>"),a=i.selection.createRange(),a=n(a.parentElement()).closest("address"),a.length&&(a.replaceWith("<blockquote>"+a.html()+"</blockquote>"),i.body.innerHTML=i.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<BLOCKQUOTE>/gi,"<BLOCKQUOTE>"),i.body.innerHTML=i.body.innerHTML.replace(/<\/BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"</BLOCKQUOTE>"),i.body.innerHTML=i.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,""))):i.execCommand("FormatBlock",!1,"<BLOCKQUOTE>"),r._addtoUndoBuffer(),r._setFocusNotIE();break;case x:o=r._generateUniqueName("form"),r.insertHTML('<form id="'+o+'" name="'+o+'" method="post">'+o+"</form>"),r._setFocusNotIE();break;case T:o=r._generateUniqueName("image"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="image"'+' value="'+o+'"/>'),r._setFocusNotIE();break;case N:o=r._generateUniqueName("textarea"),r.insertHTML('<textarea id="'+o+'" name="'+o+'" rows="4" cols="48"></textarea>'),r._setFocusNotIE();break;case C:o=r._generateUniqueName("button"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="button"'+' value="'+o+'"/>'),r._setFocusNotIE();break;case k:o=r._generateUniqueName("textbox"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="text"'+' value="'+o+'"/>'),r._setFocusNotIE();break;case L:o=r._generateUniqueName("list"),r.insertHTML('<select id="'+o+'" name="'+o+'" style="width: 120px" size="8"></select>'),r._setFocusNotIE();break;case A:o=r._generateUniqueName("password"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="password" value="'+o+'"/>'),r._setFocusNotIE();break;case O:o=r._generateUniqueName("dropdown"),r.insertHTML('<select id="'+o+'" name="'+o+'"></select>'),r._setFocusNotIE();break;case M:o=r._generateUniqueName("hidden"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="hidden" value="'+o+'" />'),r._setFocusNotIE();break;case _:o=r._generateUniqueName("radiobox"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="radio"'+' value="'+o+'">'+'<label for="'+o+'">'+o+"</label></input>"),r._setFocusNotIE();break;case D:o=r._generateUniqueName("checkbox"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="checkbox"'+' value="'+o+'">'+'<label for="'+o+'">'+o+"</label></input>"),r._setFocusNotIE();break;case P:case H:case B:case j:case F:case I:case q:case R:r._tableAction(e);break;case V:r._toggleTableBorders();break;case rt:try{i.queryCommandState(it)&&(i.execCommand(it,!1,null),r.$ribbon.wijribbon(E,it,!1))}catch(f){}i.execCommand(rt,!1,null),r._addtoUndoBuffer(),r._setFocusNotIE();break;case it:try{i.queryCommandState(rt)&&(i.execCommand(rt,!1,null),r.$ribbon.wijribbon(E,rt,!1))}catch(l){}i.execCommand(it,!1,null),r._addtoUndoBuffer(),r._setFocusNotIE();break;case ot:r._removeFormat(),r._setFocusNotIE();break;case ut:r.insertHTML("<br/>"),r._setFocusNotIE();break;case at:u=r._getSelectedContent();if(!u||u==="")u="&nbsp;";r.insertHTML("<p>"+u+"</p>"),r._setFocusNotIE();break;case ft:r.insertHTML('<div title="Print Page Break" style="font-size:1px;page-break-before:always;vertical-align:middle;height:1px;background-color:#c0c0c0">&nbsp;</div>'),r._setFocusNotIE();break;case yt:r._toggleFullScreen();break;case bt:r._undoAction(),r._setFocusNotIE();break;case wt:r._redoAction(),r._setFocusNotIE();break;case xt:r._execCut(),r._setFocusNotIE();break;case Tt:r._execCopy();break;case Nt:r._execPaste();break;case At:r.insertDateAndTime(),r._setFocusNotIE();break;case dt:r.$modes.data("wijmoWijribbon")&&r.$modes.wijribbon(b,gt,!0).wijribbon(E,dt,!0),r.$ribbon.wijribbon("option","disabled",!1),s.wijsplitter("option","panel2",{collapsed:!0});break;case vt:r.$modes.data("wijmoWijribbon")&&r.$modes.wijribbon(b,gt,!0).wijribbon(E,vt,!0),r.$ribbon.wijribbon("option","disabled",!1),s.wijsplitter("option",{panel1:{collapsed:!1},panel2:{collapsed:!1}});break;case mt:r.$modes.data("wijmoWijribbon")&&r.$modes.wijribbon(b,gt,!1).wijribbon(E,mt,!0),r.$ribbon.wijribbon("option","disabled",!0),s.wijsplitter("option","panel1",{collapsed:!0}),n.browser.msie&&r.sourceView.focus();break;case gt:s.wijsplitter("option","panel1").collapsed&&r._toggleWordWrap();break;case G:r._saveSelectionForIE(),r._createDialog(this.localizeString("backColorDialogTitle","Set BackColor"),r._getDialogRes_BackColor(),r.initBackColorDialog);break;case Y:r._saveSelectionForIE(),r._createDialog(this.localizeString("foreColorDialogTitle","Set ForeColor"),r._getDialogRes_ForeColor(),r.initForeColorDialog);break;case ht:r._saveSelectionForIE(),r._createDialog(this.localizeString("insertTableDialogTitle","Insert Table"),r._getDialogRes_Table(),r.initInsertTableDialog);break;case pt:r._getEditableTable()&&r._createDialog(this.localizeString("editTableDialogTitle","Edit Table"),r._getDialogRes_Table(),r.initEditTableDialog);break;case Et:r._createDialog(this.localizeString("previewDialogPreview","Preview"),r._getDialogRes_Preview(),r.initPreviewDialog);break;case St:r._createDialog(this.localizeString("cleanUpDialogTitle","Clean up source HTML document"),r._getDialogRes_CleanUp(),r.initCleanUpDialog);break;case kt:r._saveSelectionForIE(),r._createDialog(this.localizeString("mediaDialogTitle","Insert media"),r._getDialogRes_Media(),r.initMediaDialog);break;case Lt:r._saveSelectionForIE(),r._createDialog(this.localizeString("specialCharacterDialogTitle","Insert special character"),r._getDialogRes_SpecialCharacter(),r.initSpecialCharacterDialog);break;case Ot:r._createDialog(this.localizeString("findAndReplaceTitle","Find and replace"),r._getDialogRes_FindAndReplace(),r.initFindDialog);break;case Mt:y=r._getSelectedElement(),r._createDialog(this.localizeString("tagInspectorDialogTitle","Tag Inspector"),r._getDialogRes_TagInspector(),r.initTagInspectorDialog);break;case st:r._saveSelectionForIE(),r._createDialog(this.localizeString("templateDialogApplyTemplate","Apply Template"),r._getDialogRes_Template(),r.initTemplateDialog);break;case Pt:r._saveSelectionForIE(),r._createDialog(this.localizeString("imageEditorDialogImageBrowser","Image Browser"),r._getDialogRes_ImageBrowser(),r.initImageBrowserDialog);break;case Ht:r._saveSelectionForIE(),r._createDialog(this.localizeString("hyperLinkDialogInserthyperLink","Insert hyperLink"),r._getDialogRes_Link(),r.initHyperLinkDialog);break;case Vt:r._saveSelectionForIE(),r._createDialog("Insert Code",r._getDialogRes_Code(),r.initInsertCodeDialog);break;case U:case z:case W:case X:case K:case Q:case Z:case et:case nt:case $:case J:case tt:case lt:case Ct:i.execCommand(e,!1,null),r.options.mode==="bbcode"&&!n.browser.msie&&r._convertStyleToStandTag(),r._addtoUndoBuffer(),r._setFocusNotIE();break;case _t:r._saveText();break;case Dt:r._doSpellCheck()}r._onDesignViewBlur(null)},t.prototype._saveSelectionForIE=function(){var e=this._getDesignViewWindow(),t;n.browser.msie&&(t=e.document.selection,g=t.createRange())},t.prototype._createDialog=function(e,t,r){var i=this,s,o=i.dialog;o.html("").undelegate(i.widgetName).undelegate("."+i.widgetName).append(t),i.subDialog&&i.subDialog.html("").undelegate(i.widgetName).undelegate("."+i.widgetName),s={width:"auto",height:"auto",modal:!0,title:e,position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},o.data("wijmoWijdialog")?(o.wijdialog("reset"),o.wijdialog("option",{width:"auto",height:"auto",title:e})):n.browser.msie&&u(n.browser.version)===6?window.setTimeout(function(){o.wijdialog(s)},0):o.wijdialog(s),i._adjustDialogLayoutForIE7(),r&&r.call(i),o.wijdialog("open")},t.prototype._adjustDialogLayoutForIE7=function(){var e=this.dialog;n.browser.msie&&/^7\.[0-9]+/.test(n.browser.version)&&e.wijdialog("option","width",e.parent().width())},t.prototype._contextMenuItemClick=function(e,t,n){var r=this,i=t.item.element.attr("_c1buttoncmd");switch(i){case xt:r._execCut();break;case Tt:r._execCopy();break;case Nt:r.focus(),r._execPaste()}},t.prototype._execCut=function(){var e=this,t=e._getDesignViewDocument();n.browser.safari?i(this.localizeString("errorMessageCutError","This function is not supported in current browser.  Plesse use (Ctrl + X).")):n.browser.msie?(t.execCommand("Cut",!1,null),e._addtoUndoBuffer()):(e._execCopy(),e._deleteSelectionContent(),e._addtoUndoBuffer())},t.prototype._execCopy=function(){var e=this,t=e._getDesignViewDocument();n.browser.safari?i(this.localizeString("errorMessageCopyError","This function is not supported in current browser. Plesse use (Ctrl + C).")):n.browser.msie?(t.execCommand("Copy",!1,null),e._addtoUndoBuffer()):e._copyToClipboard(e._getSelectedContent())},t.prototype._execPaste=function(){var e=this,t,r=e._getDesignViewDocument();if(n.browser.safari)i(this.localizeString("errorMessagePasteError","This function is not supported in current browser. Plesse use (Ctrl + V)."));else if(n.browser.msie)r.execCommand("Paste",!1,null),e._addtoUndoBuffer();else try{t=e._copyFromClipboard(),t&&t!==""&&e.insertHTML(t)}catch(s){}},t.prototype._getFontSizeCollection=function(){return{"10px":Bt,"13px":jt,"16px":Ft,"18px":It,"24px":qt,"32px":Rt,"48px":Ut,1:Bt,2:jt,3:Ft,4:It,5:qt,6:Rt,7:Ut}},t.prototype._updateButtonStates=function(e){var t=this,r=t._getDesignViewDocument(),i,s,o={},u=[Z,et,tt,nt,rt,it,$,J,U,z,W,X],a,f=e.target,l=n(f);n.each(u,function(e,t){o[t]=r.queryCommandState(t)}),t.$ribbon.wijribbon(S,o),i=t._queryCommandValue(zt)||"",n.each(t.$ribbon.wijribbon("getDropdownList",zt),function(e,t){if(t.toUpperCase()===i.toUpperCase())return s=e,!1}),t.$ribbon.wijribbon(E,s,!0,zt),t._isFontSizeCustomized()?(l.is("span")?s=f.style.fontSize:s="",s===""&&(a=l.parents("span."+ms),n.each(a,function(e,t){s=t.style.fontSize;if(s&&s!=="")return!1})),s===""&&(s=l.css("font-size"))):(i=t._queryCommandValue(Wt)||"",i===""&&(i=l.css("font-size")),n.each(t._getFontSizeCollection(),function(e,t){if(e.toString()===i.toString())return s=t,!1})),t.$ribbon.wijribbon(E,s,!0,Wt)},t.prototype._queryCommandValue=function(e){var t=this._getDesignViewDocument();try{if(!t.queryCommandEnabled(e))return null}catch(n){return null}try{return t.queryCommandValue(e)}catch(r){}return null},t.prototype._escActionAssociated=function(){var e=this,t=e._getDesignViewWindow();t&&t.document&&t.document.selection!==undefined&&t.document.selection.empty(),t&&t.getSelection!==undefined&&t.getSelection().removeAllRanges(),e._hideAllDropdownsMenus()},t.prototype._hideAllDropdownsMenus=function(){var e=this;e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]("hideAllMenus"),e.$ribbon.wijribbon("hideDropdown",zt).wijribbon("hideDropdown",Wt).wijribbon("hideDropdown",ct)},t.prototype._onDesignViewKeyDown=function(e){var t=this,n;t._setSaveBtnEnabled();try{if(e.ctrlKey)n=String.fromCharCode(e.keyCode).toLowerCase();else switch(e.keyCode){case 27:t._escActionAssociated();break;case 13:case 46:t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1;break;default:t._continueSavingInputTextForUndo=!0}}catch(r){}},t.prototype._onDesignViewKeyUp=function(e){var t=this,r;if(e.keyCode===37||e.keyCode===38||e.keyCode===39||e.keyCode===40||e.keyCode===33||e.keyCode===34||e.keyCode===35||e.keyCode===36)n.browser.msie&&n.browser.version==="6.0"?(t._keyTimeoutHandlerIE6&&(clearTimeout(t._keyTimeoutHandlerIE6),t._keyTimeoutHandlerIE6=null),t._keyTimeoutHandlerIE6=window.setTimeout(function(){t._updateButtonStates(e)},300)):t._updateButtonStates(e);if(e.ctrlKey){r=String.fromCharCode(e.keyCode).toLowerCase();switch(r){case"y":t._redoAction(),e.preventDefault(),e.stopPropagation();break;case"z":t._undoAction(),e.preventDefault(),e.stopPropagation();break;case"x":case"v":t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1}}},t.prototype._onDesignViewMouseUp=function(e){var t=this,r;if(e.button===2)return;t._updateButtonStates(e),t._refreshPathSelector(),t._hideAllDropdownsMenus(),n(document).mouseup();if(n.browser.msie){r=n(e.target).closest("a");if(e.ctrlKey&&r.length>0)try{r.focus(),s.open(r[0].href,"_blank")}catch(i){}}},t.prototype._onDesignViewBlur=function(e){var t=this,r=t.options,i;i=t._getDesignViewText(),t._onTextChange(e),r.mode==="bbcode"&&(i=t._convertHtmlToBBCode(n.trim(i))),t.sourceView.val(i),r.text=i},t.prototype._onTextChange=function(e){var t=this;t._continueSavingInputTextForUndo&&(t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1),t._trigger("textChanged",e,{text:t.options.text})},t.prototype._onSourceViewBlur=function(){var e=this,t;t=e.sourceView.val(),e._setDesignViewText(t),e.options.text=t},t.prototype._convertBBCodeToHtml=function(e){return e?(e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/(?:\r\n|\n|\r)/g,"<br>"),e=e.replace(/\[EMAIL\]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$1</a>'),e=e.replace(/\[EMAIL\=([^\]]+)]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$2</a>'),e=e.replace(/\[URL\]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$1</a>'),e=e.replace(/\[URL\=([^\]]+)]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$2</a>'),e=e.replace(/\[B\]/gim,"<b>"),e=e.replace(/\[\/B\]/gim,"</b>"),e=e.replace(/\[I\]/gim,"<i>"),e=e.replace(/\[\/I\]/gim,"</i>"),e=e.replace(/\[S\]/gim,"<strike>"),e=e.replace(/\[\/S\]/gim,"</strike>"),e=e.replace(/\[U\]/gim,"<u>"),e=e.replace(/\[\/U\]/gim,"</u>"),e=e.replace(/\[IMG height=(.*?) width=(.*?)](.+?)\[\/IMG\]/gim,'<img height="$1" width = "$2" src="$3"/>'),e=e.replace(/\[BLOCK\]/gim,"<blockquote>"),e=e.replace(/\[\/BLOCK\]/gim,"</blockquote>"),e=e.replace(/\[LIST\=1\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ol><li>$1</li></ol>"),e=e.replace(/\[LIST\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ul><li>$1</li></ul>"),e=e.replace(/\[\*\]/gim,"</li><li>"),e=e.replace(/\[size=([^\]]*?)\]/gi,'<font size="$1">'),e=e.replace(/\[\/size\]/gim,"</font>"),e=e.replace(/\[color=([^\]]*?)\]/gi,'<font color="$1">'),e=e.replace(/\[\/color\]/gim,"</font>"),e):""},t.prototype._replaceComplexHtml=function(e){var t,r,i,s,o=n("<div/>").html(e);t=n("img",o),n.each(t,function(){i="[IMG height="+n(this).height()+" width="+n(this).width()+"]"+n(this).attr("src").toString()+"[/IMG]",n(this).replaceWith(i)}),r=n("font",o);for(s=r.length-1;s>=0;s--)n(r[s]).attr("color")&&n(n(r[s])).attr("size")?i="[Color="+n(n(r[s])).attr("color")+"]"+"[Size="+n(n(r[s])).attr("size")+"]"+n(n(r[s])).html()+"[/Size][/Color]":n(n(r[s])).attr("color")&&!n(n(r[s])).attr("size")?i="[Color="+n(n(r[s])).attr("color")+"] "+n(n(r[s])).html()+"[/Color]":n(n(r[s])).attr("size")&&!n(n(r[s])).attr("color")&&(i="[Size="+n(n(r[s])).attr("size")+"]"+n(n(r[s])).html()+"[/Size]"),n(n(r[s])).replaceWith(i);return o.html()},t.prototype._convertHtmlToBBCode=function(e){var t=this;if(e==="")return;return e=t._replaceComplexHtml(e),e=e.replace(/<br(?=[ \/>]).*?>/gim,"\r\n"),e=e.replace(/<a .*?href=(["'])(.+?)\1.*?>(.+?)<\/a>/gi,"[URL=$2]$3[/URL]"),e=e.replace(/<a .*?href=(["'])mailto:(.+?)\1.*?>(.+?)<\/a>/gi,"[EMAIL=$2]$3[/EMAIL]"),e=e.replace(/<(?:b|strong)>/gim,"[B]"),e=e.replace(/<\/(?:b|strong)>/gim,"[/B]"),e=e.replace(/<(?:i|em)>/gim,"[I]"),e=e.replace(/<\/(?:i|em)>/gim,"[/I]"),e=e.replace(/<(?:strike|s)>/gim,"[S]"),e=e.replace(/<\/(?:strike|s)>/gim,"[/S]"),e=e.replace(/<u>/gim,"[U]"),e=e.replace(/<\/u>/gim,"[/U]"),e=e.replace(/<blockquote.*?\>/gim,"[BLOCK]"),e=e.replace(/\s{0,}<\/blockquote>/gim,"[/BLOCK]"),e=e.replace(/(?:\r\n|\r|\n){0,1}<(?:ol)>[\s]*/gim,"[LIST=1]"),e=e.replace(/<\/(?:ol)>/gim,"[/LIST]"),e=e.replace(/(?:\r\n|\r|\n){0,1}\<(?:ul)>[\s]*/gim,"[LIST]"),e=e.replace(/<\/(?:ul)>/gim,"[/LIST]"),e=e.replace(/\s{0,}<li\s{0,1}.*?>([\s\S]*?)\n{0,}\s{0,}<\/li>/gim,"[*]$1"),e=e.replace(/&nbsp;/gi," "),e=e.replace(/(<[^>]+>)/gm,""),e},t.prototype._convertFontStyleToStandTag=function(){var e=this,t=e._getDesignViewDocument(),r=n(t.body),i,s,o=n("[style*='color: ']",r);o.length!==0&&(i=o,s="<font color='"+e._getWebColorFromRgb(o.css("color"))+"'></font>"),i&&n.each(i,function(e){n(this).is("span")?n(this).replaceWith(n(s).html(n(this).html())):n(this).is("font")&&n(this).attr("size")&&n(this).removeAttr("style").html(n(s).html())})},t.prototype._convertStyleToStandTag=function(){var e=this,t=e._getDesignViewDocument(),r=n(t.body),i,s,o,u=n("[style*='font-weight: bold;']",r),a=n("[style*='font-style: italic;']",r),f=n("[style*='text-decoration: line-through;']",r),l=n("[style*='text-decoration: underline;']",r);u.length!==0?(i=u,s="<b></b>",o="font-weight"):a.length!==0?(i=a,s="<i></i>",o="font-style"):f.length!==0?(i=f,s="<strike></strikes>",o="text-decoration"):l.length!==0&&(i=l,s="<u></u>",o="text-decoration"),i&&n.each(i,function(e){n(this).is("span")&&this.style.fontSize===""?n(this).replaceWith(n(s).html(n(this).html())):n(this).removeAttr("style").html(n(s).html())})},t.prototype._getWebColorFromRgb=function(e){var t=this,n;return e.indexOf("rgb(")===0&&(n=e.substring(4,e.length-1).split(","),e=t._convertToWebColor(u(n[0]),u(n[1]),u(n[2]))),e},t.prototype._updateList=function(e,t){var r;n("option",t).remove();for(r in e)e[r]&&t.append("<option>"+r+"</option>")},t.prototype._triggerEvent=function(e,t){var n=this,r=n.options[e];return r&&typeof r=="function"?r.call(n,t):r},t.prototype._closeDialog=function(){this.dialog.wijdialog("close"),g=null,this.focus()},t.prototype._onTemplateList=function(e){return this._triggerEvent("templateList",e)},t.prototype.updateTemplateList=function(e,t){var r=this,i=t||n("select",r.dialog);r._updateList(e,i),r._templateList=e},t.prototype.initTemplateDialog=function(){var e=this,t=e.dialog,r=n("select",t),i=e._onTemplateList();t.delegate("select","change."+e.widgetName,function(){e.templateListOnChanged()}).delegate("."+ei,"click."+e.widgetName,function(){e.deleteTemplate()}).delegate("."+ti,"click."+e.widgetName,function(){e.saveTemplate()}).delegate(gs,"click."+e.widgetName,function(){e.applyTemplate()}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()});if(!i){i=e._templateList;if(!i)return}e.updateTemplateList(i,r)},t.prototype.templateListOnChanged=function(){var e=this,t=e.dialog,r=n("select",t).val(),i=n("iframe",t),s=e._templateList,o;if(!s)return;o=s[r],o.src&&i.attr("src",o.src+"?d="+(new Date).getMilliseconds().toString()),o.text&&i.length>0&&i[0].contentWindow.document.write(o.text),r&&(n("."+Jr,t).html(r),n("."+Gr,t).val(r)),o.desc&&(n("."+Kr,t).html(o.desc),n("."+Yr,t).val(o.desc))},t.prototype._onSaveTemplate=function(e){this._triggerEvent("saveTemplate",e)},t.prototype.saveTemplate=function(){var e=this,t=e.dialog,r=n("."+Gr,t).val(),s=n("."+Yr,t).val(),o=e._templateList,u=this._getDesignViewText();if(n.trim(r)===""){i(this.localizeString("errorMessageTemplateNameError","Please input a template name!"));return}o||(e._templateList=[],o=e._templateList),o[r]||n("select",t).append("<option>"+r+"</option>"),o[r]={desc:s,text:u},e._onSaveTemplate({name:r,desc:s,text:u})},t.prototype._onDeleteTemplate=function(e){this._triggerEvent("deleteTemplate",e)},t.prototype.deleteTemplate=function(){var e=this,t=e.dialog,r=n("select",t),s=r.val(),o=e._templateList;if(n.trim(s)===""){i(this.localizeString("errorMessageTemplateFileError","Please select a template file."));return}n("option:selected",r).remove(),n("iframe",t).attr("src","about:blank"),n("."+Jr,t).empty(),n("."+Gr,t).val(""),n("."+Kr,t).empty(),n("."+Yr,t).val(""),delete o[s],e._onDeleteTemplate(s)},t.prototype.applyTemplate=function(){var e=this,t=e.dialog,r=n("select",t),s=r.val(),o=n("iframe",t)[0],u=n("."+Gr,t).val(),a=o.contentWindow.document.body.innerHTML;if(n.trim(u)===""||n.trim(s)===""){i(this.localizeString("errorMessageValidTemplateFileError","Please select a valid template file."));return}e._setDesignViewText(a),e._addtoUndoBuffer(),e._setSaveBtnEnabled(),e._closeDialog()},t.prototype._onImageList=function(){var e=this,t=e.options.imageList;return t&&typeof t=="function"?t.call(e):t},t.prototype.updateImageList=function(e,t){var r=this,i=r.dialog,s=t||n("select",i),o=n("."+Mr,i);r._updateList(e,s),r._imgList=e;if(!e){o.addClass(Ir);return}o.removeClass(Ir)},t.prototype.initImageBrowserDialog=function(){var e=this,t=e.dialog,r=e._onImageList();n("img",t).hide(),t.delegate("select","change."+e.widgetName,function(){e.imageListOnChanged()}).delegate(gs,"click."+e.widgetName,function(t){e.submitInsertImageDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()}),n("."+Pr+" input",t).bind("change."+e.widgetName,function(){e.imageUrlChanged(this)});if(!r){r=e._imgList;if(!r){n("."+Mr,t).addClass(Ir);return}}e.updateImageList(r,n("select",t))},t.prototype.imageUrlChanged=function(e){var t=this,r=t.dialog;n("img",this.dialog).attr("src",n(e).val()+"?"+(new Date).getTime()).show().bind("load",function(){n("."+Br+" input",r).val(n("img",r).width().toString()),n("."+jr+" input",r).val(n("img",r).height().toString())})},t.prototype.imageListOnChanged=function(){var e=this,t=e.dialog,r=n("select",t).val(),i=e._imgList,o;if(!i)return;o=i[r],n("img",t).prop("src",o).show(),n("."+Pr+" input",t).prop("value",o),s.setTimeout(function(){n("."+Br+" input",t).val(n("img",t).width().toString()),n("."+jr+" input",t).val(n("img",t).height().toString())},200)},t.prototype.submitInsertImageDialog=function(){var e=this,t,r=e.dialog,s=n("."+Pr+" input",r).val(),o=n("."+Hr+" input",r).val(),u=n("."+Br+" input",r).val(),a=n("."+jr+" input",r).val(),f=n("."+Fr+" input",r).val();if(n.trim(s)===""){i(this.localizeString("errorMessageSelectImageError","Please select a image."));return}if(!e._isNumeric(u)){i(this.localizeString("errorMessageImageWidthError","Please input a number for 'Image width' textbox."));return}if(!e._isNumeric(a)){i(this.localizeString("errorMessageImageHeightError","Please input a number for 'Image height' textbox."));return}e.focus(),n.browser.msie?(t='<img src="'+s+'" alt="'+o+'" style="width:'+u+"px;height:"+a+"px",e.options.mode!=="bbcode"&&f!==null&&f!==undefined&&f.length>0&&(t+=";"+f)):(t='<img src="'+s+'" alt="'+o+'" width="'+u+'" height="'+a,e.options.mode!=="bbcode"&&(t+='" style="'+f)),t+='"/>',e.insertHTML(t),e._closeDialog()},t.prototype.initHyperLinkDialog=function(){var e=this,t=e.dialog,r=e.getLinkHrefField(),i=n("."+hi,t),o,u,a,f=n("."+ri+" input",t);t.delegate(gs,"click."+e.widgetName,function(t){e.submitHyperLinkDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+si,"change."+e.widgetName,function(){e.anchorListOnChanged(this)}).delegate("."+ii+">div","click."+e.widgetName,function(){e.radioListOnChanged()}).delegate("."+pi+">div","click."+e.widgetName,function(){e.linkIconTypeOnChanged()}).delegate("."+fi+" input","change."+e.widgetName,function(){e.tempImg=n('<img src="'+n("."+fi+" input",t).val()+'">').appendTo("body"),s.setTimeout(function(){n("."+li+" input",t).val(e.tempImg.width().toString()),n("."+ci+" input",t).val(e.tempImg.height().toString()),e.tempImg.remove(),e.tempImg=undefined},200)});try{f.val(r),u=e._getLinkInnerHTML()}catch(l){}a=n(u),u&&u.substring(0,3)==="<img"?o=!0:o=!1,o?(i.show(),n("."+oi+" input",t).hide(),n("."+fi+" input",t).val(a.attr("src")),n("."+li+" input",t).val(a.attr("width")),n("."+ci+" input",t).val(a.attr("heigth"))):(n("."+oi+" input",t).show(),i.hide(),n("."+oi+" input",t).val(u)),n("."+ai+" input",t).val(e._getLinkCssField()),n("."+ui+" select",t).val(e._getLinkTarget()),n("#radAnchor",t).attr("checked","checked"),n("#radLinkTypeIsText",t).attr("checked","checked"),r.length>6&&(r.substring(0,4)==="http"?n("#radUrl",t).attr("checked","checked"):r.substring(0,6)==="mailto"?n("#radMail",t).attr("checked","checked"):r.substring(0,1)==="#"?n("#radAnchor",t).attr("checked","checked"):n("#radFile",t).attr("checked","checked")),a=undefined},t.prototype._getLinkInnerHTML=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return t.innerHTML||""}catch(n){}return""},t.prototype.getLinkHrefField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return e.fixAbsoluteUrlsIfNeeded(t.href||"")}catch(n){}return""},t.prototype._getLinkTarget=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return t.target||""}catch(n){}return""},t.prototype._getLinkCssField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return t.style.cssText||""}catch(n){}return""},t.prototype.submitHyperLinkDialog=function(){var e=this,t=e.dialog,r=n("#radMail",t),s=n("."+ri+" input",t),o=n("."+oi+" input",t),u=n("."+ai+" input",t),a=n("."+ui+" select",t),f=s.val(),l=o.val(),c=a.val(),h=n("#radLinkTypeIsImage",t),p=h.prop("checked"),d=n("."+fi+" input",t).val(),v=n("."+li+" input",t).val(),m=n("."+ci+" input",t).val(),g=u.val();if(f===""){i(this.localizeString("errorMessageAddressError","Please input address!"));return}if(l===""&&!p){i(this.localizeString("errorMessageDisplayTextError","Please input display text!"));return}if(d===""&&p){i(this.localizeString("errorMessageHyperLinkImageUrlError","Please input image url!"));return}if(!e._isNumeric(v)&&p){i(this.localizeString("errorMessageHyperLinkImageWidthError","Please input correct image width!"));return}if(!e._isNumeric(m)&&p){i(this.localizeString("errorMessageHyperLinkImageHeightError","Please input correct image height!"));return}if(r.attr("checked")&&!e._isEmail(f)){i(this.localizeString("errorMessageHyperLinkEmail","Please input correct email!"));return}p&&(l='<img src="'+d+'" width="'+v+'" height="'+m,l+='"/>'),e._editLink(l,f,g,c),e._closeDialog()},t.prototype._editLink=function(e,t,n,r){var i=this,s,o="";i.focus(),s=i._getInspectElement();try{if(s&&s.tagName==="A"){s.innerHTML=e,s.href=t,s.target=r,n!==s.style.cssText&&(s.style.cssText=n),i._addtoUndoBuffer(),i._setSaveBtnEnabled();return}}catch(u){}o='<a href="'+t+'" target="'+r+'"',n!==""&&(o+=' style="'+n+'"'),o+=">"+e+"</a>",i._setIESelection(),i.insertHTML(o)},t.prototype.anchorListOnChanged=function(e){var t=this,r=t.dialog,i=n(e).val();i!==""&&(n("."+ri+" input",r).val(i),n("#radAnchor",r).attr("checked","checked"))},t.prototype.radioListOnChanged=function(){var e=this,t=e.dialog,r=n("."+si,t),i=n("."+ri+" input",t);i.val(""),n("#radUrl",t).is(":checked")?r.hide():n("#radAnchor",t).is(":checked")?r.show():n("#radMail",t).is(":checked")?(r.hide(),i.val("mailto:")):n("#radFile",t).is(":checked")&&r.hide()},t.prototype.linkIconTypeOnChanged=function(){var e=this,t=e.dialog,r=n("."+hi,t),i=n("."+oi,t);n("#radLinkTypeIsText",t).is(":checked")?(i.show(),r.hide()):n("#radLinkTypeIsImage",t).is(":checked")&&(i.hide(),r.show())},t.prototype._getDialogRes_Code=function(){var e=this,t=e._createDiv(ni);return t.add(e._createElement("div","Enter source code",{"class":mi})),t.add(e._createElement("textarea","",{"class":vi})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype.initInsertCodeDialog=function(){var e=this,t=e.dialog;t.delegate(gs,"click."+e.widgetName,function(t){e.submitCodeDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitCodeDialog=function(){var e=this,t=e.dialog,r=n("."+vi,t),i=r.val();if(i==="")return;i=i.replace(/</g,"&lt;"),i=i.replace(/>/g,"&gt;"),i="<pre>"+i+"</pre>",e._setIESelection(),e.insertHTML(i),e._closeDialog()},t.prototype.initTagInspectorDialog=function(){var e=this,t=e.dialog,r=n("."+Ti);t.delegate(gs,"click."+e.widgetName,function(t){e.submitTagInspectorDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()}).delegate("#displayNoEmpty","click."+e.widgetName,function(){e.tagInspectorDialogSwitchAttList(this)}),e._laySelectedElementAttributes(n("."+xi,t),n("."+wi,t)),n("."+Ni+" input",t).val(e._getSelectedElementStyle()),e._selectedElementCanHaveChildren()?(r.show(),n("textarea",r).val(e._getSelectedElementInnerHTML())):r.hide()},t.prototype.submitTagInspectorDialog=function(){var e=this,t=e.dialog,r=e._getInspectElement(),i=n("."+xi,t),s=n("."+Ni+" input").val(),o=n("."+Ti+" textarea").val();try{n.each(n("input:checkbox",i),function(e,t){var i,s,o=n(t);o.is(":checked")&&(i=o.siblings("span").text(),i=i.substring(0,i.length-1),s=o.siblings("input:text").val(),n(r).attr(i,s))}),n.trim(s)!==""&&(r.style.cssText=s),e._selectedElementCanHaveChildren()&&n(r).html(o)}catch(u){}e._closeDialog(),e._addtoUndoBuffer(),e._setSaveBtnEnabled()},t.prototype.tagInspectorDialogSwitchAttList=function(e){var t=n("."+xi,this.dialog),r=!e.checked;n.each(n("input:text",t),function(e,t){n(t).val()===""&&n(t).parent("li")[r?"show":"hide"]()})},t.prototype._laySelectedElementAttributes=function(e,t){var r=this,i=r._getInspectElement(),s,o,u,a=this.localizeString("tagInspectorDialogSave","Save"),f="";if(!i)return;t.html(i.tagName),s=r._getDictionaryDeclare(),o=i.tagName.toLowerCase(),u=s[o];switch(o){case"ul":case"u":case"textarea":case"tbody":case"tr":case"th":case"td":case"table":case"select":case"strong":case"span":case"p":case"option":case"ol":case"li":case"label":case"input":case"img":case"i":case"hr":case"form":case"font":case"em":case"div":case"code":case"button":case"body":case"b":case"a":f+="<ul class='ui-helper-reset'>",n.each(u,function(e,t){var n=i.getAttribute(t)||"";f+="<li><span class='"+kr+"'>",f+=t+":</span>",f+="<input type='text' value='"+n+"'/>",f+="<input type='checkbox' id='save"+e+"'/>",f+="<label for='save"+e+"'>"+a+"</label></li>"})}e.html(f)},t.prototype._getSelectedElementStyle=function(){var e=this._getInspectElement();return e&&e.style?e.style.cssText||"":""},t.prototype._getSelectedElementInnerHTML=function(){var e=this._getInspectElement();return e?e.innerHTML:""},t.prototype._selectedElementCanHaveChildren=function(){return!n(this._getInspectElement()).is("input,hr,br,img")},t.prototype.initBackColorDialog=function(){this._initColorDialog("BackColor")},t.prototype.initForeColorDialog=function(){this._initColorDialog("ForeColor")},t.prototype._initColorDialog=function(e){var t=this,r=t.dialog,i=t._getDesignViewDocument(),s=i.queryCommandValue(e),o,a,f;r.delegate(gs,"click."+t.widgetName,function(n){t.submitColorDialog(e),t._onDesignViewBlur(n)}).delegate(ys,"click."+t.widgetName,function(){t._closeDialog()}),s&&(f=s.toString(),n.browser.mozilla&&f==="transparent"&&(f="#ffffff"),n.browser.msie&&(o=u(f),f="rgb("+(o&255)+", "+((o&65280)>>8)+", "+((o&16711680)>>16)+")"),f.indexOf("rgb(")===0?(a=f.substring(4,f.length-1).split(","),f=t._convertToWebColor(u(a[0]),u(a[1]),u(a[2]))):f.indexOf("rgba(")===0&&(a=f.substring(5,f.length-1).split(","),f=t._convertToWebColor(u(a[0]),u(a[1]),u(a[2]))),n("."+Li+" input",r).attr("value",f)),n("."+ki,r).wijeditorcolorcanvas("."+Li+" input",f)},t.prototype.submitColorDialog=function(e){var t=this,r=n("."+Li+" input",t.dialog);t.setColor(e,r.val()),t._closeDialog()},t.prototype.setColor=function(e,t){var r=this,i=r._getDesignViewDocument(),s=r._getDesignViewWindow(),o;r._setIESelection();if(n.browser.mozilla&&e==="BackColor")o=s.getSelection(),r.insertHTML('<span style="background-color:'+t+';">'+o+"</span>");else{i.execCommand(e,!1,t);if(n.browser.msie){var u=i.selection.createRange().htmlText;u.indexOf("<U>")>=0&&u.indexOf("</U>")>=0&&(i.execCommand("Underline",!1,!1),i.execCommand("Underline")),u.indexOf("<STRIKE>")>=0&&u.indexOf("</STRIKE>")>=0&&(i.execCommand("StrikeThrough",!1,!1),i.execCommand("StrikeThrough"))}r.options.mode==="bbcode"&&!n.browser.msie&&r._convertFontStyleToStandTag()}r._addtoUndoBuffer(),r._setSaveBtnEnabled()},t.prototype.initInsertTableDialog=function(){var e=this,t=e.dialog;t.delegate(gs,"click."+e.widgetName,function(t){e.submitInsertTableDialog(),e._onDesignViewBlur(t)}).delegate(ws,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Fi+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this)})},t.prototype.submitInsertTableDialog=function(){var e=this,t=e._getValuesFromTableDialog();if(!t)return;e._insertTable(t),e._closeDialog()},t.prototype._insertTable=function(e){var t=this,r="",i,s;if(!e)return!1;t.focus(),r+='<table width="'+e.width+'" height="'+e.height+'" cellspacing="'+e.cspacing+'" cellpadding="'+e.cpadding+'" border="'+e.border+'" bgcolor="'+e.bgcolor+'" style="'+e.css+'">';for(i=0;i<e.rows;i++){r+="<tr>";for(s=0;s<e.cols;s++)r+="<td>Cell "+(i+1)+"-"+(s+1)+"</td>";r+="</tr>"}r+="</table>";if(n.browser.mozilla||n.browser.msie&&u(n.browser.version)>=9)r+="<br />";t.insertHTML(r)},t.prototype.initEditTableDialog=function(){var e=this,t=e.dialog,r=e._getInspectElement(),i,s;t.delegate(gs,"click."+e.widgetName,function(t){e.submitEditTableDialog(),e._onDesignViewBlur(t)}).delegate(ws,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Fi+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this)});if(!r)return;try{i=r.rows,i.length>0?s=i[0].cells.length:s=0,i=i.length}catch(o){}n("."+Oi+" input",t).val(i),n("."+Mi+" input",t).val(s),n("."+_i+" input",t).val(r.getAttribute("width")),n("."+Di+" input",t).val(r.getAttribute("height")),n("."+Pi+" input",t).val(r.getAttribute("border")),n("."+Hi+" input",t).val(r.getAttribute("cellPadding")),n("."+Bi+" input",t).val(r.getAttribute("cellSpacing")),n("."+Fi+" input",t).val(r.getAttribute("bgcolor")||"#ffffff"),n("."+ji+" input",t).val(r.style.cssText)},t.prototype.submitEditTableDialog=function(){var e=this,t=e._getInspectElement(),r=n(t),i=e._getValuesFromTableDialog(),s=i&&u(i.rows),o=i&&u(i.cols),a,f;if(!i)return;if(t){r.attr("width",i.width),r.attr("height",i.height),r.attr("bgcolor",i.bgcolor),r.attr("border",i.border),r.attr("cellSpacing",i.cspacing),r.attr("cellPadding",i.cpadding),t.style.cssText=i.css;if(!s||isNaN(s))return;if(!o||isNaN(o))return;while(t.rows.length>s)t.deleteRow(0);while(t.rows.length<s){a=t.insertRow(0);while(a.cells.length<o)f=a.insertCell(0),f.innerHTML="&nbsp;"}n.each(t.rows,function(e,t){while(t.cells.length>o)t.deleteCell(0);while(t.cells.length<o)f=t.insertCell(0),f.innerHTML="&nbsp;"})}e._closeDialog()},t.prototype._getValuesFromTableDialog=function(){var e=this,t=e.dialog,r=n("."+Oi+" input",t).val(),s=n("."+Mi+" input",t).val(),o=n("."+_i+" input",t).val(),a=n("."+Di+" input",t).val(),f=n("."+Pi+" input",t).val(),l=n("."+Hi+" input",t).val(),c=n("."+Bi+" input",t).val(),h=n("."+ji+" input",t).val(),p=n("."+Fi+" input",t).val();return e._isNumeric(r)?e._isNumeric(s)?e._isNumeric(o)?e._isNumeric(a)?e._isNumeric(f)?e._isNumeric(l)?e._isNumeric(c)?{rows:r,cols:s,width:u(o),height:u(a),border:f,cpadding:l,cspacing:c,css:h,bgcolor:p}:(i(this.localizeString("tableDialogCellSpacingError","Please input a number for 'Cell Spacing' textbox.")),!1):(i(this.localizeString("tableDialogCellPaddingError","Please input a number for 'Cell Padding' textbox.")),!1):(i(this.localizeString("tableDialogBorderError","Please input a number for 'Border thickness' textbox.")),!1):(i(this.localizeString("errorMessageTableHeightError","Please input a number for 'Table Height' textbox.")),!1):(i(this.localizeString("errorMessageTableWidthError","Please input a number for 'Table Width ' textbox.")),!1):(i(this.localizeString("errorMessageColumnsError","Please input a number for 'Columns' textbox.")),!1):(i(this.localizeString("errorMessageRowsError","Please input a number for 'Rows' textbox.")),!1)},t.prototype.showTableColorDialog=function(e){var t=this,r,i=t.subDialog,s=n(e).prev().val(),o=t._getDialogRes_Color();r={width:"auto",height:"auto",modal:!0,title:"Set Background Color",position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},i.empty().append(o),n.browser.msie&&u(n.browser.version)===6?window.setTimeout(function(){i.wijdialog(r)},0):i.wijdialog(r),i.delegate(bs,"click."+t.widgetName,function(){t.submitTableColorDialog()}).delegate(ws,"click."+t.widgetName,function(){t.closeSubDialog()}),s!==""&&n("."+Li+" input",i).val(s),n("."+ki,i).wijeditorcolorcanvas("."+Li+" input",s),i.wijdialog("open")},t.prototype.submitTableColorDialog=function(){var e=this,t=e.subDialog,r=e.dialog,i=n("."+Li+" input",t).val();n("."+Fi+" input:text",r).val(i),e.closeSubDialog()},t.prototype.closeSubDialog=function(){this.subDialog.wijdialog("close")},t.prototype._getEditableTable=function(){var e=this,t,r,s;r=e._getSelectedElement();if(!r)return i(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;s=n(r);if(s.is("td,tr,tbody,th"))r=s.parents("table:first")[0];else if(!s.is("table")){t=s.find("table:only-child");if(!n.browser.msie||!t.length)return i(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;r=t[0]}return y=r,!0},t.prototype.initPreviewDialog=function(){var e=this,t=e.dialog;e._setPreviewContent(0),t.delegate("#rad640_480","click."+e.widgetName,function(){e._setPreviewDialogSize(640,480)}).delegate("#rad800_600","click."+e.widgetName,function(){e._setPreviewDialogSize(800,600)}).delegate("#rad1024_768","click."+e.widgetName,function(){e._setPreviewDialogSize(1024,768)}).delegate("#chkSplit","click."+e.widgetName,function(){e._splitPreviewPages(this.checked)}).delegate("."+Wi,"click."+e.widgetName,function(){e._printPreviewPage(!0)}).delegate("."+Xi,"click."+e.widgetName,function(){e._printPreviewPage(!1)}).delegate("."+Vi,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Ui,"click."+e.widgetName,function(){e._navigatePreviewPage(!1)}).delegate("."+zi,"click."+e.widgetName,function(){e._navigatePreviewPage(!0)})},t.prototype._setPreviewContent=function(e){var t=this,r=t.dialog,i=n("iframe",r),s=n("."+Ri+" span",r),o=i[0].contentWindow.document;o.open(),e===-1?(o.write(t._getPreviewAllPageContent()),s.html("1 / 1")):(o.write(t._getPreviewPageContent(e)),s.html(e+1+" / "+t._getPreviewPageCount())),o.close()},t.prototype._setPreviewDialogSize=function(e,t){var r=this,i=r.dialog,s=n("iframe",i),o=i.wijdialog("option","width"),u=i.wijdialog("option","height");o==="auto"?o=i.parent(".wijmo-wijdialog").width()-s.width():o-=s.width(),u==="auto"?u=i.parent(".wijmo-wijdialog").height()-s.height():u-=s.height(),s.css("width",e).css("height",t),i.wijdialog("option",{width:e+o,height:t+u})},t.prototype._getPreviewPageCount=function(){return this._getPreviewPages().length},t.prototype._getPreviewPageContent=function(e){var t=this._getPreviewPages();return t.length>e?t[e]:null},t.prototype._getPreviewAllPageContent=function(){return this._getDesignViewText()},t.prototype._getPreviewPages=function(){var e=this._getPreviewAllPageContent(),t=new RegExp("<(DIV|div)[^>]*(page-break-before|PAGE-BREAK-BEFORE)[ ]*:[ ]*always[^>]*>(.*?)<\\/(DIV|div)>","g"),n=e.replace(t,"!-~U^n#i@q,P|.a=g~e+br!");return n.split("!-~U^n#i@q,P|.a=g~e+br!")},t.prototype._splitPreviewPages=function(e){var t=this,r=t.dialog,i=n("."+$i,r),s=n("."+Ri,r);e?(t._setPreviewContent(0),s.show(),i.hide()):(t._setPreviewContent(-1),s.hide(),i.show()),t._curPageIdx=0},t.prototype._navigatePreviewPage=function(e){var t=this,r=n("#chkSplit",t.dialog),i=t._curPageIdx,s=t._getPreviewPageCount();r.is(":checked")&&(e?(i++,i<s?t._setPreviewContent(i):i=s-1):(i--,i>=0?t._setPreviewContent(i):i=0),t._curPageIdx=i)},t.prototype._printPreviewPage=function(e){var t=this,r=t.dialog,i=n("#chkSplit",r),s=n("iframe",r)[0].contentWindow;e&&(i.removeAttr("checked"),t._setPreviewContent(-1)),s.focus(),s.print()},t.prototype.initCleanUpDialog=function(){var e=this,t=e.dialog;n("textarea",t).val(e.sourceView.val()),t.delegate(gs,"click."+e.widgetName,function(t){e.submitCleanUpDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitCleanUpDialog=function(){var e=this,t=e.dialog,r=e.sourceView,i=r.val(),s;n("#replaceSpans",t).is(":checked")&&(s=new RegExp("<\\/?SPAN[^>]*>","g"),i=i.replace(s,"")),n("#replaceClass",t).is(":checked")&&(s=new RegExp("<(\\w[^>]*) class=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3")),n("#replaceStyle",t).is(":checked")&&(s=new RegExp('<(\\w[^>]*) style="([^"]*)"([^>]*)',"g"),i=i.replace(s,"<$1$3"),s=new RegExp("<(\\w[^>]*) lang=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3"),s=new RegExp("<\\\\?\\?xml[^>]*>","g"),i=i.replace(s,""),s=new RegExp("<\\/?\\w+:[^>]*>","g"),i=i.replace(s,"")),n("#replaceNbsp",t).is(":checked")&&(s=new RegExp("&nbsp;","g"),i=i.replace(s," ")),n("#transformPtoDiv",t).is(":checked")&&(s=new RegExp("(<P)([^>]*>.*?)(<\\/P>)","g"),i=i.replace(s,"<div$2</div>")),r.val(i),e._setDesignViewText(i),e._addtoUndoBuffer(),e._closeDialog()},t.prototype.initFindDialog=function(){var e=this,t=e.dialog;e.tRange&&(e.tRange=null),t.delegate(gs,"click."+e.widgetName,function(){e.submitFindAction()}).delegate(ys,"click."+e.widgetName,function(t){e.submitReplaceAction(),e._onDesignViewBlur(t)})},t.prototype.submitFindAction=function(){var e=this,t=n("textarea:first",e.dialog).val();if(n.trim(t)==="")return;e._findAndReplaceString(t)},t.prototype.submitReplaceAction=function(){var e=this,t=e.dialog,r=n("textarea:first",t).val(),s=n("textarea:last",t).val();if(n.trim(r)==="")return;if(n.trim(s)===""){i(this.localizeString("errorMessageReplaceStringError","please input replace string!"));return}e._findAndReplaceString(r,s)},t.prototype._findAndReplaceString=function(e,t){var r=this,s=r._getDesignViewWindow(),o=0,u=!1,a,f=t&&t!==e;t||(t=e);if(n.browser.msie)r.tRange&&(r.txtFoundInIE&&f?(o=r.tRange.findText(e),o&&(r.tRange.pasteHTML(t),r.tRange.collapse(!1),u=!0,r.txtFoundInIE=!1)):(r.tRange.collapse(!1),o=r.tRange.findText(e),o&&r.tRange.select())),!u&&(!r.tRange||!o)&&(r.tRange=s.document.body.createTextRange(),o=r.tRange.findText(e),o&&(r.tRange.select(),f&&(r.tRange.pasteHTML(t),u=!0)));else{if(r.txtFoundInNoneIE&&f)r._replaceSelectionForNoneIE(t),u=!0,r.txtFoundInNoneIE=!1;else{a=s.getSelection(),a.rangeCount>0&&a.collapseToEnd(),o=s.find(e);if(!o){o=s.find(e,0,1);while(s.find(e,0,1))continue}}r.txtFoundInNoneIE=r.txtFoundInNoneIE||o,r.txtFoundInNoneIE&&f&&(r._replaceSelectionForNoneIE(t),u=!0,r.txtFoundInNoneIE=!1)}!o&&!u?(i('"'+e+'"'+this.localizeString("errorMessageFindTextError"," String Not Found!")),r.tRange=null,r.txtFoundInNoneIE=!1,r.txtFoundInIE=!1):r.txtFoundInIE=!0},t.prototype._replaceSelectionForNoneIE=function(e){var t=this._getDesignViewDocument();t.execCommand("inserttext",!1,e)},t.prototype.initMediaDialog=function(){var e=this,t=e.dialog;t.delegate(gs,"click."+e.widgetName,function(t){e.submitMediaDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitMediaDialog=function(){var e=this,t=e.dialog,r=n("select",t).val(),s=n("."+is+" input",t).val(),o=n("."+ss+" input",t).val(),u=n("."+os+" input",t).val();if(s===""){i(this.localizeString("errorMessageUrlEmptyError","URL is empty!"));return}if(!e._isUrl(s)){i(this.localizeString("errorMessageUrlCorrectError","please input correct URL!"));return}if(!e._isNumeric(o)){i(this.localizeString("errorMessageMediaWidthError","please input width of the media!"));return}if(!e._isNumeric(u)){i(this.localizeString("errorMessageMediaHeightError","please input height of the media!"));return}e._insertMedia(r,s,o,u),e._closeDialog()},t.prototype._insertMedia=function(e,t,n,r){var i=this,s="";i._setIESelection();switch(e){case"video":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'" '+'type=audio/x-pn-realaudio-plugin console="Clip1" '+'controls="IMAGEWINDOW,ControlPanel,StatusBar" '+'autostart="true"></embed>';break;case"flash":s+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+n+'" height="'+r+'">',s+='<param name="movie" value="'+t+'">',s+='<param name="quality" value="high">',s+='<embed src="'+t+'" quality="high" '+'pluginspage="http://www.macromedia.com/go/getflashplayer" '+'type="application/x-shockwave-flash" '+'width="'+n+'" height="'+r+'"></embed>',s+="</object>";break;case"applet":s+='<applet code="'+t+'" width="'+n+'" '+'height="'+r+'"></applet>';break;case"other":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'"></embed>'}i.insertHTML(s)},t.prototype.initSpecialCharacterDialog=function(){var e=this,t=e.dialog,r=n("."+ls+" span",t);t.delegate("label","click."+e.widgetName,function(t){e.submitSpecialCharacterDialog(this),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("label","mouseover."+e.widgetName,function(){r.html(n(this).html())}).delegate("label","mouseout."+e.widgetName,function(){r.empty()})},t.prototype.submitSpecialCharacterDialog=function(e){var t=this;t._setIESelection(),t.insertHTML(n(e).html()),t._closeDialog()},t.prototype._setSaveBtnEnabled=function(){this.$ribbon.wijribbon(b,_t,!1)},t.prototype._undoAction=function(){var e=this._getDesignViewDocument().body,t={};v--,v<=0&&(v=0),e.innerHTML=m[v],v?this.$ribbon.wijribbon(b,wt,!1):(t[bt]=!0,t[wt]=!1,this.$ribbon.wijribbon(w,t))},t.prototype._redoAction=function(){var e=this._getDesignViewDocument().body,t=m.length,n={};v++,v>=t-1&&(v=t-1),e.innerHTML=m[v],v===t-1?(n[bt]=!1,n[wt]=!0,this.$ribbon.wijribbon(w,n)):this.$ribbon.wijribbon(b,bt,!1)},t.prototype._addtoUndoBuffer=function(){var e=m.length-1-v,t;for(t=0;t<e;t++)m.pop();v++,m.push(this._getDesignViewText()),this.$ribbon.wijribbon(b,bt,!1)},t.prototype._deleteSelectionContent=function(){var e=this._getDesignViewWindow(),t,r,i,s="rangeCount";if(n.browser.msie)t=e.document.selection,t.type.toLowerCase()!=="none"&&t.clear();else{t=e.getSelection();for(r=0;r<t[s];r++)i=t.getRangeAt(r),i.deleteContents()}},t.prototype._refreshPathSelector=function(){var e=this,t=e._getParentElement(e._getDesignViewWindow()),r,i=e._getPathSelector(),s=n(t).parents(),o=s.length,u="wijmo-wijeditor-label ui-state-default ui-corner-all",a;if(!t)return;r=t.tagName?t.tagName.toLowerCase():"",i.empty();for(a=o-1;a>=0;a--)i.append("<label class='"+u+"'>&lt;"+s[a].tagName.toLowerCase()+"&gt;</label>");i.append("<label class='"+u+" wijmo-wijeditor-selectlabel ui-state-highlight ui-corner-all'>&lt;"+r+"&gt;</label>")},t.prototype._toggleTableBorders=function(){var e=this._getDesignViewDocument(),t=n("#__wijStyle",e);d=!d,n.browser.safari?d?t.html("table,td,tr{border: 1px #acacac dashed;}"):t.empty():t.prop("disabled",!d)},t.prototype._tableAction=function(e){var t=this,r=t._getParentElement(t._getDesignViewWindow()),s=n(r).closest("td"),o,u,a,f,l,c,h,p,d,v,m=0;t._setSaveBtnEnabled();if(s.length===0&&e!==F)return!1;e!==F&&(o=s.parent(),u=o.closest("table"),a=s[0],f=o[0],l=u[0],c=f.rowIndex,h=a.cellIndex);try{switch(e){case H:p=f.cells.length,v=l.insertRow(c);for(m=0;m<p;m++)t._insertCell(v,m);break;case q:l.deleteRow(c);break;case P:d=l.rows.length;for(m=0;m<d;m++)t._insertCell(l.rows[m],h);break;case I:t._removeColumn(l,h);break;case B:t._insertCell(f,h+1);break;case R:p=f.cells.length,p===1?l.deleteRow(c):f.deleteCell(h);break;case j:t._splitCell(l,f,c,h);break;case F:t._mergeCell(t._getSelectedCells(r))}this._addtoUndoBuffer()}catch(g){return i(g.message),!1}return!0},t.prototype._removeColumn=function(e,t){var n=e.rows.length,r=0,i,s,o,u,a;while(r<n)i=e.rows[r],s=i.cells,o=s.length,u=t>o-1?o-1:t,a=s[u].colSpan,a>1&&o>1&&(u+1<o?s[u+1].colSpan+=a-1:s[u-1].colSpan+=a+1),o===1?(e.deleteRow(r),n=e.rows.length):(i.deleteCell(u),r++)},t.prototype._splitCell=function(e,t,n,r){var i=e.rows.length,s=0,o=0,u,a,f,l,c;while(s<=r)t.cells[s].colSpan>1&&(o+=t.cells[s].colSpan-1),s++;this._insertCell(t,r+1);if(t.cells[r].colSpan>1)t.cells[r].colSpan--;else for(f=0;f<i;f++){u=e.rows[f];if(f!==n){l=r,s=0,a=0;while(s<=l)u.cells[s].colSpan>1&&(a+=u.cells[s].colSpan-1,l-=a),s++;c=r+o-a,c<0&&(c=0),u.cells[c].colSpan++}}},t.prototype._mergeCell=function(e){var t=e.length,n,r,i,s;if(t<2||e[0].parentNode!==e[t-1].parentNode)return!1;n=e[0].parentNode,r=e[0].cellIndex,i=r+t;for(s=r+1;s<i;s++)n.cells[r].innerHTML+=n.cells[r+1].innerHTML,n.cells[r].colSpan++,n.deleteCell(r+1)},t.prototype._getSelectedCells=function(e){var t=this._getDesignViewWindow(),r=t.document,i=[],s,o,u,a,f,l,c,h;if(n.browser.msie)s=r.selection.createRange(),o=n(e).closest("tr")[0],o&&n.each(o.cells,function(e,t){var n=r.selection.createRange(),o="compareEndPoints";n.moveToElementText(t),(s.inRange(n)||s[o]("StartToStart",n)>=0&&s[o]("StartToEnd",n)<=0||s[o]("EndToStart",n)>=0&&s[o]("EndToEnd",n)<=0)&&i.push(t)});else if(n.browser.mozilla){u=t.getSelection(),f=u.rangeCount;for(a=0;a<f;a++)s=u.getRangeAt(a),l=s.startContainer,c=l.nodeName.toLowerCase(),c==="td"||c==="th"?i.push(l):c==="tr"&&(h=s.startOffset,i.push(l.cells[h]))}else{u=t.getSelection(),o=n(e).closest("tr")[0];if(o){f=o.cells.length;for(a=0;a<f;a++)i.push(o.cells[a])}}return i},t.prototype.insertDateAndTime=function(){var e=new Date;this.options.culture&&this.options.culture!==""?this.insertHTML(Globalize.format(e,"dddd ",Globalize.findClosestCulture(this.options.culture))+Globalize.format(e,"F",Globalize.findClosestCulture(this.options.culture))):this.insertHTML(e.toDateString()+" "+e.toTimeString())},t.prototype._toggleWordWrap=function(){var e=this,t=e.sourceView,r="wrap",i;p=!p,i=p?"soft":"off",t.attr(r,i),t[0].focus(),n.browser.mozilla&&(t.hide(),s.setTimeout(function(){t.show()},40))},t.prototype.insertHTML=function(e){var t=this,r=t._getDesignViewDocument(),i;try{n.browser.msie?(i=r.selection.createRange(),i.pasteHTML(e),i.collapse(!1),i.select()):r.execCommand("insertHTML",!1,e)}catch(s){}t._addtoUndoBuffer(),t._setSaveBtnEnabled()},t.prototype._getSelectedContent=function(){var e=this._getDesignViewWindow(),t=e.document,n="",r="cloneContents",i,s,o;return t.selection?(i=t.selection.createRange(),i.htmlText):(i=e.getSelection().getRangeAt(0),i&&i[r]&&(s=i[r](),o=document.createElement("div"),o.appendChild(s),n=o.innerHTML,o=null),n||"")},t.prototype._setIESelection=function(){n.browser.msie&&g&&g.select()},t.prototype._setIEFocus=function(){var e=this._getDesignViewDocument();if(n.browser.msie)try{e.body.focus()}catch(t){}},t.prototype.focus=function(){var e=this._getDesignViewWindow(),t=e.document;n.browser.msie?g?g.select():t.body?t.body.focus():t.onreadystatechange=function(){t.readyState==="complete"&&t.body.focus()}:e.focus()},t.prototype._setFocusNotIE=function(){var e=this._getDesignViewWindow();n.browser.msie||e.focus()},t.prototype._getInspectElement=function(){return y||this._getSelectedElement()},t.prototype._getSelectedElement=function(){return this._getParentElement(this._getDesignViewWindow())},t.prototype._createElement=function(e,t,n){return new ks(e,t,n)},t.prototype._createDiv=function(e,t){return this._createElement("div",{"class":e})},t.prototype._createSpan=function(e,t){var n=this;return t?e.length===0?n._createElement("span",t):this._createElement("span",t,{"class":e}):n._createElement("span",{"class":e})},t.prototype._createTextBox=function(e,t){var n={"class":e,type:"text",value:undefined};return t&&(n.value=t),this._createElement("input",n)},t.prototype._createLabel=function(e,t){return t?new ks("label",e,{"for":t}):new ks("label",e)},t.prototype._createRadio=function(e,t,n){var r={name:t,id:e,value:n,type:"radio"};return this._createElement("input",r)},t.prototype._createCheckbox=function(e){var t={type:"checkbox",id:e};return this._createElement("input","",t)},t.prototype._createSelect=function(e,t){var r=this,i={"class":e},s=r._createElement("select",i);return e===""&&(s=r._createElement("select")),n.each(t,function(e,t){n.isPlainObject(t)&&t.selected?s.add(r._createElement("option",t.text,{selected:"selected"})):s.add(r._createElement("option",t))}),s},t.prototype._createInputButton=function(e,t){var n={"class":e,type:"button",value:undefined};return t&&(n.value=t),this._createElement("input",n)},t.prototype._createTextField=function(e,t,n,r){var i=this,s=i._createDiv(t),o={type:"text",value:""};return r&&(o.value=r),s.add(i._createSpan(kr,e)),s.add(i._createElement("input",o)),n&&s.add(new Cs(n)),s},t.prototype._createSeparator=function(){var e=this,t=e._createDiv(Tr);return t.add(e._createElement("hr")),t},t.prototype._createOKCancelButtons=function(){var e=this,t=e._createDiv(Nr);return t.add(e._createElement("input",{type:"button","class":Cr,value:this.localizeString("dialogOK","OK")})),t.add(e._createElement("input",{type:"button","class":Cr,engValue:"Cancel",value:this.localizeString("dialogCancel","Cancel")})),t},t.prototype._getDialogRes_Template=function(){var e=this,t=e._createDiv(qr),n=e._createDiv(Rr),r=e._createDiv(Wr),i=e._createDiv(Xr),s=e._createDiv(Vr),o=e._createDiv($r),u=e._createElement("div",this.localizeString("templateDialogName","Name :")),a=e._createElement("div",this.localizeString("templateDialogDescription","Description :")),f=e._createDiv(Qr),l=e._createDiv(Zr);return n.add(e._createElement("div",this.localizeString("templateDialogSelectTemplate","Select Template:"),{"class":Ur})),n.add(e._createElement("div",this.localizeString("templateDialogTemplatePreview","Template Preview:"),{"class":zr})),t.add(n),i.add(e._createElement("select",{size:8})),s.add(e._createElement("iframe",{frameborder:0})),r.add(i),r.add(s),t.add(r),u.add(e._createSpan(Jr)),a.add(e._createSpan(Kr)),o.add(u),o.add(a),t.add(o),f.add(e._createSpan(kr,this.localizeString("templateDialogName","Name :"))),f.add(e._createTextBox(Gr)),f.add(e._createSpan(kr,this.localizeString("templateDialogDescription","Description :"))),f.add(e._createTextBox(Yr)),t.add(f),l.add(e._createInputButton(Cr+" "+ei,this.localizeString("templateDialogDeleteSelected","Delete selected"))),l.add(e._createInputButton(Cr+" "+ti,this.localizeString("templateDialogSaveCurrentPage","Save current page as template"))),t.add(l),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_ImageBrowser=function(){var e=this,t=e._createDiv(Lr),n=e._createDiv(Ar),r=e._createDiv(Or),i=e._createDiv(Mr),s=e._createDiv(_r),o=e._createDiv(Dr);return r.add(e._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),Pr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageAltText","Image alt text:"),Hr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),Br,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),jr,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogCssText","Css text:"),Fr)),n.add(r),i.add(s),s.add(e._createElement("select",{size:8})),i.add(o),o.add(e._createElement("img",{src:"",alt:""})),n.add(i),n.add(e._createSeparator()),n.add(e._createOKCancelButtons()),t.add(n),t.render()},t.prototype._getDialogRes_Link=function(){var e=this,t=e._createDiv(ni),r=e._createTextField(this.localizeString("hyperLinkDialogAddress","Address :"),ri),i=e._createDiv(ii+" ui-helper-clearfix"),s=e._createElement("div"),o=e._createDiv(hi),u=e._createDiv(pi),a=e._createElement("div"),f=[{id:"radUrl",value:"url",text:this.localizeString("hyperLinkDialogUrl","url")},{id:"radAnchor",value:"anchor",checked:!0,text:this.localizeString("hyperLinkDialogAnchor","anchor")},{id:"radMail",value:"email",text:this.localizeString("hyperLinkDialogEmail","email")}],l=[{id:"radLinkTypeIsText",value:"text",checked:!0,text:this.localizeString("hyperLinkDialogText","text")},{id:"radLinkTypeIsImage",value:"image",text:this.localizeString("hyperLinkDialogImage","image")}],c=[],h=e._createTextField(this.localizeString("hyperLinkDialogTextToDisplay","Text to display :"),oi),p=e._createSpan(kr,this.localizeString("hyperLinkDialogIconType","Icon Type :")),d=e._createDiv(ui),v=e._createSpan(kr,this.localizeString("hyperLinkDialogTarget","Target :")),m=[{text:"_blank",selected:!0},"_parent","_self","_top"],g=e._createSelect(ui,m),y=e._createTextField(this.localizeString("hyperLinkDialogCss","Css :"),ai),b;o.add(e._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),fi)),o.add(e._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),li,this.localizeString("dialogPixel","px"))),o.add(e._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),ci,this.localizeString("dialogPixel","px"))),t.add(r),t.add(i),i.add(s),u.add(a),a.add(p),n.each(f,function(t,n){s.add(e._createRadio(n.id,"radioList",n.value)),s.add(e._createLabel(n.text,n.id))}),n.each(l,function(t,n){a.add(e._createRadio(n.id,"linkIconRadioList",n.value)),a.add(e._createLabel(n.text,n.id))});for(b=1;b<8;b++)c.push("#anchor"+b.toString());return i.add(e._createSelect(si,c)),t.add(e._createSeparator()),t.add(u),t.add(h),t.add(o),t.add(d),d.add(v),d.add(g),t.add(y),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_TagInspector=function(){var e=this,t=e._createDiv(gi),n=e._createDiv(yi),r=e._createDiv(Ei),i=e._createDiv(Si),s=e._createDiv(Ti);return t.add(n),n.add(e._createSpan(bi,this.localizeString("tagInspectorDialogSelectedTag","Selected tag :"))),n.add(e._createSpan(wi,"")),t.add(r),r.add(e._createCheckbox("displayNoEmpty")),r.add(e._createLabel(this.localizeString("tagInspectorDialogDisplayNotEmptyAttributes","Display not empty attributes only"),"displayNoEmpty")),t.add(i),i.add(e._createSpan(kr,this.localizeString("tagInspectorDialogAttributes","Attributes:"))),i.add(e._createDiv(xi)),t.add(s),s.add(e._createSpan(kr,this.localizeString("tagInspectorDialogInnerHTML","Inner HTML:"))),s.add(e._createElement("textarea")),t.add(e._createTextField(this.localizeString("tagInspectorDialogCSSText","Css Text:"),Ni)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_Color=function(){return this._getDialogRes_CommonColor("#FFFFFF")},t.prototype._getDialogRes_ForeColor=function(){return this._getDialogRes_CommonColor("#000000")},t.prototype._getDialogRes_BackColor=function(){return this._getDialogRes_CommonColor("#FFFFFF")},t.prototype._getDialogRes_CommonColor=function(e){var t=this,n=t._createDiv(Ci),r=t._createDiv(Li);return n.add(t._createDiv(ki)),n.add(r),r.add(t._createSpan(kr,this.localizeString("backColorDialogSelectedColor","Selected Color:"))),r.add(t._createElement("input",{type:"text",value:e})),n.add(t._createSeparator()),n.add(t._createOKCancelButtons()),n.render()},t.prototype._getDialogRes_Table=function(){var e=this,t=e._createDiv(Ai),n=e._createDiv(Fi);return t.add(e._createTextField(this.localizeString("tableDialogRows","Rows :"),Oi,"",3)),t.add(e._createTextField(this.localizeString("tableDialogColumns","Columns :"),Mi,"",3)),t.add(e._createTextField(this.localizeString("tableDialogTableWidth","Table Width :"),_i,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogTableHeight","Table Height :"),Di,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogBorder","Border thickness:"),Pi)),t.add(e._createTextField(this.localizeString("tableDialogCellPadding","Cell Padding :"),Hi)),t.add(e._createTextField(this.localizeString("tableDialogCellSpacing","Cell Spacing :"),Bi)),t.add(e._createTextField(this.localizeString("tableDialogCssText","Css Text :"),ji)),t.add(n),n.add(e._createSpan(kr,this.localizeString("tableDialogBackgroundColor","Background Color:"))),n.add(e._createElement("input",{type:"text"})),n.add(e._createElement("input",{type:"button",value:"..."})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_Preview=function(){var e=this,t=e._createDiv(Ii),n=e._createDiv(qi),r=e._createDiv(Nr),i=e._createDiv(Ri),s=e._createDiv(Ji);return t.add(n),n.add(e._createSpan(kr,this.localizeString("previewDialogPreviewSize","Preview Size:"))),n.add(e._createElement("input",{id:"rad640_480",name:"preview",type:"radio",checked:"checked"})),n.add(e._createLabel("640x480","rad640_480")),n.add(e._createElement("input",{id:"rad800_600",name:"preview",type:"radio"})),n.add(e._createLabel("800x600","rad800_600")),n.add(e._createElement("input",{id:"rad1024_768",name:"preview",type:"radio"})),n.add(e._createLabel("1024x768","rad1024_768")),n.add(e._createElement("input",{id:"chkSplit",type:"checkbox",checked:"checked"})),n.add(e._createLabel(this.localizeString("previewDialogSplit","Split pages"),"chkSplit")),t.add(e._createSeparator()),t.add(r),r.add(e._createInputButton(Cr+" "+Wi,this.localizeString("previewDialogPrintAll","Print All"))),r.add(e._createInputButton(Cr+" "+Xi,this.localizeString("previewDialogPrintPage","Print Page"))),r.add(e._createInputButton(Cr+" "+Vi,this.localizeString("dialogOK","OK"))),t.add(e._createSeparator()),t.add(i),i.add(e._createElement("a",this.localizeString("previewDialogPrevPage","Prev page"),{"class":Ui,href:"#"})),i.add(e._createElement("span","1 / 1")),i.add(e._createElement("a",this.localizeString("previewDialogNextPage","Next page"),{"class":zi,href:"#"})),t.add(e._createDiv($i)),t.add(s),s.add(e._createElement("iframe",{src:"about:blank"})),t.render()},t.prototype._getDialogRes_CleanUp=function(){var e=this,t=e._createDiv(Ki),r=e._createDiv(Qi),i=e._createDiv(Gi),s=e._createDiv(Yi),o=[{id:"replaceSpans",label:this.localizeString("cleanUpDialogStripSpanTag","Strip SPAN tag")},{id:"replaceClass",label:this.localizeString("cleanUpDialogStripClass","Strip CLASS tag")},{id:"replaceStyle",label:this.localizeString("cleanUpDialogStripStyle","Strip STYLE attribute")},{id:"replaceNbsp",label:this.localizeString("cleanUpDialogReplaceSymbol","Replace &amp;nbsp; symbol")},{id:"transformPtoDiv",label:this.localizeString("cleanUpDialogTransformParagraphToDIV","Transform Paragraph to DIV")}];return t.add(r),r.add(e._createSpan(kr,this.localizeString("cleanUpDialogDocumentSource","Document source :"))),t.add(i),i.add(e._createElement("textarea",{readonly:"readonly"})),t.add(s),n.each(o,function(t,n){s.add(e._createCheckbox(n.id)),s.add(e._createLabel(n.label,n.id))}),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_FindAndReplace=function(){var e=this,t=e._createDiv(Zi),n=e._createDiv(es),r=e._createDiv(ts),i=e._createDiv(Nr);return t.add(n),n.add(e._createSpan(kr,this.localizeString("findAndReplaceFind","Find:"))),n.add(e._createElement("textarea","text")),t.add(r),r.add(e._createSpan(kr,this.localizeString("findAndReplaceReplace","Replace:"))),r.add(e._createElement("textarea")),t.add(e._createSeparator()),t.add(i),i.add(e._createInputButton(Cr,this.localizeString("findAndReplaceFindButton","Find"))),i.add(e._createInputButton(Cr,this.localizeString("findAndReplaceReplaceButton","Replace"))),t.render()},t.prototype._getDialogRes_Media=function(){var e=this,t=e._createDiv(ns),n=e._createDiv(rs);return t.add(n),n.add(e._createSpan(kr,this.localizeString("mediaDialogMediaType","Media Type :"))),n.add(e._createSelect("",["flash","video","applet","other"])),t.add(e._createTextField(this.localizeString("mediaDialogMediaUrl","Media Url :"),is)),t.add(e._createTextField(this.localizeString("mediaDialogWidth","Width :"),ss,this.localizeString("dialogPixel","px"),200)),t.add(e._createTextField(this.localizeString("mediaDialogHeight","Height :"),os,this.localizeString("dialogPixel","px"),200)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_SpecialCharacter=function(){var e=this,t=e._createDiv(us),r=e._createDiv(as),i=e._createDiv(fs),s=e._createDiv(ls),o=e._createDiv(cs),u=e._createDiv(hs,"Punctuation"),a=e._createDiv(ps),f=["&#8211;","&#8212;","&iexcl;","&iquest;","&quot;","&laquo;","&raquo;","&nbsp;"],l=e._createDiv(hs,"Symbols"),c=e._createDiv(ds),h=["&amp;","&cent;","&copy;","&divide;","&gt;","&lt;","&micro;","&#8226;","&para;","&plusmn;","&#8364;","&pound;","&reg;","&sect;","&yen;"],p=e._createDiv(hs,"Diacritics"),d=e._createDiv(vs),v=["&aacute;","&Aacute;","&agrave;","&Agrave;","&acirc;","&Acirc;","&aring;","&Aring;","&atilde;","&Atilde;","&auml;","&Auml;","&aelig;","&AElig;","&ccedil;","&Ccedil;","&eacute;","&Eacute;","&egrave;","&Egrave;","&ecirc;","&Ecirc;","&euml;","&Euml;","&iacute;","&Iacute;","&igrave;","&Igrave;","&icirc;","&Icirc;","&iuml;","&Iuml;","&ntilde;","&Ntilde;","&oacute;","&Oacute;","&ograve;","&Ograve;","&ocirc;","&Ocirc;","&oslash;","&Oslash;","&otilde;","&Otilde;","&ouml;","&Ouml;","&uacute;","&Uacute;","&ugrave;","&Ugrave;","&ucirc;","&Ucirc;","&uuml;","&Uuml;","&szlig;","&yuml;","&#8216;","&#8217;"],m=e._createDiv(Nr);return t.add(r),r.add(i),i.add(s),s.add(new ks("span")),r.add(o),o.add(u),u.add(a),n.each(f,function(t,n){a.add(e._createLabel(n))}),o.add(l),l.add(c),n.each(h,function(t,n){c.add(e._createLabel(n))}),o.add(p),p.add(d),n.each(v,function(t,n){d.add(e._createLabel(n))}),t.add(e._createSeparator()),m.add(e._createInputButton(Cr,"Cancel")),t.add(m),t.render()},t.prototype._copyFromClipboard=function(){var e,t,r,i;if(s.clipboardData)return s.clipboardData.getData("Text");if(n.browser.mozilla){try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(o){}return e=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard),e?(t=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable),t?(t.addDataFlavor("text/unicode"),e.getData(t,e.kGlobalClipboard),t.getTransferData("text/unicode",r,i),r&&(r=r.value.QueryInterface(Components.interfaces.nsISupportsString)),r?r.data.substring(0,i.value/2):""):!1):!1}},t.prototype._copyToClipboard=function(e){var t,r,o,u={},a={};if(s.clipboardData&&e)s.clipboardData.setData("Text",e);else if(n.browser.mozilla)try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),t=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!t)return;r=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!r)return;r.addDataFlavor("text/unicode"),a={},u=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),u.data=e,r.setTransferData("text/unicode",u,e.length*2),o=Components.interfaces.nsIClipboard;if(!t)return!1;t.setData(r,null,o.kGlobalClipboard)}catch(f){u="Copy text to Clipboard \n",u+="If you are using firefox please do the following :\n ",u+="1. Write in your url box : 'about:config'\n",u+="2. Change signed.applets.codebase_principal_support = true\n",i(this.localizeString("errorMessageCopyToClipboardError",u))}},t.prototype.fixAbsoluteUrlsIfNeeded=function(e){var t=this,n=o.URL,r=o.URL,i=o.URL,s=!1,u=r.length,a=e,f,l,c,h,p,d,v,m;for(v=u-1;v>0;v--){f=r.charAt(v),l=r.charAt(v-1);if(f==="/"||f==="\\"){if(f===l)break;i=r.substring(0,v)+f,s||(r=i,s=!0)}}return c=t._prepareLiteralRegexText(n+"?"),h=new RegExp(c,"g"),a=a.replace(h,"?"),p=t._prepareLiteralRegexText(r),h=new RegExp(p,"g"),a=a.replace(h,""),d=t._prepareLiteralRegexText(i),h=new RegExp(d,"g"),a=a.replace(h,"/"),m=a.indexOf("#"),m>-1&&(a=a.substr(m)),a},t.prototype._insertCell=function(e,t){var n=e.insertCell(t);return n.innerHTML="&nbsp;",n},t.prototype._getDictionaryDeclare=function(){var e={};return e.a=["accesskey","charset","class","coords","dir","href","hreflang","id","lang","name","rel","rev","shape","tabindex","target","title"],e.b=["class","dir","id","lang","title"],e.body=["alink","background","bgColor","bgproperties","bottommargin","class","dir","id","lang","leftmargin","link","marginheight","marginwidth","rightmargin","text","title","topmargin","vlink"],e.button=["accesskey","class","dir","disabled","id","lang","name","tabindex","title","type","value"],e.code=["class","dir","id","lang","title"],e.div=["align","class","dir","id","lang","title"],e.em=["class","dir","id","lang","title"],e.font=["class","color","dir","face","id","lang","pointsize","size","title"],e.form=["action","class","dir","enctype","id","lang","method","name","runat","target","title"],e.hr=["align","class","color","id","noshade","size","title","width"],e.i=["class","dir","id","lang","title"],e.img=["align","alt","border","class","controls","dir","dynsrc","height","hspace","id","ismap","lang","longdesc","loop","lowsrc","name","src","start","title","usemap","vspace","width"],e.input=["accept","accesskey","align","alt","border","checked","class","dir","disabled","height","hspace","id","lang","maxlength","name","readonly","size","src","tabindex","title","type","usemap","value","vspace","width"],e.label=["accesskey","class","dir","for","id","lang","title"],e.li=["class","dir","id","lang","title","type","value"],e.ol=["class","compact","dir","id","lang","start","title","type"],e.option=["class","dir","disabled","id","label","lang","selected","title","value"],e.p=["align","class","dir","id","lang","title"],e.span=["class","dir","id","lang","title"],e.strong=["class","dir","id","lang","title"],e.select=["accesskey","class","dir","disabled","id","lang","multiple","name","size","tabindex","title"],e.table=["align","background","bgColor","border","bordercolor","bordercolordark","bordercolorlight","cellpadding","cellspacing","class","cols","datapagesize","dir","frame","height","hspace","id","lang","rules","summary","title","vspace","width"],e.td=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.th=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.tr=["align","bgColor","bordercolor","bordercolordark","bordercolorlight","class","dir","height","id","lang","nowrap","title","valign"],e.tbody=["align","bgColor","class","dir","id","lang","title","valign"],e.textarea=["accesskey","class","cols","dir","disabled","id","label","lang","name","readonly","rows","tabindex","title","wrap"],e.u=["class","id","xml:lang"],e.ul=["class","compact","dir","id","lang","title","type"],e},t.prototype._getParentElement=function(e){var t=this,n=t._getRange(e),r,i,s,o,u;if(!n)return null;if(n.commonAncestorContainer)return r=e.getSelection(),i=n.startContainer||r.baseNode,s=n.endContainer||r.extentNode,o=n.startOffset,o===null&&(o=r.baseOffset),u=n.endOffset,u===null&&(u=r.extentOffset),i===s&&u-o===1?r.anchorNode.childNodes[r.anchorOffset]:n.commonAncestorContainer.tagName?n.commonAncestorContainer:e.document===n.commonAncestorContainer&&r.baseNode?r.baseNode.parentNode:n.commonAncestorContainer.parentNode;return n.length?n.item(0):n.parentElement?n.parentElement():null},t.prototype._getRange=function(e){var t,n;if(e.document.selection&&!s.opera)return e.document.selection.createRange();if(e.getSelection)return t=e.getSelection(),!t||t.rangeCount<1?null:(t.getRangeAt?n=t.getRangeAt(0):n=e.document.createRange(),n)},t.prototype._generateUniqueName=function(e){var t=c[e];return t||(t=0),c[e]=++t,e+t},t.prototype._setContentEditable=function(e,t){var r="designMode",i="contentEditable";try{e.body[i]&&(e.body[i]=t.toString()),e[r]&&(!t&&e[r]!=="off"?e[r]="off":t&&e[r]!=="on"&&(n.browser.msie&&u(n.browser.version)>=9||(e[r]="on"))),t&&!n.browser.msie&&e.execCommand("useCSS",!1,!0)}catch(s){}},t.prototype._setContentSpellCheck=function(e,t){var n="spellcheck";try{e.body[n]!==undefined&&(e.body[n]=t)}catch(r){}},t.prototype._formatString=function(e,t){var n=e.length,r;for(r=0;r<t-n;r++)e="0"+e;return e},t.prototype._convertToWebColor=function(e,t,n){var r=this,i,s,o,a;if(isNaN(e)||255-e<0)e=0;if(isNaN(t)||255-t<0)t=0;if(isNaN(n)||255-n<0)n=0;return i=r._formatString(u(e).toString(16),2),s=r._formatString(u(t).toString(16),2),o=r._formatString(u(n).toString(16),2),a="#"+i+s+o,a},t.prototype._prepareLiteralRegexText=function(e){var t=e;return t=t.replace("\\","\\\\"),t=t.replace(".","\\."),t=t.replace("?","\\?"),t},t.prototype._isNumeric=function(e){return(new RegExp("^\\d+$")).test(e)},t.prototype._isEmail=function(e){return(new RegExp("mailto:(\\S)+[@]{1}(\\S)+[.]{1}(\\w)+")).test(e)},t.prototype._isUrl=function(e){return(new RegExp("[a-zA-z]+://[^s]+")).test(e)},t.prototype.refresh=function(){var e=this,t=e._getDesignViewDocument(),r=e.element,i=e._getHeader(),s=e._getFooter(),o=e._oriEleWidth,u=e._oriEleHeight,a=e._getContent(),f;e.editor.width(o).height(u),this.$ribbon.wijribbon("updateRibbonSize"),f=e.editor.height()-i.outerHeight(!0)-s.outerHeight(!0),a.height(f).wijsplitter("refresh"),n.browser.mozilla?setTimeout(e._setDesignModeForFF,1e3,e):e._setContentEditable(t,!0)},t.prototype.getText=function(){var e=this;return e._getDesignViewText()},t.prototype.setText=function(e){var t=this;e&&(t._setDesignViewText(e),t.sourceView.val(e))},t.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},t}(e.wijmoWidget);t.wijeditor=Ls;var As=function(){function e(){this.initSelector=":jqmData(role='wijeditor')",this.fullScreenContainerSelector="",this.editorMode="wysiwyg",this.fullScreenMode=!1,this.showPathSelector=!0,this.mode="ribbon",this.commandButtonClick=null,this.simpleModeCommands=null,this.showFooter=!0,this.customContextMenu=!0,this.text=null,this.textChanged=null,this.localization=null}return e}();Ls.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new As),n.wijmo.registerWidget("wijeditor",Ls.prototype);var Os=mr+"-colorcanvas",Ms=mr+"-color",_s=mr+"-wheel",Ds=mr+"-overlay",Ps=mr+"-marker";n.fn.wijeditorcolorcanvas=function(e,t){var n=this.get(0);return n.wijeditorcolorcanvas||(n.wijeditorcolorcanvas=new Hs(n,e,t))};var Hs=function(){function e(e,t,r){var i=this,s="",a,f;f="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, ",s+="<div class='"+Os+"'>",s+="<div class='"+Ms+"'></div>",s+="<div class='"+_s+"'></div>",s+="<div class='"+Ds+"'></div>",s+="<div class='h-marker "+Ps+"'></div>",s+="<div class='sl-marker "+Ps+"'></div></div>",n(e).html(s),a=n("."+Os,e),i.wheel=n("."+_s,e).get(0),i.radius=84,i.square=100,i.width=194,n.browser.msie&&parseInt(n.browser.version,10)<7&&n("*",a).each(function(){var e=this,t=e.currentStyle.backgroundImage;return t!=="none"&&(t=t.substring(5,t.length-2),n(e).css({backgroundImage:"none",filter:f+"src='"+t+"')"})),this}),i.linkTo=function(e){typeof i.callback=="object"&&n(i.callback).unbind("keyup",i.updateValue),i.color=null;if(typeof e=="function")i.callback=e;else if(typeof e=="object"||typeof e=="string")i.callback=n(e),i.callback.bind("keyup",i.updateValue),i.callback.get(0).value&&i.setColor(i.callback.get(0).value);return this},i.updateValue=function(e){var t=this;t.value&&t.value!==i.color&&i.setColor(t.value)},i.setColor=function(e){var t=i.unpack(e);return i.color!==e&&t&&(i.color=e,i.rgb=t,i.hsl=i.RGBToHSL(i.rgb),i.updateDisplay()),this},i.setHSL=function(e){return i.hsl=e,i.rgb=i.HSLToRGB(e),i.color=i.pack(i.rgb),i.updateDisplay(),this},i.widgetCoords=function(e){var t,r,s,o,u;return s=e.target||e.srcElement,o=i.wheel,u=i.absolutePosition(o),t=(e.pageX||0*(e.clientX+n("html").get(0).scrollLeft))-u.x,r=(e.pageY||0*(e.clientY+n("html").get(0).scrollTop))-u.y,{x:t-i.width/2,y:r-i.width/2}},i.mousedown=function(e){o.dragging||(n(o).bind("mousemove",i.mousemove).bind("mouseup",i.mouseup),o.dragging=!0);var t=i.widgetCoords(e);return i.circleDrag=Math.max(Math.abs(t.x),Math.abs(t.y))*2>i.square,i.mousemove(e),!1},i.mousemove=function(e){var t=i.widgetCoords(e),n,r,s;return i.circleDrag?(n=Math.atan2(t.x,-t.y)/6.28,n<0&&(n+=1),i.setHSL([n,i.hsl[1],i.hsl[2]])):(r=Math.max(0,Math.min(1,-(t.x/i.square)+.5)),s=Math.max(0,Math.min(1,-(t.y/i.square)+.5)),i.setHSL([i.hsl[0],r,s])),!1},i.mouseup=function(){n(o).unbind("mousemove",i.mousemove).unbind("mouseup",i.mouseup),o.dragging=!1},i.updateDisplay=function(){var e=i.hsl[0]*6.28,t;n(".h-marker",a).css({left:Math.round(Math.sin(e)*i.radius+i.width/2)+"px",top:Math.round(-Math.cos(e)*i.radius+i.width/2)+"px"}),n(".sl-marker",a).css({left:Math.round(i.square*(.5-i.hsl[1])+i.width/2)+"px",top:Math.round(i.square*(.5-i.hsl[2])+i.width/2)+"px"}),n("."+Ms,a).css("backgroundColor",i.pack(i.HSLToRGB([i.hsl[0],1,.5]))),typeof i.callback=="object"?(n(i.callback).css({backgroundColor:i.color,color:i.hsl[2]>.5?"#000":"#fff"}),n(i.callback).each(function(){return t=this,t.value&&t.value!==i.color&&(t.value=i.color),this})):typeof i.callback=="function"&&i.callback.call(i,i.color)},i.absolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop},n;return e.offsetParent&&(n=i.absolutePosition(e.offsetParent),t.x+=n.x,t.y+=n.y),t},i.pack=function(e){var t=Math.round(e[0]*255),n,r;return n=Math.round(e[1]*255),r=Math.round(e[2]*255),"#"+(t<16?"0":"")+t.toString(16)+(n<16?"0":"")+n.toString(16)+(r<16?"0":"")+r.toString(16)},i.unpack=function(e){if(e.length===7)return[u("0x"+e.substring(1,3))/255,u("0x"+e.substring(3,5))/255,u("0x"+e.substring(5,7))/255];if(e.length===4)return[u("0x"+e.substring(1,2))/15,u("0x"+e.substring(2,3))/15,u("0x"+e.substring(3,4))/15]},i.HSLToRGB=function(e){var t,n,r,i,s,o=this;return r=e[0],i=e[1],s=e[2],n=s<=.5?s*(i+1):s+i-s*i,t=s*2-n,[o.hueToRGB(t,n,r+.33333),o.hueToRGB(t,n,r),o.hueToRGB(t,n,r-.33333)]},i.hueToRGB=function(e,t,n){return n=n<0?n+1:n>1?n-1:n,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(.66666-n)*6:e},i.RGBToHSL=function(e){var t,n,r,i,s,o,u,a,f;return u=e[0],a=e[1],f=e[2],t=Math.min(u,Math.min(a,f)),n=Math.max(u,Math.max(a,f)),r=n-t,o=(t+n)/2,s=0,o>0&&o<1&&(s=r/(o<.5?2*o:2-2*o)),i=0,r>0&&(n===u&&n!==a&&(i+=(a-f)/r),n===a&&n!==f&&(i+=2+(f-u)/r),n===f&&n!==u&&(i+=4+(u-a)/r),i/=6),[i,s,o]},n("*",a).mousedown(i.mousedown),i.setColor(r||"#000000"),t&&i.linkTo(t)}return e}();t._wijeditorcolorcanvas=Hs})(e.editor||(e.editor={}));var t=e.editor})(wijmo||(wijmo={}));