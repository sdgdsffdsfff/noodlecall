var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){"use strict";var t=jQuery;(function(e){e._map=[],e.editOptional=1,e.editRequired=2,e.separator=4,e.literal=8})(e.wijchartype||(e.wijchartype={}));var n=e.wijchartype,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createTextProvider=function(){this._textProvider=new s(this,this.options.mask,!1)},t.prototype._checkMaskAndPassword=function(){var e=!this.options.mask||this.options.mask.length<0;if(e&&this._isPassword())throw'Option "passwordChar" requires a mask'},t.prototype._updateIsPassword=function(){var e=this.options.passwordChar.length>0&&this.element.attr("type")!=="password";this.element.data("isPassword",e),this._checkMaskAndPassword()},t.prototype._beginUpdate=function(){this.element.addClass(this.options.wijCSS.wijinputmask),this._updateIsPassword(),this.element.data("defaultText",this.options.text)},t.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"text":this.setText(n);break;case"mask":case"culture":if(typeof n=="undefined"||n.length<=0)return;this._checkMaskAndPassword();var r=this.getText();t==="mask"&&(this._textProvider.mask=n,this._textProvider.initialMask=n),this._textProvider.initialize(),this._textProvider.set(r),this._updateText();break;case"promptChar":this._textProvider&&(this._textProvider.updatePromptChar(),this._updateText());break;case"hidePromptOnLeave":case"resetOnPrompt":this._updateText();break;case"passwordChar":this._updateIsPassword(),this._updateText()}},t.prototype._resetData=function(){var e=this.element.data("defaultText");if(e===undefined||e===null)e=this.element.data("elementValue");if(e===undefined||e===null)e="";this.setText(e)},t.prototype._isPassword=function(){return!!this.element.data("isPassword")},t.prototype._getTextWithPrompts=function(){return this._isInitialized()?this._textProvider.toString(!0,!0,!1):this.element.val()},t.prototype._getTextWithLiterals=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!0):this.element.val()},t.prototype._getTextWithPromptAndLiterals=function(){return this._isInitialized()?this._textProvider.toString(!0,!0,!0):this.element.val()},t.prototype._getTextWithPromptAndLiteralsAndPassword=function(){return this._isInitialized()?this._textProvider.toString(!1,!0,!0):this.element.val()},t.prototype._onChange=function(){if(!this.element)return;var e=this.element.val();this.getText()!==e&&this._getTextWithPrompts()!==e&&this._getTextWithPromptAndLiterals()!==e&&(this._textProvider.getPasswordChar()!==""?this._getTextWithPromptAndLiteralsAndPassword()!==e&&this.setText(e):this.setText(e))},t.prototype._afterFocused=function(){(this._isNullText()||!!this.options.hidePromptOnLeave)&&this._doFocus()},t}(e.wijinputcore);e.wijinputmask=r;var i=function(){function t(){this.wijCSS={wijinputmask:e.wijinputcore.prototype.options.wijCSS.wijinput+"-mask"},this.text=null,this.mask="",this.promptChar="_",this.hidePromptOnLeave=!1,this.resetOnPrompt=!0,this.allowPromptAsInput=!1,this.passwordChar="",this.resetOnSpace=!0,this.skipLiterals=!0}return t}();r.prototype.options=t.extend(!0,{},e.wijinputcore.prototype.options,new i),t.wijmo.registerWidget("wijinputmask",r.prototype);var s=function(r){function i(e,t,n){r.call(this),this.inputWidget=e,this.mask=t,this.asciiOnly=n,this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.noMask=!1,this.descriptors=[],this.initialize()}return __extends(i,r),i.prototype.initialize=function(){this.noMask=!this.mask||this.mask.length<=0;if(this.noMask)return;this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.descriptors=new Array(0);var e="none",t=!1,r=0,i,s,u,a=n.literal,f="",l,c,h,p,d=this.inputWidget._getCulture();for(i=0;i<this.mask.length;i++){u=!1,l=this.mask.charAt(i),t&&(t=!1,u=!0);if(!u){h=l;if(h<="C"){switch(h){case"#":case"9":case"?":case"C":l=this.getPromtChar(),a=n.editOptional,u=!0;break;case"$":f=d.numberFormat.currency.symbol,a=n.separator,u=!0;break;case"%":case"-":case";":case"=":case"@":case"B":a=n.literal,u=!0;break;case"&":case"0":case"A":l=this.getPromtChar(),a=n.editRequired,u=!0;break;case",":f=d.numberFormat[","],a=n.separator,u=!0;break;case".":f=d.numberFormat["."],a=n.separator,u=!0;break;case"/":f=d.calendars.standard["/"],a=n.separator,u=!0;break;case":":f=d.calendars.standard[":"],a=n.separator,u=!0;break;case"<":e="lower";continue;case">":e="upper";continue}u||(a=n.literal,u=!0)}if(!u){if(h<="\\"){switch(h){case"L":l=this.getPromtChar(),a=n.editRequired,u=!0;break;case"\\":t=!0,a=n.literal;continue}u||(a=n.literal,u=!0)}if(!u){h==="a"&&(l=this.getPromtChar(),a=n.editOptional,u=!0);if(!u){h!=="|"&&(a=n.literal,u=!0);if(!u){e="none";continue}}}}}if(u){p=new o(i,a),this.isEditDesc(p)&&(p.caseConversion=e),a!==n.separator&&(f=l);for(s=0;s<f.length;s++)c=f.charAt(s),this.testString=this.testString+c,this.descriptors[this.descriptors.length]=p,r++}}},i.prototype.getAllowPromptAsInput=function(){return this.inputWidget?this.inputWidget.options.allowPromptAsInput:!1},i.prototype.getPasswordChar=function(){return this.inputWidget?this.inputWidget.options.passwordChar:"*"},i.prototype.isPassword=function(){return this.inputWidget?this.inputWidget._isPassword():!1},i.prototype.getResetOnPrompt=function(){return this.inputWidget?this.inputWidget.options.resetOnPrompt:!0},i.prototype.getResetOnSpace=function(){return this.inputWidget?this.inputWidget.options.resetOnSpace:!0},i.prototype.getSkipLiterals=function(){return this.inputWidget?this.inputWidget.options.skipLiterals:!0},i.prototype.getHidePromptOnLeave=function(){return this.inputWidget?this.inputWidget.options.hidePromptOnLeave:!1},i.prototype._trueOR=function(e,t){return(e>>>1|t>>>1)*2+(e&1|t&1)},i.prototype.setValue=function(e){return!1},i.prototype.getValue=function(){return null},i.prototype.getPromtChar=function(){return this.inputWidget?this.inputWidget.options.promptChar:"_"},i.prototype.updatePromptChar=function(){if(this.noMask)return;var e,r;for(e=0;e<this.descriptors.length;e++){r=this.descriptors[e];if(r.charType===n.editOptional||r.charType===n.editRequired)r.isAssigned||(this.testString=t.wij.charValidator.setChar(this.testString,this.getPromtChar(),e))}},i.prototype.resetChar=function(e){var r=this.descriptors[e];this.isEditPos(e)&&r.isAssigned&&(r.isAssigned=!1,this.testString=t.wij.charValidator.setChar(this.testString,this.getPromtChar(),e),this.assignedCharCount--,r.charType===n.editRequired&&this.requiredCharCount--)},i.prototype.getAdjustedPos=function(e){return this.noMask?e>=this.testString.length&&(e=this.testString.length-1):e>=this.descriptors.length&&(e-=1),Math.max(0,e)},i.prototype.incEnumPart=function(e,t,n){return!this.noMask},i.prototype.decEnumPart=function(e,t,n){return!this.noMask},i.prototype.findNonEditPositionInRange=function(e,t,r){return this.findPositionInRange(e,t,r,this._trueOR(n.literal,n.separator))},i.prototype.findPositionInRange=function(e,t,n,r){e=Math.max(0,e),t=Math.min(t,this.testString.length-1);if(e<=t)while(e<=t){var i=n?e++:t--,s=this.descriptors[i];if((s.charType&4294967295&(r&4294967295))===s.charType)return i}return-1},i.prototype.findAssignedEditPositionInRange=function(e,t,r){return this.assignedCharCount===0?-1:this.findEditPositionInRange(e,t,r,n.editRequired)},i.prototype.findEditPositionInRange=function(e,t,r,i){do{var s,o;s=this.findPositionInRange(e,t,r,this._trueOR(n.editRequired,n.editOptional));if(s===-1)break;o=this.descriptors[s];switch(i){case n.editOptional:if(!o.isAssigned)return s;break;case n.editRequired:if(o.isAssigned)return s;break;default:return s}r?e++:t--}while(e<=t);return-1},i.prototype.findAssignedEditPositionFrom=function(e,t){if(!this.assignedCharCount)return-1;var n,r;return t?(n=e,r=this.testString.length-1):(n=0,r=e),this.findAssignedEditPositionInRange(n,r,t)},i.prototype.findEditPositionFrom=function(e,t){var n,r;return t?(n=e,r=this.testString.length-1):(n=0,r=e),this.findEditPositionInRange(n,r,t,0)},i.prototype.setChar=function(e,r,i){r=r<0?0:r,i||(i=this.descriptors[r]),this.testEscapeChar(e,r,i)?this.resetChar(r):(t.wij.charValidator.isLetter(e)&&(t.wij.charValidator.isUpper(e)?i.caseConversion==="lower"&&(e=e.toLowerCase()):i.caseConversion==="upper"&&(e=e.toUpperCase())),this.testString=t.wij.charValidator.setChar(this.testString,e,r),i.isAssigned||(i.isAssigned=!0,this.assignedCharCount++,i.charType===n.editRequired&&this.requiredCharCount++))},i.prototype.internalInsertAt=function(t,n,r,i){if(t.length===0)return r.testPosition=n,r.hint=r.noEffect,!0;if(!this._testString(t,n,r))return!1;var s=this.findEditPositionFrom(n,!0),o=this.findAssignedEditPositionInRange(s,r.testPosition,!0)!==-1,u=this.findAssignedEditPositionFrom(this.testString.length-1,!1),a,f,l,c,h;if(o&&r.testPosition===this.testString.length-1)return r.hint=r.unavailableEditPosition,r.testPosition=this.testString.length,!1;a=this.findEditPositionFrom(r.testPosition+1,!0);if(o){f=new e.wijInputResult,f.hint=f.unknown,l=!0;while(l){l=!1;if(a===-1)return r.hint=r.unavailableEditPosition,r.testPosition=this.testString.length,!1;c=this.descriptors[s];if(c.isAssigned&&!this.testChar(this.testString.charAt(s),a,f))return r.hint=f.hint,r.testPosition=a,!1;if(s!==u){s=this.findEditPositionFrom(s+1,!0),a=this.findEditPositionFrom(a+1,!0),l=!0;continue}}f.hint>r.hint&&(r.hint=f.hint)}if(!i){if(o)while(s>=n)h=this.descriptors[s],h.isAssigned?this.setChar(this.testString.charAt(s),a):this.resetChar(a),a=this.findEditPositionFrom(a-1,!1),s=this.findEditPositionFrom(s-1,!1);this.setString(t,n)}return!0},i.prototype.insertAt=function(t,n,r){typeof r=="undefined"&&(r=new e.wijInputResult);if(t===undefined)throw"InsertAt: input";return this.noMask?(this.testString=this.testString.substring(0,n)+t+this.testString.substring(n,this.testString.length),r.testPosition=n+t.length-1,!0):n>=0&&n<this.testString.length?this.internalInsertAt(t,n,r,!1):(r.testPosition=n,r.hint=r.positionOutOfRange,!1)},i.prototype.clear=function(e){if(this.noMask){this.testString="",e.hint=e.success;return}if(!this.assignedCharCount)e.hint=e.noEffect;else{e.hint=e.success;for(var t=0;t<this.testString.length;t++)this.resetChar(t)}},i.prototype.isLiteral=function(e){return e?e.charType!==n.literal?e.charType===n.separator:!0:!1},i.prototype.testEscapeChar=function(e,t,n){return t=t<0?0:t,n||(n=this.descriptors[t]),this.isLiteral(n)?this.getSkipLiterals()?e===this.testString.charAt(t):!1:!!this.getResetOnPrompt()&&e===this.getPromtChar()||!!this.getResetOnSpace()&&e===" "?!0:!1},i.prototype.testChar=function(e,n,r){if(!t.wij.charValidator.isPrintableChar(e))return r.hint=r.invalidInput,!1;var i=this.descriptors[n];if(!i)return!1;if(this.isLiteral(i))return this.getSkipLiterals()&&e===this.testString.charAt(n)?(r.hint=r.characterEscaped,!0):(r.hint=r.nonEditPosition,!1);if(e===this.getPromtChar()){if(this.getResetOnPrompt())return this.isEditDesc(i)&&i.isAssigned?r.hint=r.sideEffect:r.hint=r.characterEscaped,!0;if(!this.getAllowPromptAsInput())return r.hint=r.promptCharNotAllowed,!1}if(e===" "&&this.getResetOnSpace())return this.isEditDesc(i)&&i.isAssigned?r.hint=r.sideEffect:r.hint=r.characterEscaped,!0;switch(this.mask.charAt(i.maskPosition)){case"L":if(!t.wij.charValidator.isLetter(e))return r.hint=r.letterExpected,!1;if(!t.wij.charValidator.isAsciiLetter(e)&&this.asciiOnly)return r.hint=r.asciiCharacterExpected,!1;break;case"a":if(!t.wij.charValidator.isAlphanumeric(e)&&e!==" ")return r.hint=r.alphanumericCharacterExpected,!1;if(!t.wij.charValidator.isAciiAlphanumeric(e)&&this.asciiOnly)return r.hint=r.asciiCharacterExpected,!1;break;case"?":if(!t.wij.charValidator.isLetter(e)&&e!==" ")return r.hint=r.letterExpected,!1;if(t.wij.charValidator.isAsciiLetter(e)||!this.asciiOnly)break;return r.hint=r.asciiCharacterExpected,!1;case"A":if(!t.wij.charValidator.isAlphanumeric(e))return r.hint=r.alphanumericCharacterExpected,!1;if(t.wij.charValidator.isAciiAlphanumeric(e)||!this.asciiOnly)break;return r.hint=r.asciiCharacterExpected,!1;case"C":if(!t.wij.charValidator.isAscii(e)&&this.asciiOnly&&e!==" ")return r.hint=r.asciiCharacterExpected,!1;break;case"9":if(!t.wij.charValidator.isDigit(e)&&e!==" ")return r.hint=r.digitExpected,!1;break;case"#":if(!t.wij.charValidator.isDigit(e)&&e!=="-"&&e!=="+"&&e!==" ")return r.hint=r.digitExpected,!1;break;case"&":if(!t.wij.charValidator.isAscii(e)&&this.asciiOnly)return r.hint=r.asciiCharacterExpected,!1;break;case"0":if(!t.wij.charValidator.isDigit(e))return r.hint=r.digitExpected,!1}return e===this.testString.charAt(n)&&i.isAssigned?r.hint=r.noEffect:r.hint=r.success,!0},i.prototype._testString=function(t,n,r){r.hint=r.unknown,r.testPosition=n;if(t.length){var i=new e.wijInputResult,s,o;i.testPosition=r.testPosition,i.hint=r.hint;for(s=0;s<t.length;s++){o=t.charAt(s);if(r.testPosition>this.testString.length)return r.hint=r.unavailableEditPosition,!1;if(!this.testEscapeChar(o,r.testPosition)){r.testPosition=this.findEditPositionFrom(r.testPosition,!0);if(r.testPosition===-1)return r.testPosition=this.testString.length,r.hint=r.unavailableEditPosition,!1}if(!this.testChar(o,r.testPosition,i))return r.hint=i.hint,!1;i.hint>r.hint&&(r.hint=i.hint),r.testPosition+=1;if(r.testPosition===this.testString.length)break}r.testPosition-=1}return!0},i.prototype.set=function(t,n){typeof n=="undefined"&&(n=new e.wijInputResult);if(t===undefined)throw"SetFromPos: input parameter is null or undefined.";n.hint=n.unknown,n.testPosition=0;if(!t.length)return this.clear(n),!0;if(this.noMask)return this.testString=t,!0;if(!this.testSetString(t,n.testPosition,n))return!1;var r=this.findAssignedEditPositionFrom(n.testPosition+1,!0);return r!==-1&&this.resetString(r,this.testString.length-1),!0},i.prototype.resetString=function(e,t){if(this.noMask){this.testString="";return}e=this.findAssignedEditPositionFrom(e,!0);if(e!==-1){t=this.findAssignedEditPositionFrom(t,!1);while(e<=t)e=this.findAssignedEditPositionFrom(e,!0),this.resetChar(e),e++}},i.prototype.setString=function(e,t){var n,r;for(n=0;n<e.length;n++){r=e.charAt(n),this.testEscapeChar(r,t)||(t=this.findEditPositionFrom(t,!0));if(t<0||t>=this.testString.length)return;this.setChar(r,t),t++}},i.prototype.testSetString=function(e,t,n){return e.length>this.testString.length&&(e=e.substring(0,this.testString.length)),this._testString(e,t,n)?(this.setString(e,t),!0):!1},i.prototype.toString=function(e,r,i,s,o){var u=this.inputWidget.options.text||"",a,f,l,c,h,p,d,v,m;u=t.trim(u);if(this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&(u===""||u===this.inputWidget.options.nullText))return this.inputWidget.options.nullText;e=e===undefined?!this.isPassword():e,r=r===undefined?this.getHidePromptOnLeave()?this.inputWidget.isFocused():!0:r,i=i===undefined?!0:i;if(this.noMask){if(!e){a="";for(f=0;f<this.testString.length;f++)a+=this.getPasswordChar();return a}return this.testString}s=s===undefined?0:s,o=o===undefined?this.testString.length:o;if(o<=0)return"";s<0&&(s=0);if(s>=this.testString.length)return"";l=this.testString.length-s,o>l&&(o=l);if((!this.isPassword()||e)&&r&&i)return c=this.testString.substring(s,o-s),c;h="",p=s+o-1;for(d=s;d<=p;d++){v=this.testString.charAt(d),m=this.descriptors[d];switch(m.charType){case n.editOptional:case n.editRequired:if(!m.isAssigned)break;if(!this.isPassword()||e){h+=v;continue}h+=this.getPasswordChar();continue;case n.editRequired|n.editOptional:h+=v;continue;case n.separator:case n.literal:if(!i)continue;h+=v;continue;default:h+=v;continue}if(r){h+=v;continue}h+=" ";continue}return h},i.prototype.isEditDesc=function(e){return this.noMask?!0:e.charType!==n.editRequired?e.charType===n.editOptional:!0},i.prototype.isEditPos=function(e){if(this.noMask)return!0;if(e<0||e>=this.testString.length)return!1;var t=this.descriptors[e];return this.isEditDesc(t)},i.prototype.internalRemoveAt=function(t,n,r,i){typeof i=="undefined"&&(i=!1);if(this.noMask){try{this.testString=this.testString.substring(0,t)+this.testString.substring(n+1,this.testString.length),r.testPosition=t}catch(s){}return!0}var o=new e.wijInputResult,u,a,f,l,c,h,p,d,v,m,g=this.findAssignedEditPositionFrom(this.testString.length-1,!1);f=this.findEditPositionInRange(t,n,!0,0),r.hint=r.noEffect;if(f===-1||f>g)return r.testPosition=t,!0;r.testPosition=t,l=n<g,this.findAssignedEditPositionInRange(t,n,!0)!==-1&&(r.hint=r.success);if(l){c=this.findEditPositionFrom(n+1,!0),h=c,t=f,p=!0;while(p){p=!1,u=this.testString.charAt(c),d=this.descriptors[c];if((u!==this.getPromtChar()||d.isAssigned)&&!this.testChar(u,f,o))return r.hint=o.hint,r.testPosition=f,!1;if(c!==g){c=this.findEditPositionFrom(c+1,!0),f=this.findEditPositionFrom(f+1,!0),p=!0;continue}}r.sideEffect>r.hint&&(r.hint=r.sideEffect);if(i)return!0;c=h,f=t,v=!0;while(v){v=!1,a=this.testString.charAt(c),m=this.descriptors[c],a===this.getPromtChar()&&!m.isAssigned?this.resetChar(f):(this.setChar(a,f),this.resetChar(c));if(c!==g){c=this.findEditPositionFrom(c+1,!0),f=this.findEditPositionFrom(f+1,!0),v=!0;continue}}t=f+1}return t<=n&&this.resetString(t,n),!0},i.prototype.removeAt=function(t,n,r){typeof n=="undefined"&&(n=t),typeof r=="undefined"&&(r=new e.wijInputResult);if(n>=this.testString.length)return r.testPosition=n,r.hint=r.positionOutOfRange,!1;if(t>=0&&t<=n){var i=this.internalRemoveAt(t,n,r,!1);return i}return r.testPosition=t,r.hint=r.positionOutOfRange,!1},i}(e.wijTextProvider);e.wijMaskedTextProvider=s;var o=function(){function e(e,t){this.maskPos=e,this.charType=t,this.caseConversion="none",this.isAssigned=!1,this.maskPosition=0,this.maskPosition=e,this.charType=t}return e}();e.wijCharDescriptor=o})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));