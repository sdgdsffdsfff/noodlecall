var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=180,n=9,r=5,i=function(i){function s(){i.apply(this,arguments)}return __extends(s,i),s.prototype._create=function(){var e=this;i.prototype._create.call(this),e.element.addClass(this.options.wijCSS.radialGauge)},s.prototype._set_radius=function(){var e=this;e._redrawMarksAndLabels(),e.pointer.wijRemove(),e._paintPointer(),e._setPointer()},s.prototype._set_startAngle=function(){var e=this;e._redrawMarksAndLabels(),e._setPointer()},s.prototype._set_sweepAngle=function(e){var t=this;e>360&&(t.options.endAngle=360),t._redrawMarksAndLabels(),t._setPointer()},s.prototype._set_width=function(){var e=this;e._autoCalculate(),i.prototype._set_width.call(this)},s.prototype._set_height=function(){var e=this;e._autoCalculate(),i.prototype._set_height.call(this)},s.prototype._set_origin=function(){var e=this;e._autoCalculate()},s.prototype._set_cap=function(){var e=this;e.pointer.wijRemove(),e._paintPointer(),e._setPointer()},s.prototype._clearState=function(){i.prototype._clearState.call(this),this.markBbox=null},s.prototype._valueToAngleIncludeOffset=function(n){return e.GaugeUtil.mod360(this._valueToAngle(n)+t)},s.prototype._valueToAngle=function(e){var t=this,n=t._valueToLogical(e);return t._logicalToAngle(n)},s.prototype._angleToValue=function(e){var t=this,n=t._angleToLogical(e);return t._logicalToValue(n)},s.prototype._logicalToAngle=function(e){var t=this,n=t.options,r=n.startAngle,i=n.sweepAngle,s=n.isInverted;return s?r*e+(r+i)*(1-e):r*(1-e)+(r+i)*e},s.prototype._angleToLogical=function(t){var n=this,r=n.options,i=r.startAngle,s=r.isInverted,o=e.GaugeUtil.mod360(t-i),u=r.sweepAngle,a,f;return u===0||o===0?s?1:0:(u<0&&(o=360-o,u=-u),a=o-u,a>0?(f=360-o,a<f?1:0):s?1-o/u:o/u)},s.prototype._generatePoints=function(e,t,i,s){var o=this,u=o.options.isInverted,a=parseInt((n+n*(Math.abs(parseInt((t-e).toString(),10))/(n*r))).toString(),10),f=[],l,c,h,p,d;for(d=0;d<a;d++)l=d/(a-1),c=i+(s-i)*l,p=e+(t-e)*l,h=o._angleToValue(p),f.push(o._valueToPoint(h,c));return f},s.prototype._valueToPoint=function(e,t){var n=this,r=n._valueToAngleIncludeOffset(e)*Math.PI/180,i=t;return{x:i*Math.cos(r),y:i*Math.sin(r)}},s.prototype._pointToValue=function(t){var n=e.GaugeUtil.mod360(Math.atan2(t.x,-t.y)*180/Math.PI);return this._angleToValue(n)},s.prototype._radiusScreen=function(e){var t=this,n=t.options;return Math.max(n.radius*e,0)},s.prototype._autoCalculate=function(){var t=this,n=t.options,r=n.width,i=n.height,s,o,u,a=e.GaugeUtil.formatString(n.max,n.labels.format),f=0,l,c=i-n.marginTop-n.marginBottom,h=r-n.marginLeft-n.marginRight;t.centerPoint={x:n.marginLeft+h*n.origin.x,y:n.marginTop+c*n.origin.y},t.radius=n.radius,n.radius==="auto"&&(t.faceRadius=Math.min(h,c)/2,l=t._getFaceBorder(),t.faceRadius-=l,s=t._getMarkerbbox(n.tickMajor).width,o=t._getMarkerbbox(n.tickMinor).width,u=t._getLabelBBox(a).width,n.tickMajor.position==="center"?(f-=s/2,f-=u):n.tickMajor.position==="outside"&&(f-=s,f-=u),n.tickMinor.position==="center"?f=Math.min(f,-o/2):n.tickMinor.position==="outside"&&(f=Math.min(f,-o)),t.radius=t.faceRadius+f,n.tickMajor.position!=="inside"&&(t.faceRadius+=f))},s.prototype._getFaceBorder=function(){var e=this,t=e._paintFace(),n=t.attr("stroke-width")||1;return t.type==="set"&&(n=t[0].attr("stroke-width")||1),t.wijRemove(),n},s.prototype._getMaxRangeWidth=function(){var e=this,t=e.options,n=0;return $.each(t.ranges,function(e,t){n=Math.max(n,t.width||0),n=Math.max(n,t.startWidth||0),n=Math.max(n,t.endWidth||0)}),n},s.prototype._getMarkerbbox=function(e){var t=this,n=t._paintMarkEle(e),r=n.wijGetBBox();return n.wijRemove(),{width:r.width,height:r.height}},s.prototype._paintMark=function(e,t,n){var r=this,i,s=t.position||"inside",o=t.offset||0;return i=r._paintMarkEle(t),i.attr(t.style),$.wijraphael.addClass($(i.node),r.options.wijCSS.radialGaugeMarker),$(i.node).data("value",e),r._applyAlignment(i,s,o),r._setMarkValue(e,i),i},s.prototype._applyAlignment=function(e,t,n){if(!e)return;var r=e.wijGetBBox(),i=r.width/2,s=0;switch(t){case"outside":s-=i+n;break;case"inside":s+=i+n}e.transform("t"+s+","+0)},s.prototype._paintMarkEle=function(t){var n=this,r=n.options,i={x:n.centerPoint.x-n.radius,y:n.centerPoint.y},s=t.marker||"circle",o=s==="rect"?5:2,u=2,a,f=t.style["stroke-width"]||0;if(s==="tri"||s==="invertedTri")o=5,u=3;return s==="cross"&&(t.style.fill=t.style.stroke||t.style.fill),isNaN(i.x)&&(i.x=0),a=o*t.factor,u+=f*2,a+=f*2,$.isFunction(s)?s.call(n,n.canvas,i,r):e.GaugeUtil.paintMarker(n.canvas,s,i.x,i.y,a,u)},s.prototype._setMarkValue=function(e,t){var n=this,r=n._valueToAngle(e);t.transform(Raphael.format("r{0},{1},{2}...",r,n.centerPoint.x,n.centerPoint.y))},s.prototype._paintLabel=function(t,n){var r=this,i=r._valueToAngle(t),s=n.format,o=n.style,u=n.offset,a=t.toString(),f=r.options.tickMajor,l=f.position||"inside",c,h,p,d,v;s!==""&&(a=e.GaugeUtil.formatString(t,s)),p=r._getMarkerBbox(),v=r._getLabelBBox(a);switch(l){case"inside":d=p.x+p.width+v.width/2;break;case"outside":d=p.x-v.width/2;break;default:d=p.x-v.width/2}return d=r.centerPoint.x-d+u,c=e.GaugeUtil.getPositionByAngle(r.centerPoint.x,r.centerPoint.y,d,i),h=r.canvas.text(c.x,c.y,a),h.attr(o),$.wijraphael.addClass($(h.node),r.options.wijCSS.radialGaugeLabel),h},s.prototype._getLabelBBox=function(e){var t=this,n=t.options,r,i;return r=t.canvas.text(0,0,e),r.attr(n.gaugeLableStyle),i=r.wijGetBBox(),r.wijRemove(),i},s.prototype._getMarkerBbox=function(){var e=this,t=e.options,n=t.tickMajor,r;return e.markBbox||(r=e._paintMarkEle(n),e._applyAlignment(r,n.position,n.offset||0),e.markBbox=r.wijGetBBox(),r.wijRemove()),e.markBbox},s.prototype._paintFace=function(){var e=this,t=e.options,n=Math.min(t.width,t.height)/2,r,i;return e.faceRadius&&(n=e.faceRadius),t.face&&t.face.template&&$.isFunction(t.face.template)?(i={canvas:e.canvas,r:n,origin:{x:e.centerPoint.x,y:e.centerPoint.y}},t.face.template.call(e,i)):(r=e.canvas.circle(e.centerPoint.x,e.centerPoint.y,n),t.face&&t.face.style&&r.attr(t.face.style),$.wijraphael.addClass($(r.node),t.wijCSS.radialGaugeFace),r)},s.prototype._paintPointer=function(){var e=this,t=e.options,n=t.pointer,r=e.radius*n.length,i={x:e.centerPoint.x-r+n.offset*e.radius,y:e.centerPoint.y-n.width/2},s;if(!n.visible)return;t.cap&&t.cap.behindPointer&&t.cap.visible&&e._paintCap(),n.template&&$.isFunction(n.template)?s=n.template.call(e.canvas,i,$.extend({},n,{length:r})):(n.shape==="rect"?s=e.canvas.rect(i.x-n.width/2,i.y,r,n.width):s=e.canvas.isoTri(i.x-n.width/2,i.y,r,n.width),s.attr(n.style)),e.pointer=s,$.wijraphael.addClass($(s.node),t.wijCSS.radialGaugePointer),(!t.cap||!t.cap.behindPointer)&&t.cap.visible&&e._paintCap()},s.prototype._paintCap=function(){var e=this,t=e.options,n=t.cap,r;return n&&n.template&&$.isFunction(n.template)?(r={canvas:e.canvas,origin:{x:e.centerPoint.x,y:e.centerPoint.y}},e.cap=n.template.call(e,r),e.cap):(e.cap=e.canvas.circle(e.centerPoint.x,e.centerPoint.y,n.radius),n&&n.style&&e.cap.attr(n.style),$.wijraphael.addClass($(e.cap.node),t.wijCSS.radialGaugeCap),e.cap)},s.prototype._paintRange=function(e){var t=this,n=t.options,r=isNaN(e.startValue)?0:e.startValue,i=isNaN(e.endValue)?0:e.endValue,s=isNaN(e.startWidth)?isNaN(e.width)?0:e.width:e.startWidth,o=isNaN(e.endWidth)?isNaN(e.width)?0:e.width:e.endWidth,u=e.startDistance||1,a=e.endDistance||1,f,l;r!==i&&(i>r?(f=Math.max(r,n.min),l=Math.min(n.max,i)):(f=Math.max(n.min,i),l=Math.min(n.max,r)),u*=t.radius,a*=t.radius,t._drawRange(f,l,u,a,s,o,e))},s.prototype._drawRange=function(e,t,n,r,i,s,o){var u=this,a=u._valueToAngle(e),f=u._valueToAngle(t),l=u._generatePoints(a,f,i+n,s+r),c=u._generatePoints(a,f,n,r),h,p,d="";$.each(l,function(e,t){e===0?d+="M"+Math.round(t.x+u.centerPoint.x)+" "+Math.round(t.y+u.centerPoint.y):d+="L"+(t.x+u.centerPoint.x)+" "+Math.round(t.y+u.centerPoint.y)});for(h=c.length-1;h>=0;h--)d+="L"+Math.round(c[h].x+u.centerPoint.x)+" "+Math.round(c[h].y+u.centerPoint.y);d+="Z",p=u.canvas.path(d),p.attr(o.style),u.ranges.push(p),$.wijraphael.addClass($(p.node),u.options.wijCSS.radialGaugeRange)},s.prototype._setOffPointerValue=function(){var e=this,t=e._valueToAngle(0);e.pointer.transform(Raphael.format("r{0},{1},{2}",t,e.centerPoint.x,e.centerPoint.y))},s.prototype._setPointer=function(){var e=this,t=e.options,n=e._valueToAngle(t.value),r=t.animation;if(!e.pointer)return;i.prototype._setPointer.call(this),r.enabled?e.pointer.stop().wijAnimate({transform:"r"+n+","+e.centerPoint.x+","+e.centerPoint.y},r.duration,r.easing):e.pointer.transform(Raphael.format("r{0},{1},{2}",n,e.centerPoint.x,e.centerPoint.y))},s}(e.wijgauge);e.wijradialgauge=i,i.prototype.widgetEventPrefix="wijradialgauge";var s=function(){function e(){this.initSelector=":jqmData(role='wijradialgauge')",this.wijCSS={radialGauge:"wijmo-wijradialgauge",radialGaugeLabel:"wijmo-wijradialgauge-label",radialGaugeMarker:"wijmo-wijradialgauge-mark",radialGaugeFace:"wijmo-wijradialgauge-face",radialGaugePointer:"wijmo-wijradialgauge-pointer",radialGaugeCap:"wijmo-wijradialgauge-cap",radialGaugeRange:"wijmo-wijradialgauge-range"},this.radius="auto",this.startAngle=0,this.sweepAngle=180,this.pointer={length:.8,style:{fill:"#1E395B",stroke:"#1E395B"},width:8,offset:.15,shape:"tri",visible:!0,template:null},this.origin={x:.5,y:.5},this.labels={format:"",style:{fill:"#1E395B","font-size":12,"font-weight":"800"},offset:30,visible:!0},this.tickMinor={position:"inside",offset:30,style:{fill:"#1E395B"},visible:!0,factor:1,marker:"rect",interval:5},this.tickMajor={position:"inside",offset:27,style:{fill:"#1E395B",stroke:"#1E395B","stroke-width":1},visible:!0,interval:10,factor:2,marker:"rect"},this.cap={radius:15,style:{fill:"#1E395B",stroke:"#1E395B"},behindPointer:!1,visible:!0,template:null},this.face={style:{fill:"r(0.9, 0.60)#FFFFFF-#D9E3F0",stroke:"#7BA0CC","stroke-width":4},template:null}}return e}();i.prototype.options=$.extend(!0,{},e.wijgauge.prototype.options,new s),$.wijmo.registerWidget("wijradialgauge",i.prototype)})(e.gauge||(e.gauge={}));var t=e.gauge})(wijmo||(wijmo={}));