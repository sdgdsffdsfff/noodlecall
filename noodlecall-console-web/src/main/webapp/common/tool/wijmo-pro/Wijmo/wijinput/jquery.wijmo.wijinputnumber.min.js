var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype._createTextProvider=function(){this._textProvider=new i(this,this.options.type),this._textProvider._nullvalue=this.element.val()===""&&this.options.value===null},r.prototype._beginUpdate=function(){var e=this.options;this.element.addClass(e.wijCSS.wijinputnumber),this.element.data({defaultValue:e.value,preValue:e.value}).attr({"aria-valuemin":e.minValue,"aria-valuemax":e.maxValue,"aria-valuenow":e.value||0})},r.prototype._setOption=function(e,t){n.prototype._setOption.call(this,e,t);switch(e){case"minValue":this.element.attr("aria-valuemin",t),this._updateText();break;case"maxValue":this.element.attr("aria-valuemax",t),this._updateText();break;case"value":this.setValue(t),this._updateText();break;case"showGroup":case"decimalPlaces":case"culture":this._textProvider.updateStringFormat(),this._updateText()}},r.prototype._setData=function(e){this.setValue(e)},r.prototype._resetData=function(){var e=this.element.data("defaultValue");if(e===undefined||e===null){e=this.element.data("elementValue");if(e===undefined||e===null&&e==="")e=0}this.setValue(e)},r.prototype._validateData=function(){this._textProvider.checkAndRepairBounds(!0,!1)||this._updateText()},r.prototype._raiseDataChanged=function(){var e=this.options.value,t=this.element.data("preValue");this.element.data("preValue",e),t!==e&&(this.element.attr("aria-valuenow",e),this._trigger("valueChanged",null,{value:e}))},r.prototype._onChange=function(){},r.prototype.getValue=function(){if(this._textProvider._nullvalue)return null;var e=this._textProvider.getValue();if(e===undefined||e===null)e=this.getText();return e},r.prototype.setValue=function(e,t){typeof t=="undefined"&&(t=!1);try{t=!!t,e===null||typeof e=="undefined"||isNaN(e)?e=null:typeof e=="boolean"?e=e?"1":"0":typeof e=="string"&&(e=this._textProvider.tryParseValue(e));if(this._textProvider.setValue(e))this._updateText();else if(t){var n="",r;n=this.getText(),this.setText(e),e=e.trim(),r=this.getText().trim(),r!==e&&this.setText(n)}else this.setText(e);return!0}catch(i){return!1}},r.prototype.isValueNull=function(){try{return this._textProvider.isValueNull()}catch(e){return!0}},r.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(this.options.showNullText&&this.isValueNull())return"0";var e=this.options.value?this.options.value:0;return this.options.type==="percent"&&(e=(e/100).toFixed(10)),e.toString()},r.prototype._updateText=function(e){typeof e=="undefined"&&(e=!1);if(!this._isInitialized())return;this._textProvider._nullvalue||(this.options.value=this._textProvider.getValue()),n.prototype._updateText.call(this,e),this._textProvider.checkAndRepairBounds(!1,!1)||this._trigger("valueBoundsExceeded")},r.prototype._doSpin=function(n,r){if(!this._allowEdit())return!1;if(r&&this.element.data("breakSpinner"))return!1;var i=this.element.wijtextselection(),s=new e.wijInputResult;return this.element.data("focusNotCalledFirstTime")!==-9&&(new Date).getTime()-this.element.data("focusNotCalledFirstTime")<600&&(this.element.data("focusNotCalledFirstTime",-9),this.element.data("prevCursorPos",0)),this.element.data("prevCursorPos")===-1?this.element.data("prevCursorPos",i.start):i.start=this.element.data("prevCursorPos"),s.testPosition=i.start,this._textProvider[n?"incEnumPart":"decEnumPart"](i.start,s,this.options.increment),this._updateText(),this.element.data("prevCursorPos",s.testPosition),this.selectText(s.testPosition,s.testPosition),r&&!this.element.data("breakSpinner")&&window.setTimeout(t.proxy(function(){this._doSpin(n,!0)},this),this._calcSpinInterval()),!0},r.prototype._deleteSelText=function(e){typeof e=="undefined"&&(e=!1);var t=this.element.wijtextselection(),r=t.start===0&&t.end===this.element.val().length,i;if(t.start===t.end&&!e){i=this._textProvider._stringFormat._currentText;if(i.charAt(t.end)===this._textProvider.getGroupSeparator()||i.charAt(t.end)===this._textProvider.getDecimalSeparator()){t.start++,t.end++,this.element.wijtextselection(t);return}}n.prototype._deleteSelText.call(this,e);if(r||parseFloat(this.element.val())===0)this._textProvider._nullvalue=!0,this._updateText(!0),this.options.value=null},r}(e.wijinputcore);e.wijinputnumber=n;var r=function(){function t(){this.wijCSS={wijinputnumber:e.wijinputcore.prototype.options.wijCSS.wijinput+"-numeric"},this.type="numeric",this.value=null,this.minValue=-1e9,this.maxValue=1e9,this.showGroup=!1,this.decimalPlaces=2,this.increment=1,this.valueChanged=null,this.valueBoundsExceeded=null}return t}();n.prototype.options=t.extend(!0,{},e.wijinputcore.prototype.options,new r),t.wijmo.registerWidget("wijinputnumber",n.prototype);var i=function(n){function r(e,t){n.call(this),this._type="numeric",this._stringFormat=null,this._nullvalue=!1,this.inputWidget=e,this._type=t,this._stringFormat=new s(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture()),this._stringFormat._setValueFromJSFloat(this.getValue())}return __extends(r,n),r.prototype._getCulture=function(){return this.inputWidget._getCulture()},r.prototype.getDecimalSeparator=function(){return this._getCulture().numberFormat["."]},r.prototype.getGroupSeparator=function(){return this._getCulture().numberFormat[","]},r.prototype.tryParseValue=function(e){return this._stringFormat.tryParseValue(e)},r.prototype.toString=function(){return this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&this.isValueNull()?this.inputWidget.options.nullText:this._stringFormat.getFormattedValue()},r.prototype.isValueNull=function(){var e=this.inputWidget.options,t=e.minValue;return null===e.value||undefined===e.value||this._nullvalue},r.prototype.set=function(e,t){return this.clear(),this.insertAt(e,0,t),!0},r.prototype.clear=function(){this._stringFormat.clear()},r.prototype.checkAndRepairBounds=function(e,t){var n=!0,r,i;return typeof e=="undefined"&&(e=!1),r=this.inputWidget.options.minValue,i=this.inputWidget.options.maxValue,typeof t!="undefined"&&t?this._stringFormat.checkMinValue(r,!1,!0):(this._stringFormat.checkMinValue(r,e,!1)||(n=!1),this._stringFormat.checkMaxValue(i,e)||(n=!1),this.inputWidget.options.decimalPlaces>=0&&this._stringFormat.checkDigitsLimits(this.inputWidget.options.decimalPlaces),n)},r.prototype.countSubstring=function(e,t){var n=0,r=e.indexOf(t);while(r!==-1)n++,r=e.indexOf(t,r+1);return n},r.prototype.getAdjustedPositionFromLeft=function(e){var n=this._stringFormat._currentText,r,i;for(r=0;r<n.length;r++){i=n.charAt(r);if(!(!t.wij.charValidator.isDigit(i)&&i!==this.getGroupSeparator()&&i!==this.getDecimalSeparator()||i==="0"))break;this._stringFormat.isZero()?e<r&&e++:e<=r&&e++}return e},r.prototype.getDecimalSeparatorPos=function(){var e=this._stringFormat._currentText;return e.indexOf(this.getDecimalSeparator())},r.prototype.removeLeadingZero=function(e){var t=0;(e.charAt(t)===" "||e.charAt(t)===this._getCulture().numberFormat.currency.symbol)&&t++;while(e.charAt(t)==="0"&&e.charAt(t+1)!==".")e=e.substr(0,t)+e.substr(t+1);return e},r.prototype.insertAt=function(n,r,i){var s=this._getCulture().numberFormat,o,u,a,f,l,c,h,p,d,v;i||(i=new e.wijInputResult),this._nullvalue=!1;if(n.length===1){if(n==="+")return this._stringFormat.setPositiveSign(),this.checkAndRepairBounds(!0,!1),!0;if(n==="-"||n===")"||n==="(")return this._stringFormat.invertSign(),this.checkAndRepairBounds(!0,!1),i.testPosition=r,this._stringFormat.isNegative()?i.testPosition=r:i.testPosition=r-2,!0;if(!t.wij.charValidator.isDigit(n)){if(n===this.getDecimalSeparator()){o=this.getDecimalSeparatorPos();if(o>=0)return i.testPosition=o,!0}if(n!==this.getGroupSeparator()&&n!==this.getDecimalSeparator()&&n!==")"&&n!=="+"&&n!=="-"&&n!=="("&&n!==this.getDecimalSeparator())return this._type==="percent"&&n===s.percent.symbol?(i.testPosition=r,!0):this._type==="currency"&&n===s.currency.symbol?(i.testPosition=r,!0):!1}}r=this.getAdjustedPositionFromLeft(r),u=r,a=this._stringFormat._currentText,u>a.length&&(u=a.length-1),f=this.removeLeadingZero(a.substring(0,u)),l=a.substring(u,a.length),this._stringFormat.isZero()&&(l=l.replace(/0/,"")),i.testPosition=f.length+n.length-1,this._stringFormat.deFormatValue(f+n+l),c=this._stringFormat._currentText;try{this.inputWidget.options.showGroup?(h=this.countSubstring(f,this._stringFormat._groupSeparator),p=this.countSubstring(c.substring(0,f.length+n.length),this._stringFormat._groupSeparator),i.testPosition+=p-h):n.length===1&&(d=f.charAt(f.length-1),v=c.charAt(i.testPosition-1),v!==d&&i.testPosition--)}catch(m){}return!0},r.prototype.removeAt=function(t,n,r,i){typeof r=="undefined"&&(r=new e.wijInputResult),typeof i=="undefined"&&(i=!1);var s=this._getCulture().numberFormat,o,u,a,f,l,c;r.testPosition=t;try{o=this._stringFormat._currentText;if(t===n&&o.substring(t,n+1)===this.getDecimalSeparator())return!1;u=o.slice(0,t),a=u,f=o.slice(t,n+1).indexOf(this.getDecimalSeparator())>=0,f&&(a+=this.getDecimalSeparator()),a+=o.slice(n+1),a=a||"0",this._stringFormat.deFormatValue(a),a=this._stringFormat._currentText,this._nullvalue=!1;if(this.inputWidget.options.showGroup)if(f)r.testPosition=a.indexOf(this.getDecimalSeparator());else try{l=this.countSubstring(u,this._stringFormat._groupSeparator),c=this.countSubstring(a.substring(0,Math.max(0,t-1)),this._stringFormat._groupSeparator),r.testPosition-=l-c,(o.indexOf(s.currency.symbol)===r.testPosition||o.indexOf(s.percent.symbol)===r.testPosition)&&r.testPosition++}catch(h){}return!0}catch(p){}return!0},r.prototype.incEnumPart=function(t,n,r){return n||(n=new e.wijInputResult),this._stringFormat.increment(r),this._nullvalue=!1,this.checkAndRepairBounds(!0,!1)},r.prototype.decEnumPart=function(t,n,r){return n||(n=new e.wijInputResult),this._stringFormat.decrement(r),this._nullvalue=!1,this.checkAndRepairBounds(!0,!1)},r.prototype.getValue=function(){return this._stringFormat.getJSFloatValue()},r.prototype.setValue=function(e){try{return e===null?(this._nullvalue=!0,e=0):this._nullvalue=!1,this._stringFormat._setValueFromJSFloat(e),this.checkAndRepairBounds(!0,!1),!0}catch(t){return!1}},r.prototype.updateStringFormat=function(){var e="0";typeof this._stringFormat!="undefined"&&(e=this._stringFormat._currentValueInString),this._stringFormat=new s(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture()),this._stringFormat._currentValueInString=e},r}(e.wijTextProvider);e.wijNumberTextProvider=i;var s=function(){function e(e,t,n,r){this.type=e,this.digitsPlaces=t,this.showGroup=n,this.culture=r,this._currentValueInString="0",this._currentText="0",this._groupSeparator=" "}return e.prototype.decimalSeparator=function(){return this.culture.numberFormat["."]},e.prototype.isNegtive=function(e){return e.indexOf("-")!==-1||e.indexOf("(")!==-1},e.prototype.stripValue=function(e){var t=this.culture.numberFormat,n=t[this.type]||t,r=this.isNegtive(e),i=n[","],s=n["."],o=new RegExp("["+i+t.percent.symbol+t.currency.symbol+" ]","g"),u;return this._groupSeparator=i,e=this._removeNegativeSign(e),e=e.replace(o,""),e=e.replace(s,"."),u=/([\d\.])+/.exec(e),u&&(e=u[0]),r&&(e="-"+e),e},e.prototype.tryParseValue=function(e){try{var t=parseFloat(this.stripValue(e));return isNaN(t)&&(t=null),t}catch(n){return null}},e.prototype.deFormatValue=function(e){e=this.stripValue(e),this._currentValueInString=e,this._currentText=this.formatValue(e)},e.prototype.formatValue=function(e){var t=this.culture.numberFormat,n=t[this.type]||t,r=this.digitsPlaces,i=this.isNegtive(e),s=n.pattern[i?0:1]||"n",o=n[","],u=n["."],a=r!==-2?r:n.decimals,f=this.showGroup?n.groupSizes:[0],l;return e=this._removeLeadingZero(e),l=this.formatDigit(e,o,u,a,f),l=this._removeLeadingZero(l),l.indexOf(u)===0&&(l="0"+l),l===""&&(l="0"),this._currentValueInString=e,this._currentText=this.applyFormatPattern(s,l,t.percent.symbol,t.currency.symbol),this._currentText},e.prototype.getFormattedValue=function(){return this.formatValue(this._currentValueInString)},e.prototype.getJSFloatValue=function(){try{return this._currentValueInString===""?0:parseFloat(this._currentValueInString)}catch(e){return Number.NaN}},e.prototype.clear=function(){this._currentValueInString="0",this._currentText="0"},e.prototype._setValueFromJSFloat=function(e){var t=""+e;try{return this._currentValueInString=t,this.formatValue(t),!0}catch(n){return!1}},e.prototype.isZero=function(e){typeof e=="undefined"&&(e=this._currentValueInString);var t=this._removeNegativeSign(e),n;return t?(n=parseFloat(t),!isNaN(n)&&!n):!0},e.prototype.setPositiveSign=function(){this._currentValueInString=this._removeNegativeSign(this._currentValueInString)},e.prototype._removeNegativeSign=function(e){return e.replace(/[()\-]/g,"")},e.prototype._removeLeadingZero=function(e){return e.replace(/^0+/,"")},e.prototype.isNegative=function(){return this._currentValueInString.indexOf("-")!==-1||this._currentValueInString.indexOf("(")!==-1},e.prototype.invertSign=function(){var e=this.isNegative();e?this.setPositiveSign():this._currentValueInString=this._currentValueInString.length?"-"+this._currentValueInString:"0",this.isZero()&&(this._currentValueInString=e?"0":"-0"),this.formatValue(this._currentValueInString)},e.prototype.parseNumber=function(e){typeof e=="undefined"&&(e=this._currentValueInString);var t=e.split(".",2);return{decimal:parseInt(t[0],10)||0,fraction:(t.length>1?parseInt(t[1],10):0)||0}},e.prototype._change=function(e){var t=this.parseNumber();this._currentValueInString=""+(t.decimal+e)+"."+t.fraction},e.prototype.increment=function(e){typeof e=="undefined"&&(e=1),this._change(e)},e.prototype.decrement=function(e){typeof e=="undefined"&&(e=1),this._change(-e)},e.prototype.checkDigitsLimits=function(e){var t=this._currentValueInString.split("."),n="";if(!t.length||t.length===1&&t[0]==="")return;t.length>1&&(n=t[1]),n=n.substring(0,e);while(n.length<e)n+="0";this._currentValueInString=t[0],n&&(this._currentValueInString+="."+n)},e.prototype.checkMinValue=function(e,t,n){typeof n=="undefined"&&(n=!1);var r=!0,i,s,o,u,a;try{i=this._currentValueInString.split("."),s=parseFloat(i[0]===""||i[0]==="-"?"0":i[0]),o=0,i.length>1&&parseFloat(i[1])>0&&(o=parseFloat("1."+i[1]));if(s<0||i[0]==="-")o*=-1;e=""+e+"",i=e.split("."),u=parseFloat(i[0]),a=0,i.length>1&&parseFloat(i[1])>0&&(a=parseFloat("1."+i[1]));if(s>u)return!0;s<u||n&&s===u&&o<=a?r=!1:s===u&&s<0&&o>a?r=!1:s===u&&s>=0&&o<a&&(r=!1),!r&&t&&(this._currentValueInString=""+e+"")}catch(f){}return r},e.prototype.checkMaxValue=function(e,t){var n=!0,r,i,s,o,u;try{r=this._currentValueInString.split("."),i=parseFloat(r[0]===""||r[0]==="-"?"0":r[0]),s=0,r.length>1&&parseFloat(r[1])>0&&(s=parseFloat("1."+r[1]));if(i<0||r[0]==="-")s*=-1;e=""+e+"",r=e.split("."),o=parseFloat(r[0]),u=0,r.length>1&&parseFloat(r[1])>0&&(u=parseFloat("1."+r[1]));if(i<o)return!0;i>o&&(n=!1),i===o&&i>=0&&s>u&&(n=!1),i===o&&i<0&&s<u&&(n=!1),!n&&t&&(this._currentValueInString=""+e+"")}catch(a){}return n},e.prototype.applyFormatPattern=function(e,t,n,r){return e.replace(/n/g,t).replace(/%/g,n).replace(/\$/g,r)},e.prototype.formatDigit=function(e,t,n,r,i){var s=this._removeNegativeSign(e),o,u,a,f,l,c;o=s.indexOf("."),o===-1&&(o=s.length),u="",a=0,f=0;for(c=s.length-1;c>=0;c--)l=s.charAt(c),c<o&&(u=l+u,f++,f===i[a]*1&&i[a]*1&&c&&(u=t+u,f=0,i.length-1>a&&a++));if(r>0){u+=n;for(c=0;c<r;c++)l="0",c+o+1<s.length&&(l=s.charAt(c+o+1)),u+=l}return r===-1&&o<s.length-1&&(u+=n,u+=s.substr(o+1)),u},e}();e.wijNumberFormat=s})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));