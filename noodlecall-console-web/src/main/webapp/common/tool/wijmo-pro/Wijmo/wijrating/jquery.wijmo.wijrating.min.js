var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=this;"use strict";var r=jQuery,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(t,n){var i=this.options,s=r("."+i.wijCSS.wijratingResetButton,this.ratingElement[0]),o=r("."+i.wijCSS.wijratingStarContainer,this.ratingElement[0]),u=r("."+i.wijCSS.wijratingNormalStar,this.ratingElement[0]);if(r.isPlainObject(i[t])){switch(t){case"resetButton":typeof n.disabled!="undefined"&&n.disabled!==i[t].disabled&&(n.disabled?(s.hide(),s.attr("aria-hidden",!0)):i.disabled||(s.show(),s.attr("aria-hidden",!1))),typeof n.hint!="undefined"&&n.hint!==i[t].hint&&(n.hint===null?s.attr("title",""):s.attr("title",n.hint)),n.position&&n.position.length&&n.position!==i[t].position&&(n.position==="rightOrBottom"?s.parent().append(s):s.parent().prepend(s)),typeof n.customizedClass!="undefined"&&n.customizedClass!==i[t].customizedClass&&(i[t].customizedClass.length&&s.removeClass(i[t].customizedClass),n.customizedClass.length&&s.addClass(n.customizedClass));break;case"hint":typeof n.disabled!="undefined"&&n.disabled!==i[t].disabled&&(n.disabled?u.removeAttr("title"):this._resetHint(i.hint.content)),typeof n.content!="undefined"&&n.content!==i[t].content&&(i[t].disabled||this._resetHint(n.content));break;case"icons":typeof n.iconsClass!="undefined"&&(i[t].iconsClass&&i[t].iconsClass.length&&this._removeCustomizedIconsClass(i[t].iconsClass),this._addCustomizedIconsClass(n.iconsClass,i.split)),typeof n.hoverIconsClass!="undefined"&&i[t].hoverIconsClass&&i[t].hoverIconsClass.length&&this._removeCustomizedIconsClass(i[t].hoverIconsClass),typeof n.ratedIconsClass!="undefined"&&(i[t].ratedIconsClass&&i[t].ratedIconsClass.length&&this._removeCustomizedIconsClass(i[t].ratedIconsClass),this._resetValue(i.value,i.ratingMode,n.ratedIconsClass));break;default:}r.extend(!0,i[t],n)}else{if(n===i[t])return;switch(t){case"disabled":n?(this._unbindLiveEvents(),s.hide(),s.attr("aria-hidden",!0)):(this._bindLiveEvents(),i.resetButton.disabled||(s.show(),s.attr("aria-hidden",!1)));break;case"count":this._createStars(i.split,n,o);break;case"split":this._createStars(n,i.count,o);break;case"totalValue":this._resetTotalValue(n);break;case"orientation":n==="vertical"?this.ratingElement.addClass(i.wijCSS.wijvRating):this.ratingElement.removeClass(i.wijCSS.wijvRating),i.split>1&&(i[t]=n,this._createStars(i.split,i.count,o));break;case"direction":i[t]=n,this._createStars(i.split,i.count,o);break;case"ratingMode":this._resetValue(i.value,n,i.icons.ratedIconsClass);break;case"value":if(i.min&&n<i.min)return;if(i.max&&n>i.max)return;this._resetValue(n,i.ratingMode,i.icons.ratedIconsClass);break;case"iconWidth":i[t]=n,this._createStars(i.split,i.count,o);break;case"iconHeight":i[t]=n,this._createStars(i.split,i.count,o);break;default:}e.prototype._setOption.call(this,t,n)}},t.prototype._create=function(){var t=this.options,n;if(this.element.is("select"))this._parseSelect(),this.element.hide(),n=r("<div></div>"),this.element.after(n);else{if(!this.element.is("div"))return;this.element.children("input[type='radio']").length>0?(this._parseRadio(),this.element.hide(),n=r("<div></div>"),this.element.after(n)):n=this.element}this.ratingElement=n,this._createRating(),t.disabled||this._bindLiveEvents(),e.prototype._create.call(this)},t.prototype.destroy=function(){var t=this.options;this._unbindLiveEvents(),this.element!==this.ratingElement?(this.ratingElement.remove(),this.element.show()):this.element.removeClass(t.wijCSS.widget).removeClass(t.wijCSS.wijrating).removeClass(t.wijCSS.wijvRating).empty(),e.prototype.destroy.call(this)},t.prototype._unbindLiveEvents=function(){var e=this.options;this.ratingElement.off(".wijrating","."+e.wijCSS.wijratingNormalStar).off(".wijrating","."+e.wijCSS.wijratingResetButton)},t.prototype._bindLiveEvents=function(){var e=this,t=e.options,n="."+t.wijCSS.wijratingNormalStar,i="."+t.wijCSS.wijratingResetButton,s,o={element:e.ratingElement,mouseover:function(i){var o=r(i.target),u=r(n,e.ratingElement[0]);o.is(n)&&(u.removeClass(t.wijCSS.wijratingHoverStar),o.addClass(t.wijCSS.wijratingHoverStar),t.ratingMode==="continuous"&&(t.direction==="reversed"?o.parent().nextAll().children().addClass(t.wijCSS.wijratingHoverStar):o.parent().prevAll().children().addClass(t.wijCSS.wijratingHoverStar)),e._addCustomizedHoverIconsClass(t.icons.hoverIconsClass,t.split,o),s={value:parseFloat(o.html()),target:o},e._trigger("hover",i,s))},mouseout:function(i){var s=r(i.target),o=r(n,e.ratingElement[0]);s.is(n)&&(o.removeClass(t.wijCSS.wijratingHoverStar),e._removeCustomizedIconsClass(t.icons.hoverIconsClass))},click:function(i){var o=r(i.target),u=parseFloat(o.html()),a=r(n,e.ratingElement[0]),f={duration:500,easing:null,delay:250,animated:null},l=r.wijmo.wijrating.animations,c;r.extend(!0,f,t.animation),c=f.animated;if(!o.is(n))return;if(t.max&&u>t.max)return;if(t.min&&u<t.min)return;s={oldValue:t.value,newValue:u,target:o};if(e._trigger("rating",i,s)===!1)return!1;t.value=u,e._resetValue(u,t.ratingMode,t.icons.ratedIconsClass),a.removeClass(t.wijCSS.wijratingHoverStar),e._removeCustomizedIconsClass(t.icons.hoverIconsClass),s={value:u,target:o},c?l&&l[c]?l[c](t,a,function(){e._trigger("rated",i,s)}):r.effects&&(r.effects[c]||r.effects.effect&&r.effects.effect[c])?e._playJqueryAnimation(f,a,function(){r.browser.msie&&parseInt(r.browser.version)<9&&a.css("filter",""),e._trigger("rated",i,s)}):e._trigger("rated",i,s):e._trigger("rated",i,s)}},u={element:e.ratingElement,mouseover:function(e){var n=r(e.target);n=n.closest("."+t.wijCSS.wijratingResetButton),n.addClass(t.wijCSS.wijratingHoverResetButton).addClass(t.wijCSS.stateHover),t.resetButton.customizedHoverClass&&t.resetButton.customizedHoverClass.length&&n.addClass(t.resetButton.customizedHoverClass)},mouseout:function(e){var n=r(e.target);n=n.closest("."+t.wijCSS.wijratingResetButton),n.removeClass(t.wijCSS.wijratingHoverResetButton).removeClass(t.wijCSS.stateHover),t.resetButton.customizedHoverClass&&t.resetButton.customizedHoverClass.length&&n.removeClass(t.resetButton.customizedHoverClass)},click:function(t){var n=r(t.target);e._setOption("value",0),s={target:n},e._trigger("reset",t,s)}};this.ratingElement.on("mouseover.wijrating",n,r.proxy(o.mouseover,o)).on("mouseout.wijrating",n,r.proxy(o.mouseout,o)).on("click.wijrating",n,r.proxy(o.click,o)).on("mouseover.wijrating",i,r.proxy(u.mouseover,u)).on("mouseout.wijrating",i,r.proxy(u.mouseout,u)).on("click.wijrating",i,r.proxy(u.click,u))},t.prototype._createRating=function(){var e=this.ratingElement,t=this.options,n,i,s;e.addClass(t.wijCSS.wijrating).addClass(t.wijCSS.widget),t.orientation==="vertical"&&e.addClass(t.wijCSS.wijvRating),n=r("<div></div>").addClass(t.wijCSS.wijratingResetButton).addClass(t.wijCSS.cornerAll).addClass(t.wijCSS.stateDefault),t.resetButton.customizedClass&&t.resetButton.customizedClass.length&&n.addClass(t.resetButton.customizedClass),n.appendTo(e),n.attr("role","button").attr("aria-label","reset").attr("aria-hidden",!1),t.resetButton.hint&&t.resetButton.hint.length&&n.attr("title",t.resetButton.hint);if(t.resetButton.disabled||t.disabled)n.hide(),n.attr("aria-hidden",!0);i=r("<span></span>"),i.addClass(t.wijCSS.icon).addClass(t.wijCSS.iconClose),n.append(i),s=r("<div></div>"),s.attr("role","radiogroup").addClass(t.wijCSS.wijratingStarContainer),t.resetButton.position==="leftOrTop"?s.appendTo(e):s.prependTo(e),this._createStars(t.split,t.count,s)},t.prototype._createStars=function(e,t,n){var i=this.options,s=i.hint,o,u,a,f=0,l=0,c=0,h=Math.ceil(i.iconWidth/e),p=Math.ceil(i.iconHeight/e),d=i.icons.ratedIconsClass,v,m,g=d&&d.length;n.empty();for(l;l<t*e;l++,c++)a=Math.round((l+1)*i.totalValue*100/t/e)/100,f=Math.round((l+2)*i.totalValue*100/t/e)/100,c===e&&(c=0),u=r("<div></div>"),u.attr("role","radio").attr("aria-checked",!1),i.orientation==="vertical"?u.width(i.iconWidth).height(p):u.width(h).height(i.iconHeight),u.addClass(i.wijCSS.wijratingStar),o=r("<div>"+a+"</div>"),o.addClass(i.wijCSS.wijratingNormalStar).width(i.iconWidth).height(i.iconHeight),u.attr("aria-label",a),c>0&&i.direction==="normal"?i.orientation==="vertical"?o.css({"margin-top":"-"+c*p+"px"}):o.css({"margin-left":"-"+c*h+"px"}):c<e-1&&i.direction==="reversed"&&(i.orientation==="vertical"?o.css({"margin-top":"-"+(e-1-c)*p+"px"}):o.css({"margin-left":"-"+(e-1-c)*h+"px"})),s.disabled||(s.content&&s.content.length?l<=s.content.length&&(o.attr("title",s.content[l]),u.attr("aria-label",s.content[l])):o.attr("title",a)),g&&(typeof d=="string"?m=d:r.isArray(d)&&(v=Math.floor(l/e),d.length>v&&(m=d[v]))),a===i.value||f>i.value&&a<i.value&&i.ratingMode==="single"?(o.addClass(i.wijCSS.wijratingRatedStar),g&&o.addClass(m),u.attr("aria-checked",!0)):a<i.value&&i.ratingMode==="continuous"&&(o.addClass(i.wijCSS.wijratingRatedStar),g&&o.addClass(m)),o.appendTo(u),i.direction==="reversed"?u.prependTo(n):u.appendTo(n);this._addCustomizedIconsClass(i.icons.iconsClass,e)},t.prototype._resetValue=function(e,t,n){var i=this.options,s=r("."+i.wijCSS.wijratingNormalStar,this.ratingElement[0]),o=t||i.ratingMode,u=n&&n.length,a=0,f;r.each(s,function(t,l){var c=r(l),h=parseFloat(c.html()),p;t<s.length-1?p=parseFloat(r(s[t+1]).html()):p=i.direction==="normal"?i.totalValue+1:-1,c.removeClass(i.wijCSS.wijratingRatedStar),c.parent().attr("aria-checked",!1),u&&(typeof n=="string"?(c.removeClass(n),f=n):r.isArray(n)&&(r.each(n,function(e,t){c.removeClass(t)}),i.direction==="reversed"?a=Math.floor((s.length-1-t)/i.split):a=Math.floor(t/i.split),n.length>a&&(f=n[a]))),h===e||p>e&&h<e&&o==="single"?(c.addClass(i.wijCSS.wijratingRatedStar),u&&c.addClass(f),c.parent().attr("aria-checked",!0)):o==="continuous"&&h<e&&(c.addClass(i.wijCSS.wijratingRatedStar),u&&c.addClass(f))})},t.prototype._resetTotalValue=function(e){var t=this.options,n=t.hint,i=r("."+t.wijCSS.wijratingNormalStar,this.ratingElement[0]),s=i.length;r.each(i,function(i,u){var a=r(u),f=Math.round((i+1)*e*100/s)/100,l=parseFloat(a.html());l===t.value&&(t.value=f),a.html(f.toString()),n&&n.length&&n.length>=i&&n[i]&&n[i].length?a.attr("title",n[i]):a.attr("title",f)})},t.prototype._resetHint=function(e){var t=this.options,n=r("."+t.wijCSS.wijratingNormalStar,this.ratingElement[0]);r.each(n,function(t,n){var i=r(n),s=parseFloat(i.html());e&&e.length&&e.length>=t&&e[t]&&e[t].length?i.attr("title",e[t]):i.attr("title",s)})},t.prototype._clearIntentTimer=function(){this.intentTimers&&this.intentTimers.length&&r.each(this.intentTimers,function(e,t){t&&(window.clearTimeout(t),t=null)}),this.intentTimers=[]},t.prototype._playJqueryAnimation=function(e,t,n){var i=this,s=this,o=s.options,u={easing:e.easing},a=e.animated;s._clearIntentTimer(),r.each(t,function(f,l){var c=Math.floor(f/o.split)*e.delay,h;h=window.setTimeout(function(){r(l).hide(a,u,e.duration,function(){if(f!==t.length-1)return;r.each(t,function(f,l){var c=Math.floor(f/o.split)*e.delay,h;h=window.setTimeout(function(){r(l).show(a,u,e.duration,function(){f===t.length-1&&n&&r.isFunction(n)&&n.call(i)})},c),s.intentTimers.push(h)})})},c),s.intentTimers.push(h)})},t.prototype._addCustomizedIconsClass=function(e,t){var n=this,i=n.options,s,o=0,u=0;e&&e.length&&(s=r("."+i.wijCSS.wijratingNormalStar,n.ratingElement[0]),r.each(s,function(i,s){o===t&&(o=0,u++);if(typeof e=="string")r(s).addClass(e);else if(r.isArray(e)){var a=e.length;u<a&&(n.options.direction==="reversed"?r(s).addClass(e[a-u-1]):r(s).addClass(e[u]))}o++}))},t.prototype._addCustomizedHoverIconsClass=function(e,t,n){var i=this.options,s=i.direction,o=i.ratingMode,u=r("."+i.wijCSS.wijratingNormalStar,this.ratingElement[0]),a=u.index(n),f=0,l;if(e&&e.length)if(typeof e=="string")n.addClass(e),o!=="single"&&(s==="reversed"?n.parent().nextAll().children().addClass(e):n.parent().prevAll().children().addClass(e));else if(r.isArray(e))if(o==="single")s==="reversed"?l=u.length-1-a:l=a,f=Math.floor(l/t),e.length>f&&n.addClass(e[f]);else if(s==="reversed")for(l=u.length-1;l>=a;l--)f=Math.floor((u.length-1-l)/t),e.length>f&&r(u[l]).addClass(e[f]);else for(l=0;l<=a;l++)f=Math.floor(l/t),e.length>f&&r(u[l]).addClass(e[f])},t.prototype._removeCustomizedIconsClass=function(e){var t=this.options,n=r("."+t.wijCSS.wijratingNormalStar,this.ratingElement[0]);e&&e.length&&(typeof e=="string"?n.removeClass(e):r.isArray(e)&&r.each(e,function(e,t){n.removeClass(t)}))},t.prototype._parseSelect=function(){var e=this.options,t=[],n=r("option",this.element);n.length&&(e.count=n.length,e.totalValue=n.length,r.each(n,function(n,i){var s=r(i);t.push(s.html()),s.is(":selected")&&(e.value=n+1)}),e.hint.content=t)},t.prototype._parseRadio=function(){var e=this,t=e.options,n=[],i=r("input[type='radio']",e.element);i.length&&(t.count=i.length,t.totalValue=i.length,r.each(i,function(i,s){var u=r(s),a=u.attr("id"),f;a&&a.length>0?(f=r("label[for='"+a+"']",e.element),f.length?n.push(f.html()):n.push("")):n.push(""),u.is(":checked")&&(t.value=i+1)}),t.hint.content=n)},t}(e.wijmoWidget);t.wijrating=i;var s=function(){function e(){this.wijCSS={wijrating:"wijmo-wijrating",wijratingStarContainer:"wijmo-wijrating-starcontainer",wijratingResetButton:"wijmo-wijrating-reset",wijratingHoverResetButton:"wijmo-wijrating-resethover",wijratingStar:"wijmo-wijrating-star",wijratingNormalStar:"wijmo-wijrating-normal",wijratingHoverStar:"wijmo-wijrating-hover",wijratingRatedStar:"wijmo-wijrating-rated",wijvRating:"wijmo-wijrating-vertical"},this.wijMobileCSS={iconClose:"ui-icon-delete"},this.disabled=!1,this.count=5,this.split=1,this.totalValue=5,this.value=0,this.min=null,this.max=null,this.resetButton={disabled:!1,hint:"cancel this rating!",position:"leftOrTop",customizedClass:"",customizedHoverClass:""},this.hint={disabled:!1,content:null},this.orientation="horizontal",this.direction="normal",this.ratingMode="continuous",this.icons={iconsClass:null,hoverIconsClass:null,ratedIconsClass:null},this.iconWidth=16,this.iconHeight=16,this.animation=null,this.rating=null,this.rated=null,this.reset=null,this.hover=null}return e}();i.prototype.options=r.extend(!0,{},e.wijmoWidget.prototype.options,new s),r.wijmo.registerWidget("wijrating",i.prototype),r.mobile&&(r.mobile.selectmenu.prototype.options.initSelector=r.mobile.selectmenu.prototype.options.initSelector+":not( :jqmData(role='wijrating') )"),r.extend(r.wijmo.wijrating,{animations:{scroll:function(e,t,i){var s=e,o=i,u=250,a=500,f="linear",l=250,c=jQuery.makeArray(t);c.reverse(),r.each(c,function(e,n){var i=Math.floor(e/s.split)*l,c={width:0},h,p;h=window.setTimeout(function(){r(n).animate(c,u,f,function(){window.clearTimeout(h);if(e!==t.length-1)return;p=window.setTimeout(function(){r.each(t,function(e,n){var i=Math.floor(e/s.split)*l,a={width:s.iconWidth},c;c=window.setTimeout(function(){var i=this;r(n).animate(a,u,f,function(){window.clearTimeout(c),e===t.length-1&&o&&r.isFunction(o)&&o.call(i)})},i)}),window.clearTimeout(p)},a)})},i)}),i&&r.isFunction(i)&&i.call(n)}}})})(e.rating||(e.rating={}));var t=e.rating})(wijmo||(wijmo={}));