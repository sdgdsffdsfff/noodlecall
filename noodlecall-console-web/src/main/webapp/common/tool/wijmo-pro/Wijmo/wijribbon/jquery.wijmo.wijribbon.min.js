var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijribbon",i="wijmo-wijribbon",s=i+"-disabled",o=i+"-bigbutton",u=i+"-panel",a=i+"-groups",f=i+"-group",l=f+"-content",c=f+"-label",h=i+"-dropdown",p=i+"-dropdowngroup",d=i+"-abbrev",v=d+"group",m=i+"-text",g=i+"-icon",y=i+"-abbrevicon",b="ui-button",w="ui-state-active",E=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e._ribbonify(),n(window).bind("resize.wijribbon",function(){e.updateRibbonSize()}),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.updateRibbonSize(),e.options.disabled&&e._setDisabled(!0),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijribbon"),e.options.disabled&&e._setDisabled(!0)},t.prototype._setOption=function(e,t){n.wijmo.widget.prototype._setOption.apply(this,arguments),e==="disabled"&&this._setDisabled(t),n(".wijmo-wijribbon-startmenulink",this.element).unbind("click.tabs")},t.prototype._setDisabled=function(e){var t=this,r=t.element,i=r.offset(),o=i.top,u=i.left,a=n("body"),f=this.options.wijCSS,l=t.disabledModal;r.data("wijmoWijtabs")&&r.wijtabs("option","disabled",e),r.closest(".wijmo-wijeditor").length!==0&&(o=0,u=0,a=r.parent()),e?(l||(l=n("<div></div>").addClass(f.stateDisabled+" "+s).css({top:o,left:u,"background-color":"lightgray",position:"absolute"}).appendTo(a).bind("click mousedown mouseup mouseover mouseout focus keydown keypress",function(e){return e.stopPropagation(),e.preventDefault(),!1}),t.disabledModal=l),t.disabledModal.width(r.width()).height(r.outerHeight()).show()):t.disabledModal&&t.disabledModal.hide()},t.prototype._initCustomButtons=function(){var e=this,t;n.each(n("[customtype]",e.element),function(r,i){t=n(i).attr("customtype"),t&&e.options.custombuttons[t]&&e.options.custombuttons[t].create(n(i))})},t.prototype._ribbonify=function(){var e=this,t=this.options.wijCSS;e.buttons={},e.listUis={},e.accessbarBtns={},e._initCustomButtons(),e._createAccessToolBar(),e._getButtonSets(),e._createButtons(),e._createGroup(),e._createSplit(),e._createDropdwon(),e._createInputDropdown(),e._createGallery(),e._hideShowedList(),e._createTab(),n("."+t.helperReset+":not(."+a+", ."+t.tabsNav+", .wijmo-wijmenu-list)",e.element).hover(function(){n(this).addClass(t.stateHover)},function(){n(this).removeClass(t.stateHover)}),n("."+b,e.element).bind("mouseenter",function(){n("."+t.buttonText,this).addClass(t.stateHover)}).bind("mouseleave",function(){n("."+t.buttonText,this).removeClass(t.stateHover)}),n("button."+b,e.element).bind("mousedown",function(){e._addActiveClassToButtonText(this)}).bind("mouseup",function(){e._addActiveClassToButtonText(this)}),n("label."+b,e.element).bind("click",function(){n("span",this)&&n("span",this).length===1&&e._addActiveClassToLabelButtonText(this)})},t.prototype._addActiveClassToButtonText=function(e){var t=this.options.wijCSS;e&&(n(e).hasAllClasses(w)?n("."+t.buttonText,e).addClass(t.stateActive):n("."+t.buttonText,e).removeClass(t.stateActive))},t.prototype._addActiveClassToLabelButtonText=function(e){var t=this,r,i,s;e&&(i=n(e).attr("for"),r=n("#"+i,t.element),r.is(":checkbox")?t._addActiveClassToButtonText(e):r.is(":radio")&&(s=t.element.find("[name='"+r.attr("name")+"']"),n.each(s,function(){t._updateGroupElementTextState(this)})))},t.prototype._updateGroupElementTextState=function(e){var t,r=this.options.wijCSS;if(!e)return;t=n("[for='"+n(e).attr("id")+"']",n(e).parent()),t&&(t.hasAllClasses(r.stateActive)?t.children("."+r.buttonText).addClass(r.stateActive):t.children("."+r.buttonText).removeClass(r.stateActive))},t.prototype._getButtonSets=function(){var e=this,t;e.groups=[],e.splits=[],e.dropdowns=[],e.inputDropdowns=[],n("span>button, span>:checkbox, span>:radio, div>button, div>:checkbox, div>:radio, div>:text",e.element).each(function(r,i){if(n(i).parents("[customtype]")&&n(i).parents("[customtype]").length!==0)return;return t=n(i).parent(),n(">ul",t).length===0&&!t.hasClass("wijmo-wijribbon-accesstoolbar")?e.groups.push(t):n(">button",t).length===2?e.splits.push(t):n(">button",t).length===1?e.dropdowns.push(t):n(">input[type='text']",t).length===1&&e.inputDropdowns.push(t),this}),e.groups=e._unique(e.groups),e.splits=e._unique(e.splits)},t.prototype._unique=function(e){var t=n.makeArray(n.map(e,function(e){return e.get(0)}));return n.map(n.unique(t),function(e){return n(e)})},t.prototype._createButtons=function(){var e=this,t=e.element;n(":checkbox",t).each(function(){if(n(this).parents("[customtype]")&&n(this).parents("[customtype]").length!==0)return;return e._createButton(n(this),"checkbox"),n(this).bind("change",function(){e._addActiveClassToLabelButtonText(n(this).button("widget")[0])}),this}),n(":radio",t).each(function(){if(n(this).parents("[customtype]")&&n(this).parents("[customtype]").length!==0)return;return e._createButton(n(this),"radio"),n(this).bind("change",function(){e._addActiveClassToLabelButtonText(n(this).button("widget")[0])}),this}),n("button",t).each(function(){if(n(this).parents("[customtype]")&&n(this).parents("[customtype]").length!==0)return;return e._createButton(n(this),"button"),this})},t.prototype._createButton=function(e,t){var r=this,i=this.options.wijCSS,s=r._buildButtonOption(e,t),o=e.data("commandName"),u;e.button(s),s.text||(t==="button"?e.children("."+i.buttonText).text(o):(u=n("[for='"+e.attr("id")+"']",e.parent()),u&&u.children("."+i.buttonText).text(o))),e.parent().is(".wijmo-wijribbon-accesstoolbar")&&e.attr("canlocateonaccesstoolbar")==="true"&&e.button("widget").hide(),r._triggerEvent(e)},t.prototype._createGroup=function(){n.each(this.groups,function(e,t){t.buttonset()})},t.prototype._createSplit=function(){var e=this,t=this.options.wijCSS;n.each(e.splits,function(r,s){var o=s.children("ul"),u=s.children("button:eq(0)"),a=u.data("commandName"),f=s.children("button:eq(1)"),l;o.children("li").addClass(t.cornerAll),s.addClass(i+"-"+a),f.button({icons:{primary:t.iconArrowDown},text:!1}).data("list",o).unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault()}).bind("mouseup",function(t){o=n(this).data("list"),o.is(":visible")?(e.showList.hide().css("z-index",""),e.showList=null):(o.show().position({my:"left top",at:"left bottom",of:s}).css("z-index",9999),e.showList=o),t.stopPropagation(),t.preventDefault()}),f.children("."+t.buttonText).text("foo"),s.after(o),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+h).hide(),s.buttonset(),l={ui:u,defaultValue:u.button("option","label"),buttons:[],type:"split",trigger:f,list:o},n("button, :checkbox, :radio",o).bind("click",function(t){o.hide().css("z-index",""),e.showList=null,t.preventDefault()}),o.find(">li>button,>li>:radio,>li>:checkbox").each(function(t,r){var i=n(r).data("commandName");i!==""&&e.buttons[i]&&(e.buttons[i].parent=u,e.buttons[i].type="split"),l.buttons.push(n(r))}),a!==""&&(e.listUis[a]=l)})},t.prototype._createDropdwon=function(){var e=this,t=this.options.wijCSS,r,s;e.dropdownLabels={},n.each(e.dropdowns,function(r,s){var o=s.children("ul"),u=s.children("button:eq(0)"),a=u.data("commandName"),f;o.children("li").addClass(t.cornerAll),s.addClass(i+"-"+a),u.button({icons:{secondary:t.iconArrowDown}}).unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault()}).bind("mouseup",function(t){e._showDropDownList(o,u),t.stopPropagation(),t.preventDefault()}).bind("keydown",function(t){if(!o.is(":visible"))return;e._dropdownListKeyHandler(t,o,u)}),f={ui:u,defaultValue:u.button("option","label"),buttons:[],type:"dropdown",list:o},n("button, :checkbox, :radio",o).bind("click",function(r){var i=n(this).data("commandName"),s,a=u.children("."+t.buttonText).width();e.dropdownLabels[i]||(e.dropdownLabels[i]=e._getDropdownLabelSubstr(n(this).button("option","label"),u.children("."+t.buttonText),a)),s=e.dropdownLabels[i],u.button("option","label",s),u.attr("title",n(this).button("option","label")),o.hide().css("z-index",""),e.showList=null,r.preventDefault()}),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+h).hide(),s.buttonset(),e._collectDropDownButtons(o,u,f,a)})},t.prototype._createInputDropdown=function(){var e=this,t=this.options.wijCSS;e.dropdownLabels={},n.each(e.inputDropdowns,function(r,s){var o=s.children("ul"),u=s.children("input[type='text']:eq(0)"),a=e._createInputDropDownWrapper(u),f=u.prop("name"),l;s.prepend(a),o.children("li").addClass(t.cornerAll),s.addClass(i+"-"+f),u.removeProp("name").data("commandName",f).addClass(t.stateDefault+" "+t.content+" "+t.cornerLeft),a.find("a").bind("mouseup",function(t){e._showDropDownList(o,u),u.focus(),t.stopPropagation(),t.preventDefault()}).bind("keydown",function(t){e._dropdownListKeyHandler(t,o,a)}),e._bindInputEvent(u,o),l={ui:u,defaultValue:u.val(),buttons:[],type:"dropdown",list:o},n("button, :checkbox, :radio",o).bind("click",function(t){var r=n(this).data("commandName"),i;e.dropdownLabels[r]||(e.dropdownLabels[r]=n(this).button("option","label")),i=e.dropdownLabels[r],u.val(n(this).button("option","label")).attr("title",n(this).button("option","label")),o.hide().css("z-index",""),e.showList=null,t.preventDefault(),t.stopPropagation()}),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+h).hide(),e._collectDropDownButtons(o,u,l,f)})},t.prototype._collectDropDownButtons=function(e,t,r,i){var s=this;e.find(">li>button,>li>:radio,>li>:checkbox").each(function(e,i){var o=n(i).data("commandName");o!==""&&s.buttons[o]&&(s.buttons[o].parent=t,s.buttons[o].type="dropdown"),r.buttons.push(n(i))}),i!==""&&(s.listUis[i]=r)},t.prototype._showDropDownList=function(e,t){var n=this;e.is(":visible")&&!e.find("li."+n.options.wijCSS.stateActive)?(n.showList.hide().css("z-index",""),n.showList=null):(n.showList&&(n.showList.hide(),n.showList=null),e.show().position({my:"left top",at:"left bottom",of:t}).css("z-index",9999),n.showList=e,n.isShow=!0)},t.prototype._bindInputEvent=function(e,t){var n=this,r,i;e.bind("change",function(t){var r={name:undefined,commandName:undefined};r.name=e.prop("name"),r.commandName=e.val(),n._trigger("click",t,r)}).bind("keydown",function(r){n._dropdownListKeyHandler(r,t,e)})},t.prototype._dropdownListKeyHandler=function(e,t,n){var r=this,i=e.keyCode,s=r._getKeyCodeEnum();switch(i){case s.UP:r._activeDropDownListElement(!1,t,n),e.preventDefault();break;case s.DOWN:r._activeDropDownListElement(!0,t,n),e.preventDefault();break;case s.ENTER:t.find("label."+r.options.wijCSS.stateActive).parent("li").find("input").trigger("click"),e.preventDefault()}},t.prototype._activeDropDownListElement=function(e,t,r){var i=this,s=t.find("li").length,o,u;if(!t.is(":visible")){i._showDropDownList(t,r);return}u=t.find("label."+i.options.wijCSS.stateActive).parent("li"),u&&u.length>0&&(o=t.find("li").index(u)),i._changeListItemActiveState(u,!1),o===undefined?o=0:e?(o++,o==s&&(o=undefined)):(o--,o==-1&&(o=s-1)),i._changeListItemActiveState(n(t.find("li")[o]),!0)},t.prototype._changeListItemActiveState=function(e,t){var r=this.options.wijCSS;if(!e)return;t?(n("label",e).addClass(r.stateActive),n("span",e).addClass(r.stateActive)):(n("label",e).removeClass(r.stateActive),n("span",e).removeClass(r.stateActive))},t.prototype._createGallery=function(){var e=this,t=e.options.wijCSS;n(".wijmo-wijribbon-gallery",e.element).each(function(r,i){n(i).children("div").each(function(r,i){n(i).bind("mouseenter",function(e){if(n(i).hasAllClasses(t.stateDisabled))return;n(i).addClass(t.stateHover)}).bind("mouseleave",function(e){if(n(i).hasAllClasses(t.stateDisabled))return;n(i).removeClass(t.stateHover)}).bind("click",function(r){if(n(i).hasAllClasses(t.stateDisabled))return;n(i).parent("div.wijmo-wijribbon-gallery").children("div").removeClass(t.stateActive),n(i).addClass(t.stateActive);var s={name:undefined,commandName:undefined};s.name=n(i).parent("div.wijmo-wijribbon-gallery").attr("name"),s.commandName=n(i).attr("name"),e._trigger("click",r,s)}),e.buttons[n(i).attr("name")]={button:n(i),type:"galleryBtn"}})})},t.prototype._getKeyCodeEnum=function(){if(n.ui&&n.ui.keyCode)return n.ui.keyCode;if(n.mobile&&n.mobile.keyCode)return n.mobile.keyCode;throw"keyCode object is not found"},t.prototype._createInputDropDownWrapper=function(e){var t=this.options.wijCSS,r=n("<span class='wijmo-wijribbon-inputdropdownwrapper'></span>").append(e);return n("<a></a>").appendTo(r).button({icons:{primary:t.iconArrowDown},text:!1}).removeClass(t.cornerAll).addClass("wijmo-wijribbon-inputdropdownbtn "+t.cornerRight),r},t.prototype._createTab=function(){var e=this,t=this.options.wijCSS,r=e.element;return r.addClass(i),e.tabEle=r,n(">ul",r).length>0?(r.wijtabs({select:function(t,n){e._hideAllMenus()}}),e._createRibbonGroups(),n(".wijmo-wijribbon-startmenu")&&n(".wijmo-wijribbon-startmenu").length>0&&(r.wijtabs("option","selected",1),e._createStartMenu()),!0):(r.addClass(i+"-simple").addClass(t.stateDefault).addClass(t.helperClearFix),!1)},t.prototype._createAccessToolBar=function(){var e=this,t,r=n("<div class='wijmo-wijribbon-accesstoolbar'></div>"),i;if(n("*[canlocateonaccesstoolbar='true']",e.element).length===0&&n("*[locateonaccesstoolbar='true']",e.element).length===0)return;n("input[canlocateonaccesstoolbar='true'],input[locateonaccesstoolbar='true']",e.element).each(function(){t=n(this).attr("id")+"_accessbar";var r=n("label[for="+n(this).attr("id")+"]");e.accessbarBtns[r.attr("title")]={button:n(this).clone().attr("id",t),type:n(this).attr("type"),labelEle:r.clone().attr("for",t),selected:n(this).attr("locateonaccesstoolbar")==="true"?!0:!1}}),n("button[canlocateonaccesstoolbar='true'],button[locateonaccesstoolbar='true']",e.element).each(function(){t=n(this).attr("id")+"_accessbar",e.accessbarBtns[n(this).attr("title")]={button:n(this).clone(),type:"button",selected:n(this).attr("locateonaccesstoolbar")==="true"?!0:!1}}),n.each(e.accessbarBtns,function(e,t){r.append(t.button),t.labelEle&&r.append(t.labelEle)}),i=n('<button title="Customize Access Toolbar" class ="wijmo-wijribbon-accesstoolbarbtn '+e.options.wijCSS.iconArrowDown+'"'+' name="quicktoolbar"></button>'),r.append(i),e.accessbarBtns&&e.element.prepend(r),e._createCustomQuickToolbarMenu(i,r)},t.prototype._createCustomQuickToolbarMenu=function(e,t){var r=this,i,s,o=r.options.wijCSS,u=n('<ul class="wijmo-wijribbon-accesstoolbarmenu"></ul>');n.each(r.accessbarBtns,function(e,t){s=t.selected?" wijmo-wijribbon-accesstoolbarmenuitemchecked":" wijmo-wijribbon-accesstoolbarmenuitemunchecked",i=n('<li><a class="'+o.cornerAll+'" tabindex="-1">'+'<span class="'+o.icon+s+'"></span><span'+' class="wijmo-wijmenu-text">'+e+"</span></a></li>"),i.data("accessbarcommand",e),u.append(i)}),u.prepend("<li class='wijmo-wijribbon-accesstoolbarmenutitleitem'><a>Customize Access Toolbar</a></li>"),t.append(u),u.wijmenu({trigger:e,triggerEvent:"click",orientation:"vertical",select:function(e,t){var i=t.item,s=i.element.data("accessbarcommand"),a=n("span."+o.icon,i.element),f=r.accessbarBtns[s].button,l=f.button("widget");a.hasClass("wijmo-wijribbon-accesstoolbarmenuitemchecked")?(a.removeClass("wijmo-wijribbon-accesstoolbarmenuitemchecked").addClass("wijmo-wijribbon-accesstoolbarmenuitemunchecked"),l.hide().removeAttr("canlocateonaccesstoolbar").attr("locateonaccesstoolbar","true")):(a.addClass("wijmo-wijribbon-accesstoolbarmenuitemchecked").removeClass("wijmo-wijribbon-accesstoolbarmenuitemunchecked"),l.show().removeAttr("locateonaccesstoolbar").attr("canlocateonaccesstoolbar","true")),u.wijmenu("deactivate",null)}}),u.wijmenu("setItemDisabled",n(".wijmo-wijribbon-accesstoolbarmenutitleitem"),!0)},t.prototype.updateRibbonSize=function(){var e=this,t,r=this.options.wijCSS,s;e.tabEle.children("div").not(".wijmo-wijmenu").each(function(o,u){var a=n(u),f=a.is(":visible"),l=a.find(">ul>li:not(.wijmo-wijmenu-item)"),c=[],h=a.width();return f||(a.removeClass(r.wijtabsHide),h=a.width()),l.each(function(r,o){var u=n(o),a=u.find(">div:last"),f=e._getGroupLabelText(a);return t=u.children("."+p),s=u.children("."+v),t&&(u.addClass(i+"-"+f.toLowerCase()).prepend(t.children()),t.remove(),s&&s.remove()),c.push({width:u.outerWidth(!0),text:f}),this}),e._adjustRibbonGroupIfNeeded(l,c,h),f||a.addClass(r.wijtabsHide),this}),e.options.disabled&&e._setDisabled(!0)},t.prototype._createRibbonGroups=function(){var e=this,t=this.options.wijCSS;e.tabEle.children("div").each(function(r,s){var o=n(s),h=o.is(":visible"),p=o.find(">ul:not(.wijmo-wijribbon-accesstoolbarmenu)>li"),d=[],v;if(o.data("destroy.tabs")){o.remove();return}return h||o.removeClass(t.wijtabsHide),v=o.width(),o.addClass(u),o.hasAllClasses(t.tabsPanel)||(o.addClass("wijmo-wijribbon-accesstoolbar"),e.tabEle.prepend(o)),o.find(">ul").addClass(t.helperReset+" "+t.helperClearFix+" "+t.content+" "+t.cornerAll+" "+a),p.each(function(r,s){var o=n(s),u=o.find(">div:last"),a=u.find("span"),h=t.stateDefault+" "+f,p=e._getGroupLabelText(u);return u&&(h+=" "+i+"-"+p.toLowerCase()),o.addClass(h),u.addClass(c).bind("click",function(){return!1}),o.wrapInner("<div class = '"+l+"'></div>"),o.children().bind("mouseover",function(){n(this).addClass(t.stateHover)}).bind("mouseout",function(){n(this).removeClass(t.stateHover)}),u.appendTo(o),d.push({width:o.outerWidth(!0),text:p}),this}),e._originalGroupInfo=d,e._adjustRibbonGroupIfNeeded(p,d,v),h||o.addClass(t.wijtabsHide),this})},t.prototype._createStartMenu=function(){var e=this,t=n(".wijmo-wijribbon-startmenulink",e.element),r=e.options.wijCSS;t.unbind("click"),t.parent("li").addClass("wijmo-wijribbon-startmenulinkcontainer").hover(function(){n(this).removeClass("wijmo-wijribbon-startmenulinkcontainer")},function(){n(this).addClass("wijmo-wijribbon-startmenulinkcontainer")}),n(".wijmo-wijribbon-startmenuindicator",e.element).addClass(r.icon+" "+r.iconArrowDown),n(".wijmo-wijribbon-startmenu",e.element).wijmenu({trigger:n(".wijmo-wijribbon-startmenulink",e.element).parent(),triggerEvent:"click",orientation:"vertical",select:function(t,n){var r={name:undefined,commandName:undefined};r.commandName=n.item._link.attr("name"),e._trigger("click",t,r)},hidden:function(e,t){t.activeItem&&t.activeItem._link.removeClass(r.stateFocus)}})},t.prototype._getGroupLabelText=function(e){var t,r;return e&&(t=e.find("span"),e.attr("displayname")?r=e.attr("displayname"):t&&t.length>0&&!e.hasAllClasses(v)?r=n(t[0]).text():r=n.trim(e.text())),r},t.prototype._adjustRibbonGroupIfNeeded=function(e,t,r){var s=this,o=e.length-1,u=0,a=0,f=0,l,c,h;for(;o>=0;o--){f=0;for(u=0;u<o;u++)f+=t[u].width;f+a+t[o].width<=r?(l=n(e[o]).children("."+p),c=n(e[o]).children("."+v),l&&(n(e[o]).addClass(i+"-"+t[o].text.toLowerCase()).prepend(l.children()),l.remove(),c&&c.remove())):(h=t[o],a+=s._createDropDownRibbonGroup(h.text,e[o]))}},t.prototype._createDropDownRibbonGroup=function(e,t){var r=this,s=i+"-"+e.toLowerCase(),o=this.options.wijCSS,u=n(t).removeClass(s),a=r._getGroupLabelText(u.find(">div:last"))||e,l;return u.wrapInner("<div class='"+p+" "+f+"'></div>").children().hide().addClass(s).bind("mouseup."+r.widget,function(e){r.showDrpDwnGroup!==null&&(r.showDrpDwnGroup.hide().css("z-index",""),r.showDrpDwnGroup=null)}),l=n("<div class='"+v+"'>"+"<span class='"+d+a.toLowerCase()+" "+g+" "+y+"'></span>"+"<span class='"+m+"'>"+a+"</span>"+"<span class='"+o.icon+" "+o.iconArrowDown+" "+g+"'></span></div>").appendTo(u).unbind(r.widget).bind("mouseover."+r.widget,function(e){n(this).addClass(o.stateHover)}).bind("mouseout."+r.widget,function(e){n(this).removeClass(o.stateHover)}).bind("click."+r.widget,function(e){var t=n(this).siblings("."+p);t.is(":visible")?(t.hide().css("z-index",""),r.showDrpDwnGroup=null):(r.showDrpDwnGroup&&r.showDrpDwnGroup.hide().css("z-index",""),t.show().position({my:"left top",at:"left bottom",of:this}).css("z-index","10000"),r.showDrpDwnGroup=t,e.stopPropagation())}),u.outerWidth(!0)},t.prototype._hideShowedList=function(){var e=this;n(document).bind("mouseup",function(t){var r=t.target;e.showList&&(n(r).is(document)||!n.contains(e.showList.get(0),r))&&(e.showList.hide().css("z-index",""),e.showList=null),e.showDrpDwnGroup&&(n(r).is(document)||!n.contains(e.showDrpDwnGroup.get(0),r))&&(e.showDrpDwnGroup.hide().css("z-index",""),e.showDrpDwnGroup=null)})},t.prototype._buildButtonOption=function(e,t){var r=!0,i=this,s=e.attr("class"),u,a,f,l,c,h,p;if(s&&s!==""&&s!==o)a=s.split(" ")[0],e.removeClass(a),c=n.trim(e.text()),c===""&&(r=!1);else{if(t==="checkbox"||t==="radio"){if(n.trim(e.attr("id"))==="")return;h=n("[for='"+e.attr("id")+"']",e.parent());if(!h.is("label"))return;s=h.attr("class"),s&&s!==""&&s!==o?(a=s.split(" ")[0],h.removeClass(a),c=n.trim(h.text()),c===""&&(r=!1)):u=h.children("span,div")}else t==="button"&&(u=e.children("span,div"));u&&(u.length===1?u.eq(0).attr("class")!==""&&(f=u.eq(0),a=f.attr("class"),r=!1):u.length===2?u.eq(0).attr("class")&&(f=u.eq(0),a=f.attr("class"),f.is("span")?l="left":f.is("div")&&(l="top"),c=u.eq(1).text()):t==="button"&&n.trim(e.text())!==""&&(c=n.trim(e.text())))}return t==="button"?(e.empty(),p=n.trim(e.attr("name")),p!==""&&e.removeAttr("name")):(p=n.trim(h.attr("name")),p!==""&&h.removeAttr("name")),p!==""&&(e.data("commandName",p),i.buttons[p]||(i.buttons[p]={button:undefined,accessToolbarButton:undefined}),e.parent().is(".wijmo-wijribbon-accesstoolbar")?i.buttons[p].accessToolbarButton=e:i.buttons[p].button=e),{label:c,icons:{primary:a},position:l,text:r}},t.prototype._triggerEvent=function(e){var t=this,n,r,i=t.options.wijCSS;e.bind("click",function(i){if(t.options.disabled){i.preventDefault(),i.stopPropagation();return}t._hideAllMenus();var s=!0,o=e.data("commandName"),u=t.buttons[o],a={name:undefined,commandName:undefined};u&&u.parent&&(a.name=u.parent.data("commandName")),a.commandName=o,t._trigger("click",i,a),e.parent().is(".wijmo-wijribbon-accesstoolbar")?n=t.buttons[o].button:n=t.buttons[o].accessToolbarButton,n&&(r=n.button("widget"),n.is("button")||(r&&r.hasAllClasses(w)&&(s=!1),t._setBtnWidgetCheckedStyle(n,s))),e.is("button")&&(i.preventDefault(),i.stopPropagation())})},t.prototype._getDropdownLabelSubstr=function(e,t,r){var i=this,s=e.length,o=0,u=s,a=Math.floor((o+u)/2),f=n("<span></span>"),l=e.substr(0,a),c;f.appendTo(t.parent()),c=i._calculateWidth(l,f);while(c!==r&&u>o)l=e.substr(0,a+1),c=i._calculateWidth(l,f),c>r?u=a-1:c<r&&(o=a+1),a=Math.floor((o+u)/2);return f.remove(),l},t.prototype._calculateWidth=function(e,t){return t.text(e),t.width()},t.prototype.hideDropdown=function(e){var t=this,n=t.listUis[e];n&&n.list&&n.list.hide()},t.prototype._hideAllMenus=function(){var e=this;n(".wijmo-wijmenu",e.tabEle).hide()},t.prototype.setTabPageVisible=function(e,t){var r=this,i=n("a[href=#"+e+"]",r.element).parent("li"),s=i.parent("ul"),o;i&&i.length>0&&(t?(i.show(),o=n("li",s).index(i)):(i.hide(),o=n("li",s).index(n('li:visible:not(".wijmo-wijribbon-startmenulinkcontainer")',s)))),r.element.wijtabs("option","selected",o)},t.prototype.destroy=function(){this.disabledModal&&this.disabledModal.remove(),n(window).unbind("resize.wijribbon"),n.Widget.prototype.destroy.call(this)},t.prototype.getDropdownList=function(e){var t=this,r=t.listUis[e],i={};return r&&n.each(r.buttons,function(e,t){i[t.data("commandName")]=t.button("option","label")}),i},t.prototype.setButtonDisabled=function(e,t){var r=this.buttons[e],i=this.options.wijCSS,s,o,u=!1,a,f,l;if(r&&r.disabled){r.disabled(t);return}r&&r.button&&r.type==="galleryBtn"&&r.button.addClass(i.stateDisabled);if(r&&r.button){a=r.button,f=r.accessToolbarButton,u=a.is("button");if(r.type==="galleryBtn"){t?a.addClass(i.stateDisabled):a.removeClass(i.stateDisabled);return}a.button("option","disabled",t),s=n("."+i.buttonText,a),s&&s.removeClass(i.stateHover),f&&(f.button("option","disabled",t),o=n("."+i.buttonText,f),o&&o.removeClass(i.stateHover)),u?e!=="save"&&(a.children("."+i.buttonText).text(e),f&&a.children("."+i.buttonText).text(e)):n("[for='"+a.attr("id")+"']",a.parent()).children("."+i.buttonText).text(e),l=this.listUis[e],l&&l.type==="split"&&(l.trigger.button("option","disabled",t),l.trigger.children("."+i.buttonText).text(e))}},t.prototype.setButtonsDisabled=function(e){var t=this;n.each(e,function(e,n){t.setButtonDisabled(e,n)})},t.prototype.setButtonsChecked=function(e){var t=this;n.each(e,function(e,r){n.isPlainObject(r)?t.setButtonChecked(e,r.checked,r.name):t.setButtonChecked(e,r,null)})},t.prototype.registerButtonInformation=function(e,t){if(e&&t)return this.buttons[e]=t},t.prototype.ribbonClick=function(e,t){this._trigger("click",e,t)},t.prototype._setBtnWidgetCheckedStyle=function(e,t){var n=this,e,r=n.options.wijCSS;e.is("button")?t?e.addClass(r.stateActive):e.removeClass(r.stateActive):e.is("input[type='text']")||(e.prop("checked",t),e.button("refresh")),n._addActiveClassToButtonText(e.button("widget"))},t.prototype.removeButtonHoverState=function(e){var t=this,r,i=this.options.wijCSS,s=t.buttons[e];s&&s.button&&(r=s.button,r.is("button")&&(r.removeClass(i.stateHover).removeClass(i.stateFocus),n("span",r).removeClass(i.stateHover)))},t.prototype.setButtonChecked=function(e,t,r){var i=this,s,o=i.buttons[e],u=this.options.wijCSS,a,f,l,c;if(o&&o.checked){o.checked(t);return}if(o&&o.button){a=o.button,f=o.accessToolbarButton;if(a.is("button"))t?(a.addClass(u.stateActive),f&&f.addClass(u.stateActive)):(a.removeClass(u.stateActive),f&&f.removeClass(u.stateActive));else{if(o.type==="galleryBtn"){var h=a.parent("div");n("div",h).removeClass(u.stateActive),t?a.addClass(u.stateActive):a.removeClass(u.stateActive);return}a.is("input[type='text']")||(a.prop("checked",t),a.button("refresh"),f&&(f.prop("checked",t),f.button("refresh")))}o.parent?o.type==="dropdown"&&t&&(i.dropdownLabels[e]||(i.dropdownLabels[e]=i._getDropdownLabelSubstr(a.button("option","label"),o.parent.children("."+u.buttonText),o.parent.children("."+u.buttonText).width())),c=i.dropdownLabels[e],o.parent.is("input[type='text']")?(o.parent.val(c),o.parent.attr("title",c)):(o.parent.button("option","label",c),o.parent.attr("title",a.button("option","label"))),s=n(":radio",o.button.closest("ul")),s&&n.each(s,function(){i._updateGroupElementTextState(this)})):(i._addActiveClassToButtonText(a.button("widget")),f&&i._addActiveClassToButtonText(f.button("widget")))}else r&&(l=i.listUis[r],l&&(l.ui.is("input[type='text']")?l.ui.val(l.defaultValue):l.ui.button("option","label",l.defaultValue),l.buttons&&n.each(l.buttons,function(e,t){t.prop("checked",!1),t.button("refresh"),i._addActiveClassToButtonText(t.button("widget"))})))},t}(e.wijmoWidget);t.wijribbon=E;var S=function(){function e(){this.initSelector=":jqmData(role='wijribbon')",this.wijCSS={wijtabsHide:"wijmo-wijtabs-hide"},this.click=null,this.custombuttons=null}return e}();E.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new S),n.wijmo.registerWidget("wijribbon",E.prototype)})(e.ribbon||(e.ribbon={}));var t=e.ribbon})(wijmo||(wijmo={}));