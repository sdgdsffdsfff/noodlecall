var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijlist",i="wijmo-wijlist-item",s=i+"-alternate",o=i+"-selected",u=i+"-first",a=i+"-last",f="wijmo-wijlistitem-active",l="item.wijlist",c=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.removeAll=function(){var e=this;e.items=[],e._refresh()},t.prototype.addItem=function(e,t){var n=this;n._checkData(),t===null||t===undefined?n.items.push(e):n.items&&n.items.splice(t,0,e),n._refresh(),n._trigger("added",null,{item:e,index:t})},t.prototype.removeItem=function(e){var t=this,n;t._checkData(),n=t.indexOf(e),n>=0&&t.removeItemAt(n)},t.prototype.indexOf=function(e){var t=this,n=-1,r=0,i;t._checkData();for(r=0;r<t.items.length;r++){i=t.items[r];if(i.label===e.label&&i.value===e.value){n=r;break}}return n},t.prototype.findIndexByLabel=function(e){var t=this,n=-1,r=0,i;if(e===null||e===undefined)return n;t._checkData();for(r=0;r<t.items.length;r++){i=t.items[r];if(i.label===e){n=r;break}}return n},t.prototype.removeItemAt=function(e){var t=this;t._checkData(),t.items.splice(e,1),t._refresh()},t.prototype._checkData=function(){var e=this;e.items||(e.items=[])},t.prototype._refresh=function(){var e=this;e.renderList(),e.refreshSuperPanel()},t.prototype._setOption=function(t,r){var i=this,s,u=o+" "+i.options.wijCSS.stateActive,a,f,l;e.prototype._setOption.call(this,t,r);if(t==="disabled")i._handleDisabledOption(r,i.element);else if(t==="selectionMode")s=i.selectedItem,s&&(s.selected=!1,s.element&&s.element.removeClass(u),i.selectedItem=undefined),i.selectedItems&&n.each(i.selectedItems,function(e,t){t.selected=!1,t.element.removeClass(u)}),i.selectedItem=[];else if(t==="listItems")f=i._isBind(),f?(l=i._getRenderItems(),i.setItems(l)):i.setItems(r),i.renderList(),i.refreshSuperPanel();else if(t==="dataSource")f=i._isBind(),f&&(l=i._getRenderItems(),i.setItems(l),i.renderList(),i.refreshSuperPanel());else if(t==="autoSize"||t==="maxItemsCount")!i.options.autoSize&&i.element.is(":visible")&&(i._oriHeight!==0?i.element.height(i._oriHeight):(a=i.ul.outerHeight(),i.element.height(a),n(".wijmo-wijsuperpanel-statecontainer",i.element).height(a),n(".wijmo-wijsuperpanel-contentwrapper",i.element).height(a))),i.refreshSuperPanel()},t.prototype._create=function(){var e=this,t=this.element,r=this.options,i=r.wijCSS,s=i.widget+" "+i.content+" "+i.cornerAll+" wijmo-wijlist",o;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e._oriHeight=parseInt(t.css("height"),10),t.addClass(s).attr({role:"listbox","aria-activedescendant":f,"aria-multiselectable":r.selectionMode==="multiple"}).bind("click."+e.widgetName,e,e._onListClick),t.is("div")&&t.children().is("ul")&&(e._isInnerData=!0,e._templates=[],n.each(n("ul > li",t),function(t,n){e._templates.push({templateHtml:n.innerHTML})}),e._oriChildren=t.children().hide()),e.ul=n("<ul class='"+i.listul+"'></ul>").appendTo(t),r.listItems!==null&&(o=e._getRenderItems(),o&&(e.setItems(o),e.renderList(),e.refreshSuperPanel())),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refreshSuperPanel(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijlist"),r.disabled&&(e.disable(),e._handleDisabledOption(!0,e.element))},t.prototype._isBind=function(){var e=this.options,t=e.listItems;return t!==null&&t.label&&t.label.bind?!0:!1},t.prototype._getRenderItems=function(){var e=this.options,t=e.listItems;return t!==null?n.isArray(t)&&t.length>0&&typeof t[0].label=="string"?t:t.label&&t.label.bind?this._getMappingItems():null:null},t.prototype._getMappingItems=function(){var e=this.options,t=e.dataSource,r=e.listItems,i,s,o;return!t||!r?null:!r.label||!r.label.bind||!r.value||!r.value.bind?null:(s=r.label.bind,o=r.value.bind,t&&t.length!==0?(i=[],n.each(t,function(e,t){i.push({label:t[s],value:t[o]})}),i):null)},t.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r=e||t.element,i=r.offset(),s=r.outerWidth(),o=r.outerHeight();return n("<div></div>").addClass("ui-disabled").css({"z-index":"99999",position:"absolute",width:s,height:o,left:i.left,top:i.top,"pointer-events":"auto"})},t.prototype.setTemplateItems=function(e){this._setItemsByExtend(e,!0)},t.prototype.setItems=function(e){this._setItemsByExtend(e,!1)},t.prototype._setItemsByExtend=function(e,t){var r=this,i,s=[];n.each(e,function(e,t){s[e]=n.extend(!0,{},t)});if(t){if(r._templates&&s&&s.length!==r._templates.length)return;r.items=s,r.items||(r.items=[]),n.each(r._templates,function(e){r.items[e]?r.items[e].templateHtml=r._templates[e].templateHtml:r.items.push({templateHtml:r._templates[e].templateHtml,label:s[e].label,value:s[e].value})})}else r.items=s;if(!s)return null;i=n.grep(s,function(e){return e.selected},undefined),r.options.selectionMode==="single"?(r.selectedItems=[],r.selectedItem=i.length>0?i[0]:undefined):r.selectedItems=i},t.prototype.filterItems=function(e,t,r,i){var s=this,u=s._escapeRegex(e),a,f=o+" "+s.options.wijCSS.stateActive,l=s.options.wijCSS.priorityPrimary,c,h="",p=!1,d=s.options.wijCSS.listItem,v=null;if(!this.items)return null;n("li[wijhidden]."+d,s.element)&&n("li[wijhidden]."+d,s.element).length>0&&(p=!0),n("span."+l,s.element)&&n("span."+l,s.element).length>0&&(p=!0);if(!p&&(!e||e.length===0)){n.each(this.items,function(e,t){t.selected?(s.activate(null,t,!1),t.element&&t.element.addClass(f),s.selectedItem=t):t.element&&t.element.hasAllClasses(f)&&t.element.removeClass(f)});return}return a=new RegExp(u,"i"),n.each(this.items,function(e,i){c=i.label,i.templateHtml?c=i.templateHtml:i.text!==undefined&&(c=i.text),n("span."+l,i.element).length>0&&i.element.empty().append(c);var o=a.exec(i.label);o===null&&t?i.element&&(i.element.hide(),i.element.attr("wijhidden","wijhidden")):(i.selected?(s.activate(null,i,!1),i.element&&i.element.addClass(f),s.selectedItem=i):i.element&&i.element.hasAllClasses(f)&&i.element.removeClass(f),r&&(h=c.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+u+")(?![^<>]*>)(?![^&;]+;)","gi"),"<span class='"+l+"'>$1</span>"),i.element&&i.element.html(h)),i.element&&!i.element.is(":visible")&&(i.element.show(),i.element.removeAttr("wijhidden")),u!==undefined&&u.length!==0&&v===null&&o&&o.index===0&&(v=i))}),v},t.prototype.popItem=function(){var e=this;e._checkData(),e.items.pop(),e._refresh()},t.prototype.getList=function(){return this.ul},t.prototype._onListClick=function(e){var t=e.data;if(t.options.disabled)return;if(!n(e.target).closest("."+t.options.wijCSS.listItem).length)return;t.select(e)},t.prototype.destroy=function(){var t=this,n=this.element,r=this.options,i=r.wijCSS,s=i.widget+" "+i.content+" "+i.cornerAll+" wijmo-wijlist";t.superPanel!==undefined&&t.superPanel.destroy(),n.removeClass("wijmo-wijobserver-visibility").removeClass(s).removeAttr("role").removeAttr("aria-activedescendant").unbind("."+t.widgetName),t.ul.remove(),t.disabledDiv&&(t.disabledDiv.remove(),t.disabledDiv=null),t._isInnerData&&t._oriChildren.show(),e.prototype.destroy.call(this)},t.prototype._getItemByDataItem=function(e){var t;return n.each(this.items,function(n,r){if(e.label===r.label&&e.value===r.value)return t=r,!1}),t},t.prototype.activate=function(e,t,n){var r=this,i,s;r.deactivate();if(t===null||t===undefined)return;if(r._trigger("focusing",e,t)===!1)return;i=r.active=r._getItemByDataItem(t),s=i&&i.element,s&&(r.options.addHoverItemClass&&s.addClass(r.options.wijCSS.stateHover),s.attr("id",f)),n&&r.superPanel!==undefined&&r.superPanel.scrollChildIntoView(s),r.element.is(":visible")&&r._trigger("focus",e,t)},t.prototype.deactivate=function(){var e=this,t=e.active,n;if(!t)return;n=t.element,e._trigger("blur",null,t),n&&n.removeClass(e.options.wijCSS.stateHover).removeAttr("id"),e.active=undefined},t.prototype.next=function(e){this.move("next","."+this.options.wijCSS.listItem+":first",e)},t.prototype.nextPage=function(){this.superPanel.doScrolling("bottom",!0)},t.prototype.previous=function(e){this.move("prev","."+this.options.wijCSS.listItem+":last",e)},t.prototype.previousPage=function(){this.superPanel.doScrolling("top",!0)},t.prototype.first=function(){return this.active&&!this.active.element.prev().length},t.prototype.last=function(){return this.active&&!this.active.element.next().length},t.prototype.move=function(e,t,n){var r=this,i,s;if(!r.active){i=r.ul.children(":visible"+t).data(l),r.activate(n,i,!0);return}s=r.active.element[e+"All"](":visible."+r.options.wijCSS.listItem).eq(0),s.length?r.activate(n,s.data(l),!0):r.activate(n,r.element.children(t).data(l),!0)},t.prototype.select=function(e,t){var r=this,i,s,u=o+" "+r.options.wijCSS.stateActive,a,f,c;if(!r.active){r.active=n(n(e.target).closest("."+r.options.wijCSS.listItem)).data(l);if(!r.active)return}i=r.active.element;if(i===undefined||i.attr("wijhidden"))return;a=i.data(l);if(!a)return;f=r.options.selectionMode==="single",f?(c=r.selectedItem,i.addClass(u).attr("aria-selected","true"),a.selected=!0,c!==undefined&&a!==c&&(c.selected=!1,c.element&&c.element.removeClass(u).removeAttr("aria-selected")),r.selectedItem=a,s=n.inArray(a,r.items),r._trigger("selected",e,{item:a,previousItem:c,selectedIndex:s,data:t})):(a.selected=!a.selected,a.selected?i.addClass(u).attr("aria-selected","true"):i.removeClass(u).removeClass("wijmo-wijcombobox-selecteditem").removeAttr("aria-selected","true"),s=[],r.selectedItems=n.grep(r.items,function(e,t){return e.selected&&s.push(t),e.selected===!0},undefined),r._trigger("selected",e,{selectedIndex:s,item:a,selectedItems:r.selectedItems}))},t.prototype._findItemsByValues=function(e){var t,r=[];return r=n.grep(this.items,function(n,r){t=!1;for(var i=0;i<e.length;i++)n.value===e[i]&&(t=!0);return t},undefined),r},t.prototype._findItemsByIndices=function(e){var t=this,r=this.items.length,i=[];return n.each(e,function(e,n){n>=0&&n<r&&i.push(t.items[n])}),i},t.prototype.getItems=function(e,t){var r=this,i,s,o,u;s=n.isArray(e),i=!s&&typeof e=="number"||s&&typeof e[0]=="number",o=s?e:[e];if(!t)u=r._findItemsByValues(o);else{if(!i)return null;u=r._findItemsByIndices(o)}return u},t.prototype.selectItems=function(e,t,r){var i=this,s=this.options.selectionMode==="single",u=o+" "+i.options.wijCSS.stateActive,a,f,l;l=i.getItems(e,r),s?(l.length>0&&(a=l[0],a.selected=!0,a.element.addClass(u)),f=i.selectedItem,f&&(f.selected=!1,f.element.removeClass(u)),i.selectedItem=a,t&&i._trigger("selected",null,{item:a,previousItem:f})):(n.each(l,function(e,t){t.selected=!0,t.element.addClass(u)}),i.selectedItems=n.grep(i.items,function(e){return e.selected},undefined),t&&i._trigger("selected",null,{selectedItems:i.selectedItems}))},t.prototype.unselectItems=function(e){var t=this,r=this.options.selectionMode,i=o+" "+t.options.wijCSS.stateActive,s,u;if(r==="single")s=t.selectedItem,s&&(s.selected=!1,s.element.removeClass(i),t.selectedItem=undefined);else{u=t.getItems(e,!0);if(!u||u.length===0)return;n.each(u,function(e,t){t.selected=!1,t.element.removeClass(i).removeClass("wijmo-wijcombobox-selecteditem")}),t.selectedItems=n.grep(t.items,function(e){return e.selected},undefined)}},t.prototype.renderList=function(){var e=this,t=this.ul,n=this.options,r,i,s,o,f;t.empty(),r=e.items;if(r===undefined||r===null)return;i=r.length;if(i===0)return;s=n.selectionMode==="single";for(o=0;o<i;o++)f=r[o],e._renderItem(t,f,o,s);i>0&&(r[0].element&&r[0].element.addClass(u),r[i-1].element&&r[i-1].element.addClass(a)),e._trigger("listRendered",null,e)},t.prototype._renderItem=function(e,t,r,i){var u=this,a=n("<li role='option' class='"+u.options.wijCSS.listItem+" "+u.options.wijCSS.cornerAll+"'></li>"),f=o+" "+u.options.wijCSS.stateActive,c,h;t.element=a,t.list=u;if(u._trigger("itemRendering",null,t)===!1)return;return c=t.label,t.title&&a.attr("title",t.title),t.templateHtml?c=t.templateHtml:t.text!==undefined&&(c=t.text),a.bind("mouseover",function(e){if(u.options.disabled)return;u.activate(e,t,!1)}).bind("mouseout",function(){if(u.options.disabled)return;u.options.keepHightlightOnMouseLeave||u.deactivate()}).data(l,t),t.templateHtml?a.append(c):a.text(c),a.appendTo(e),u._isInnerData||(h=t.imageUrl,h!==undefined&&h.length>0&&a.prepend("<img src='"+t.imageUrl+"'>")),t.selected&&(u.activate(null,t,!1),a.addClass(f)),r%2===1&&a.addClass(s),u._trigger("itemRendered",null,t),a},t.prototype._escapeRegex=function(e){return e===undefined?e:e.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},t.prototype.adjustOptions=function(){var e=this.options,t;if(e.data!==null)for(t=0;t<e.listItems.length;t++)delete e.listItems[t].element,delete e.listItems[t].list;return e},t.prototype.refreshSuperPanel=function(){var e=this,t=this.element,r=this.options,i=this.ul,s=i.children("."+e.options.wijCSS.listItem+":first"),o,u,a,f=t.find(".wijmo-wijsuperpanel-header"),l=t.find(".wijmo-wijsuperpanel-footer"),c=null,h,p,d,v,m,g,y;if(!t.is(":visible"))return!1;u=i.outerHeight(),a=t.innerWidth(),r.autoSize&&(c=s.outerHeight(!0)*r.maxItemsCount),c!==null&&t.height(Math.min(c,u)),h=t.innerHeight(),f.length&&(h-=f.height()),l.length&&(h-=l.height()),p=h/(u-h),m=101*p/(1+p),d=s.outerHeight()/(u-h)*(101-m),e.superPanel===undefined?(g={allowResize:!1,keyboardSupport:!1,bubbleScrollingEvent:!0,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollSmallChange:d,scrollLargeChange:m}},n.extend(g,r.superPanelOptions),e.superPanel=t.wijsuperpanel(g).data("wijmoWijsuperpanel"),e.superPanel&&e.superPanel.vNeedScrollBar&&(i.setOutWidth(a-18),e.superPanel.refresh())):(v=e.superPanel.options.vScroller,v.scrollLargeChange=m,v.scrollSmallChange=d,e.superPanel.paintPanel(),e.superPanel.vNeedScrollBar||n.support.isTouchEnabled&&n.support.isTouchEnabled()?(i.setOutWidth(a-18),e.superPanel.refresh()):(i.setOutWidth(t.outerWidth()),o=t.children(".wijmo-wijsuperpanel-header").outerHeight(),o!==null&&o!==undefined&&t.height(u+o),e.superPanel.refresh())),y=i.css("padding-top"),y.length>0?(v=e.superPanel.options.vScroller,v.firstStepChangeFix=e.superPanel.scrollPxToValue(parseFloat(y),"v")):v.firstStepChangeFix=0,i.setOutWidth(i.parent().parent().innerWidth()),r.disabled&&e.disabledDiv&&e.disabledDiv.css("left",t.offset().left).css("top",t.offset().top).css("width",t.outerWidth()).css("height",t.outerHeight())},t}(e.wijmoWidget);t.wijlist=c;var h=function(){function e(){this.wijCSS={listul:"wijmo-wijlist-ul",listItem:"wijmo-wijlist-item"},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-up-b",stateActive:"ui-btn-down-b"},this.initSelector=":jqmData(role='wijlist')",this.dataSource=null,this.listItems=[],this.selected=null,this.selectionMode="single",this.autoSize=!1,this.maxItemsCount=5,this.addHoverItemClass=!0,this.superPanelOptions=null,this.disabled=!1,this.focusing=null,this.focus=null,this.blur=null,this.itemRendering=null,this.itemRendered=null,this.listRendered=null,this.added=null,this.keepHightlightOnMouseLeave=!1}return e}();c.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new h),n.wijmo.registerWidget("wijlist",c.prototype)})(e.list||(e.list={}));var t=e.list})(wijmo||(wijmo={}));